[0m11:52:22.630116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faa7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc4f1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc4ec90>]}


============================== 11:52:22.638218 | f8b467e8-235b-450f-a31b-8d7882bbffa3 ==============================
[0m11:52:22.638218 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:52:22.639065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:52:26.132339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8b467e8-235b-450f-a31b-8d7882bbffa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11019a0f0>]}
[0m11:52:26.201110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8b467e8-235b-450f-a31b-8d7882bbffa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f631c70>]}
[0m11:52:26.202348 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:52:26.350821 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:52:26.444503 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:52:26.445074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8b467e8-235b-450f-a31b-8d7882bbffa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110994620>]}
[0m11:52:27.617380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8b467e8-235b-450f-a31b-8d7882bbffa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b71940>]}
[0m11:52:27.723471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8b467e8-235b-450f-a31b-8d7882bbffa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c47d70>]}
[0m11:52:27.724139 [info ] [MainThread]: Found 1 model, 1 source, 428 macros
[0m11:52:27.724618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8b467e8-235b-450f-a31b-8d7882bbffa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110240470>]}
[0m11:52:27.726962 [info ] [MainThread]: 
[0m11:52:27.727713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:52:27.728713 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:52:27.804128 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:52:27.804630 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:52:27.805018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:27.848152 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  role "admin" does not exist

[0m11:52:27.853696 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:52:27.854471 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:52:27.855247 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m11:52:27.855828 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:52:27.856347 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m11:52:27.857371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:27.857890 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:52:27.858326 [info ] [MainThread]: 
[0m11:52:27.858893 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m11:52:27.859564 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  role "admin" does not exist
  
[0m11:52:27.862989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.329828, "process_in_blocks": "0", "process_kernel_time": 0.489448, "process_mem_max_rss": "110206976", "process_out_blocks": "0", "process_user_time": 3.364888}
[0m11:52:27.863974 [debug] [MainThread]: Command `dbt run` failed at 11:52:27.863770 after 5.33 seconds
[0m11:52:27.864753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf5ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110241e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b2fa10>]}
[0m11:52:27.865773 [debug] [MainThread]: Flushing usage events
[0m12:55:58.411157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbd18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfeaf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfeaab0>]}


============================== 12:55:58.418376 | 6a40284e-adec-40b7-b59b-3847d96197e7 ==============================
[0m12:55:58.418376 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:55:58.419187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:55:58.711489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a40284e-adec-40b7-b59b-3847d96197e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae8c5f0>]}
[0m12:55:58.780178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a40284e-adec-40b7-b59b-3847d96197e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b5be0>]}
[0m12:55:58.781300 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:55:58.930822 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:55:59.075923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:55:59.076439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:55:59.116542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a40284e-adec-40b7-b59b-3847d96197e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5c7cb0>]}
[0m12:55:59.226019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a40284e-adec-40b7-b59b-3847d96197e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc96420>]}
[0m12:55:59.226608 [info ] [MainThread]: Found 1 model, 1 source, 428 macros
[0m12:55:59.227042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a40284e-adec-40b7-b59b-3847d96197e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c54ccb0>]}
[0m12:55:59.229713 [info ] [MainThread]: 
[0m12:55:59.230587 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:55:59.231813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:55:59.313486 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:55:59.313973 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:55:59.314356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:59.372047 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.058 seconds
[0m12:55:59.374306 [debug] [ThreadPool]: On list_postgres: Close
[0m12:55:59.375323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_pipedrive_analytics)
[0m12:55:59.375940 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_pipedrive_analytics"
"
[0m12:55:59.382468 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m12:55:59.382911 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: BEGIN
[0m12:55:59.383326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:59.399805 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m12:55:59.400530 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m12:55:59.400934 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_pipedrive_analytics"} */
create schema if not exists "public_pipedrive_analytics"
[0m12:55:59.402958 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m12:55:59.404159 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m12:55:59.404557 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m12:55:59.404915 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m12:55:59.406961 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m12:55:59.407476 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: Close
[0m12:55:59.408849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_pipedrive_analytics, now list_postgres_public_pipedrive_analytics)
[0m12:55:59.415989 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:55:59.416465 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m12:55:59.416822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:59.434390 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m12:55:59.434960 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:55:59.435438 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m12:55:59.440278 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m12:55:59.442429 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m12:55:59.444129 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m12:55:59.449501 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:59.449956 [debug] [MainThread]: On master: BEGIN
[0m12:55:59.450292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:59.467480 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m12:55:59.468051 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:59.468585 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:55:59.473594 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:55:59.475031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a40284e-adec-40b7-b59b-3847d96197e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdd9520>]}
[0m12:55:59.475580 [debug] [MainThread]: On master: ROLLBACK
[0m12:55:59.476970 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:59.477453 [debug] [MainThread]: On master: BEGIN
[0m12:55:59.479778 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:55:59.480629 [debug] [MainThread]: On master: COMMIT
[0m12:55:59.481116 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:59.481525 [debug] [MainThread]: On master: COMMIT
[0m12:55:59.482914 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:55:59.483417 [debug] [MainThread]: On master: Close
[0m12:55:59.483976 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:55:59.484577 [info ] [MainThread]: 
[0m12:55:59.487964 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m12:55:59.488631 [info ] [Thread-1 (]: 1 of 1 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m12:55:59.489210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.test_model)
[0m12:55:59.489652 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m12:55:59.498999 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m12:55:59.500496 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m12:55:59.551206 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m12:55:59.552074 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:55:59.552517 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: BEGIN
[0m12:55:59.552917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:59.570015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m12:55:59.570849 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:55:59.571348 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m12:55:59.577003 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.005 seconds
[0m12:55:59.584423 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:55:59.584917 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m12:55:59.587208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:55:59.608597 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m12:55:59.609093 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:55:59.609546 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m12:55:59.612628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:55:59.619575 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m12:55:59.625852 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m12:55:59.626365 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m12:55:59.629828 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:55:59.633338 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m12:55:59.636224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a40284e-adec-40b7-b59b-3847d96197e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a895670>]}
[0m12:55:59.637053 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 4579[0m in 0.14s]
[0m12:55:59.638386 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m12:55:59.640021 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:59.640485 [debug] [MainThread]: On master: BEGIN
[0m12:55:59.640842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:55:59.660541 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m12:55:59.661444 [debug] [MainThread]: On master: COMMIT
[0m12:55:59.661924 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:59.662336 [debug] [MainThread]: On master: COMMIT
[0m12:55:59.663774 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:55:59.664220 [debug] [MainThread]: On master: Close
[0m12:55:59.664734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:59.665140 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m12:55:59.665535 [info ] [MainThread]: 
[0m12:55:59.665961 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m12:55:59.666853 [debug] [MainThread]: Command end result
[0m12:55:59.695700 [info ] [MainThread]: 
[0m12:55:59.696296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:55:59.696710 [info ] [MainThread]: 
[0m12:55:59.697132 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:55:59.700128 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3831896, "process_in_blocks": "0", "process_kernel_time": 0.485808, "process_mem_max_rss": "107806720", "process_out_blocks": "0", "process_user_time": 2.499511}
[0m12:55:59.700902 [debug] [MainThread]: Command `dbt run` succeeded at 12:55:59.700754 after 1.38 seconds
[0m12:55:59.701590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfa9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b69c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9c4c20>]}
[0m12:55:59.702129 [debug] [MainThread]: Flushing usage events
[0m13:14:08.015059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1a6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3431a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e342c90>]}


============================== 13:14:08.023372 | df80fca9-dd5a-4ac1-8ba2-7b6fdb796164 ==============================
[0m13:14:08.023372 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:14:08.024948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:14:08.312570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df80fca9-dd5a-4ac1-8ba2-7b6fdb796164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e80e120>]}
[0m13:14:08.378576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df80fca9-dd5a-4ac1-8ba2-7b6fdb796164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e20d3a0>]}
[0m13:14:08.380498 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:14:08.521484 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:14:08.670215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:14:08.670788 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:14:08.709317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df80fca9-dd5a-4ac1-8ba2-7b6fdb796164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e938140>]}
[0m13:14:08.837178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df80fca9-dd5a-4ac1-8ba2-7b6fdb796164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2ff470>]}
[0m13:14:08.837889 [info ] [MainThread]: Found 1 model, 1 source, 428 macros
[0m13:14:08.838398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df80fca9-dd5a-4ac1-8ba2-7b6fdb796164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f133650>]}
[0m13:14:08.840923 [info ] [MainThread]: 
[0m13:14:08.841443 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:14:08.843599 [debug] [MainThread]: Command end result
[0m13:14:08.872064 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9457402, "process_in_blocks": "0", "process_kernel_time": 0.486952, "process_mem_max_rss": "102731776", "process_out_blocks": "0", "process_user_time": 2.363084}
[0m13:14:08.872926 [debug] [MainThread]: Command `dbt test` succeeded at 13:14:08.872783 after 0.95 seconds
[0m13:14:08.873418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6bed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dde0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1a6210>]}
[0m13:14:08.873853 [debug] [MainThread]: Flushing usage events
[0m13:31:53.986233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5b920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801b440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801af30>]}


============================== 13:31:53.995665 | 136c4155-7088-4107-99b6-f3d45e4548a6 ==============================
[0m13:31:53.995665 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:31:53.997022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:31:54.283372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '136c4155-7088-4107-99b6-f3d45e4548a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107661100>]}
[0m13:31:54.348879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '136c4155-7088-4107-99b6-f3d45e4548a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b9730>]}
[0m13:31:54.350827 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:31:54.495029 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:31:54.634153 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m13:31:54.634702 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/test_model.sql
[0m13:31:54.686881 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.enpal_assessment_project
[0m13:31:54.704077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '136c4155-7088-4107-99b6-f3d45e4548a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108611490>]}
[0m13:31:54.798150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '136c4155-7088-4107-99b6-f3d45e4548a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e35ca0>]}
[0m13:31:54.798777 [info ] [MainThread]: Found 1 source, 428 macros
[0m13:31:54.799197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '136c4155-7088-4107-99b6-f3d45e4548a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086109b0>]}
[0m13:31:54.801260 [info ] [MainThread]: 
[0m13:31:54.801710 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:31:54.803788 [debug] [MainThread]: Command end result
[0m13:31:54.830063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.94013536, "process_in_blocks": "0", "process_kernel_time": 0.472724, "process_mem_max_rss": "100003840", "process_out_blocks": "0", "process_user_time": 2.342559}
[0m13:31:54.830991 [debug] [MainThread]: Command `dbt run` succeeded at 13:31:54.830801 after 0.94 seconds
[0m13:31:54.831753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aac620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fad50>]}
[0m13:31:54.832269 [debug] [MainThread]: Flushing usage events
[0m13:32:36.553130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103985160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e3b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e3ad20>]}


============================== 13:32:36.558306 | d843b4c3-e05a-4740-83de-09ec147864ed ==============================
[0m13:32:36.558306 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:32:36.559191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:32:36.798133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd843b4c3-e05a-4740-83de-09ec147864ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103875610>]}
[0m13:32:36.865123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd843b4c3-e05a-4740-83de-09ec147864ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ebc200>]}
[0m13:32:36.866058 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:32:36.996090 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:32:37.092999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:32:37.093440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:32:37.094014 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.enpal_assessment_project
[0m13:32:37.109098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd843b4c3-e05a-4740-83de-09ec147864ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452c080>]}
[0m13:32:37.190383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd843b4c3-e05a-4740-83de-09ec147864ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c34b30>]}
[0m13:32:37.191032 [info ] [MainThread]: Found 1 source, 428 macros
[0m13:32:37.191453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd843b4c3-e05a-4740-83de-09ec147864ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b238f0>]}
[0m13:32:37.193698 [info ] [MainThread]: 
[0m13:32:37.194292 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:32:37.196491 [debug] [MainThread]: Command end result
[0m13:32:37.222443 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.75012475, "process_in_blocks": "0", "process_kernel_time": 0.326546, "process_mem_max_rss": "99532800", "process_out_blocks": "0", "process_user_time": 2.050174}
[0m13:32:37.223357 [debug] [MainThread]: Command `dbt run` succeeded at 13:32:37.223208 after 0.75 seconds
[0m13:32:37.223926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a218e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452cb60>]}
[0m13:32:37.224398 [debug] [MainThread]: Flushing usage events
[0m13:44:22.967867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf7ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf7a9c0>]}


============================== 13:44:22.976647 | 248688b9-d91e-4cc4-bfb4-fa7849cc372c ==============================
[0m13:44:22.976647 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:44:22.977803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:44:23.269145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '248688b9-d91e-4cc4-bfb4-fa7849cc372c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b826930>]}
[0m13:44:23.337660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '248688b9-d91e-4cc4-bfb4-fa7849cc372c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce66540>]}
[0m13:44:23.339259 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:44:23.484477 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:44:23.552621 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:44:23.553193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '248688b9-d91e-4cc4-bfb4-fa7849cc372c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c528b90>]}
[0m13:44:24.779181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '248688b9-d91e-4cc4-bfb4-fa7849cc372c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c528d40>]}
[0m13:44:24.894990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '248688b9-d91e-4cc4-bfb4-fa7849cc372c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de57fe0>]}
[0m13:44:24.895549 [info ] [MainThread]: Found 1 model, 1 source, 428 macros
[0m13:44:24.896046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '248688b9-d91e-4cc4-bfb4-fa7849cc372c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d046960>]}
[0m13:44:24.898562 [info ] [MainThread]: 
[0m13:44:24.899544 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:44:24.901148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:44:24.980261 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:44:24.980733 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:44:24.981098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:25.047673 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.066 seconds
[0m13:44:25.049287 [debug] [ThreadPool]: On list_postgres: Close
[0m13:44:25.050756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:44:25.057611 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:44:25.058059 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m13:44:25.058394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:25.074522 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m13:44:25.075022 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:44:25.075556 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:44:25.079455 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:44:25.080955 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:44:25.082185 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:44:25.087245 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:25.087714 [debug] [MainThread]: On master: BEGIN
[0m13:44:25.088052 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:25.103612 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m13:44:25.104108 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:25.104608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:44:25.109838 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m13:44:25.111203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '248688b9-d91e-4cc4-bfb4-fa7849cc372c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df6de80>]}
[0m13:44:25.111689 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:25.112911 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:25.113303 [debug] [MainThread]: On master: BEGIN
[0m13:44:25.115100 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:44:25.115698 [debug] [MainThread]: On master: COMMIT
[0m13:44:25.116258 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:25.116667 [debug] [MainThread]: On master: COMMIT
[0m13:44:25.117929 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:44:25.118354 [debug] [MainThread]: On master: Close
[0m13:44:25.118890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:44:25.119320 [info ] [MainThread]: 
[0m13:44:25.122695 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:44:25.123362 [info ] [Thread-1 (]: 1 of 1 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m13:44:25.123918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m13:44:25.124349 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:44:25.133251 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:25.135343 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:44:25.182202 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:25.183254 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:25.183775 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m13:44:25.184235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:25.200869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:44:25.201544 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:25.202030 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m13:44:25.205863 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:44:25.212951 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:25.213446 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m13:44:25.215050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:25.231617 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:44:25.232123 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:25.232533 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:44:25.234940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:44:25.241754 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m13:44:25.247553 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:25.248054 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m13:44:25.249854 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:44:25.252731 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m13:44:25.254507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '248688b9-d91e-4cc4-bfb4-fa7849cc372c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfa66c0>]}
[0m13:44:25.255313 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.13s]
[0m13:44:25.256228 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:44:25.257848 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:25.258351 [debug] [MainThread]: On master: BEGIN
[0m13:44:25.258874 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:25.277182 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m13:44:25.277846 [debug] [MainThread]: On master: COMMIT
[0m13:44:25.278265 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:25.278619 [debug] [MainThread]: On master: COMMIT
[0m13:44:25.279790 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:44:25.280209 [debug] [MainThread]: On master: Close
[0m13:44:25.280734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:25.281095 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__activity' was properly closed.
[0m13:44:25.281494 [info ] [MainThread]: 
[0m13:44:25.281922 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m13:44:25.282857 [debug] [MainThread]: Command end result
[0m13:44:25.371713 [info ] [MainThread]: 
[0m13:44:25.372272 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:25.372666 [info ] [MainThread]: 
[0m13:44:25.373081 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:44:25.376234 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5042033, "process_in_blocks": "0", "process_kernel_time": 0.508846, "process_mem_max_rss": "112644096", "process_out_blocks": "0", "process_user_time": 3.644893}
[0m13:44:25.376926 [debug] [MainThread]: Command `dbt run` succeeded at 13:44:25.376796 after 2.51 seconds
[0m13:44:25.377375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3898e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10accd070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce678f0>]}
[0m13:44:25.377787 [debug] [MainThread]: Flushing usage events
[0m13:53:27.739438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f81ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105db110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105dac30>]}


============================== 13:53:27.747317 | cae1f26e-73fe-4bd7-bf31-9d6a5dc24017 ==============================
[0m13:53:27.747317 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:53:27.748073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:53:28.035746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cae1f26e-73fe-4bd7-bf31-9d6a5dc24017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4785c0>]}
[0m13:53:28.100754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cae1f26e-73fe-4bd7-bf31-9d6a5dc24017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea164e0>]}
[0m13:53:28.102689 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:53:28.250085 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:53:28.397473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m13:53:28.398194 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__fields.sql
[0m13:53:28.398686 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__deal_changes.sql
[0m13:53:28.399151 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__stages.sql
[0m13:53:28.399557 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__activity_types.sql
[0m13:53:28.399961 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__users.sql
[0m13:53:28.618700 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.stg_pipedrive__fields' (models/staging/stg_pipedrive__fields.sql) depends on a source named 'postgres_public.fields' which was not found
[0m13:53:28.621462 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.98127276, "process_in_blocks": "0", "process_kernel_time": 0.454799, "process_mem_max_rss": "98189312", "process_out_blocks": "0", "process_user_time": 2.345927}
[0m13:53:28.622366 [debug] [MainThread]: Command `dbt run` failed at 13:53:28.622169 after 0.98 seconds
[0m13:53:28.622905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8fad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef860c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11140f650>]}
[0m13:53:28.623425 [debug] [MainThread]: Flushing usage events
[0m13:55:02.228531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4fb5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c09b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c09ac60>]}


============================== 13:55:02.236126 | df4df9a2-0147-455f-b8d4-e74ad03acb74 ==============================
[0m13:55:02.236126 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:55:02.237180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:55:02.513563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df4df9a2-0147-455f-b8d4-e74ad03acb74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af401d0>]}
[0m13:55:02.581092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df4df9a2-0147-455f-b8d4-e74ad03acb74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a94a7e0>]}
[0m13:55:02.582746 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:55:02.733263 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:55:02.876363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m13:55:02.876976 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__stages.sql
[0m13:55:02.877412 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__deal_changes.sql
[0m13:55:02.877787 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__activity_types.sql
[0m13:55:02.878158 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__fields.sql
[0m13:55:02.878564 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__users.sql
[0m13:55:03.104525 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.stg_pipedrive__stages' (models/staging/stg_pipedrive__stages.sql) depends on a source named 'postgres_public.stages' which was not found
[0m13:55:03.108298 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9772314, "process_in_blocks": "0", "process_kernel_time": 0.387069, "process_mem_max_rss": "98902016", "process_out_blocks": "0", "process_user_time": 2.246496}
[0m13:55:03.109150 [debug] [MainThread]: Command `dbt run` failed at 13:55:03.108991 after 0.98 seconds
[0m13:55:03.109674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd2f2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aefd7c0>]}
[0m13:55:03.110354 [debug] [MainThread]: Flushing usage events
[0m13:56:28.290961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce545f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2bb170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2bac60>]}


============================== 13:56:28.299483 | 62a387d1-e3c4-45cc-9c6c-2d546eb34be0 ==============================
[0m13:56:28.299483 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:56:28.300343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:56:28.584717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62a387d1-e3c4-45cc-9c6c-2d546eb34be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d77e420>]}
[0m13:56:28.654432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62a387d1-e3c4-45cc-9c6c-2d546eb34be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b26ed20>]}
[0m13:56:28.655800 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:56:28.810403 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:56:28.960249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m13:56:28.960945 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__users.sql
[0m13:56:28.961504 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__stages.sql
[0m13:56:28.961943 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__activity_types.sql
[0m13:56:28.962357 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__deal_changes.sql
[0m13:56:29.175543 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.stg_pipedrive__users' (models/staging/stg_pipedrive__users.sql) depends on a source named 'postgres_public.users' which was not found
[0m13:56:29.181585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9856079, "process_in_blocks": "0", "process_kernel_time": 0.459976, "process_mem_max_rss": "99012608", "process_out_blocks": "0", "process_user_time": 2.392054}
[0m13:56:29.182497 [debug] [MainThread]: Command `dbt run` failed at 13:56:29.182329 after 0.99 seconds
[0m13:56:29.183101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc7afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcbddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0bb260>]}
[0m13:56:29.183726 [debug] [MainThread]: Flushing usage events
[0m13:57:40.240487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7da570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e97b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e97ad50>]}


============================== 13:57:40.245939 | 6f9511cf-8784-4b01-b75d-54e09f187945 ==============================
[0m13:57:40.245939 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:57:40.247209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:40.483081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f9511cf-8784-4b01-b75d-54e09f187945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eec6bd0>]}
[0m13:57:40.552044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f9511cf-8784-4b01-b75d-54e09f187945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e353020>]}
[0m13:57:40.553009 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:57:40.692523 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:57:40.811581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m13:57:40.812193 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__fields.sql
[0m13:57:40.812603 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__users.sql
[0m13:57:40.813065 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__deal_changes.sql
[0m13:57:40.813501 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__activity_types.sql
[0m13:57:40.813899 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__stages.sql
[0m13:57:40.814472 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/sources.yml
[0m13:57:41.131381 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.stg_pipedrive__activity_types' (models/staging/stg_pipedrive__activity_types.sql) depends on a source named 'postgres_public.activity_types' which was not found
[0m13:57:41.133219 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.97407824, "process_in_blocks": "0", "process_kernel_time": 0.289983, "process_mem_max_rss": "100061184", "process_out_blocks": "0", "process_user_time": 2.203568}
[0m13:57:41.133929 [debug] [MainThread]: Command `dbt run` failed at 13:57:41.133793 after 0.97 seconds
[0m13:57:41.134414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e97aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f84ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f84c920>]}
[0m13:57:41.134853 [debug] [MainThread]: Flushing usage events
[0m13:58:19.056907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad968d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10add72c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10add6d80>]}


============================== 13:58:19.062281 | b5d4dc59-5d41-4df8-93e2-8a1906a0273f ==============================
[0m13:58:19.062281 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:58:19.063333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:58:19.294012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5d4dc59-5d41-4df8-93e2-8a1906a0273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeed3d0>]}
[0m13:58:19.359049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5d4dc59-5d41-4df8-93e2-8a1906a0273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c36750>]}
[0m13:58:19.359966 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:58:19.489142 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:58:19.605078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m13:58:19.605689 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__stages.sql
[0m13:58:19.606097 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__fields.sql
[0m13:58:19.606482 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__users.sql
[0m13:58:19.606866 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__deal_changes.sql
[0m13:58:19.607247 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__activity_types.sql
[0m13:58:19.607808 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/sources.yml
[0m13:58:19.994063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5d4dc59-5d41-4df8-93e2-8a1906a0273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd268a0>]}
[0m13:58:20.105443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5d4dc59-5d41-4df8-93e2-8a1906a0273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc28f50>]}
[0m13:58:20.106014 [info ] [MainThread]: Found 6 models, 6 sources, 428 macros
[0m13:58:20.106441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d4dc59-5d41-4df8-93e2-8a1906a0273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a864e60>]}
[0m13:58:20.108891 [info ] [MainThread]: 
[0m13:58:20.109651 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:58:20.114604 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:58:20.203517 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:58:20.203970 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:58:20.204337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:20.258230 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.054 seconds
[0m13:58:20.259873 [debug] [ThreadPool]: On list_postgres: Close
[0m13:58:20.261538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:58:20.268413 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:58:20.268858 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m13:58:20.269199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:20.285288 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m13:58:20.286027 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:58:20.286490 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:58:20.290429 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:58:20.291971 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:58:20.293190 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:58:20.298611 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:20.299052 [debug] [MainThread]: On master: BEGIN
[0m13:58:20.299384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:20.315033 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m13:58:20.315609 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:20.316116 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:58:20.321182 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m13:58:20.322666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d4dc59-5d41-4df8-93e2-8a1906a0273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcccc20>]}
[0m13:58:20.323157 [debug] [MainThread]: On master: ROLLBACK
[0m13:58:20.324425 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:20.324837 [debug] [MainThread]: On master: BEGIN
[0m13:58:20.326887 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:58:20.327418 [debug] [MainThread]: On master: COMMIT
[0m13:58:20.327847 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:20.328195 [debug] [MainThread]: On master: COMMIT
[0m13:58:20.329434 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:58:20.329828 [debug] [MainThread]: On master: Close
[0m13:58:20.330460 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:58:20.330910 [info ] [MainThread]: 
[0m13:58:20.333742 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:58:20.334436 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m13:58:20.335038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m13:58:20.335501 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:58:20.346654 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:58:20.348124 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:58:20.387232 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:58:20.388414 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:58:20.388945 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m13:58:20.389359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:20.406350 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:58:20.407045 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:58:20.407530 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m13:58:20.410268 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:58:20.417504 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:58:20.418016 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m13:58:20.419614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:58:20.422988 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:58:20.423438 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m13:58:20.425396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:58:20.444430 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:58:20.444934 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:58:20.445364 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:58:20.448163 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:58:20.455086 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m13:58:20.460667 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:58:20.461147 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m13:58:20.464358 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:58:20.467294 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m13:58:20.468934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d4dc59-5d41-4df8-93e2-8a1906a0273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109681790>]}
[0m13:58:20.469705 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.13s]
[0m13:58:20.470559 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:58:20.471174 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:58:20.471747 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m13:58:20.472299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m13:58:20.472730 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:58:20.476945 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:58:20.478128 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:58:20.482803 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:58:20.485047 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:58:20.485535 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m13:58:20.485944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:20.504079 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:58:20.504665 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:58:20.505124 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity_types"
  );
[0m13:58:20.508538 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:58:20.511803 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:58:20.512242 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m13:58:20.513910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:58:20.515672 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:58:20.516111 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:58:20.516635 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:58:20.518501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:58:20.521123 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m13:58:20.522290 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:58:20.522926 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m13:58:20.524432 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:58:20.526022 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m13:58:20.526624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d4dc59-5d41-4df8-93e2-8a1906a0273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1ff3b0>]}
[0m13:58:20.527307 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.05s]
[0m13:58:20.528170 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:58:20.528855 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:58:20.529837 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m13:58:20.530475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m13:58:20.530967 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:58:20.534049 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:58:20.534997 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:58:20.538886 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:58:20.539934 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:58:20.540549 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m13:58:20.541063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:20.560623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:58:20.561323 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:58:20.561792 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."deal_changes"
  );
[0m13:58:20.564487 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:58:20.568093 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:58:20.568659 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m13:58:20.570591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:58:20.572605 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:58:20.573122 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:58:20.573555 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:58:20.575700 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:58:20.578410 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m13:58:20.579327 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:58:20.580054 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m13:58:20.581969 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:58:20.583806 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m13:58:20.584542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d4dc59-5d41-4df8-93e2-8a1906a0273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c09ce30>]}
[0m13:58:20.585445 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.05s]
[0m13:58:20.586403 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:58:20.586974 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields
[0m13:58:20.587887 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__fields ... [RUN]
[0m13:58:20.588570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__fields)
[0m13:58:20.589073 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields
[0m13:58:20.591937 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m13:58:20.592753 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields
[0m13:58:20.596482 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m13:58:20.597439 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m13:58:20.597913 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: BEGIN
[0m13:58:20.598316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:20.614869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:58:20.615397 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m13:58:20.615852 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m13:58:20.618860 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:58:20.622376 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m13:58:20.622888 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp" rename to "stg_pipedrive__fields"
[0m13:58:20.624544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:58:20.626566 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m13:58:20.627019 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m13:58:20.627427 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m13:58:20.629125 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:58:20.633114 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup"
[0m13:58:20.634122 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m13:58:20.634597 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup" cascade
[0m13:58:20.636125 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:58:20.637685 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: Close
[0m13:58:20.638305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d4dc59-5d41-4df8-93e2-8a1906a0273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2585c0>]}
[0m13:58:20.639007 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields  [[32mCREATE VIEW[0m in 0.05s]
[0m13:58:20.639727 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields
[0m13:58:20.640247 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:58:20.640993 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m13:58:20.641558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m13:58:20.641996 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:58:20.644633 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:58:20.645407 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:58:20.649532 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:58:20.650417 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:58:20.651005 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m13:58:20.651440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:20.667413 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:58:20.668044 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:58:20.668498 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."stages"
  );
[0m13:58:20.670700 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:58:20.674145 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:58:20.674620 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m13:58:20.676207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:58:20.677911 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:58:20.678352 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:58:20.678760 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:58:20.680650 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:58:20.683271 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m13:58:20.684082 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:58:20.684515 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m13:58:20.686037 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:58:20.687638 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m13:58:20.688209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d4dc59-5d41-4df8-93e2-8a1906a0273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c25af30>]}
[0m13:58:20.688872 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.05s]
[0m13:58:20.689594 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:58:20.690091 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:58:20.690900 [info ] [Thread-1 (]: 6 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m13:58:20.691620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m13:58:20.692088 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m13:58:20.694771 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:58:20.695558 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m13:58:20.699830 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:58:20.701067 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:58:20.701681 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m13:58:20.702238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:20.719567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:58:20.720143 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:58:20.720593 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m13:58:20.723132 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:58:20.727113 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:58:20.727631 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m13:58:20.729297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:58:20.731059 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:58:20.731533 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:58:20.731946 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:58:20.733734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:58:20.736509 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m13:58:20.737441 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:58:20.737962 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m13:58:20.739389 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:58:20.740991 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m13:58:20.741583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d4dc59-5d41-4df8-93e2-8a1906a0273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0ee9f0>]}
[0m13:58:20.742286 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.05s]
[0m13:58:20.742996 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:58:20.744387 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:20.744848 [debug] [MainThread]: On master: BEGIN
[0m13:58:20.745199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:20.760490 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m13:58:20.761208 [debug] [MainThread]: On master: COMMIT
[0m13:58:20.761620 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:20.761982 [debug] [MainThread]: On master: COMMIT
[0m13:58:20.763381 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:58:20.763952 [debug] [MainThread]: On master: Close
[0m13:58:20.764594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:20.765132 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__users' was properly closed.
[0m13:58:20.765608 [info ] [MainThread]: 
[0m13:58:20.766187 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m13:58:20.768177 [debug] [MainThread]: Command end result
[0m13:58:20.797338 [info ] [MainThread]: 
[0m13:58:20.797853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:58:20.798236 [info ] [MainThread]: 
[0m13:58:20.798642 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:58:20.800313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8278074, "process_in_blocks": "0", "process_kernel_time": 0.363255, "process_mem_max_rss": "112988160", "process_out_blocks": "0", "process_user_time": 2.794194}
[0m13:58:20.800987 [debug] [MainThread]: Command `dbt run` succeeded at 13:58:20.800856 after 1.83 seconds
[0m13:58:20.801448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c75e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109baf530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba7b0b0>]}
[0m13:58:20.801867 [debug] [MainThread]: Flushing usage events
[0m14:47:31.594234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b964b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d47320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d46d50>]}


============================== 14:47:31.601187 | 75a4631d-b57e-47f0-9d18-bed7eb1109fb ==============================
[0m14:47:31.601187 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:47:31.602087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:47:31.895382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75a4631d-b57e-47f0-9d18-bed7eb1109fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11328dfa0>]}
[0m14:47:31.962135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75a4631d-b57e-47f0-9d18-bed7eb1109fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112130c20>]}
[0m14:47:31.963705 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:47:32.110936 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:47:32.262003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:47:32.262732 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/schema.yml
[0m14:47:32.329735 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:47:32.330337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '75a4631d-b57e-47f0-9d18-bed7eb1109fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b53290>]}
[0m14:47:32.574271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75a4631d-b57e-47f0-9d18-bed7eb1109fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c341d0>]}
[0m14:47:32.719201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75a4631d-b57e-47f0-9d18-bed7eb1109fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ebad50>]}
[0m14:47:32.719804 [info ] [MainThread]: Found 6 models, 2 data tests, 6 sources, 428 macros
[0m14:47:32.720234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a4631d-b57e-47f0-9d18-bed7eb1109fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e7a810>]}
[0m14:47:32.722574 [info ] [MainThread]: 
[0m14:47:32.723268 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:47:32.728156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m14:47:32.808139 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m14:47:32.808615 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m14:47:32.809133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:32.868243 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m14:47:32.868905 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m14:47:32.869373 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m14:47:32.873739 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m14:47:32.875651 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m14:47:32.877046 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m14:47:32.883526 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:32.883972 [debug] [MainThread]: On master: BEGIN
[0m14:47:32.884314 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:47:32.901219 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m14:47:32.901955 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:32.902562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:47:32.908066 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m14:47:32.909681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a4631d-b57e-47f0-9d18-bed7eb1109fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11164e510>]}
[0m14:47:32.910231 [debug] [MainThread]: On master: ROLLBACK
[0m14:47:32.911638 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:32.912062 [debug] [MainThread]: On master: BEGIN
[0m14:47:32.914048 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:47:32.914546 [debug] [MainThread]: On master: COMMIT
[0m14:47:32.914942 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:32.915294 [debug] [MainThread]: On master: COMMIT
[0m14:47:32.916492 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:47:32.916925 [debug] [MainThread]: On master: Close
[0m14:47:32.917459 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:47:32.917907 [info ] [MainThread]: 
[0m14:47:32.921163 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m14:47:32.921716 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_pipedrive__activity_id .......................... [RUN]
[0m14:47:32.922270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m14:47:32.922706 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m14:47:32.944670 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m14:47:32.945697 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m14:47:32.963292 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m14:47:32.964356 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m14:47:32.964794 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m14:47:32.965191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:32.981031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m14:47:32.981601 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m14:47:32.982073 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m14:47:32.984326 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 13: select id
                ^

[0m14:47:32.984923 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m14:47:32.986784 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m14:47:32.999189 [debug] [Thread-1 (]: Database Error in test not_null_stg_pipedrive__activity_id (models/staging/schema.yml)
  column "id" does not exist
  LINE 13: select id
                  ^
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/not_null_stg_pipedrive__activity_id.sql
[0m14:47:32.999854 [error] [Thread-1 (]: 1 of 2 ERROR not_null_stg_pipedrive__activity_id ............................... [[31mERROR[0m in 0.08s]
[0m14:47:33.000722 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m14:47:33.001238 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9
[0m14:47:33.002428 [info ] [Thread-1 (]: 2 of 2 START test unique_stg_pipedrive__activity_id ............................ [RUN]
[0m14:47:33.003048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9)
[0m14:47:33.003523 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9
[0m14:47:33.014223 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9"
[0m14:47:33.015137 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9
[0m14:47:33.017412 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9"
[0m14:47:33.018183 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9"
[0m14:47:33.018741 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9: BEGIN
[0m14:47:33.019238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:33.035586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m14:47:33.036309 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9"
[0m14:47:33.036777 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:47:33.038692 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 12:     id as unique_field,
             ^

[0m14:47:33.039273 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9: ROLLBACK
[0m14:47:33.041367 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9: Close
[0m14:47:33.045075 [debug] [Thread-1 (]: Database Error in test unique_stg_pipedrive__activity_id (models/staging/schema.yml)
  column "id" does not exist
  LINE 12:     id as unique_field,
               ^
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/unique_stg_pipedrive__activity_id.sql
[0m14:47:33.046221 [error] [Thread-1 (]: 2 of 2 ERROR unique_stg_pipedrive__activity_id ................................. [[31mERROR[0m in 0.04s]
[0m14:47:33.047066 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9
[0m14:47:33.048422 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:33.048816 [debug] [MainThread]: On master: BEGIN
[0m14:47:33.049155 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:47:33.068109 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m14:47:33.068895 [debug] [MainThread]: On master: COMMIT
[0m14:47:33.069669 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:33.070298 [debug] [MainThread]: On master: COMMIT
[0m14:47:33.073436 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:47:33.074275 [debug] [MainThread]: On master: Close
[0m14:47:33.074922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:33.075353 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_pipedrive__activity_id.79ccca21a9' was properly closed.
[0m14:47:33.075977 [info ] [MainThread]: 
[0m14:47:33.076427 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m14:47:33.077981 [debug] [MainThread]: Command end result
[0m14:47:33.108123 [info ] [MainThread]: 
[0m14:47:33.108699 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:47:33.109092 [info ] [MainThread]: 
[0m14:47:33.109578 [error] [MainThread]:   Database Error in test not_null_stg_pipedrive__activity_id (models/staging/schema.yml)
  column "id" does not exist
  LINE 13: select id
                  ^
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/not_null_stg_pipedrive__activity_id.sql
[0m14:47:33.109952 [info ] [MainThread]: 
[0m14:47:33.110430 [error] [MainThread]:   Database Error in test unique_stg_pipedrive__activity_id (models/staging/schema.yml)
  column "id" does not exist
  LINE 12:     id as unique_field,
               ^
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/unique_stg_pipedrive__activity_id.sql
[0m14:47:33.110918 [info ] [MainThread]: 
[0m14:47:33.111339 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m14:47:33.114551 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.6220015, "process_in_blocks": "0", "process_kernel_time": 0.532661, "process_mem_max_rss": "113577984", "process_out_blocks": "0", "process_user_time": 2.822276}
[0m14:47:33.115563 [debug] [MainThread]: Command `dbt test` failed at 14:47:33.115358 after 1.62 seconds
[0m14:47:33.116181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f056d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141a3f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114213410>]}
[0m14:47:33.116762 [debug] [MainThread]: Flushing usage events
[0m14:48:08.218617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e5d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111abf050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111abeb70>]}


============================== 14:48:08.225997 | 8257fb63-c026-41f0-b6dc-d5982c51ca51 ==============================
[0m14:48:08.225997 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:48:08.226782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:48:08.482968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8257fb63-c026-41f0-b6dc-d5982c51ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ae8a40>]}
[0m14:48:08.550147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8257fb63-c026-41f0-b6dc-d5982c51ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103ca420>]}
[0m14:48:08.551379 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:48:08.692429 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:48:08.857252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:48:08.858224 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/schema.yml
[0m14:48:09.143014 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:48:09.144050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8257fb63-c026-41f0-b6dc-d5982c51ca51', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b67a40>]}
[0m14:48:09.350845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8257fb63-c026-41f0-b6dc-d5982c51ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aac7a0>]}
[0m14:48:09.495698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8257fb63-c026-41f0-b6dc-d5982c51ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d654f0>]}
[0m14:48:09.496284 [info ] [MainThread]: Found 6 models, 2 data tests, 6 sources, 428 macros
[0m14:48:09.496726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8257fb63-c026-41f0-b6dc-d5982c51ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b43b00>]}
[0m14:48:09.499167 [info ] [MainThread]: 
[0m14:48:09.499897 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:48:09.504536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m14:48:09.580677 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m14:48:09.581164 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m14:48:09.581546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:09.616768 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m14:48:09.617325 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m14:48:09.617913 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m14:48:09.623242 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m14:48:09.625330 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m14:48:09.626729 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m14:48:09.633231 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:09.633672 [debug] [MainThread]: On master: BEGIN
[0m14:48:09.634017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:48:09.650946 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m14:48:09.651484 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:09.651960 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:48:09.656764 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m14:48:09.658407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8257fb63-c026-41f0-b6dc-d5982c51ca51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103ca660>]}
[0m14:48:09.658941 [debug] [MainThread]: On master: ROLLBACK
[0m14:48:09.660341 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:09.660799 [debug] [MainThread]: On master: BEGIN
[0m14:48:09.662771 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:48:09.663263 [debug] [MainThread]: On master: COMMIT
[0m14:48:09.663643 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:09.663988 [debug] [MainThread]: On master: COMMIT
[0m14:48:09.665145 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:48:09.665559 [debug] [MainThread]: On master: Close
[0m14:48:09.666104 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:48:09.666535 [info ] [MainThread]: 
[0m14:48:09.669724 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m14:48:09.670269 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_pipedrive__activity_activity_id ................. [RUN]
[0m14:48:09.670820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287)
[0m14:48:09.671250 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m14:48:09.693554 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m14:48:09.694478 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m14:48:09.713151 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m14:48:09.714099 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m14:48:09.714539 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: BEGIN
[0m14:48:09.714931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:09.730920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m14:48:09.731510 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m14:48:09.731963 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where activity_id is null



      
    ) dbt_internal_test
[0m14:48:09.735454 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:48:09.740265 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: ROLLBACK
[0m14:48:09.742062 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: Close
[0m14:48:09.742896 [info ] [Thread-1 (]: 1 of 2 PASS not_null_stg_pipedrive__activity_activity_id ....................... [[32mPASS[0m in 0.07s]
[0m14:48:09.743753 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m14:48:09.744315 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988
[0m14:48:09.744772 [info ] [Thread-1 (]: 2 of 2 START test unique_stg_pipedrive__activity_activity_id ................... [RUN]
[0m14:48:09.745540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287, now test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988)
[0m14:48:09.745992 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988
[0m14:48:09.752998 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988"
[0m14:48:09.753877 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988
[0m14:48:09.756352 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988"
[0m14:48:09.757616 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988"
[0m14:48:09.758286 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988: BEGIN
[0m14:48:09.758712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:09.777831 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m14:48:09.778476 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988"
[0m14:48:09.778931 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where activity_id is not null
group by activity_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:48:09.783068 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:48:09.784961 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988: ROLLBACK
[0m14:48:09.786478 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988: Close
[0m14:48:09.787510 [error] [Thread-1 (]: 2 of 2 FAIL 11 unique_stg_pipedrive__activity_activity_id ...................... [[31mFAIL 11[0m in 0.04s]
[0m14:48:09.788606 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988
[0m14:48:09.790366 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:09.790846 [debug] [MainThread]: On master: BEGIN
[0m14:48:09.791215 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:48:09.810396 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m14:48:09.811384 [debug] [MainThread]: On master: COMMIT
[0m14:48:09.812131 [debug] [MainThread]: Using postgres connection "master"
[0m14:48:09.812640 [debug] [MainThread]: On master: COMMIT
[0m14:48:09.814777 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m14:48:09.815215 [debug] [MainThread]: On master: Close
[0m14:48:09.815705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:09.816186 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_pipedrive__activity_activity_id.0235be8988' was properly closed.
[0m14:48:09.816676 [info ] [MainThread]: 
[0m14:48:09.817254 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m14:48:09.818543 [debug] [MainThread]: Command end result
[0m14:48:09.849832 [info ] [MainThread]: 
[0m14:48:09.850352 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:48:09.850733 [info ] [MainThread]: 
[0m14:48:09.851207 [error] [MainThread]: [31mFailure in test unique_stg_pipedrive__activity_activity_id (models/staging/schema.yml)[0m
[0m14:48:09.851655 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m14:48:09.852016 [info ] [MainThread]: 
[0m14:48:09.852448 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/schema.yml/unique_stg_pipedrive__activity_activity_id.sql
[0m14:48:09.852855 [info ] [MainThread]: 
[0m14:48:09.853286 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:48:09.855645 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.729615, "process_in_blocks": "0", "process_kernel_time": 0.489039, "process_mem_max_rss": "116441088", "process_out_blocks": "0", "process_user_time": 2.998165}
[0m14:48:09.856393 [debug] [MainThread]: Command `dbt test` failed at 14:48:09.856252 after 1.73 seconds
[0m14:48:09.856897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dddad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130dbc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a8b560>]}
[0m14:48:09.857336 [debug] [MainThread]: Flushing usage events
[0m15:14:18.637418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c33ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e00b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e00ab40>]}


============================== 15:14:18.644896 | 312366b0-3e07-4b34-ae70-7c61a2945fbc ==============================
[0m15:14:18.644896 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:14:18.645770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:14:19.029335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '312366b0-3e07-4b34-ae70-7c61a2945fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e55e3c0>]}
[0m15:14:19.098960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '312366b0-3e07-4b34-ae70-7c61a2945fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5be1b0>]}
[0m15:14:19.100850 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:14:19.244026 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:14:19.425498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:14:19.426271 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://tests/assert_activity_composite_unique.sql
[0m15:14:19.426990 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/schema.yml
[0m15:14:19.828089 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:14:19.828674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '312366b0-3e07-4b34-ae70-7c61a2945fbc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef092b0>]}
[0m15:14:20.007201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '312366b0-3e07-4b34-ae70-7c61a2945fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e12a3f0>]}
[0m15:14:20.163541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '312366b0-3e07-4b34-ae70-7c61a2945fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2eba10>]}
[0m15:14:20.164132 [info ] [MainThread]: Found 6 models, 2 data tests, 6 sources, 428 macros
[0m15:14:20.164551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '312366b0-3e07-4b34-ae70-7c61a2945fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0ef440>]}
[0m15:14:20.166828 [info ] [MainThread]: 
[0m15:14:20.167546 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:20.172357 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m15:14:20.288192 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:14:20.288689 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m15:14:20.289081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:20.342879 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m15:14:20.343521 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:14:20.343999 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m15:14:20.349195 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m15:14:20.351266 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m15:14:20.352710 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m15:14:20.361891 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:20.362480 [debug] [MainThread]: On master: BEGIN
[0m15:14:20.362881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:20.380718 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m15:14:20.381228 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:20.381789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:14:20.386552 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m15:14:20.388133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '312366b0-3e07-4b34-ae70-7c61a2945fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2ebfe0>]}
[0m15:14:20.388647 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:20.389852 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:20.390276 [debug] [MainThread]: On master: BEGIN
[0m15:14:20.392429 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:14:20.392936 [debug] [MainThread]: On master: COMMIT
[0m15:14:20.393403 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:20.393774 [debug] [MainThread]: On master: COMMIT
[0m15:14:20.395030 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:14:20.395458 [debug] [MainThread]: On master: Close
[0m15:14:20.395984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:20.396402 [info ] [MainThread]: 
[0m15:14:20.399345 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_activity_composite_unique
[0m15:14:20.399884 [info ] [Thread-1 (]: 1 of 2 START test assert_activity_composite_unique ............................. [RUN]
[0m15:14:20.400419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.assert_activity_composite_unique)
[0m15:14:20.400862 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_activity_composite_unique
[0m15:14:20.410108 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_activity_composite_unique"
[0m15:14:20.411430 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_activity_composite_unique
[0m15:14:20.434362 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_activity_composite_unique"
[0m15:14:20.435423 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_activity_composite_unique"
[0m15:14:20.435878 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_activity_composite_unique: BEGIN
[0m15:14:20.436292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:20.454842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m15:14:20.455506 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_activity_composite_unique"
[0m15:14:20.455989 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_activity_composite_unique: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_activity_composite_unique"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Activity table can have duplicate activity_id
-- but must differ in either type and/or assigned_to_user

WITH count_rows AS (
SELECT
    activity_id,
    type,
    assigned_to_user,
    ROW_NUMBER() OVER(PARTITION BY activity_id, type, assigned_to_user) AS cnt
FROM "postgres"."public"."activity"
)
SELECT * FROM count_rows
WHERE cnt >=2
      
    ) dbt_internal_test
[0m15:14:20.463139 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m15:14:20.467867 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_activity_composite_unique: ROLLBACK
[0m15:14:20.469559 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_activity_composite_unique: Close
[0m15:14:20.470446 [info ] [Thread-1 (]: 1 of 2 PASS assert_activity_composite_unique ................................... [[32mPASS[0m in 0.07s]
[0m15:14:20.471645 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_activity_composite_unique
[0m15:14:20.491650 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:14:20.498120 [info ] [Thread-1 (]: 2 of 2 START test not_null_stg_pipedrive__activity_activity_id ................. [RUN]
[0m15:14:20.498896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_activity_composite_unique, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287)
[0m15:14:20.499478 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:14:20.514018 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:14:20.515831 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:14:20.518407 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:14:20.519705 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:14:20.520173 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: BEGIN
[0m15:14:20.520595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:20.537464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:14:20.538017 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:14:20.538525 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where activity_id is null



      
    ) dbt_internal_test
[0m15:14:20.541965 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:14:20.544005 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: ROLLBACK
[0m15:14:20.545413 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: Close
[0m15:14:20.546188 [info ] [Thread-1 (]: 2 of 2 PASS not_null_stg_pipedrive__activity_activity_id ....................... [[32mPASS[0m in 0.05s]
[0m15:14:20.546986 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:14:20.548429 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:20.548907 [debug] [MainThread]: On master: BEGIN
[0m15:14:20.549261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:20.564718 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m15:14:20.565418 [debug] [MainThread]: On master: COMMIT
[0m15:14:20.565826 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:20.566175 [debug] [MainThread]: On master: COMMIT
[0m15:14:20.567641 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:14:20.568073 [debug] [MainThread]: On master: Close
[0m15:14:20.568562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:20.568905 [debug] [MainThread]: Connection 'test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287' was properly closed.
[0m15:14:20.569288 [info ] [MainThread]: 
[0m15:14:20.569700 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:14:20.570685 [debug] [MainThread]: Command end result
[0m15:14:20.601771 [info ] [MainThread]: 
[0m15:14:20.602284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:20.602673 [info ] [MainThread]: 
[0m15:14:20.603085 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:14:20.605457 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0583832, "process_in_blocks": "0", "process_kernel_time": 0.548696, "process_mem_max_rss": "117641216", "process_out_blocks": "0", "process_user_time": 3.19111}
[0m15:14:20.606214 [debug] [MainThread]: Command `dbt test` succeeded at 15:14:20.606073 after 2.06 seconds
[0m15:14:20.606700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a32ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e00ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e00acf0>]}
[0m15:14:20.607133 [debug] [MainThread]: Flushing usage events
[0m15:33:50.105807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11029e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e02f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e02a20>]}


============================== 15:33:50.114422 | 5bbe2800-8e36-450b-afb0-e5fd5a883a4e ==============================
[0m15:33:50.114422 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:33:50.115148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m15:33:50.385748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bbe2800-8e36-450b-afb0-e5fd5a883a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ecddf0>]}
[0m15:33:50.451721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bbe2800-8e36-450b-afb0-e5fd5a883a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c8ed50>]}
[0m15:33:50.453651 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:33:50.597580 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:33:50.800827 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m15:33:50.801376 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://tests/assert_activity_composite_unique.sql
[0m15:33:50.908236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bbe2800-8e36-450b-afb0-e5fd5a883a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112379d30>]}
[0m15:33:51.068041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bbe2800-8e36-450b-afb0-e5fd5a883a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e50890>]}
[0m15:33:51.068933 [info ] [MainThread]: Found 6 models, 1 test, 6 sources, 428 macros
[0m15:33:51.069696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bbe2800-8e36-450b-afb0-e5fd5a883a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112df0a70>]}
[0m15:33:51.072962 [info ] [MainThread]: 
[0m15:33:51.074277 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:33:51.085313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m15:33:51.171590 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:33:51.172078 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m15:33:51.172485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:51.229580 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m15:33:51.230218 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:33:51.230713 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m15:33:51.234727 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m15:33:51.236474 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m15:33:51.237695 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m15:33:51.245197 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:51.245776 [debug] [MainThread]: On master: BEGIN
[0m15:33:51.246192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:51.267033 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m15:33:51.283962 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:51.287809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:33:51.292988 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m15:33:51.294628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bbe2800-8e36-450b-afb0-e5fd5a883a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c8f200>]}
[0m15:33:51.295192 [debug] [MainThread]: On master: ROLLBACK
[0m15:33:51.296805 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:51.297316 [debug] [MainThread]: On master: BEGIN
[0m15:33:51.299716 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:33:51.300377 [debug] [MainThread]: On master: COMMIT
[0m15:33:51.300794 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:51.301146 [debug] [MainThread]: On master: COMMIT
[0m15:33:51.302376 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:33:51.302789 [debug] [MainThread]: On master: Close
[0m15:33:51.303382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:51.303810 [info ] [MainThread]: 
[0m15:33:51.306451 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:33:51.307000 [info ] [Thread-1 (]: 1 of 1 START test not_null_stg_pipedrive__activity_activity_id ................. [RUN]
[0m15:33:51.307552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287)
[0m15:33:51.307987 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:33:51.330134 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:33:51.331900 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:33:51.350158 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:33:51.351090 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:33:51.351520 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: BEGIN
[0m15:33:51.351911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:51.367677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m15:33:51.368452 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:33:51.369037 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where activity_id is null



      
    ) dbt_internal_test
[0m15:33:51.371482 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:33:51.376152 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: ROLLBACK
[0m15:33:51.377911 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: Close
[0m15:33:51.379136 [info ] [Thread-1 (]: 1 of 1 PASS not_null_stg_pipedrive__activity_activity_id ....................... [[32mPASS[0m in 0.07s]
[0m15:33:51.380113 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:33:51.381521 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:51.382066 [debug] [MainThread]: On master: BEGIN
[0m15:33:51.382764 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:51.404879 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m15:33:51.405506 [debug] [MainThread]: On master: COMMIT
[0m15:33:51.405937 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:51.406354 [debug] [MainThread]: On master: COMMIT
[0m15:33:51.407713 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:33:51.408133 [debug] [MainThread]: On master: Close
[0m15:33:51.408628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:51.409121 [debug] [MainThread]: Connection 'test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287' was properly closed.
[0m15:33:51.409646 [info ] [MainThread]: 
[0m15:33:51.410075 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m15:33:51.410936 [debug] [MainThread]: Command end result
[0m15:33:51.444546 [info ] [MainThread]: 
[0m15:33:51.445121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:51.445592 [info ] [MainThread]: 
[0m15:33:51.446016 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:33:51.448667 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4442046, "process_in_blocks": "0", "process_kernel_time": 0.51691, "process_mem_max_rss": "111517696", "process_out_blocks": "0", "process_user_time": 2.618525}
[0m15:33:51.449518 [debug] [MainThread]: Command `dbt test` succeeded at 15:33:51.449355 after 1.45 seconds
[0m15:33:51.450043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e11ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111890890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111890290>]}
[0m15:33:51.450559 [debug] [MainThread]: Flushing usage events
[0m15:34:08.763596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11241aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11241ab40>]}


============================== 15:34:08.771433 | 1ac74836-c96e-40c7-96c5-66494183840e ==============================
[0m15:34:08.771433 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:34:08.772237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:34:09.046418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ac74836-c96e-40c7-96c5-66494183840e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cca5d0>]}
[0m15:34:09.126264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ac74836-c96e-40c7-96c5-66494183840e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112131130>]}
[0m15:34:09.127927 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:34:09.277394 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:34:09.449461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:34:09.450315 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/schema.yml
[0m15:34:09.718745 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:34:09.719324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1ac74836-c96e-40c7-96c5-66494183840e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129f27e0>]}
[0m15:34:09.937978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ac74836-c96e-40c7-96c5-66494183840e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11328cbf0>]}
[0m15:34:10.087330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ac74836-c96e-40c7-96c5-66494183840e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136d2030>]}
[0m15:34:10.087914 [info ] [MainThread]: Found 6 models, 2 data tests, 6 sources, 428 macros
[0m15:34:10.088325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac74836-c96e-40c7-96c5-66494183840e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112531730>]}
[0m15:34:10.090680 [info ] [MainThread]: 
[0m15:34:10.091353 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:34:10.095985 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m15:34:10.169654 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:34:10.170120 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m15:34:10.170478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:10.229523 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m15:34:10.230147 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:34:10.230609 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m15:34:10.234962 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m15:34:10.236713 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m15:34:10.238731 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m15:34:10.245569 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:10.246021 [debug] [MainThread]: On master: BEGIN
[0m15:34:10.246361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:34:10.261725 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m15:34:10.262348 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:10.262826 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:34:10.268079 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m15:34:10.270006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac74836-c96e-40c7-96c5-66494183840e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11328f590>]}
[0m15:34:10.270631 [debug] [MainThread]: On master: ROLLBACK
[0m15:34:10.272032 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:10.272456 [debug] [MainThread]: On master: BEGIN
[0m15:34:10.274619 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:34:10.275300 [debug] [MainThread]: On master: COMMIT
[0m15:34:10.275887 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:10.276279 [debug] [MainThread]: On master: COMMIT
[0m15:34:10.277578 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:34:10.278009 [debug] [MainThread]: On master: Close
[0m15:34:10.278562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:34:10.279065 [info ] [MainThread]: 
[0m15:34:10.281843 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:34:10.282410 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_pipedrive__activity_activity_id ................. [RUN]
[0m15:34:10.283053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287)
[0m15:34:10.283506 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:34:10.302747 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:34:10.303639 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:34:10.320180 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:34:10.321098 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:34:10.321533 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: BEGIN
[0m15:34:10.321931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:10.338914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:34:10.339591 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:34:10.340054 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where activity_id is null



      
    ) dbt_internal_test
[0m15:34:10.342465 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:34:10.347146 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: ROLLBACK
[0m15:34:10.348655 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: Close
[0m15:34:10.349426 [info ] [Thread-1 (]: 1 of 2 PASS not_null_stg_pipedrive__activity_activity_id ....................... [[32mPASS[0m in 0.07s]
[0m15:34:10.350223 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:34:10.350777 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:34:10.351312 [info ] [Thread-1 (]: 2 of 2 START test relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_  [RUN]
[0m15:34:10.351929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19)
[0m15:34:10.352419 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:34:10.360419 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:34:10.361439 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:34:10.363921 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:34:10.365001 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:34:10.365730 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: BEGIN
[0m15:34:10.366179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:10.382533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m15:34:10.383196 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:34:10.383709 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where type is not null
),

parent as (
    select type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:34:10.387532 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:34:10.389284 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: ROLLBACK
[0m15:34:10.390769 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: Close
[0m15:34:10.391688 [info ] [Thread-1 (]: 2 of 2 PASS relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m15:34:10.392493 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:34:10.394081 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:10.394615 [debug] [MainThread]: On master: BEGIN
[0m15:34:10.394958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:34:10.411448 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m15:34:10.412029 [debug] [MainThread]: On master: COMMIT
[0m15:34:10.412430 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:10.412775 [debug] [MainThread]: On master: COMMIT
[0m15:34:10.414049 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:34:10.414549 [debug] [MainThread]: On master: Close
[0m15:34:10.415526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:10.416249 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19' was properly closed.
[0m15:34:10.416878 [info ] [MainThread]: 
[0m15:34:10.417493 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m15:34:10.418629 [debug] [MainThread]: Command end result
[0m15:34:10.449209 [info ] [MainThread]: 
[0m15:34:10.450494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:34:10.451269 [info ] [MainThread]: 
[0m15:34:10.451843 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:34:10.454135 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7799922, "process_in_blocks": "0", "process_kernel_time": 0.504243, "process_mem_max_rss": "115843072", "process_out_blocks": "0", "process_user_time": 2.969947}
[0m15:34:10.454905 [debug] [MainThread]: Command `dbt test` succeeded at 15:34:10.454773 after 1.78 seconds
[0m15:34:10.455381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e736d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11368c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134435f0>]}
[0m15:34:10.455814 [debug] [MainThread]: Flushing usage events
[0m15:41:15.339247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b8f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b8ec30>]}


============================== 15:41:15.347814 | 3938a514-3159-4378-a68d-c820596305de ==============================
[0m15:41:15.347814 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:41:15.349058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:41:15.637599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3938a514-3159-4378-a68d-c820596305de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108492840>]}
[0m15:41:15.707934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3938a514-3159-4378-a68d-c820596305de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a6d8b0>]}
[0m15:41:15.710255 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:41:15.856445 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:41:16.017004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:41:16.017826 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/schema.yml
[0m15:41:16.277452 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:41:16.278104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3938a514-3159-4378-a68d-c820596305de', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a185190>]}
[0m15:41:16.496028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3938a514-3159-4378-a68d-c820596305de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e2180>]}
[0m15:41:16.645679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3938a514-3159-4378-a68d-c820596305de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae2ef90>]}
[0m15:41:16.646328 [info ] [MainThread]: Found 6 models, 3 data tests, 6 sources, 428 macros
[0m15:41:16.646800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3938a514-3159-4378-a68d-c820596305de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9f67b0>]}
[0m15:41:16.649403 [info ] [MainThread]: 
[0m15:41:16.650196 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:41:16.656502 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m15:41:16.735210 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:41:16.735966 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m15:41:16.736384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:16.791986 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m15:41:16.792564 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:41:16.793075 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m15:41:16.797059 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m15:41:16.798765 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m15:41:16.800060 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m15:41:16.806535 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:16.806983 [debug] [MainThread]: On master: BEGIN
[0m15:41:16.807319 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:41:16.822664 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m15:41:16.823176 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:16.823646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:41:16.828601 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m15:41:16.830193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3938a514-3159-4378-a68d-c820596305de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae1ac30>]}
[0m15:41:16.830692 [debug] [MainThread]: On master: ROLLBACK
[0m15:41:16.831929 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:16.832334 [debug] [MainThread]: On master: BEGIN
[0m15:41:16.834100 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:41:16.834563 [debug] [MainThread]: On master: COMMIT
[0m15:41:16.835112 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:16.835513 [debug] [MainThread]: On master: COMMIT
[0m15:41:16.836786 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:41:16.837191 [debug] [MainThread]: On master: Close
[0m15:41:16.837725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:41:16.838234 [info ] [MainThread]: 
[0m15:41:16.841312 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:41:16.841872 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_pipedrive__activity_activity_id ................. [RUN]
[0m15:41:16.842458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287)
[0m15:41:16.843006 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:41:16.862415 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:41:16.864344 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:41:16.883508 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:41:16.884441 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:41:16.884867 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: BEGIN
[0m15:41:16.885255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:16.902553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:41:16.903308 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:41:16.903883 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where activity_id is null



      
    ) dbt_internal_test
[0m15:41:16.906276 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:41:16.910919 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: ROLLBACK
[0m15:41:16.912299 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: Close
[0m15:41:16.913134 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_pipedrive__activity_activity_id ....................... [[32mPASS[0m in 0.07s]
[0m15:41:16.914019 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:41:16.914565 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:41:16.915142 [info ] [Thread-1 (]: 2 of 3 START test relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_  [RUN]
[0m15:41:16.915795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed)
[0m15:41:16.916241 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:41:16.922104 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:41:16.923152 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:41:16.927072 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:41:16.928470 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:41:16.928999 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: BEGIN
[0m15:41:16.929411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:16.947583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m15:41:16.948179 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:41:16.948644 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select assigned_to_user as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where assigned_to_user is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:41:16.952538 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:41:16.954307 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: ROLLBACK
[0m15:41:16.955712 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: Close
[0m15:41:16.956532 [info ] [Thread-1 (]: 2 of 3 PASS relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m15:41:16.957457 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:41:16.958033 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:41:16.958564 [info ] [Thread-1 (]: 3 of 3 START test relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_  [RUN]
[0m15:41:16.959193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19)
[0m15:41:16.959642 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:41:16.964900 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:41:16.966158 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:41:16.968731 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:41:16.969714 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:41:16.970235 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: BEGIN
[0m15:41:16.970641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:16.989575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m15:41:16.990375 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:41:16.990871 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where type is not null
),

parent as (
    select type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:41:16.994992 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:41:16.996711 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: ROLLBACK
[0m15:41:16.998954 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: Close
[0m15:41:17.000530 [info ] [Thread-1 (]: 3 of 3 PASS relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m15:41:17.001448 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:41:17.003142 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:17.003620 [debug] [MainThread]: On master: BEGIN
[0m15:41:17.003973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:41:17.019874 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m15:41:17.020446 [debug] [MainThread]: On master: COMMIT
[0m15:41:17.020871 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:17.021230 [debug] [MainThread]: On master: COMMIT
[0m15:41:17.023913 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:41:17.024414 [debug] [MainThread]: On master: Close
[0m15:41:17.025013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:17.025385 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19' was properly closed.
[0m15:41:17.025788 [info ] [MainThread]: 
[0m15:41:17.026327 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m15:41:17.027526 [debug] [MainThread]: Command end result
[0m15:41:17.059993 [info ] [MainThread]: 
[0m15:41:17.060503 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:41:17.060889 [info ] [MainThread]: 
[0m15:41:17.061297 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:41:17.063676 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.8140931, "process_in_blocks": "0", "process_kernel_time": 0.543968, "process_mem_max_rss": "116162560", "process_out_blocks": "0", "process_user_time": 3.03335}
[0m15:41:17.064438 [debug] [MainThread]: Command `dbt test` succeeded at 15:41:17.064298 after 1.81 seconds
[0m15:41:17.064903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b4e480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa9f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b8ec30>]}
[0m15:41:17.065326 [debug] [MainThread]: Flushing usage events
[0m15:43:34.881868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3f7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fce33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fce2ed0>]}


============================== 15:43:34.888905 | 394ffacd-6fb2-4338-9f66-d1e8b81cb6a2 ==============================
[0m15:43:34.888905 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:43:34.889842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:43:35.170372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '394ffacd-6fb2-4338-9f66-d1e8b81cb6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110226c30>]}
[0m15:43:35.238172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '394ffacd-6fb2-4338-9f66-d1e8b81cb6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee0c680>]}
[0m15:43:35.240038 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:43:35.388793 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:43:35.575568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:43:35.576468 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/schema.yml
[0m15:43:35.844396 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:43:35.845026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '394ffacd-6fb2-4338-9f66-d1e8b81cb6a2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6e7d70>]}
[0m15:43:36.074166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '394ffacd-6fb2-4338-9f66-d1e8b81cb6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c68530>]}
[0m15:43:36.219264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '394ffacd-6fb2-4338-9f66-d1e8b81cb6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f7e8a0>]}
[0m15:43:36.219955 [info ] [MainThread]: Found 6 models, 4 data tests, 6 sources, 428 macros
[0m15:43:36.220389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '394ffacd-6fb2-4338-9f66-d1e8b81cb6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b4b6b0>]}
[0m15:43:36.222910 [info ] [MainThread]: 
[0m15:43:36.223608 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:43:36.228571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m15:43:36.312468 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:43:36.312950 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m15:43:36.313331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:36.370093 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m15:43:36.370797 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:43:36.371258 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m15:43:36.375251 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m15:43:36.377076 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m15:43:36.378365 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m15:43:36.389418 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:36.390230 [debug] [MainThread]: On master: BEGIN
[0m15:43:36.390975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:36.407219 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m15:43:36.407814 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:36.408294 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:43:36.413074 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m15:43:36.414685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '394ffacd-6fb2-4338-9f66-d1e8b81cb6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c6b050>]}
[0m15:43:36.415221 [debug] [MainThread]: On master: ROLLBACK
[0m15:43:36.417101 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:36.417555 [debug] [MainThread]: On master: BEGIN
[0m15:43:36.420032 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:43:36.420642 [debug] [MainThread]: On master: COMMIT
[0m15:43:36.421041 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:36.421394 [debug] [MainThread]: On master: COMMIT
[0m15:43:36.422724 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:43:36.423179 [debug] [MainThread]: On master: Close
[0m15:43:36.423783 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:43:36.424296 [info ] [MainThread]: 
[0m15:43:36.427141 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:43:36.427682 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_pipedrive__activity_activity_id ................. [RUN]
[0m15:43:36.428231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287)
[0m15:43:36.428737 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:43:36.447005 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:43:36.448329 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:43:36.464425 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:43:36.465324 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:43:36.465755 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: BEGIN
[0m15:43:36.466150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:36.482385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m15:43:36.482986 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:43:36.483547 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where activity_id is null



      
    ) dbt_internal_test
[0m15:43:36.485936 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:43:36.490551 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: ROLLBACK
[0m15:43:36.491946 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: Close
[0m15:43:36.492791 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_pipedrive__activity_activity_id ....................... [[32mPASS[0m in 0.06s]
[0m15:43:36.493695 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:43:36.494259 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:43:36.494854 [info ] [Thread-1 (]: 2 of 4 START test relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_  [RUN]
[0m15:43:36.495484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed)
[0m15:43:36.495934 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:43:36.501433 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:43:36.502879 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:43:36.505392 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:43:36.506188 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:43:36.506646 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: BEGIN
[0m15:43:36.507070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:36.523971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:43:36.524662 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:43:36.525159 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select assigned_to_user as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where assigned_to_user is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:43:36.530350 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m15:43:36.532201 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: ROLLBACK
[0m15:43:36.533625 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: Close
[0m15:43:36.534421 [info ] [Thread-1 (]: 2 of 4 PASS relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m15:43:36.535430 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:43:36.536018 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901
[0m15:43:36.536538 [info ] [Thread-1 (]: 3 of 4 START test relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_  [RUN]
[0m15:43:36.537217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901)
[0m15:43:36.537691 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901
[0m15:43:36.543071 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901"
[0m15:43:36.544104 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901
[0m15:43:36.546835 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901"
[0m15:43:36.547763 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901"
[0m15:43:36.548201 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901: BEGIN
[0m15:43:36.548594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:36.567195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m15:43:36.567894 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901"
[0m15:43:36.568367 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select deal_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where deal_id is not null
),

parent as (
    select deal_id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:43:36.574226 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m15:43:36.576020 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901: ROLLBACK
[0m15:43:36.577284 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901: Close
[0m15:43:36.578014 [error] [Thread-1 (]: 3 of 4 FAIL 4571 relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_  [[31mFAIL 4571[0m in 0.04s]
[0m15:43:36.578927 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901
[0m15:43:36.579507 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:43:36.580096 [info ] [Thread-1 (]: 4 of 4 START test relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_  [RUN]
[0m15:43:36.580737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_.165dbda901, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19)
[0m15:43:36.581201 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:43:36.587228 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:43:36.588422 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:43:36.590984 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:43:36.591793 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:43:36.592248 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: BEGIN
[0m15:43:36.592705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:36.610555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m15:43:36.611267 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:43:36.611873 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where type is not null
),

parent as (
    select type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:43:36.617428 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m15:43:36.619165 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: ROLLBACK
[0m15:43:36.620788 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: Close
[0m15:43:36.621545 [info ] [Thread-1 (]: 4 of 4 PASS relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m15:43:36.622380 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:43:36.623742 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:36.624261 [debug] [MainThread]: On master: BEGIN
[0m15:43:36.624614 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:36.641415 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m15:43:36.642130 [debug] [MainThread]: On master: COMMIT
[0m15:43:36.642622 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:36.643032 [debug] [MainThread]: On master: COMMIT
[0m15:43:36.644309 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:43:36.644728 [debug] [MainThread]: On master: Close
[0m15:43:36.645226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:36.645579 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19' was properly closed.
[0m15:43:36.645983 [info ] [MainThread]: 
[0m15:43:36.646455 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m15:43:36.649164 [debug] [MainThread]: Command end result
[0m15:43:36.681288 [info ] [MainThread]: 
[0m15:43:36.681953 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:43:36.682430 [info ] [MainThread]: 
[0m15:43:36.683135 [error] [MainThread]: [31mFailure in test relationships_stg_pipedrive__activity_deal_id__deal_id__ref_stg_pipedrive__deal_changes_ (models/staging/schema.yml)[0m
[0m15:43:36.683660 [error] [MainThread]:   Got 4571 results, configured to fail if != 0
[0m15:43:36.684067 [info ] [MainThread]: 
[0m15:43:36.684606 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/schema.yml/relationships_stg_pipedrive__a_3b2ee211e84dc0823c6bda806384cf7e.sql
[0m15:43:36.685014 [info ] [MainThread]: 
[0m15:43:36.685452 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:43:36.687805 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.8967073, "process_in_blocks": "0", "process_kernel_time": 0.540637, "process_mem_max_rss": "117268480", "process_out_blocks": "0", "process_user_time": 3.070992}
[0m15:43:36.688575 [debug] [MainThread]: Command `dbt test` failed at 15:43:36.688422 after 1.90 seconds
[0m15:43:36.689087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8a2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f150ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110da8a40>]}
[0m15:43:36.689548 [debug] [MainThread]: Flushing usage events
[0m15:55:04.816497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df3dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0dafc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0daae0>]}


============================== 15:55:04.825581 | 1d7d5408-c07f-4717-b23a-c8131c81b648 ==============================
[0m15:55:04.825581 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:55:04.826793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:55:05.114010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d7d5408-c07f-4717-b23a-c8131c81b648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6262a0>]}
[0m15:55:05.182767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d7d5408-c07f-4717-b23a-c8131c81b648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d35f440>]}
[0m15:55:05.184143 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:55:05.325754 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:55:05.497245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:55:05.498251 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/schema.yml
[0m15:55:05.760298 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:55:05.760890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1d7d5408-c07f-4717-b23a-c8131c81b648', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed75af0>]}
[0m15:55:05.984775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d7d5408-c07f-4717-b23a-c8131c81b648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f005b80>]}
[0m15:55:06.127666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d7d5408-c07f-4717-b23a-c8131c81b648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f35e720>]}
[0m15:55:06.128261 [info ] [MainThread]: Found 6 models, 3 data tests, 6 sources, 428 macros
[0m15:55:06.128692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d7d5408-c07f-4717-b23a-c8131c81b648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f153ef0>]}
[0m15:55:06.131073 [info ] [MainThread]: 
[0m15:55:06.131745 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:06.136453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m15:55:06.212050 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:55:06.212560 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m15:55:06.212949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:06.270151 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m15:55:06.270748 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:55:06.271196 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m15:55:06.275639 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m15:55:06.277383 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m15:55:06.280065 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m15:55:06.286797 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:06.287250 [debug] [MainThread]: On master: BEGIN
[0m15:55:06.287596 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:06.302971 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m15:55:06.303656 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:06.304149 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:55:06.308997 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m15:55:06.310581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d7d5408-c07f-4717-b23a-c8131c81b648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3b0380>]}
[0m15:55:06.311084 [debug] [MainThread]: On master: ROLLBACK
[0m15:55:06.312534 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:06.312950 [debug] [MainThread]: On master: BEGIN
[0m15:55:06.314924 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:55:06.315507 [debug] [MainThread]: On master: COMMIT
[0m15:55:06.315896 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:06.316244 [debug] [MainThread]: On master: COMMIT
[0m15:55:06.318625 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:55:06.319061 [debug] [MainThread]: On master: Close
[0m15:55:06.319592 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:55:06.320001 [info ] [MainThread]: 
[0m15:55:06.323127 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:55:06.323687 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_pipedrive__activity_activity_id ................. [RUN]
[0m15:55:06.324244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287)
[0m15:55:06.324686 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:55:06.345656 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:55:06.346854 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:55:06.364731 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:55:06.365779 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:55:06.366230 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: BEGIN
[0m15:55:06.366628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:06.382465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m15:55:06.383066 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:55:06.383541 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where activity_id is null



      
    ) dbt_internal_test
[0m15:55:06.385855 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:55:06.390580 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: ROLLBACK
[0m15:55:06.391991 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: Close
[0m15:55:06.392772 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_pipedrive__activity_activity_id ....................... [[32mPASS[0m in 0.07s]
[0m15:55:06.393617 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:55:06.394158 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:55:06.394701 [info ] [Thread-1 (]: 2 of 3 START test relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_  [RUN]
[0m15:55:06.395400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed)
[0m15:55:06.395872 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:55:06.403667 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:55:06.404907 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:55:06.407713 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:55:06.408591 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:55:06.409185 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: BEGIN
[0m15:55:06.409855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:06.427346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:55:06.428002 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:55:06.428548 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select assigned_to_user as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where assigned_to_user is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:55:06.433061 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:55:06.435079 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: ROLLBACK
[0m15:55:06.436540 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: Close
[0m15:55:06.437320 [info ] [Thread-1 (]: 2 of 3 PASS relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m15:55:06.438094 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:55:06.438835 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:55:06.439426 [info ] [Thread-1 (]: 3 of 3 START test relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_  [RUN]
[0m15:55:06.440171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19)
[0m15:55:06.440653 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:55:06.445969 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:55:06.446982 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:55:06.449524 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:55:06.450352 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:55:06.450778 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: BEGIN
[0m15:55:06.451161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:06.469542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m15:55:06.470184 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:55:06.470678 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where type is not null
),

parent as (
    select type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:55:06.474636 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:55:06.476544 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: ROLLBACK
[0m15:55:06.478952 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: Close
[0m15:55:06.479741 [info ] [Thread-1 (]: 3 of 3 PASS relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m15:55:06.480531 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:55:06.482036 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:06.482596 [debug] [MainThread]: On master: BEGIN
[0m15:55:06.482958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:06.499031 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m15:55:06.499792 [debug] [MainThread]: On master: COMMIT
[0m15:55:06.500235 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:06.500596 [debug] [MainThread]: On master: COMMIT
[0m15:55:06.503346 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:55:06.503895 [debug] [MainThread]: On master: Close
[0m15:55:06.504504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:06.504956 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19' was properly closed.
[0m15:55:06.505638 [info ] [MainThread]: 
[0m15:55:06.506091 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m15:55:06.507600 [debug] [MainThread]: Command end result
[0m15:55:06.542046 [info ] [MainThread]: 
[0m15:55:06.542562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:55:06.542952 [info ] [MainThread]: 
[0m15:55:06.543364 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:55:06.545644 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.82004, "process_in_blocks": "0", "process_kernel_time": 0.526506, "process_mem_max_rss": "116015104", "process_out_blocks": "0", "process_user_time": 3.017639}
[0m15:55:06.546525 [debug] [MainThread]: Command `dbt test` succeeded at 15:55:06.546380 after 1.82 seconds
[0m15:55:06.547010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e6d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db687a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6abbc0>]}
[0m15:55:06.547512 [debug] [MainThread]: Flushing usage events
[0m15:57:59.709041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad31100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccbf320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccbee10>]}


============================== 15:57:59.715949 | 9ca2af77-a372-4b7f-9c97-6356e4d163f0 ==============================
[0m15:57:59.715949 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:57:59.716674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:59.962257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ca2af77-a372-4b7f-9c97-6356e4d163f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d20c950>]}
[0m15:58:00.030315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ca2af77-a372-4b7f-9c97-6356e4d163f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc9d940>]}
[0m15:58:00.031910 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:58:00.175326 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:58:00.350791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:00.351322 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:00.406100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ca2af77-a372-4b7f-9c97-6356e4d163f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2b4260>]}
[0m15:58:00.536551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ca2af77-a372-4b7f-9c97-6356e4d163f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2b4e00>]}
[0m15:58:00.537133 [info ] [MainThread]: Found 6 models, 3 data tests, 6 sources, 428 macros
[0m15:58:00.537580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ca2af77-a372-4b7f-9c97-6356e4d163f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daed160>]}
[0m15:58:00.540236 [info ] [MainThread]: 
[0m15:58:00.541148 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:58:00.547858 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:58:00.624042 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:58:00.624587 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:58:00.625441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:00.665883 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.040 seconds
[0m15:58:00.667508 [debug] [ThreadPool]: On list_postgres: Close
[0m15:58:00.669234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m15:58:00.676367 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:58:00.676821 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m15:58:00.677159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:00.692760 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m15:58:00.693272 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:58:00.693812 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m15:58:00.697764 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m15:58:00.699369 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m15:58:00.700617 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m15:58:00.706715 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:00.707156 [debug] [MainThread]: On master: BEGIN
[0m15:58:00.707493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:00.724209 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m15:58:00.725102 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:00.725597 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:58:00.730513 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m15:58:00.732055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ca2af77-a372-4b7f-9c97-6356e4d163f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d231cd0>]}
[0m15:58:00.732544 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:00.733813 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:00.734224 [debug] [MainThread]: On master: BEGIN
[0m15:58:00.736068 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:58:00.736531 [debug] [MainThread]: On master: COMMIT
[0m15:58:00.736910 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:00.737257 [debug] [MainThread]: On master: COMMIT
[0m15:58:00.739350 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:58:00.739800 [debug] [MainThread]: On master: Close
[0m15:58:00.740367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:00.741102 [info ] [MainThread]: 
[0m15:58:00.744998 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m15:58:00.745909 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m15:58:00.746582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m15:58:00.747283 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m15:58:00.759267 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:00.760560 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m15:58:00.802395 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:00.803991 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:00.804615 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m15:58:00.805027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:00.822325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:58:00.822990 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:00.823445 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m15:58:00.826245 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:58:00.835289 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:00.836150 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m15:58:00.838312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:00.842502 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:00.843137 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m15:58:00.845030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:00.864106 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m15:58:00.864621 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:00.865034 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m15:58:00.867189 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:58:00.874134 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m15:58:00.880333 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:00.880885 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m15:58:00.883657 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:58:00.886832 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m15:58:00.888592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca2af77-a372-4b7f-9c97-6356e4d163f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b569550>]}
[0m15:58:00.889391 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.14s]
[0m15:58:00.890316 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m15:58:00.891061 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m15:58:00.891670 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m15:58:00.892285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m15:58:00.892721 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m15:58:00.895430 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:00.897136 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m15:58:00.901589 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:00.902495 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:00.903011 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m15:58:00.903538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:00.922073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m15:58:00.922764 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:00.923215 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity_types"
  );
[0m15:58:00.925831 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:58:00.929288 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:00.929770 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m15:58:00.931389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:00.934777 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:00.935241 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m15:58:00.936793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:00.938693 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m15:58:00.939134 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:00.939538 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m15:58:00.942162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:58:00.946097 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m15:58:00.946948 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:00.947371 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m15:58:00.950138 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:58:00.951877 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m15:58:00.952943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca2af77-a372-4b7f-9c97-6356e4d163f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df5bce0>]}
[0m15:58:00.953792 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m15:58:00.954556 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m15:58:00.955083 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m15:58:00.955775 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m15:58:00.956341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m15:58:00.956769 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m15:58:00.959765 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:00.960614 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m15:58:00.964311 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:00.965434 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:00.965875 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m15:58:00.966277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:00.983719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:58:00.984338 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:00.984807 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."deal_changes"
  );
[0m15:58:00.988939 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:58:00.992603 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:00.993215 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m15:58:00.994861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:00.998829 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:00.999570 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m15:58:01.002875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:58:01.005233 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m15:58:01.005762 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:01.006254 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m15:58:01.008967 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:58:01.011782 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m15:58:01.012674 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:01.013127 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m15:58:01.015993 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:58:01.017715 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m15:58:01.018687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca2af77-a372-4b7f-9c97-6356e4d163f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db54e90>]}
[0m15:58:01.019729 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m15:58:01.020704 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m15:58:01.021513 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields
[0m15:58:01.022215 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__fields ... [RUN]
[0m15:58:01.022800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__fields)
[0m15:58:01.023264 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields
[0m15:58:01.026485 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:01.027377 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields
[0m15:58:01.031737 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:01.032634 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:01.033107 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: BEGIN
[0m15:58:01.033597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:01.054806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m15:58:01.055581 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:01.056158 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m15:58:01.059168 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:58:01.062663 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:01.063159 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields" rename to "stg_pipedrive__fields__dbt_backup"
[0m15:58:01.065127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:01.068531 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:01.069015 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp" rename to "stg_pipedrive__fields"
[0m15:58:01.088873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m15:58:01.092636 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m15:58:01.093490 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:01.094174 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m15:58:01.097944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:58:01.100939 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup"
[0m15:58:01.101797 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:01.102263 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup" cascade
[0m15:58:01.105264 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:58:01.106940 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: Close
[0m15:58:01.107614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca2af77-a372-4b7f-9c97-6356e4d163f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df613a0>]}
[0m15:58:01.108411 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields  [[32mCREATE VIEW[0m in 0.08s]
[0m15:58:01.109352 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields
[0m15:58:01.109903 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m15:58:01.110448 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m15:58:01.111309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m15:58:01.111930 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m15:58:01.114838 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:01.115830 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m15:58:01.121940 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:01.122780 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:01.123213 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m15:58:01.123617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:01.139502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m15:58:01.140093 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:01.140538 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."stages"
  );
[0m15:58:01.142866 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:58:01.146204 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:01.146655 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m15:58:01.148157 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:01.151348 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:01.151806 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m15:58:01.153377 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:01.155287 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m15:58:01.155735 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:01.156142 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m15:58:01.158149 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:58:01.160792 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m15:58:01.161623 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:01.162053 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m15:58:01.164655 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:58:01.166292 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m15:58:01.166954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca2af77-a372-4b7f-9c97-6356e4d163f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfbe9c0>]}
[0m15:58:01.167725 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m15:58:01.168451 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m15:58:01.168955 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m15:58:01.169670 [info ] [Thread-1 (]: 6 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m15:58:01.170240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m15:58:01.170678 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m15:58:01.173443 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:01.174381 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m15:58:01.178600 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:01.179631 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:01.180148 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m15:58:01.180553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:01.196324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m15:58:01.196905 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:01.197361 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m15:58:01.199715 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:58:01.203193 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:01.203667 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m15:58:01.205276 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:01.208585 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:01.209058 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m15:58:01.210595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:01.212572 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m15:58:01.213027 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:01.213432 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m15:58:01.215289 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:58:01.217904 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m15:58:01.218721 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:01.219172 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m15:58:01.221418 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:58:01.222975 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m15:58:01.223567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca2af77-a372-4b7f-9c97-6356e4d163f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de7bf20>]}
[0m15:58:01.224246 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.05s]
[0m15:58:01.225088 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m15:58:01.226527 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:01.227046 [debug] [MainThread]: On master: BEGIN
[0m15:58:01.227525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:01.242550 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m15:58:01.243265 [debug] [MainThread]: On master: COMMIT
[0m15:58:01.243721 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:01.244105 [debug] [MainThread]: On master: COMMIT
[0m15:58:01.245463 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:58:01.246019 [debug] [MainThread]: On master: Close
[0m15:58:01.246652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:01.247113 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__users' was properly closed.
[0m15:58:01.247567 [info ] [MainThread]: 
[0m15:58:01.248105 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m15:58:01.249997 [debug] [MainThread]: Command end result
[0m15:58:01.281150 [info ] [MainThread]: 
[0m15:58:01.281688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:01.282146 [info ] [MainThread]: 
[0m15:58:01.282582 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:58:01.284655 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6987569, "process_in_blocks": "0", "process_kernel_time": 0.486261, "process_mem_max_rss": "109297664", "process_out_blocks": "0", "process_user_time": 2.827838}
[0m15:58:01.285742 [debug] [MainThread]: Command `dbt run` succeeded at 15:58:01.285502 after 1.70 seconds
[0m15:58:01.286408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d95b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccbeed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccbf140>]}
[0m15:58:01.286866 [debug] [MainThread]: Flushing usage events
[0m15:58:07.475805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f106150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2a7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2a6ba0>]}


============================== 15:58:07.482816 | 1111d84e-1597-4e73-8320-8cdfd7ff6ce1 ==============================
[0m15:58:07.482816 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:58:07.483534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:58:07.717839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1111d84e-1597-4e73-8320-8cdfd7ff6ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1404d0>]}
[0m15:58:07.797019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1111d84e-1597-4e73-8320-8cdfd7ff6ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec64830>]}
[0m15:58:07.798408 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:58:07.941180 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:58:08.080933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:08.081403 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:08.134811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1111d84e-1597-4e73-8320-8cdfd7ff6ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f894050>]}
[0m15:58:08.264534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1111d84e-1597-4e73-8320-8cdfd7ff6ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102c52e0>]}
[0m15:58:08.265104 [info ] [MainThread]: Found 6 models, 3 data tests, 6 sources, 428 macros
[0m15:58:08.265528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1111d84e-1597-4e73-8320-8cdfd7ff6ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100bd490>]}
[0m15:58:08.267807 [info ] [MainThread]: 
[0m15:58:08.268478 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:58:08.273050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m15:58:08.341257 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:58:08.341750 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m15:58:08.342233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:08.373809 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m15:58:08.374977 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:58:08.375733 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m15:58:08.380396 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m15:58:08.382495 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m15:58:08.384332 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m15:58:08.393163 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:08.393653 [debug] [MainThread]: On master: BEGIN
[0m15:58:08.394160 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:08.414751 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m15:58:08.415573 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:08.416250 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:58:08.422328 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m15:58:08.423979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1111d84e-1597-4e73-8320-8cdfd7ff6ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f894680>]}
[0m15:58:08.424631 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:08.426792 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:08.427313 [debug] [MainThread]: On master: BEGIN
[0m15:58:08.430197 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:58:08.431027 [debug] [MainThread]: On master: COMMIT
[0m15:58:08.431560 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:08.432001 [debug] [MainThread]: On master: COMMIT
[0m15:58:08.434772 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:58:08.435293 [debug] [MainThread]: On master: Close
[0m15:58:08.435913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:08.436560 [info ] [MainThread]: 
[0m15:58:08.439461 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:58:08.440189 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_pipedrive__activity_activity_id ................. [RUN]
[0m15:58:08.440767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287)
[0m15:58:08.441252 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:58:08.464263 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:58:08.465260 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:58:08.482377 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:58:08.483332 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:58:08.483811 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: BEGIN
[0m15:58:08.484250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:08.504473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m15:58:08.505325 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"
[0m15:58:08.506021 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select activity_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where activity_id is null



      
    ) dbt_internal_test
[0m15:58:08.508715 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:58:08.513739 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: ROLLBACK
[0m15:58:08.515216 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287: Close
[0m15:58:08.516234 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_pipedrive__activity_activity_id ....................... [[32mPASS[0m in 0.08s]
[0m15:58:08.517139 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287
[0m15:58:08.517923 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:58:08.518717 [info ] [Thread-1 (]: 2 of 3 START test relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_  [RUN]
[0m15:58:08.519353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_activity_id.7828522287, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed)
[0m15:58:08.519797 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:58:08.530134 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:58:08.530995 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:58:08.533491 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:58:08.534577 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:58:08.535160 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: BEGIN
[0m15:58:08.535787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:08.557177 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m15:58:08.558299 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"
[0m15:58:08.558924 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select assigned_to_user as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where assigned_to_user is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:58:08.564119 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m15:58:08.566000 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: ROLLBACK
[0m15:58:08.567455 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed: Close
[0m15:58:08.568246 [info ] [Thread-1 (]: 2 of 3 PASS relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.05s]
[0m15:58:08.569002 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed
[0m15:58:08.569525 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:58:08.570079 [info ] [Thread-1 (]: 3 of 3 START test relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_  [RUN]
[0m15:58:08.570801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_assigned_to_user__id__ref_stg_pipedrive__users_.2d71c9b1ed, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19)
[0m15:58:08.571261 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:58:08.578313 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:58:08.579369 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:58:08.582277 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:58:08.583271 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:58:08.583758 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: BEGIN
[0m15:58:08.584169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:08.601313 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:58:08.602014 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"
[0m15:58:08.602515 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where type is not null
),

parent as (
    select type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:58:08.606525 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:58:08.608318 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: ROLLBACK
[0m15:58:08.609931 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19: Close
[0m15:58:08.610659 [info ] [Thread-1 (]: 3 of 3 PASS relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m15:58:08.611503 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19
[0m15:58:08.612905 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:08.613350 [debug] [MainThread]: On master: BEGIN
[0m15:58:08.613697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:08.629718 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m15:58:08.630419 [debug] [MainThread]: On master: COMMIT
[0m15:58:08.630821 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:08.631188 [debug] [MainThread]: On master: COMMIT
[0m15:58:08.632773 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:58:08.633293 [debug] [MainThread]: On master: Close
[0m15:58:08.633967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:08.634448 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_type__type__ref_stg_pipedrive__activity_types_.7825462d19' was properly closed.
[0m15:58:08.635094 [info ] [MainThread]: 
[0m15:58:08.635650 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m15:58:08.637210 [debug] [MainThread]: Command end result
[0m15:58:08.670326 [info ] [MainThread]: 
[0m15:58:08.670869 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:08.671300 [info ] [MainThread]: 
[0m15:58:08.671717 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:58:08.673482 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2791713, "process_in_blocks": "0", "process_kernel_time": 0.339848, "process_mem_max_rss": "110985216", "process_out_blocks": "0", "process_user_time": 2.344214}
[0m15:58:08.674222 [debug] [MainThread]: Command `dbt test` succeeded at 15:58:08.674083 after 1.28 seconds
[0m15:58:08.674698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b61ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dba5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2a6c30>]}
[0m15:58:08.675358 [debug] [MainThread]: Flushing usage events
[0m15:58:40.972153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc19a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd330b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd32ba0>]}


============================== 15:58:40.977801 | 20553400-2d60-4f1a-9f21-17d69c951ee8 ==============================
[0m15:58:40.977801 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:58:40.978747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:58:41.233167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20553400-2d60-4f1a-9f21-17d69c951ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abd1880>]}
[0m15:58:41.299192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20553400-2d60-4f1a-9f21-17d69c951ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1f5ca0>]}
[0m15:58:41.300137 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:58:41.429174 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:58:41.566010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:58:41.566741 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__activity_types.sql
[0m15:58:41.848450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20553400-2d60-4f1a-9f21-17d69c951ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc8e960>]}
[0m15:58:41.958459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20553400-2d60-4f1a-9f21-17d69c951ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc4e060>]}
[0m15:58:41.959153 [info ] [MainThread]: Found 6 models, 3 data tests, 6 sources, 428 macros
[0m15:58:41.959606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20553400-2d60-4f1a-9f21-17d69c951ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb73e30>]}
[0m15:58:41.962022 [info ] [MainThread]: 
[0m15:58:41.962666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:58:41.967517 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:58:42.037275 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:58:42.037748 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:58:42.038134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:42.068610 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.030 seconds
[0m15:58:42.070185 [debug] [ThreadPool]: On list_postgres: Close
[0m15:58:42.071853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m15:58:42.078661 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:58:42.079121 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m15:58:42.079467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:42.094877 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m15:58:42.095386 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m15:58:42.095930 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m15:58:42.100078 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m15:58:42.101712 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m15:58:42.103006 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m15:58:42.109419 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:42.109879 [debug] [MainThread]: On master: BEGIN
[0m15:58:42.110228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:42.126300 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m15:58:42.126904 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:42.127397 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:58:42.132297 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m15:58:42.133836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20553400-2d60-4f1a-9f21-17d69c951ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb53260>]}
[0m15:58:42.134337 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:42.135571 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:42.135988 [debug] [MainThread]: On master: BEGIN
[0m15:58:42.138476 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:58:42.139051 [debug] [MainThread]: On master: COMMIT
[0m15:58:42.139465 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:42.139832 [debug] [MainThread]: On master: COMMIT
[0m15:58:42.141201 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:58:42.141628 [debug] [MainThread]: On master: Close
[0m15:58:42.142325 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:42.142969 [info ] [MainThread]: 
[0m15:58:42.145566 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m15:58:42.146328 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m15:58:42.146981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m15:58:42.147585 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m15:58:42.157774 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:42.158702 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m15:58:42.202633 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:42.203542 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:42.203976 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m15:58:42.204378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:42.220409 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m15:58:42.221103 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:42.221557 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m15:58:42.224415 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:58:42.231761 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:42.232277 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m15:58:42.233840 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:42.237197 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:42.237651 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m15:58:42.239373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:42.258170 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m15:58:42.258702 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:42.259311 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m15:58:42.261442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:58:42.269501 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m15:58:42.275373 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m15:58:42.276011 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m15:58:42.278808 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:58:42.281638 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m15:58:42.283370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20553400-2d60-4f1a-9f21-17d69c951ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2dda60>]}
[0m15:58:42.284191 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.14s]
[0m15:58:42.285177 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m15:58:42.285764 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m15:58:42.286328 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m15:58:42.286998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m15:58:42.287486 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m15:58:42.290931 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:42.291805 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m15:58:42.298183 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:42.299294 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:42.299733 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m15:58:42.300134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:42.316967 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:58:42.317569 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:42.318124 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    SELECT
    id,
    name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type
FROM "postgres"."public"."activity_types"
  );
[0m15:58:42.322063 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:58:42.325920 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:42.326484 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m15:58:42.328177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:42.331444 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:42.331902 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m15:58:42.333477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:42.335556 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m15:58:42.336053 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:42.336471 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m15:58:42.338336 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:58:42.340986 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m15:58:42.341829 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m15:58:42.342290 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m15:58:42.345098 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:58:42.346765 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m15:58:42.347383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20553400-2d60-4f1a-9f21-17d69c951ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0c1700>]}
[0m15:58:42.348170 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m15:58:42.349096 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m15:58:42.349748 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m15:58:42.350882 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m15:58:42.351605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m15:58:42.352123 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m15:58:42.356735 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:42.357786 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m15:58:42.362659 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:42.363557 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:42.363995 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m15:58:42.364405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:42.387516 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m15:58:42.388200 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:42.388654 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."deal_changes"
  );
[0m15:58:42.390942 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:58:42.394458 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:42.394941 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m15:58:42.396560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:42.399852 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:42.400309 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m15:58:42.402962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:58:42.404973 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m15:58:42.405496 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:42.405989 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m15:58:42.407997 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:58:42.410697 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m15:58:42.411614 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m15:58:42.412042 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m15:58:42.414494 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:58:42.416083 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m15:58:42.416674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20553400-2d60-4f1a-9f21-17d69c951ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d147f50>]}
[0m15:58:42.417369 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.07s]
[0m15:58:42.418114 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m15:58:42.418640 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields
[0m15:58:42.419341 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__fields ... [RUN]
[0m15:58:42.419921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__fields)
[0m15:58:42.420366 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields
[0m15:58:42.423099 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:42.423893 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields
[0m15:58:42.429686 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:42.431167 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:42.431673 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: BEGIN
[0m15:58:42.432129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:42.451275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m15:58:42.451971 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:42.452545 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m15:58:42.454897 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:58:42.458230 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:42.458799 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields" rename to "stg_pipedrive__fields__dbt_backup"
[0m15:58:42.460467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:42.463646 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:42.464091 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp" rename to "stg_pipedrive__fields"
[0m15:58:42.465582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:42.467585 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m15:58:42.468035 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:42.468447 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m15:58:42.470361 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:58:42.473007 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup"
[0m15:58:42.473835 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m15:58:42.474265 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup" cascade
[0m15:58:42.476799 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:58:42.478396 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: Close
[0m15:58:42.478983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20553400-2d60-4f1a-9f21-17d69c951ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d15bbc0>]}
[0m15:58:42.479689 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields  [[32mCREATE VIEW[0m in 0.06s]
[0m15:58:42.480488 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields
[0m15:58:42.481019 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m15:58:42.481714 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m15:58:42.482277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m15:58:42.482722 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m15:58:42.485578 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:42.486365 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m15:58:42.490091 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:42.490885 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:42.491591 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m15:58:42.492103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:42.509271 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:58:42.510056 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:42.510569 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."stages"
  );
[0m15:58:42.513042 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:58:42.516349 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:42.516799 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m15:58:42.518644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:42.521999 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:42.522493 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m15:58:42.524041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:42.526044 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m15:58:42.526541 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:42.526962 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m15:58:42.529023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:58:42.531618 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m15:58:42.532436 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m15:58:42.532860 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m15:58:42.535309 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:58:42.536865 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m15:58:42.537465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20553400-2d60-4f1a-9f21-17d69c951ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0be1e0>]}
[0m15:58:42.538161 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m15:58:42.538887 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m15:58:42.539398 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m15:58:42.540050 [info ] [Thread-1 (]: 6 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m15:58:42.540743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m15:58:42.541216 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m15:58:42.544120 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:42.544952 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m15:58:42.548714 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:42.549502 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:42.549941 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m15:58:42.550344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:42.567513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:58:42.568252 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:42.568748 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m15:58:42.571232 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:58:42.576349 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:42.576845 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m15:58:42.578451 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:42.581700 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:42.582149 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m15:58:42.583675 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:58:42.585624 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m15:58:42.586146 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:42.586566 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m15:58:42.588378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:58:42.591097 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m15:58:42.592019 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m15:58:42.592499 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m15:58:42.594794 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:58:42.596416 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m15:58:42.597049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20553400-2d60-4f1a-9f21-17d69c951ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccda7e0>]}
[0m15:58:42.597799 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m15:58:42.598583 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m15:58:42.600073 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:42.600503 [debug] [MainThread]: On master: BEGIN
[0m15:58:42.600860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:42.617275 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m15:58:42.617852 [debug] [MainThread]: On master: COMMIT
[0m15:58:42.618385 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:42.618832 [debug] [MainThread]: On master: COMMIT
[0m15:58:42.620631 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:58:42.621315 [debug] [MainThread]: On master: Close
[0m15:58:42.621951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:42.622568 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__users' was properly closed.
[0m15:58:42.623267 [info ] [MainThread]: 
[0m15:58:42.624032 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m15:58:42.626702 [debug] [MainThread]: Command end result
[0m15:58:42.662887 [info ] [MainThread]: 
[0m15:58:42.663411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:42.663802 [info ] [MainThread]: 
[0m15:58:42.664222 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:58:42.666519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7783196, "process_in_blocks": "0", "process_kernel_time": 0.356176, "process_mem_max_rss": "112345088", "process_out_blocks": "0", "process_user_time": 2.766382}
[0m15:58:42.667309 [debug] [MainThread]: Command `dbt run` succeeded at 15:58:42.667162 after 1.78 seconds
[0m15:58:42.667795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab8dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7a3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd32870>]}
[0m15:58:42.668219 [debug] [MainThread]: Flushing usage events
[0m16:09:40.256234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d263aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1af080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1aeb70>]}


============================== 16:09:40.340787 | 745ef26d-f4ea-4545-9f61-9e74166e6ffe ==============================
[0m16:09:40.340787 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:09:40.341720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:09:40.625013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '745ef26d-f4ea-4545-9f61-9e74166e6ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0845f0>]}
[0m16:09:40.698128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '745ef26d-f4ea-4545-9f61-9e74166e6ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf93260>]}
[0m16:09:40.699960 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:09:40.845753 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:09:41.025422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m16:09:41.026314 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/schema.yml
[0m16:09:41.026777 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__activity.sql
[0m16:09:41.027270 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__activity_types.sql
[0m16:09:41.318038 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:09:41.318892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '745ef26d-f4ea-4545-9f61-9e74166e6ffe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e775be0>]}
[0m16:09:41.547346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '745ef26d-f4ea-4545-9f61-9e74166e6ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1fac60>]}
[0m16:09:41.704419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '745ef26d-f4ea-4545-9f61-9e74166e6ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1faba0>]}
[0m16:09:41.705215 [info ] [MainThread]: Found 6 models, 6 data tests, 6 sources, 428 macros
[0m16:09:41.706020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '745ef26d-f4ea-4545-9f61-9e74166e6ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10effbc80>]}
[0m16:09:41.711048 [info ] [MainThread]: 
[0m16:09:41.711895 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:41.719669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m16:09:41.801947 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:09:41.802430 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m16:09:41.802810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:41.860000 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m16:09:41.860862 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:09:41.861446 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m16:09:41.865502 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m16:09:41.867232 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m16:09:41.868626 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m16:09:41.875188 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:41.875633 [debug] [MainThread]: On master: BEGIN
[0m16:09:41.875973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:41.892598 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m16:09:41.893164 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:41.893666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:41.898651 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m16:09:41.900221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '745ef26d-f4ea-4545-9f61-9e74166e6ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4438c0>]}
[0m16:09:41.900840 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:41.902348 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:41.902783 [debug] [MainThread]: On master: BEGIN
[0m16:09:41.904754 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:09:41.905312 [debug] [MainThread]: On master: COMMIT
[0m16:09:41.905688 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:41.906036 [debug] [MainThread]: On master: COMMIT
[0m16:09:41.907281 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:09:41.907702 [debug] [MainThread]: On master: Close
[0m16:09:41.908271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:09:41.908767 [info ] [MainThread]: 
[0m16:09:41.912398 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m16:09:41.912947 [info ] [Thread-1 (]: 1 of 6 START test not_null_stg_pipedrive__activity_deal_id ..................... [RUN]
[0m16:09:41.913502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m16:09:41.913948 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m16:09:41.930962 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m16:09:41.931844 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m16:09:41.948723 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m16:09:41.949641 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m16:09:41.950066 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m16:09:41.950857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:41.966777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:09:41.967504 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m16:09:41.967972 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m16:09:41.970272 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:09:41.974860 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m16:09:41.976391 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m16:09:41.977177 [info ] [Thread-1 (]: 1 of 6 PASS not_null_stg_pipedrive__activity_deal_id ........................... [[32mPASS[0m in 0.06s]
[0m16:09:41.977996 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m16:09:41.978625 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m16:09:41.979155 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_pipedrive__activity_due_date .................... [RUN]
[0m16:09:41.979822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5)
[0m16:09:41.980292 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m16:09:41.985760 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m16:09:41.988044 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m16:09:41.990562 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m16:09:41.991597 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m16:09:41.992211 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: BEGIN
[0m16:09:41.992646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:42.008820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:09:42.009575 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m16:09:42.010039 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_date is null



      
    ) dbt_internal_test
[0m16:09:42.012451 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "due_date" does not exist
LINE 13: select due_date
                ^
HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.due_to".

[0m16:09:42.013106 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: ROLLBACK
[0m16:09:42.014936 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: Close
[0m16:09:42.025922 [debug] [Thread-1 (]: Database Error in test not_null_stg_pipedrive__activity_due_date (models/staging/schema.yml)
  column "due_date" does not exist
  LINE 13: select due_date
                  ^
  HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.due_to".
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/not_null_stg_pipedrive__activity_due_date.sql
[0m16:09:42.026641 [error] [Thread-1 (]: 2 of 6 ERROR not_null_stg_pipedrive__activity_due_date ......................... [[31mERROR[0m in 0.05s]
[0m16:09:42.027614 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m16:09:42.028224 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m16:09:42.029643 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_pipedrive__activity_id .......................... [RUN]
[0m16:09:42.030482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m16:09:42.031000 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m16:09:42.037753 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m16:09:42.039023 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m16:09:42.042081 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m16:09:42.044016 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m16:09:42.044594 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m16:09:42.045143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:42.062161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:09:42.062912 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m16:09:42.063493 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m16:09:42.065539 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 13: select id
                ^

[0m16:09:42.068207 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m16:09:42.070314 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m16:09:42.074573 [debug] [Thread-1 (]: Database Error in test not_null_stg_pipedrive__activity_id (models/staging/schema.yml)
  column "id" does not exist
  LINE 13: select id
                  ^
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/not_null_stg_pipedrive__activity_id.sql
[0m16:09:42.075329 [error] [Thread-1 (]: 3 of 6 ERROR not_null_stg_pipedrive__activity_id ............................... [[31mERROR[0m in 0.04s]
[0m16:09:42.076555 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m16:09:42.077330 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m16:09:42.077805 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_pipedrive__activity_is_done ..................... [RUN]
[0m16:09:42.078577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m16:09:42.079313 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m16:09:42.083945 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m16:09:42.084882 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m16:09:42.087409 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m16:09:42.088220 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m16:09:42.088633 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m16:09:42.089043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:42.106061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:09:42.106665 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m16:09:42.107118 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m16:09:42.109380 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "is_done" does not exist
LINE 13: select is_done
                ^
HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.done".

[0m16:09:42.110137 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m16:09:42.113553 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m16:09:42.116911 [debug] [Thread-1 (]: Database Error in test not_null_stg_pipedrive__activity_is_done (models/staging/schema.yml)
  column "is_done" does not exist
  LINE 13: select is_done
                  ^
  HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.done".
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/not_null_stg_pipedrive__activity_is_done.sql
[0m16:09:42.117932 [error] [Thread-1 (]: 4 of 6 ERROR not_null_stg_pipedrive__activity_is_done .......................... [[31mERROR[0m in 0.04s]
[0m16:09:42.118713 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m16:09:42.119222 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m16:09:42.119662 [info ] [Thread-1 (]: 5 of 6 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m16:09:42.120275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m16:09:42.120728 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m16:09:42.128672 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m16:09:42.129874 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m16:09:42.132398 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m16:09:42.133359 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m16:09:42.133928 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m16:09:42.134371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:42.150735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:09:42.151439 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m16:09:42.151986 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:09:42.154186 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "activity_type" does not exist
LINE 12:     select activity_type as from_field
                    ^

[0m16:09:42.154708 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m16:09:42.156406 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m16:09:42.160933 [debug] [Thread-1 (]: Database Error in test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_ (models/staging/schema.yml)
  column "activity_type" does not exist
  LINE 12:     select activity_type as from_field
                      ^
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/relationships_stg_pipedrive__a_3f73663604b5399ab0c08dc16d6c52a2.sql
[0m16:09:42.161789 [error] [Thread-1 (]: 5 of 6 ERROR relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[31mERROR[0m in 0.04s]
[0m16:09:42.162641 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m16:09:42.163233 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m16:09:42.164024 [info ] [Thread-1 (]: 6 of 6 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m16:09:42.164669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m16:09:42.165126 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m16:09:42.171125 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m16:09:42.171957 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m16:09:42.174324 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m16:09:42.175197 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m16:09:42.175700 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m16:09:42.176107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:42.191569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:09:42.192095 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m16:09:42.192609 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:09:42.194393 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "user_id" does not exist
LINE 12:     select user_id as from_field
                    ^

[0m16:09:42.194995 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m16:09:42.196894 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m16:09:42.200550 [debug] [Thread-1 (]: Database Error in test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_ (models/staging/schema.yml)
  column "user_id" does not exist
  LINE 12:     select user_id as from_field
                      ^
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/relationships_stg_pipedrive__a_c600f1e8f629a2b656794408e684f653.sql
[0m16:09:42.201501 [error] [Thread-1 (]: 6 of 6 ERROR relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[31mERROR[0m in 0.04s]
[0m16:09:42.202263 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m16:09:42.203842 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:42.204328 [debug] [MainThread]: On master: BEGIN
[0m16:09:42.204705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:42.221973 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m16:09:42.222604 [debug] [MainThread]: On master: COMMIT
[0m16:09:42.223081 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:42.223562 [debug] [MainThread]: On master: COMMIT
[0m16:09:42.224908 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:09:42.225342 [debug] [MainThread]: On master: Close
[0m16:09:42.225866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:42.226378 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m16:09:42.227058 [info ] [MainThread]: 
[0m16:09:42.227588 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m16:09:42.229567 [debug] [MainThread]: Command end result
[0m16:09:42.260280 [info ] [MainThread]: 
[0m16:09:42.260855 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:09:42.261272 [info ] [MainThread]: 
[0m16:09:42.261752 [error] [MainThread]:   Database Error in test not_null_stg_pipedrive__activity_due_date (models/staging/schema.yml)
  column "due_date" does not exist
  LINE 13: select due_date
                  ^
  HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.due_to".
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/not_null_stg_pipedrive__activity_due_date.sql
[0m16:09:42.262171 [info ] [MainThread]: 
[0m16:09:42.262711 [error] [MainThread]:   Database Error in test not_null_stg_pipedrive__activity_id (models/staging/schema.yml)
  column "id" does not exist
  LINE 13: select id
                  ^
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/not_null_stg_pipedrive__activity_id.sql
[0m16:09:42.263116 [info ] [MainThread]: 
[0m16:09:42.263587 [error] [MainThread]:   Database Error in test not_null_stg_pipedrive__activity_is_done (models/staging/schema.yml)
  column "is_done" does not exist
  LINE 13: select is_done
                  ^
  HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.done".
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/not_null_stg_pipedrive__activity_is_done.sql
[0m16:09:42.263978 [info ] [MainThread]: 
[0m16:09:42.264505 [error] [MainThread]:   Database Error in test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_ (models/staging/schema.yml)
  column "activity_type" does not exist
  LINE 12:     select activity_type as from_field
                      ^
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/relationships_stg_pipedrive__a_3f73663604b5399ab0c08dc16d6c52a2.sql
[0m16:09:42.265006 [info ] [MainThread]: 
[0m16:09:42.265552 [error] [MainThread]:   Database Error in test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_ (models/staging/schema.yml)
  column "user_id" does not exist
  LINE 12:     select user_id as from_field
                      ^
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/relationships_stg_pipedrive__a_c600f1e8f629a2b656794408e684f653.sql
[0m16:09:42.265961 [info ] [MainThread]: 
[0m16:09:42.266389 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=5 SKIP=0 TOTAL=6
[0m16:09:42.268609 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.111673, "process_in_blocks": "0", "process_kernel_time": 0.546959, "process_mem_max_rss": "116523008", "process_out_blocks": "0", "process_user_time": 3.152802}
[0m16:09:42.269349 [debug] [MainThread]: Command `dbt test` failed at 16:09:42.269209 after 2.11 seconds
[0m16:09:42.269835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a522d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1aee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1aed50>]}
[0m16:09:42.270255 [debug] [MainThread]: Flushing usage events
[0m16:10:35.190414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf45fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d597620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d597110>]}


============================== 16:10:35.197546 | 03aa82be-48f4-4fbc-a4b1-a9cc31d84699 ==============================
[0m16:10:35.197546 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:10:35.198385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:10:35.484559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03aa82be-48f4-4fbc-a4b1-a9cc31d84699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c439a90>]}
[0m16:10:35.554809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03aa82be-48f4-4fbc-a4b1-a9cc31d84699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8ace00>]}
[0m16:10:35.556161 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:10:35.703281 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:10:35.873475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:35.873978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:35.927124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03aa82be-48f4-4fbc-a4b1-a9cc31d84699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db00c50>]}
[0m16:10:36.057142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03aa82be-48f4-4fbc-a4b1-a9cc31d84699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e23aba0>]}
[0m16:10:36.057813 [info ] [MainThread]: Found 6 models, 6 data tests, 6 sources, 428 macros
[0m16:10:36.058309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03aa82be-48f4-4fbc-a4b1-a9cc31d84699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db00ce0>]}
[0m16:10:36.061180 [info ] [MainThread]: 
[0m16:10:36.061994 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:36.066517 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:10:36.144592 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:10:36.145090 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:10:36.145475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:36.202331 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.057 seconds
[0m16:10:36.203998 [debug] [ThreadPool]: On list_postgres: Close
[0m16:10:36.205777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m16:10:36.212495 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:10:36.212941 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m16:10:36.213282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:36.229045 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m16:10:36.229618 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:10:36.230179 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m16:10:36.235284 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m16:10:36.236988 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m16:10:36.238302 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m16:10:36.244534 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:36.244971 [debug] [MainThread]: On master: BEGIN
[0m16:10:36.245306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:36.261397 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m16:10:36.261989 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:36.262496 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:10:36.267464 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m16:10:36.269108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03aa82be-48f4-4fbc-a4b1-a9cc31d84699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3b02c0>]}
[0m16:10:36.269621 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:36.270962 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:36.271395 [debug] [MainThread]: On master: BEGIN
[0m16:10:36.273279 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:10:36.273815 [debug] [MainThread]: On master: COMMIT
[0m16:10:36.274218 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:36.274570 [debug] [MainThread]: On master: COMMIT
[0m16:10:36.275812 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:10:36.276222 [debug] [MainThread]: On master: Close
[0m16:10:36.276795 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:36.277259 [info ] [MainThread]: 
[0m16:10:36.280502 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:10:36.281250 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m16:10:36.281823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m16:10:36.282250 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:10:36.292544 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:10:36.293899 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:10:36.336676 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:10:36.337617 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:10:36.338040 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m16:10:36.338432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:36.354718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:10:36.355340 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:10:36.355855 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date,
FROM "postgres"."public"."activity"
  );
[0m16:10:36.357961 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 17: FROM "postgres"."public"."activity"
         ^

[0m16:10:36.358585 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: ROLLBACK
[0m16:10:36.360437 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m16:10:36.371518 [debug] [Thread-1 (]: Database Error in model stg_pipedrive__activity (models/staging/stg_pipedrive__activity.sql)
  syntax error at or near "FROM"
  LINE 17: FROM "postgres"."public"."activity"
           ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__activity.sql
[0m16:10:36.373331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03aa82be-48f4-4fbc-a4b1-a9cc31d84699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb45e20>]}
[0m16:10:36.374140 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[31mERROR[0m in 0.09s]
[0m16:10:36.374894 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:10:36.375397 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:10:36.376719 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m16:10:36.377276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m16:10:36.377702 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:10:36.380579 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:10:36.381714 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:10:36.385887 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:10:36.386769 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:10:36.387221 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m16:10:36.387646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:36.407727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m16:10:36.408772 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:10:36.409326 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type,
FROM "postgres"."public"."activity_types"
  );
[0m16:10:36.410812 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 17: FROM "postgres"."public"."activity_types"
         ^

[0m16:10:36.411344 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: ROLLBACK
[0m16:10:36.412983 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m16:10:36.416547 [debug] [Thread-1 (]: Database Error in model stg_pipedrive__activity_types (models/staging/stg_pipedrive__activity_types.sql)
  syntax error at or near "FROM"
  LINE 17: FROM "postgres"."public"."activity_types"
           ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__activity_types.sql
[0m16:10:36.417776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03aa82be-48f4-4fbc-a4b1-a9cc31d84699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db913a0>]}
[0m16:10:36.418778 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[31mERROR[0m in 0.04s]
[0m16:10:36.419881 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:10:36.420401 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:10:36.420935 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m16:10:36.421541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m16:10:36.422094 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:10:36.425058 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:10:36.425946 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:10:36.429770 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:10:36.430585 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:10:36.431010 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m16:10:36.431411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:36.451894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m16:10:36.452560 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:10:36.453018 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."deal_changes"
  );
[0m16:10:36.455691 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:10:36.463364 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:10:36.463893 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m16:10:36.465582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:36.468977 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:10:36.469462 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m16:10:36.471119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:36.489799 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m16:10:36.490317 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:10:36.490725 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m16:10:36.493080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:10:36.501196 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m16:10:36.506856 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:10:36.507327 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m16:10:36.510101 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:10:36.512824 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m16:10:36.513528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03aa82be-48f4-4fbc-a4b1-a9cc31d84699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e87f410>]}
[0m16:10:36.514286 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.09s]
[0m16:10:36.515064 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:10:36.515621 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:10:36.516417 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__fields ... [RUN]
[0m16:10:36.517188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__fields)
[0m16:10:36.517655 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:10:36.520643 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:10:36.521871 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:10:36.525913 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:10:36.526759 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:10:36.527212 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: BEGIN
[0m16:10:36.527633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:36.548277 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m16:10:36.549001 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:10:36.549479 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m16:10:36.552042 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:10:36.555248 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:10:36.555691 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields" rename to "stg_pipedrive__fields__dbt_backup"
[0m16:10:36.557298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:36.560637 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:10:36.561227 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp" rename to "stg_pipedrive__fields"
[0m16:10:36.562914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:36.564892 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m16:10:36.565326 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:10:36.565727 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m16:10:36.568178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:10:36.570945 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup"
[0m16:10:36.571845 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:10:36.572260 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup" cascade
[0m16:10:36.575005 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:10:36.576646 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: Close
[0m16:10:36.577266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03aa82be-48f4-4fbc-a4b1-a9cc31d84699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bffc2c0>]}
[0m16:10:36.578020 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields  [[32mCREATE VIEW[0m in 0.06s]
[0m16:10:36.578874 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:10:36.579421 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:10:36.580150 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m16:10:36.580835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m16:10:36.581274 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:10:36.583971 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:10:36.584969 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:10:36.588908 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:10:36.589778 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:10:36.590233 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m16:10:36.590631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:36.609688 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m16:10:36.610345 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:10:36.610826 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."stages"
  );
[0m16:10:36.615503 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:10:36.619081 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:10:36.619583 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m16:10:36.621112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:36.624279 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:10:36.624743 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m16:10:36.626348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:36.628519 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m16:10:36.629004 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:10:36.629413 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m16:10:36.631207 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:10:36.633856 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m16:10:36.634659 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:10:36.635134 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m16:10:36.637512 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:10:36.639175 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m16:10:36.639802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03aa82be-48f4-4fbc-a4b1-a9cc31d84699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3a2ed0>]}
[0m16:10:36.640502 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m16:10:36.641239 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:10:36.641759 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m16:10:36.642402 [info ] [Thread-1 (]: 6 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m16:10:36.642992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m16:10:36.643423 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m16:10:36.647558 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:10:36.648770 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m16:10:36.652954 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:10:36.653859 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:10:36.654318 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m16:10:36.654746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:36.675933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m16:10:36.676979 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:10:36.677693 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m16:10:36.680752 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:10:36.684819 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:10:36.685355 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m16:10:36.687213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:36.690521 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:10:36.690985 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m16:10:36.692685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:10:36.694681 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m16:10:36.695169 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:10:36.695581 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m16:10:36.697785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:10:36.700531 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m16:10:36.701595 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:10:36.702120 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m16:10:36.705446 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:10:36.707082 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m16:10:36.707703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03aa82be-48f4-4fbc-a4b1-a9cc31d84699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e440920>]}
[0m16:10:36.708534 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m16:10:36.709451 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m16:10:36.711081 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:36.711509 [debug] [MainThread]: On master: BEGIN
[0m16:10:36.711863 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:36.729280 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m16:10:36.729931 [debug] [MainThread]: On master: COMMIT
[0m16:10:36.730335 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:36.730775 [debug] [MainThread]: On master: COMMIT
[0m16:10:36.732064 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:10:36.732491 [debug] [MainThread]: On master: Close
[0m16:10:36.733121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:36.733657 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__users' was properly closed.
[0m16:10:36.734166 [info ] [MainThread]: 
[0m16:10:36.734958 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m16:10:36.736908 [debug] [MainThread]: Command end result
[0m16:10:36.771138 [info ] [MainThread]: 
[0m16:10:36.771908 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:10:36.772614 [info ] [MainThread]: 
[0m16:10:36.773348 [error] [MainThread]:   Database Error in model stg_pipedrive__activity (models/staging/stg_pipedrive__activity.sql)
  syntax error at or near "FROM"
  LINE 17: FROM "postgres"."public"."activity"
           ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__activity.sql
[0m16:10:36.773828 [info ] [MainThread]: 
[0m16:10:36.774313 [error] [MainThread]:   Database Error in model stg_pipedrive__activity_types (models/staging/stg_pipedrive__activity_types.sql)
  syntax error at or near "FROM"
  LINE 17: FROM "postgres"."public"."activity_types"
           ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__activity_types.sql
[0m16:10:36.774771 [info ] [MainThread]: 
[0m16:10:36.775203 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m16:10:36.777433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6799237, "process_in_blocks": "0", "process_kernel_time": 0.54182, "process_mem_max_rss": "109682688", "process_out_blocks": "0", "process_user_time": 2.863489}
[0m16:10:36.778272 [debug] [MainThread]: Command `dbt run` failed at 16:10:36.778133 after 1.68 seconds
[0m16:10:36.778798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d024140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d024b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e885130>]}
[0m16:10:36.779239 [debug] [MainThread]: Flushing usage events
[0m16:11:01.431472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f15190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119631a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111962bd0>]}


============================== 16:11:01.440647 | 0f3b7dd2-862a-48c1-9f9b-b2301dd8f78d ==============================
[0m16:11:01.440647 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:11:01.441658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:11:01.711812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f3b7dd2-862a-48c1-9f9b-b2301dd8f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a5bfe0>]}
[0m16:11:01.777778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f3b7dd2-862a-48c1-9f9b-b2301dd8f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110874380>]}
[0m16:11:01.779382 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:11:01.930126 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:11:02.106485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:11:02.107298 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__activity.sql
[0m16:11:02.371469 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:11:02.372048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0f3b7dd2-862a-48c1-9f9b-b2301dd8f78d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ed8710>]}
[0m16:11:02.602890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f3b7dd2-862a-48c1-9f9b-b2301dd8f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112910350>]}
[0m16:11:02.731339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f3b7dd2-862a-48c1-9f9b-b2301dd8f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127fe8d0>]}
[0m16:11:02.731940 [info ] [MainThread]: Found 6 models, 6 data tests, 6 sources, 428 macros
[0m16:11:02.732442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f3b7dd2-862a-48c1-9f9b-b2301dd8f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128b6720>]}
[0m16:11:02.735121 [info ] [MainThread]: 
[0m16:11:02.735848 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:02.740581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:11:02.815699 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:11:02.816186 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:11:02.816570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:02.870309 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.054 seconds
[0m16:11:02.872254 [debug] [ThreadPool]: On list_postgres: Close
[0m16:11:02.874482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m16:11:02.881072 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:11:02.881522 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m16:11:02.881863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:02.897746 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m16:11:02.898309 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:11:02.898765 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m16:11:02.903206 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m16:11:02.904833 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m16:11:02.906012 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m16:11:02.911958 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:02.912396 [debug] [MainThread]: On master: BEGIN
[0m16:11:02.912728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:02.929366 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m16:11:02.929936 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:02.930434 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:11:02.935375 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m16:11:02.936929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f3b7dd2-862a-48c1-9f9b-b2301dd8f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a26570>]}
[0m16:11:02.937417 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:02.938622 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:02.939039 [debug] [MainThread]: On master: BEGIN
[0m16:11:02.942051 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:11:02.942661 [debug] [MainThread]: On master: COMMIT
[0m16:11:02.943063 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:02.943430 [debug] [MainThread]: On master: COMMIT
[0m16:11:02.944671 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:11:02.945105 [debug] [MainThread]: On master: Close
[0m16:11:02.945667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:02.946106 [info ] [MainThread]: 
[0m16:11:02.949144 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:11:02.949936 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m16:11:02.950667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m16:11:02.951175 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:11:02.961319 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:02.962186 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:11:03.008457 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:03.009385 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:03.009816 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m16:11:03.010213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:03.027571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:11:03.028171 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:03.028747 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m16:11:03.032255 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:11:03.039579 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:03.040083 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m16:11:03.041672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:03.044909 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:03.045381 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m16:11:03.047321 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:03.066761 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m16:11:03.067314 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:03.067755 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m16:11:03.070754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:11:03.078863 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m16:11:03.084528 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:03.085081 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m16:11:03.087980 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:11:03.091287 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m16:11:03.093120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b7dd2-862a-48c1-9f9b-b2301dd8f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d1ab40>]}
[0m16:11:03.093904 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.14s]
[0m16:11:03.094842 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:11:03.095410 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:11:03.095977 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m16:11:03.096664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m16:11:03.097130 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:11:03.099998 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:11:03.100793 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:11:03.104865 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:11:03.105692 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:11:03.106123 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m16:11:03.106591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:03.126399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m16:11:03.127490 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:11:03.128085 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type,
FROM "postgres"."public"."activity_types"
  );
[0m16:11:03.130808 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 17: FROM "postgres"."public"."activity_types"
         ^

[0m16:11:03.131373 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: ROLLBACK
[0m16:11:03.133231 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m16:11:03.145469 [debug] [Thread-1 (]: Database Error in model stg_pipedrive__activity_types (models/staging/stg_pipedrive__activity_types.sql)
  syntax error at or near "FROM"
  LINE 17: FROM "postgres"."public"."activity_types"
           ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__activity_types.sql
[0m16:11:03.146079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b7dd2-862a-48c1-9f9b-b2301dd8f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129a62d0>]}
[0m16:11:03.146791 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[31mERROR[0m in 0.05s]
[0m16:11:03.147583 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:11:03.148112 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:11:03.149482 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m16:11:03.150059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m16:11:03.150526 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:11:03.153658 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:03.154830 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:11:03.159031 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:03.159874 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:03.160309 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m16:11:03.160713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:03.179766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m16:11:03.180424 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:03.180872 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."deal_changes"
  );
[0m16:11:03.183301 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:11:03.186740 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:03.187224 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m16:11:03.188885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:03.192308 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:03.192790 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m16:11:03.194345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:03.196251 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m16:11:03.196716 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:03.197126 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m16:11:03.199173 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:11:03.203522 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m16:11:03.204478 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:03.204908 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m16:11:03.207703 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:11:03.209907 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m16:11:03.210633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b7dd2-862a-48c1-9f9b-b2301dd8f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef3920>]}
[0m16:11:03.211379 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m16:11:03.212123 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:11:03.212639 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:11:03.213329 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__fields ... [RUN]
[0m16:11:03.213916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__fields)
[0m16:11:03.214345 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:11:03.216989 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:03.217753 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:11:03.221738 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:03.222572 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:03.223000 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: BEGIN
[0m16:11:03.223402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:03.246867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m16:11:03.247849 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:03.248513 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m16:11:03.251971 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:11:03.256407 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:03.256926 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields" rename to "stg_pipedrive__fields__dbt_backup"
[0m16:11:03.259498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:11:03.263768 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:03.264426 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp" rename to "stg_pipedrive__fields"
[0m16:11:03.266615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:11:03.269544 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m16:11:03.270216 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:03.270919 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m16:11:03.273183 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:11:03.277500 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup"
[0m16:11:03.278603 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:03.279140 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup" cascade
[0m16:11:03.281834 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:11:03.283488 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: Close
[0m16:11:03.284083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b7dd2-862a-48c1-9f9b-b2301dd8f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef3410>]}
[0m16:11:03.284994 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields  [[32mCREATE VIEW[0m in 0.07s]
[0m16:11:03.285866 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:11:03.286419 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:11:03.287048 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m16:11:03.287676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m16:11:03.288126 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:11:03.291293 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:03.292272 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:11:03.296564 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:03.297402 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:03.297917 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m16:11:03.298319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:03.313867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:11:03.314450 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:03.314913 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."stages"
  );
[0m16:11:03.316981 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:11:03.320474 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:03.320957 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m16:11:03.322356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:03.325848 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:03.326332 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m16:11:03.327732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:03.329571 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m16:11:03.330011 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:03.330415 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m16:11:03.332070 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:11:03.334769 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m16:11:03.335625 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:03.336051 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m16:11:03.338292 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:11:03.339882 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m16:11:03.340497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b7dd2-862a-48c1-9f9b-b2301dd8f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e95640>]}
[0m16:11:03.341220 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.05s]
[0m16:11:03.342066 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:11:03.342786 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m16:11:03.343517 [info ] [Thread-1 (]: 6 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m16:11:03.344081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m16:11:03.344514 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m16:11:03.348714 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:03.349498 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m16:11:03.353724 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:03.354723 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:03.355194 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m16:11:03.355882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:03.374442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m16:11:03.375193 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:03.375858 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m16:11:03.378495 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:11:03.381799 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:03.382264 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m16:11:03.384016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:03.387445 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:03.387920 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m16:11:03.389479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:03.391449 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m16:11:03.391905 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:03.392316 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m16:11:03.394404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:11:03.397017 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m16:11:03.397842 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:03.398274 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m16:11:03.400688 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:11:03.402474 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m16:11:03.403084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b7dd2-862a-48c1-9f9b-b2301dd8f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f3b920>]}
[0m16:11:03.403811 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m16:11:03.404564 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m16:11:03.406046 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:03.406470 [debug] [MainThread]: On master: BEGIN
[0m16:11:03.406811 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:03.422618 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m16:11:03.423135 [debug] [MainThread]: On master: COMMIT
[0m16:11:03.423551 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:03.423914 [debug] [MainThread]: On master: COMMIT
[0m16:11:03.425997 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:11:03.426566 [debug] [MainThread]: On master: Close
[0m16:11:03.427096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:03.427492 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__users' was properly closed.
[0m16:11:03.427933 [info ] [MainThread]: 
[0m16:11:03.428426 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m16:11:03.430327 [debug] [MainThread]: Command end result
[0m16:11:03.461108 [info ] [MainThread]: 
[0m16:11:03.461623 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:11:03.462106 [info ] [MainThread]: 
[0m16:11:03.462651 [error] [MainThread]:   Database Error in model stg_pipedrive__activity_types (models/staging/stg_pipedrive__activity_types.sql)
  syntax error at or near "FROM"
  LINE 17: FROM "postgres"."public"."activity_types"
           ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__activity_types.sql
[0m16:11:03.463045 [info ] [MainThread]: 
[0m16:11:03.463451 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m16:11:03.466122 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1208608, "process_in_blocks": "0", "process_kernel_time": 0.529039, "process_mem_max_rss": "115216384", "process_out_blocks": "0", "process_user_time": 3.265253}
[0m16:11:03.466927 [debug] [MainThread]: Command `dbt run` failed at 16:11:03.466785 after 2.12 seconds
[0m16:11:03.467423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc72d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113dbfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a794c0>]}
[0m16:11:03.467867 [debug] [MainThread]: Flushing usage events
[0m16:11:19.625718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107253200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637b830>]}


============================== 16:11:19.634185 | 72685c24-42ab-4d23-9c94-8ec939d6e6d0 ==============================
[0m16:11:19.634185 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:11:19.634953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:11:19.875764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72685c24-42ab-4d23-9c94-8ec939d6e6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f4620>]}
[0m16:11:19.942880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72685c24-42ab-4d23-9c94-8ec939d6e6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107280f20>]}
[0m16:11:19.943958 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:11:20.081938 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:11:20.244951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:11:20.245709 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__activity_types.sql
[0m16:11:20.535980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72685c24-42ab-4d23-9c94-8ec939d6e6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10779c920>]}
[0m16:11:20.669534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72685c24-42ab-4d23-9c94-8ec939d6e6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107962030>]}
[0m16:11:20.670151 [info ] [MainThread]: Found 6 models, 6 data tests, 6 sources, 428 macros
[0m16:11:20.670603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72685c24-42ab-4d23-9c94-8ec939d6e6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106802d20>]}
[0m16:11:20.673163 [info ] [MainThread]: 
[0m16:11:20.673832 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:20.678399 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:11:20.756542 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:11:20.757102 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:11:20.757540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:20.793712 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m16:11:20.795359 [debug] [ThreadPool]: On list_postgres: Close
[0m16:11:20.797112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m16:11:20.804028 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:11:20.804485 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m16:11:20.804829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:20.820705 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m16:11:20.821306 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:11:20.821765 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m16:11:20.825717 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m16:11:20.827355 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m16:11:20.828565 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m16:11:20.834645 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:20.835095 [debug] [MainThread]: On master: BEGIN
[0m16:11:20.835437 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:20.851972 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m16:11:20.852695 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:20.853278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:11:20.858518 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m16:11:20.860109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72685c24-42ab-4d23-9c94-8ec939d6e6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b62660>]}
[0m16:11:20.860661 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:20.862186 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:20.862638 [debug] [MainThread]: On master: BEGIN
[0m16:11:20.864864 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:11:20.865414 [debug] [MainThread]: On master: COMMIT
[0m16:11:20.865804 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:20.866194 [debug] [MainThread]: On master: COMMIT
[0m16:11:20.867355 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:11:20.867888 [debug] [MainThread]: On master: Close
[0m16:11:20.868488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:20.868925 [info ] [MainThread]: 
[0m16:11:20.872122 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:11:20.872862 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m16:11:20.873415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m16:11:20.873876 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:11:20.882439 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:20.883293 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:11:20.927127 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:20.928107 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:20.928565 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m16:11:20.928972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:20.948211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m16:11:20.948888 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:20.949358 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m16:11:20.952101 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:11:20.959404 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:20.960053 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m16:11:20.962125 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:11:20.965474 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:20.965955 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m16:11:20.969118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:11:20.994125 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m16:11:20.994657 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:20.995134 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m16:11:20.998786 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:11:21.006400 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m16:11:21.027644 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:11:21.028176 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m16:11:21.031092 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:11:21.034061 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m16:11:21.036310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72685c24-42ab-4d23-9c94-8ec939d6e6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106801ac0>]}
[0m16:11:21.037167 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.16s]
[0m16:11:21.038568 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:11:21.039180 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:11:21.039799 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m16:11:21.040762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m16:11:21.041305 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:11:21.044240 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:11:21.045148 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:11:21.049546 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:11:21.050470 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:11:21.051168 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m16:11:21.051588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:21.069586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m16:11:21.070190 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:11:21.070664 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m16:11:21.073673 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:11:21.077081 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:11:21.077568 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m16:11:21.079242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:21.082670 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:11:21.083158 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m16:11:21.085765 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:11:21.087829 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m16:11:21.088383 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:11:21.088945 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m16:11:21.090851 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:11:21.093512 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m16:11:21.094393 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:11:21.094831 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m16:11:21.097224 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:11:21.099085 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m16:11:21.099747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72685c24-42ab-4d23-9c94-8ec939d6e6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085443e0>]}
[0m16:11:21.100445 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m16:11:21.101236 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:11:21.101806 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:11:21.102933 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m16:11:21.103549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m16:11:21.104155 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:11:21.107472 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:21.108464 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:11:21.112720 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:21.113605 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:21.114064 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m16:11:21.114484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:21.135155 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m16:11:21.135904 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:21.136511 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."deal_changes"
  );
[0m16:11:21.139503 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:11:21.142767 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:21.143228 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m16:11:21.144875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:21.148295 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:21.148916 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m16:11:21.150606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:21.153105 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m16:11:21.153599 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:21.154013 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m16:11:21.156167 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:11:21.160237 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m16:11:21.161097 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:11:21.161536 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m16:11:21.164042 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:11:21.165815 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m16:11:21.166443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72685c24-42ab-4d23-9c94-8ec939d6e6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108694bf0>]}
[0m16:11:21.167124 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m16:11:21.168016 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:11:21.168572 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:11:21.169346 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__fields ... [RUN]
[0m16:11:21.169922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__fields)
[0m16:11:21.170367 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:11:21.173031 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:21.173823 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:11:21.177648 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:21.178437 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:21.178873 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: BEGIN
[0m16:11:21.179287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:21.195882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:11:21.196532 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:21.197001 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m16:11:21.201500 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:11:21.207137 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:21.207903 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields" rename to "stg_pipedrive__fields__dbt_backup"
[0m16:11:21.209729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:21.213126 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:21.213797 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp" rename to "stg_pipedrive__fields"
[0m16:11:21.215635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:21.218213 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m16:11:21.218730 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:21.219164 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m16:11:21.221300 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:11:21.223937 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup"
[0m16:11:21.224835 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:11:21.225686 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup" cascade
[0m16:11:21.229143 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:11:21.231068 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: Close
[0m16:11:21.232146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72685c24-42ab-4d23-9c94-8ec939d6e6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086943e0>]}
[0m16:11:21.233375 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields  [[32mCREATE VIEW[0m in 0.06s]
[0m16:11:21.234530 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:11:21.235617 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:11:21.236409 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m16:11:21.237083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m16:11:21.237567 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:11:21.240570 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:21.242056 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:11:21.245893 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:21.246882 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:21.247391 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m16:11:21.247802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:21.288984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m16:11:21.289874 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:21.290663 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."stages"
  );
[0m16:11:21.295336 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:11:21.299980 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:21.300473 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m16:11:21.302329 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:21.305635 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:21.306131 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m16:11:21.307966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:21.309944 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m16:11:21.310375 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:21.310789 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m16:11:21.312980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:11:21.315762 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m16:11:21.316615 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:11:21.317046 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m16:11:21.319790 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:11:21.321343 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m16:11:21.321955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72685c24-42ab-4d23-9c94-8ec939d6e6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108544680>]}
[0m16:11:21.322638 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.08s]
[0m16:11:21.323357 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:11:21.323865 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m16:11:21.324456 [info ] [Thread-1 (]: 6 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m16:11:21.325207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m16:11:21.325672 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m16:11:21.328587 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:21.329376 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m16:11:21.335097 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:21.335960 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:21.336383 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m16:11:21.336777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:21.355376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m16:11:21.356027 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:21.356493 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m16:11:21.358913 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:11:21.362148 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:21.362618 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m16:11:21.364406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:21.367803 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:21.368263 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m16:11:21.369893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:21.371754 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m16:11:21.372222 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:21.372635 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m16:11:21.374642 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:11:21.377292 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m16:11:21.378132 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:11:21.378657 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m16:11:21.381154 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:11:21.382703 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m16:11:21.383283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72685c24-42ab-4d23-9c94-8ec939d6e6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086add90>]}
[0m16:11:21.384001 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m16:11:21.384721 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m16:11:21.386377 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:21.386824 [debug] [MainThread]: On master: BEGIN
[0m16:11:21.387173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:21.404548 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m16:11:21.405264 [debug] [MainThread]: On master: COMMIT
[0m16:11:21.405665 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:21.406017 [debug] [MainThread]: On master: COMMIT
[0m16:11:21.407844 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:11:21.408412 [debug] [MainThread]: On master: Close
[0m16:11:21.408959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:21.409427 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__users' was properly closed.
[0m16:11:21.409909 [info ] [MainThread]: 
[0m16:11:21.410329 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m16:11:21.412280 [debug] [MainThread]: Command end result
[0m16:11:21.450414 [info ] [MainThread]: 
[0m16:11:21.451014 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:21.451566 [info ] [MainThread]: 
[0m16:11:21.452112 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:11:21.454559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9111396, "process_in_blocks": "0", "process_kernel_time": 0.367258, "process_mem_max_rss": "112443392", "process_out_blocks": "0", "process_user_time": 2.817008}
[0m16:11:21.455308 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:21.455168 after 1.91 seconds
[0m16:11:21.455788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10355ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce08c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072121e0>]}
[0m16:11:21.456233 [debug] [MainThread]: Flushing usage events
[0m16:11:27.652191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11095b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110afb170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110afac60>]}


============================== 16:11:27.657375 | 010eb3bf-7e51-47c2-82a3-1d25f2440428 ==============================
[0m16:11:27.657375 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:11:27.658053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:11:27.913832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '010eb3bf-7e51-47c2-82a3-1d25f2440428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9959d0>]}
[0m16:11:27.982704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '010eb3bf-7e51-47c2-82a3-1d25f2440428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110beb9b0>]}
[0m16:11:27.983668 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:11:28.113769 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:11:28.256109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:28.256573 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:28.308536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '010eb3bf-7e51-47c2-82a3-1d25f2440428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110c8620>]}
[0m16:11:28.440724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '010eb3bf-7e51-47c2-82a3-1d25f2440428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b15df0>]}
[0m16:11:28.441346 [info ] [MainThread]: Found 6 models, 6 data tests, 6 sources, 428 macros
[0m16:11:28.441775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '010eb3bf-7e51-47c2-82a3-1d25f2440428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117cf2c0>]}
[0m16:11:28.444232 [info ] [MainThread]: 
[0m16:11:28.444891 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:28.449457 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m16:11:28.517373 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:11:28.517844 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m16:11:28.518208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:28.547338 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m16:11:28.547980 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:11:28.548460 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m16:11:28.552443 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m16:11:28.554142 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m16:11:28.555424 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m16:11:28.562117 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:28.562573 [debug] [MainThread]: On master: BEGIN
[0m16:11:28.562926 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:28.579549 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m16:11:28.580185 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:28.580660 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:11:28.585429 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m16:11:28.587051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '010eb3bf-7e51-47c2-82a3-1d25f2440428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110be9f70>]}
[0m16:11:28.587559 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:28.588869 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:28.589384 [debug] [MainThread]: On master: BEGIN
[0m16:11:28.591317 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:11:28.591885 [debug] [MainThread]: On master: COMMIT
[0m16:11:28.592355 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:28.592710 [debug] [MainThread]: On master: COMMIT
[0m16:11:28.593977 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:11:28.594421 [debug] [MainThread]: On master: Close
[0m16:11:28.594977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:28.595445 [info ] [MainThread]: 
[0m16:11:28.597909 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m16:11:28.598504 [info ] [Thread-1 (]: 1 of 6 START test not_null_stg_pipedrive__activity_deal_id ..................... [RUN]
[0m16:11:28.599066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m16:11:28.599498 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m16:11:28.621159 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m16:11:28.622147 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m16:11:28.638744 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m16:11:28.639677 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m16:11:28.640116 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m16:11:28.640601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:28.656100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:11:28.656725 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m16:11:28.657241 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m16:11:28.659602 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:11:28.664219 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m16:11:28.666645 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m16:11:28.667456 [info ] [Thread-1 (]: 1 of 6 PASS not_null_stg_pipedrive__activity_deal_id ........................... [[32mPASS[0m in 0.07s]
[0m16:11:28.668354 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m16:11:28.669085 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m16:11:28.669724 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_pipedrive__activity_due_date .................... [RUN]
[0m16:11:28.670529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5)
[0m16:11:28.671017 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m16:11:28.675462 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m16:11:28.676316 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m16:11:28.678763 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m16:11:28.679629 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m16:11:28.680083 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: BEGIN
[0m16:11:28.680484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:28.697554 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:11:28.698258 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m16:11:28.698733 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_date is null



      
    ) dbt_internal_test
[0m16:11:28.702630 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:11:28.704757 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: ROLLBACK
[0m16:11:28.706169 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: Close
[0m16:11:28.706958 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_pipedrive__activity_due_date .......................... [[32mPASS[0m in 0.04s]
[0m16:11:28.707776 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m16:11:28.708356 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m16:11:28.708878 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_pipedrive__activity_id .......................... [RUN]
[0m16:11:28.709776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m16:11:28.710242 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m16:11:28.714393 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m16:11:28.715230 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m16:11:28.717483 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m16:11:28.718929 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m16:11:28.719370 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m16:11:28.719772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:28.739542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m16:11:28.740878 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m16:11:28.741576 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m16:11:28.744483 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:11:28.746238 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m16:11:28.747744 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m16:11:28.748525 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_pipedrive__activity_id ................................ [[32mPASS[0m in 0.04s]
[0m16:11:28.749463 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m16:11:28.750078 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m16:11:28.750615 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_pipedrive__activity_is_done ..................... [RUN]
[0m16:11:28.751488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m16:11:28.752196 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m16:11:28.757308 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m16:11:28.758285 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m16:11:28.760766 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m16:11:28.761716 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m16:11:28.762182 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m16:11:28.762588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:28.782824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m16:11:28.783519 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m16:11:28.783995 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m16:11:28.786501 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:11:28.788308 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m16:11:28.789681 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m16:11:28.790541 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_pipedrive__activity_is_done ........................... [[32mPASS[0m in 0.04s]
[0m16:11:28.791359 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m16:11:28.791884 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m16:11:28.792445 [info ] [Thread-1 (]: 5 of 6 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m16:11:28.793029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m16:11:28.793496 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m16:11:28.805007 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m16:11:28.805881 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m16:11:28.808900 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m16:11:28.809821 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m16:11:28.810277 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m16:11:28.810687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:28.825455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:11:28.826110 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m16:11:28.826630 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:11:28.831321 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:11:28.833170 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m16:11:28.834845 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m16:11:28.835788 [info ] [Thread-1 (]: 5 of 6 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m16:11:28.836634 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m16:11:28.837169 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m16:11:28.837667 [info ] [Thread-1 (]: 6 of 6 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m16:11:28.838394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m16:11:28.838868 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m16:11:28.844940 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m16:11:28.845811 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m16:11:28.848150 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m16:11:28.849057 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m16:11:28.849516 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m16:11:28.850202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:28.868974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m16:11:28.869553 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m16:11:28.870034 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:11:28.873799 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:11:28.875583 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m16:11:28.876970 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m16:11:28.877753 [info ] [Thread-1 (]: 6 of 6 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m16:11:28.878550 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m16:11:28.879916 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:28.880351 [debug] [MainThread]: On master: BEGIN
[0m16:11:28.880714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:28.895766 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:11:28.896462 [debug] [MainThread]: On master: COMMIT
[0m16:11:28.897003 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:28.897521 [debug] [MainThread]: On master: COMMIT
[0m16:11:28.898922 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:11:28.899485 [debug] [MainThread]: On master: Close
[0m16:11:28.900136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:28.900813 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m16:11:28.901246 [info ] [MainThread]: 
[0m16:11:28.901676 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m16:11:28.903631 [debug] [MainThread]: Command end result
[0m16:11:28.934990 [info ] [MainThread]: 
[0m16:11:28.935724 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:28.936142 [info ] [MainThread]: 
[0m16:11:28.936569 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:11:28.938378 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3739007, "process_in_blocks": "0", "process_kernel_time": 0.366826, "process_mem_max_rss": "110804992", "process_out_blocks": "0", "process_user_time": 2.4403}
[0m16:11:28.939260 [debug] [MainThread]: Command `dbt test` succeeded at 16:11:28.939104 after 1.37 seconds
[0m16:11:28.939767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce16d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f7dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110afb170>]}
[0m16:11:28.940202 [debug] [MainThread]: Flushing usage events
[0m16:23:31.465068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ec3fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c07350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c06e70>]}


============================== 16:23:31.473142 | d72d1912-f835-491b-9ee5-1b1231fe872b ==============================
[0m16:23:31.473142 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:23:31.474148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:23:31.743314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd72d1912-f835-491b-9ee5-1b1231fe872b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa5ac0>]}
[0m16:23:31.809398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd72d1912-f835-491b-9ee5-1b1231fe872b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105144560>]}
[0m16:23:31.810491 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:23:31.955305 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:23:32.121803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:23:32.122587 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/schema.yml
[0m16:23:32.123103 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__deal_changes.sql
[0m16:23:32.387044 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:23:32.387617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd72d1912-f835-491b-9ee5-1b1231fe872b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050cafc0>]}
[0m16:23:32.600204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd72d1912-f835-491b-9ee5-1b1231fe872b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fcfb0>]}
[0m16:23:32.727045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd72d1912-f835-491b-9ee5-1b1231fe872b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf9520>]}
[0m16:23:32.727637 [info ] [MainThread]: Found 6 models, 10 data tests, 6 sources, 428 macros
[0m16:23:32.728076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd72d1912-f835-491b-9ee5-1b1231fe872b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b8980>]}
[0m16:23:32.730942 [info ] [MainThread]: 
[0m16:23:32.731964 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:23:32.738648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:23:32.814754 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:23:32.815420 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:23:32.815950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:32.873812 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.058 seconds
[0m16:23:32.875526 [debug] [ThreadPool]: On list_postgres: Close
[0m16:23:32.877353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m16:23:32.884025 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:23:32.884478 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m16:23:32.884822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:23:32.900477 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m16:23:32.901091 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:23:32.901524 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m16:23:32.905394 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m16:23:32.907016 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m16:23:32.908498 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m16:23:32.914943 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:32.915402 [debug] [MainThread]: On master: BEGIN
[0m16:23:32.915739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:32.931360 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m16:23:32.931899 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:32.932447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:23:32.937194 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m16:23:32.938754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd72d1912-f835-491b-9ee5-1b1231fe872b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c45f70>]}
[0m16:23:32.939249 [debug] [MainThread]: On master: ROLLBACK
[0m16:23:32.940464 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:32.940860 [debug] [MainThread]: On master: BEGIN
[0m16:23:32.943385 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:23:32.944217 [debug] [MainThread]: On master: COMMIT
[0m16:23:32.944881 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:32.945396 [debug] [MainThread]: On master: COMMIT
[0m16:23:32.946820 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:23:32.947332 [debug] [MainThread]: On master: Close
[0m16:23:32.947940 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:23:32.948523 [info ] [MainThread]: 
[0m16:23:32.952561 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:23:32.953263 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m16:23:32.953962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m16:23:32.954415 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:23:32.965704 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:23:32.966719 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:23:33.008372 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:23:33.009406 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:23:33.009853 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m16:23:33.010249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:33.026234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:23:33.026834 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:23:33.027325 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m16:23:33.030025 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:23:33.036988 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:23:33.037492 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m16:23:33.039285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:33.042718 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:23:33.043201 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m16:23:33.044965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:33.064739 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m16:23:33.065258 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:23:33.065676 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m16:23:33.069239 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:23:33.076254 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m16:23:33.082038 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:23:33.082519 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m16:23:33.085420 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:23:33.088197 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m16:23:33.089816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd72d1912-f835-491b-9ee5-1b1231fe872b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b1d00>]}
[0m16:23:33.090583 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.13s]
[0m16:23:33.091697 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:23:33.092360 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:23:33.092936 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m16:23:33.093495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m16:23:33.094019 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:23:33.096931 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:23:33.097742 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:23:33.102157 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:23:33.103157 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:23:33.103594 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m16:23:33.103999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:33.124449 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m16:23:33.125293 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:23:33.125805 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m16:23:33.128637 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:23:33.131989 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:23:33.132457 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m16:23:33.134073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:33.137438 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:23:33.137919 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m16:23:33.139459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:33.141353 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m16:23:33.141825 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:23:33.142239 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m16:23:33.144356 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:23:33.147034 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m16:23:33.147880 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:23:33.148308 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m16:23:33.151168 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:23:33.152802 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m16:23:33.153406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd72d1912-f835-491b-9ee5-1b1231fe872b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715fda0>]}
[0m16:23:33.154169 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m16:23:33.154914 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:23:33.155449 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:23:33.156202 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m16:23:33.156785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m16:23:33.157232 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:23:33.160162 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:23:33.160990 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:23:33.166312 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:23:33.167182 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:23:33.167616 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m16:23:33.168013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:33.185196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:23:33.185819 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:23:33.186295 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m16:23:33.190849 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:23:33.194179 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:23:33.194647 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m16:23:33.196409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:33.199826 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:23:33.200307 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m16:23:33.201844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:33.203847 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m16:23:33.204342 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:23:33.204756 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m16:23:33.206547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:23:33.209251 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m16:23:33.210229 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:23:33.210675 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m16:23:33.213019 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:23:33.214636 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m16:23:33.215358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd72d1912-f835-491b-9ee5-1b1231fe872b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716b4a0>]}
[0m16:23:33.216199 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m16:23:33.217234 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:23:33.217852 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:23:33.218573 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__fields ... [RUN]
[0m16:23:33.219165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__fields)
[0m16:23:33.219689 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:23:33.222806 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:23:33.225803 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:23:33.231225 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:23:33.232232 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:23:33.232648 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: BEGIN
[0m16:23:33.233064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:33.253903 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m16:23:33.254731 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:23:33.255189 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m16:23:33.257872 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:23:33.261224 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:23:33.261666 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields" rename to "stg_pipedrive__fields__dbt_backup"
[0m16:23:33.263211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:33.266384 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:23:33.266861 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp" rename to "stg_pipedrive__fields"
[0m16:23:33.268463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:33.270612 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m16:23:33.271113 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:23:33.271551 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m16:23:33.273681 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:23:33.276576 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup"
[0m16:23:33.277446 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:23:33.277876 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup" cascade
[0m16:23:33.280237 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:23:33.281836 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: Close
[0m16:23:33.282434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd72d1912-f835-491b-9ee5-1b1231fe872b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0b020>]}
[0m16:23:33.283108 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields  [[32mCREATE VIEW[0m in 0.06s]
[0m16:23:33.283828 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:23:33.284333 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:23:33.284983 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m16:23:33.285552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m16:23:33.285992 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:23:33.288762 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:23:33.289546 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:23:33.293775 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:23:33.294666 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:23:33.295136 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m16:23:33.295520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:33.313479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m16:23:33.314181 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:23:33.314647 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."stages"
  );
[0m16:23:33.317161 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:23:33.320637 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:23:33.321100 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m16:23:33.322822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:33.328392 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:23:33.328898 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m16:23:33.330617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:33.332568 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m16:23:33.333048 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:23:33.333471 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m16:23:33.335463 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:23:33.338080 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m16:23:33.338939 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:23:33.339378 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m16:23:33.342247 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:23:33.343819 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m16:23:33.344444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd72d1912-f835-491b-9ee5-1b1231fe872b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719bbc0>]}
[0m16:23:33.345163 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m16:23:33.345889 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:23:33.346557 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m16:23:33.347361 [info ] [Thread-1 (]: 6 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m16:23:33.348015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m16:23:33.348454 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m16:23:33.351281 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:23:33.352085 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m16:23:33.355938 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:23:33.356965 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:23:33.357420 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m16:23:33.357838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:33.377683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m16:23:33.378514 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:23:33.379038 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m16:23:33.381606 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:23:33.384974 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:23:33.385465 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m16:23:33.387187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:23:33.390892 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:23:33.391512 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m16:23:33.393795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:23:33.396095 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m16:23:33.396587 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:23:33.397140 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m16:23:33.399220 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:23:33.402300 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m16:23:33.403435 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:23:33.403913 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m16:23:33.407466 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:23:33.410123 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m16:23:33.411085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd72d1912-f835-491b-9ee5-1b1231fe872b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107056330>]}
[0m16:23:33.411917 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m16:23:33.412838 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m16:23:33.414407 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:33.414841 [debug] [MainThread]: On master: BEGIN
[0m16:23:33.415227 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:23:33.433800 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m16:23:33.434421 [debug] [MainThread]: On master: COMMIT
[0m16:23:33.434835 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:33.435190 [debug] [MainThread]: On master: COMMIT
[0m16:23:33.436423 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:23:33.436859 [debug] [MainThread]: On master: Close
[0m16:23:33.437430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:33.437790 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__users' was properly closed.
[0m16:23:33.438246 [info ] [MainThread]: 
[0m16:23:33.438673 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m16:23:33.440491 [debug] [MainThread]: Command end result
[0m16:23:33.475150 [info ] [MainThread]: 
[0m16:23:33.475898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:23:33.476342 [info ] [MainThread]: 
[0m16:23:33.476767 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:23:33.479044 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.138224, "process_in_blocks": "0", "process_kernel_time": 0.517757, "process_mem_max_rss": "114290688", "process_out_blocks": "0", "process_user_time": 3.175885}
[0m16:23:33.479835 [debug] [MainThread]: Command `dbt run` succeeded at 16:23:33.479682 after 2.14 seconds
[0m16:23:33.480334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c044a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c06e70>]}
[0m16:23:33.480769 [debug] [MainThread]: Flushing usage events
[0m16:23:44.898600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109590bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ceed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ce9f0>]}


============================== 16:23:44.906910 | 2816b973-122d-4245-8694-10b96a7fed5f ==============================
[0m16:23:44.906910 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:23:44.909018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:23:45.137914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2816b973-122d-4245-8694-10b96a7fed5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c1e3c0>]}
[0m16:23:45.204270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2816b973-122d-4245-8694-10b96a7fed5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a38c0>]}
[0m16:23:45.205216 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:23:45.338267 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:23:45.479388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:23:45.479851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:23:45.532318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2816b973-122d-4245-8694-10b96a7fed5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c9ea50>]}
[0m16:23:45.669805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2816b973-122d-4245-8694-10b96a7fed5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6eeb10>]}
[0m16:23:45.670361 [info ] [MainThread]: Found 6 models, 10 data tests, 6 sources, 428 macros
[0m16:23:45.670777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2816b973-122d-4245-8694-10b96a7fed5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cafc80>]}
[0m16:23:45.673656 [info ] [MainThread]: 
[0m16:23:45.674451 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:23:45.681716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m16:23:45.750885 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:23:45.751390 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m16:23:45.751789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:45.782445 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m16:23:45.783241 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:23:45.783997 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m16:23:45.788681 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m16:23:45.790402 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m16:23:45.791949 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m16:23:45.798700 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:45.799147 [debug] [MainThread]: On master: BEGIN
[0m16:23:45.799486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:45.816824 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m16:23:45.817486 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:45.817992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:23:45.822753 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m16:23:45.824367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2816b973-122d-4245-8694-10b96a7fed5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fda900>]}
[0m16:23:45.824982 [debug] [MainThread]: On master: ROLLBACK
[0m16:23:45.827085 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:45.827556 [debug] [MainThread]: On master: BEGIN
[0m16:23:45.829905 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:23:45.830656 [debug] [MainThread]: On master: COMMIT
[0m16:23:45.831093 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:45.831571 [debug] [MainThread]: On master: COMMIT
[0m16:23:45.833279 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:23:45.833814 [debug] [MainThread]: On master: Close
[0m16:23:45.834520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:23:45.835311 [info ] [MainThread]: 
[0m16:23:45.837911 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m16:23:45.838479 [info ] [Thread-1 (]: 1 of 10 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m16:23:45.839050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m16:23:45.839489 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m16:23:45.861785 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m16:23:45.863059 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m16:23:45.880435 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m16:23:45.881371 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m16:23:45.881818 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m16:23:45.882217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:45.899480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:23:45.900055 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m16:23:45.900533 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m16:23:45.902958 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:23:45.907750 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m16:23:45.909734 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m16:23:45.910598 [info ] [Thread-1 (]: 1 of 10 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.07s]
[0m16:23:45.911415 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m16:23:45.912036 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m16:23:45.912669 [info ] [Thread-1 (]: 2 of 10 START test not_null_stg_pipedrive__activity_due_date ................... [RUN]
[0m16:23:45.913409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5)
[0m16:23:45.913883 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m16:23:45.918439 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m16:23:45.919285 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m16:23:45.921649 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m16:23:45.922432 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m16:23:45.922906 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: BEGIN
[0m16:23:45.923309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:45.944520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m16:23:45.945110 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m16:23:45.945562 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_date is null



      
    ) dbt_internal_test
[0m16:23:45.948056 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:23:45.949787 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: ROLLBACK
[0m16:23:45.951209 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: Close
[0m16:23:45.952067 [info ] [Thread-1 (]: 2 of 10 PASS not_null_stg_pipedrive__activity_due_date ......................... [[32mPASS[0m in 0.04s]
[0m16:23:45.953239 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m16:23:45.953865 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m16:23:45.954447 [info ] [Thread-1 (]: 3 of 10 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m16:23:45.955096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m16:23:45.955632 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m16:23:45.962406 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m16:23:45.963311 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m16:23:45.966917 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m16:23:45.967865 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m16:23:45.968325 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m16:23:45.968727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:45.988215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m16:23:45.988836 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m16:23:45.989330 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m16:23:45.993123 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:23:45.995032 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m16:23:45.996432 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m16:23:45.997246 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m16:23:45.998052 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m16:23:45.998600 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m16:23:45.999079 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m16:23:45.999820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m16:23:46.000301 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m16:23:46.004910 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m16:23:46.005830 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m16:23:46.008948 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m16:23:46.009933 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m16:23:46.010393 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m16:23:46.010814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:46.026868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:23:46.027541 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m16:23:46.028032 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m16:23:46.030226 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:23:46.031943 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m16:23:46.033184 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m16:23:46.033934 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.03s]
[0m16:23:46.034723 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m16:23:46.035240 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m16:23:46.035752 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m16:23:46.036411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m16:23:46.036868 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m16:23:46.041160 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m16:23:46.042133 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m16:23:46.044565 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m16:23:46.045353 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m16:23:46.045801 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m16:23:46.046205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:46.063010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:23:46.063742 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m16:23:46.064230 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m16:23:46.067176 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:23:46.068875 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m16:23:46.070048 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m16:23:46.070766 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.03s]
[0m16:23:46.071523 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m16:23:46.072051 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269
[0m16:23:46.072545 [info ] [Thread-1 (]: 6 of 10 START test not_null_stg_pipedrive__deal_changes_changed_field_key ...... [RUN]
[0m16:23:46.073097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269)
[0m16:23:46.073559 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269
[0m16:23:46.078109 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269"
[0m16:23:46.078963 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269
[0m16:23:46.081332 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269"
[0m16:23:46.082156 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269"
[0m16:23:46.082602 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269: BEGIN
[0m16:23:46.083100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:46.099077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:23:46.099768 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269"
[0m16:23:46.100249 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select changed_field_key
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where changed_field_key is null



      
    ) dbt_internal_test
[0m16:23:46.102933 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:23:46.104753 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269: ROLLBACK
[0m16:23:46.106007 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269: Close
[0m16:23:46.106785 [info ] [Thread-1 (]: 6 of 10 PASS not_null_stg_pipedrive__deal_changes_changed_field_key ............ [[32mPASS[0m in 0.03s]
[0m16:23:46.107656 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269
[0m16:23:46.108387 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m16:23:46.108991 [info ] [Thread-1 (]: 7 of 10 START test not_null_stg_pipedrive__deal_changes_id ..................... [RUN]
[0m16:23:46.109583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m16:23:46.110037 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m16:23:46.114354 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m16:23:46.115205 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m16:23:46.117585 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m16:23:46.118422 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m16:23:46.118915 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m16:23:46.119366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:46.136426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:23:46.136990 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m16:23:46.137507 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m16:23:46.141337 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:23:46.143210 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m16:23:46.144586 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m16:23:46.145470 [info ] [Thread-1 (]: 7 of 10 PASS not_null_stg_pipedrive__deal_changes_id ........................... [[32mPASS[0m in 0.04s]
[0m16:23:46.146367 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m16:23:46.146877 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m16:23:46.147360 [info ] [Thread-1 (]: 8 of 10 START test not_null_stg_pipedrive__deal_changes_new_value .............. [RUN]
[0m16:23:46.148048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m16:23:46.148549 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m16:23:46.153074 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m16:23:46.153946 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m16:23:46.156779 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m16:23:46.157962 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m16:23:46.158552 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m16:23:46.159092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:46.175340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:23:46.175971 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m16:23:46.176610 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m16:23:46.180444 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:23:46.182171 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m16:23:46.183441 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m16:23:46.184185 [info ] [Thread-1 (]: 8 of 10 PASS not_null_stg_pipedrive__deal_changes_new_value .................... [[32mPASS[0m in 0.04s]
[0m16:23:46.184924 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m16:23:46.185544 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m16:23:46.186045 [info ] [Thread-1 (]: 9 of 10 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m16:23:46.186830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m16:23:46.187308 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m16:23:46.197536 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m16:23:46.198435 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m16:23:46.202507 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m16:23:46.203414 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m16:23:46.203936 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m16:23:46.204356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:46.222754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m16:23:46.223499 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m16:23:46.224022 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:23:46.228242 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:23:46.230220 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m16:23:46.231732 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m16:23:46.232551 [info ] [Thread-1 (]: 9 of 10 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.05s]
[0m16:23:46.233480 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m16:23:46.234042 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m16:23:46.234637 [info ] [Thread-1 (]: 10 of 10 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m16:23:46.235445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m16:23:46.236003 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m16:23:46.242447 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m16:23:46.243278 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m16:23:46.245848 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m16:23:46.246691 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m16:23:46.247328 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m16:23:46.247795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:46.269926 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m16:23:46.270721 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m16:23:46.271299 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:23:46.275734 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:23:46.277689 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m16:23:46.279383 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m16:23:46.280319 [info ] [Thread-1 (]: 10 of 10 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m16:23:46.281168 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m16:23:46.282677 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:46.283212 [debug] [MainThread]: On master: BEGIN
[0m16:23:46.283833 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:23:46.300238 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m16:23:46.300741 [debug] [MainThread]: On master: COMMIT
[0m16:23:46.301211 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:46.301649 [debug] [MainThread]: On master: COMMIT
[0m16:23:46.303677 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:23:46.304129 [debug] [MainThread]: On master: Close
[0m16:23:46.304623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:46.304972 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m16:23:46.305370 [info ] [MainThread]: 
[0m16:23:46.305787 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m16:23:46.308493 [debug] [MainThread]: Command end result
[0m16:23:46.344057 [info ] [MainThread]: 
[0m16:23:46.344728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:23:46.345243 [info ] [MainThread]: 
[0m16:23:46.345685 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:23:46.347523 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5418473, "process_in_blocks": "0", "process_kernel_time": 0.404442, "process_mem_max_rss": "110317568", "process_out_blocks": "0", "process_user_time": 2.617287}
[0m16:23:46.348523 [debug] [MainThread]: Command `dbt test` succeeded at 16:23:46.348344 after 1.54 seconds
[0m16:23:46.349104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5a29f0>]}
[0m16:23:46.349556 [debug] [MainThread]: Flushing usage events
[0m16:59:28.613745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e2c00>]}


============================== 16:59:28.620927 | cefc9421-3810-41fd-9a91-73ac03f1242c ==============================
[0m16:59:28.620927 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:59:28.621853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:28.906089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cefc9421-3810-41fd-9a91-73ac03f1242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ce630>]}
[0m16:59:28.972384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cefc9421-3810-41fd-9a91-73ac03f1242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a3c80>]}
[0m16:59:28.973595 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:59:29.121284 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:59:29.289245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:59:29.290010 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__stages.sql
[0m16:59:29.580916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cefc9421-3810-41fd-9a91-73ac03f1242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098503e0>]}
[0m16:59:29.711617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cefc9421-3810-41fd-9a91-73ac03f1242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109803950>]}
[0m16:59:29.712210 [info ] [MainThread]: Found 6 models, 10 data tests, 6 sources, 428 macros
[0m16:59:29.712654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cefc9421-3810-41fd-9a91-73ac03f1242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed4da0>]}
[0m16:59:29.715267 [info ] [MainThread]: 
[0m16:59:29.715947 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:59:29.721657 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:59:29.793491 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:59:29.794006 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:59:29.794400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:29.859788 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.065 seconds
[0m16:59:29.861531 [debug] [ThreadPool]: On list_postgres: Close
[0m16:59:29.863317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m16:59:29.870199 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:59:29.870670 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m16:59:29.871046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:29.887205 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m16:59:29.887918 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m16:59:29.888576 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m16:59:29.892716 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m16:59:29.894328 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m16:59:29.895517 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m16:59:29.901745 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:29.902192 [debug] [MainThread]: On master: BEGIN
[0m16:59:29.902526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:29.918186 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m16:59:29.918845 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:29.919345 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:59:29.924498 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m16:59:29.926097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cefc9421-3810-41fd-9a91-73ac03f1242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af83e0>]}
[0m16:59:29.926596 [debug] [MainThread]: On master: ROLLBACK
[0m16:59:29.927824 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:29.928240 [debug] [MainThread]: On master: BEGIN
[0m16:59:29.930002 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:59:29.930556 [debug] [MainThread]: On master: COMMIT
[0m16:59:29.930975 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:29.931324 [debug] [MainThread]: On master: COMMIT
[0m16:59:29.932575 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:59:29.932991 [debug] [MainThread]: On master: Close
[0m16:59:29.933522 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:29.933929 [info ] [MainThread]: 
[0m16:59:29.936872 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:59:29.937801 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m16:59:29.938504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m16:59:29.939146 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:59:29.949640 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:59:29.950555 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:59:29.995670 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:59:29.996761 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:59:29.997226 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m16:59:29.997634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:30.019712 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m16:59:30.020363 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:59:30.020966 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m16:59:30.024625 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:59:30.031507 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:59:30.032015 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m16:59:30.033628 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:30.038294 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:59:30.038957 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m16:59:30.040758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:30.059357 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m16:59:30.059864 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:59:30.060267 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m16:59:30.064018 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:59:30.071163 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m16:59:30.077176 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m16:59:30.077761 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m16:59:30.080727 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:59:30.083484 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m16:59:30.085136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefc9421-3810-41fd-9a91-73ac03f1242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071916d0>]}
[0m16:59:30.085914 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.15s]
[0m16:59:30.086964 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m16:59:30.087519 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:59:30.088075 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m16:59:30.088931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m16:59:30.089388 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:59:30.092225 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:59:30.093369 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:59:30.097776 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:59:30.098664 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:59:30.099167 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m16:59:30.100672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:30.117701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:59:30.118327 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:59:30.118781 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m16:59:30.122944 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:59:30.126664 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:59:30.127184 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m16:59:30.128715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:30.131924 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:59:30.132379 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m16:59:30.133894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:30.135794 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m16:59:30.136262 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:59:30.136774 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m16:59:30.139955 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:59:30.142625 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m16:59:30.143439 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m16:59:30.143859 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m16:59:30.146196 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:59:30.147787 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m16:59:30.148382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefc9421-3810-41fd-9a91-73ac03f1242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c08d10>]}
[0m16:59:30.149121 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m16:59:30.149913 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m16:59:30.150439 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:59:30.151117 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m16:59:30.151701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m16:59:30.152144 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:59:30.155011 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:59:30.155966 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:59:30.162249 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:59:30.163199 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:59:30.163661 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m16:59:30.164059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:30.181601 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:59:30.182223 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:59:30.182721 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m16:59:30.185382 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:59:30.188783 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:59:30.189279 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m16:59:30.191114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:30.194429 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:59:30.194881 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m16:59:30.196702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:30.200427 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m16:59:30.200934 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:59:30.201343 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m16:59:30.203426 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:59:30.206227 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m16:59:30.207076 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m16:59:30.207504 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m16:59:30.209890 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:59:30.211456 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m16:59:30.212042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefc9421-3810-41fd-9a91-73ac03f1242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d40320>]}
[0m16:59:30.212774 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m16:59:30.213700 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m16:59:30.214242 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:59:30.215022 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__fields ... [RUN]
[0m16:59:30.215575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__fields)
[0m16:59:30.216010 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:59:30.218766 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:59:30.220123 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:59:30.226449 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:59:30.227320 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:59:30.227750 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: BEGIN
[0m16:59:30.228148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:30.245525 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:59:30.246197 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:59:30.246738 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m16:59:30.249332 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:59:30.252792 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:59:30.253255 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields" rename to "stg_pipedrive__fields__dbt_backup"
[0m16:59:30.255188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:30.258578 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:59:30.259055 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp" rename to "stg_pipedrive__fields"
[0m16:59:30.260562 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:30.262536 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m16:59:30.263016 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:59:30.263625 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m16:59:30.265583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:59:30.268214 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup"
[0m16:59:30.269023 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m16:59:30.269448 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup" cascade
[0m16:59:30.272408 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:59:30.274051 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: Close
[0m16:59:30.274641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefc9421-3810-41fd-9a91-73ac03f1242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c06a20>]}
[0m16:59:30.275325 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields  [[32mCREATE VIEW[0m in 0.06s]
[0m16:59:30.276089 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields
[0m16:59:30.276623 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:59:30.277307 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m16:59:30.277898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m16:59:30.278340 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:59:30.281139 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:59:30.282265 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:59:30.288872 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:59:30.289956 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:59:30.290523 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m16:59:30.290968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:30.308031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:59:30.308652 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m16:59:30.309110 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    SELECT
    stage_id AS id,
    name AS stage_name
FROM "postgres"."public"."stages"
  );
[0m16:59:30.311256 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "name" does not exist
LINE 9:     name AS stage_name
            ^

[0m16:59:30.312084 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: ROLLBACK
[0m16:59:30.313832 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m16:59:30.323665 [debug] [Thread-1 (]: Database Error in model stg_pipedrive__stages (models/staging/stg_pipedrive__stages.sql)
  column "name" does not exist
  LINE 9:     name AS stage_name
              ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__stages.sql
[0m16:59:30.324240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefc9421-3810-41fd-9a91-73ac03f1242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cf67e0>]}
[0m16:59:30.324911 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[31mERROR[0m in 0.05s]
[0m16:59:30.325640 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m16:59:30.326140 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m16:59:30.326768 [info ] [Thread-1 (]: 6 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m16:59:30.328128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m16:59:30.328585 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m16:59:30.331517 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:59:30.332288 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m16:59:30.336317 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:59:30.337242 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:59:30.337827 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m16:59:30.338416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:30.354410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:59:30.355128 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:59:30.355602 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m16:59:30.357926 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:59:30.361831 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:59:30.362346 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m16:59:30.363971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:30.368590 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:59:30.369089 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m16:59:30.370687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:30.372620 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m16:59:30.373069 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:59:30.373479 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m16:59:30.375159 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:59:30.377782 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m16:59:30.378627 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m16:59:30.379061 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m16:59:30.381278 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:59:30.382881 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m16:59:30.383497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefc9421-3810-41fd-9a91-73ac03f1242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db6510>]}
[0m16:59:30.384232 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m16:59:30.384995 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m16:59:30.386429 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:30.386885 [debug] [MainThread]: On master: BEGIN
[0m16:59:30.387239 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:59:30.402336 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:59:30.403046 [debug] [MainThread]: On master: COMMIT
[0m16:59:30.403626 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:30.404127 [debug] [MainThread]: On master: COMMIT
[0m16:59:30.406319 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:59:30.406966 [debug] [MainThread]: On master: Close
[0m16:59:30.407541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:30.407941 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__users' was properly closed.
[0m16:59:30.408493 [info ] [MainThread]: 
[0m16:59:30.408913 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m16:59:30.410784 [debug] [MainThread]: Command end result
[0m16:59:30.441799 [info ] [MainThread]: 
[0m16:59:30.442317 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:59:30.442700 [info ] [MainThread]: 
[0m16:59:30.443172 [error] [MainThread]:   Database Error in model stg_pipedrive__stages (models/staging/stg_pipedrive__stages.sql)
  column "name" does not exist
  LINE 9:     name AS stage_name
              ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__stages.sql
[0m16:59:30.443566 [info ] [MainThread]: 
[0m16:59:30.443979 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m16:59:30.446160 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9265605, "process_in_blocks": "0", "process_kernel_time": 0.529026, "process_mem_max_rss": "113082368", "process_out_blocks": "0", "process_user_time": 3.017589}
[0m16:59:30.446888 [debug] [MainThread]: Command `dbt run` failed at 16:59:30.446755 after 1.93 seconds
[0m16:59:30.447355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce0c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108357ec0>]}
[0m16:59:30.447766 [debug] [MainThread]: Flushing usage events
[0m17:00:03.201630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f30d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f46f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f46ef60>]}


============================== 17:00:03.209287 | 4c401db4-bfb1-41d3-9b61-b2245259f040 ==============================
[0m17:00:03.209287 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:00:03.210188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:00:03.476859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c401db4-bfb1-41d3-9b61-b2245259f040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f585610>]}
[0m17:00:03.541763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c401db4-bfb1-41d3-9b61-b2245259f040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f431eb0>]}
[0m17:00:03.543302 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:00:03.691938 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:00:03.862885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:00:03.863613 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__stages.sql
[0m17:00:04.151839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c401db4-bfb1-41d3-9b61-b2245259f040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f46c920>]}
[0m17:00:04.281804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c401db4-bfb1-41d3-9b61-b2245259f040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110383d70>]}
[0m17:00:04.282467 [info ] [MainThread]: Found 6 models, 10 data tests, 6 sources, 428 macros
[0m17:00:04.282993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c401db4-bfb1-41d3-9b61-b2245259f040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11029b5c0>]}
[0m17:00:04.285999 [info ] [MainThread]: 
[0m17:00:04.286777 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:00:04.291854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:00:04.368535 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:00:04.369019 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:00:04.369414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:04.423118 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.054 seconds
[0m17:00:04.424745 [debug] [ThreadPool]: On list_postgres: Close
[0m17:00:04.426456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m17:00:04.433033 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:00:04.433485 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m17:00:04.433850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:04.449267 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m17:00:04.449810 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:00:04.450234 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m17:00:04.454400 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m17:00:04.456078 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m17:00:04.457393 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m17:00:04.463400 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:04.463933 [debug] [MainThread]: On master: BEGIN
[0m17:00:04.464293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:04.480982 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m17:00:04.482160 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:04.482722 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:00:04.487803 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m17:00:04.489439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c401db4-bfb1-41d3-9b61-b2245259f040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11066c530>]}
[0m17:00:04.489943 [debug] [MainThread]: On master: ROLLBACK
[0m17:00:04.491277 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:04.491693 [debug] [MainThread]: On master: BEGIN
[0m17:00:04.493655 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m17:00:04.494353 [debug] [MainThread]: On master: COMMIT
[0m17:00:04.496221 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:04.497186 [debug] [MainThread]: On master: COMMIT
[0m17:00:04.499097 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:00:04.499576 [debug] [MainThread]: On master: Close
[0m17:00:04.500116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:00:04.500545 [info ] [MainThread]: 
[0m17:00:04.503420 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m17:00:04.504094 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m17:00:04.504652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m17:00:04.505123 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m17:00:04.513805 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:00:04.514777 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m17:00:04.556512 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:00:04.557441 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:00:04.557872 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m17:00:04.558271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:04.576836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:00:04.577443 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:00:04.577927 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m17:00:04.580612 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:00:04.587554 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:00:04.588052 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m17:00:04.590032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:04.594574 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:00:04.595175 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m17:00:04.596991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:04.615739 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m17:00:04.616254 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:00:04.616664 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m17:00:04.619237 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:00:04.626895 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m17:00:04.632729 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:00:04.633380 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m17:00:04.636287 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:00:04.639367 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m17:00:04.641128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c401db4-bfb1-41d3-9b61-b2245259f040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f457380>]}
[0m17:00:04.641923 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.14s]
[0m17:00:04.642866 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m17:00:04.643441 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m17:00:04.644115 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m17:00:04.644743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m17:00:04.645205 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m17:00:04.648226 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:00:04.649117 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m17:00:04.652986 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:00:04.653814 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:00:04.654256 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m17:00:04.654827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:04.674223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m17:00:04.674868 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:00:04.675392 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m17:00:04.678338 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:00:04.682148 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:00:04.682781 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m17:00:04.685446 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:00:04.690222 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:00:04.690814 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m17:00:04.692902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:04.695528 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m17:00:04.696075 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:00:04.696522 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m17:00:04.700420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:00:04.705141 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m17:00:04.706120 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:00:04.706604 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m17:00:04.709531 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:00:04.711306 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m17:00:04.712325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c401db4-bfb1-41d3-9b61-b2245259f040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11086c8f0>]}
[0m17:00:04.713579 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.07s]
[0m17:00:04.715345 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m17:00:04.716204 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m17:00:04.717346 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m17:00:04.718134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m17:00:04.718752 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m17:00:04.724335 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:00:04.725436 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m17:00:04.729566 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:00:04.730484 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:00:04.730940 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m17:00:04.731341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:04.752437 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m17:00:04.753239 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:00:04.753895 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m17:00:04.757500 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:00:04.761121 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:00:04.761717 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m17:00:04.764101 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:00:04.768314 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:00:04.768805 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m17:00:04.770733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:04.774464 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m17:00:04.774962 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:00:04.775453 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m17:00:04.777601 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:00:04.780222 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m17:00:04.781105 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:00:04.781697 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m17:00:04.784281 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:00:04.785842 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m17:00:04.786463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c401db4-bfb1-41d3-9b61-b2245259f040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108afb60>]}
[0m17:00:04.787170 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.07s]
[0m17:00:04.788133 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m17:00:04.788726 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields
[0m17:00:04.789612 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__fields ... [RUN]
[0m17:00:04.790661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__fields)
[0m17:00:04.791195 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields
[0m17:00:04.793855 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:00:04.794625 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields
[0m17:00:04.798735 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:00:04.799834 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:00:04.800420 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: BEGIN
[0m17:00:04.800959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:04.817273 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:00:04.817891 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:00:04.818356 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m17:00:04.820750 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:00:04.824955 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:00:04.825677 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields" rename to "stg_pipedrive__fields__dbt_backup"
[0m17:00:04.827665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:04.831054 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:00:04.831653 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp" rename to "stg_pipedrive__fields"
[0m17:00:04.833593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:04.835837 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m17:00:04.836352 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:00:04.836848 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m17:00:04.839118 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:00:04.841922 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup"
[0m17:00:04.842745 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:00:04.843172 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup" cascade
[0m17:00:04.845515 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:00:04.847100 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: Close
[0m17:00:04.847704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c401db4-bfb1-41d3-9b61-b2245259f040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089e030>]}
[0m17:00:04.848461 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields  [[32mCREATE VIEW[0m in 0.06s]
[0m17:00:04.849222 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields
[0m17:00:04.849730 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m17:00:04.850534 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m17:00:04.851080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m17:00:04.851517 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m17:00:04.854208 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:00:04.855048 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m17:00:04.859105 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:00:04.860002 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:00:04.860469 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m17:00:04.860879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:04.878324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:00:04.879056 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:00:04.879501 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m17:00:04.882056 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:00:04.885411 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:00:04.885859 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m17:00:04.887517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:04.890924 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:00:04.891457 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m17:00:04.892983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:04.894860 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m17:00:04.895297 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:00:04.895700 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m17:00:04.897619 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:00:04.900225 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m17:00:04.901096 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:00:04.901526 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m17:00:04.903826 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:00:04.905537 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m17:00:04.906181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c401db4-bfb1-41d3-9b61-b2245259f040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11087e2d0>]}
[0m17:00:04.906905 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m17:00:04.907660 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m17:00:04.908180 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m17:00:04.908951 [info ] [Thread-1 (]: 6 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m17:00:04.909508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m17:00:04.909952 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m17:00:04.914042 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:00:04.914889 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m17:00:04.918599 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:00:04.919384 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:00:04.919814 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m17:00:04.920204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:04.938416 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:00:04.954264 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:00:04.955534 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m17:00:04.960792 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:00:04.966617 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:00:04.967396 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m17:00:04.970193 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:00:04.975110 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:00:04.975681 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m17:00:04.977615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:04.979910 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m17:00:04.980519 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:00:04.981082 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m17:00:04.983629 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:00:04.986614 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m17:00:04.987480 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:00:04.987929 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m17:00:04.990926 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:00:04.992606 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m17:00:04.993217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c401db4-bfb1-41d3-9b61-b2245259f040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ca210>]}
[0m17:00:04.993920 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.08s]
[0m17:00:04.994656 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m17:00:04.996041 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:04.996461 [debug] [MainThread]: On master: BEGIN
[0m17:00:04.996839 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:05.012870 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m17:00:05.013371 [debug] [MainThread]: On master: COMMIT
[0m17:00:05.013795 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:05.014146 [debug] [MainThread]: On master: COMMIT
[0m17:00:05.015425 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:00:05.015868 [debug] [MainThread]: On master: Close
[0m17:00:05.016425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:05.016973 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__users' was properly closed.
[0m17:00:05.017473 [info ] [MainThread]: 
[0m17:00:05.017896 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m17:00:05.019762 [debug] [MainThread]: Command end result
[0m17:00:05.051812 [info ] [MainThread]: 
[0m17:00:05.052312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:00:05.052687 [info ] [MainThread]: 
[0m17:00:05.053173 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:00:05.055894 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9581735, "process_in_blocks": "0", "process_kernel_time": 0.508207, "process_mem_max_rss": "112025600", "process_out_blocks": "0", "process_user_time": 3.065198}
[0m17:00:05.056678 [debug] [MainThread]: Command `dbt run` succeeded at 17:00:05.056536 after 1.96 seconds
[0m17:00:05.057166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f46efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110114bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eee7c80>]}
[0m17:00:05.057745 [debug] [MainThread]: Flushing usage events
[0m17:00:11.146076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072501a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d92c30>]}


============================== 17:00:11.150974 | d23388bf-2cca-4dd3-b7f7-6980f0d30997 ==============================
[0m17:00:11.150974 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:00:11.151638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:00:11.386802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd23388bf-2cca-4dd3-b7f7-6980f0d30997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d92a80>]}
[0m17:00:11.452324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd23388bf-2cca-4dd3-b7f7-6980f0d30997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7cf20>]}
[0m17:00:11.453309 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:00:11.588098 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:00:11.726456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:00:11.726926 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:00:11.778836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd23388bf-2cca-4dd3-b7f7-6980f0d30997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e86780>]}
[0m17:00:11.910407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd23388bf-2cca-4dd3-b7f7-6980f0d30997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bc3800>]}
[0m17:00:11.910962 [info ] [MainThread]: Found 6 models, 10 data tests, 6 sources, 428 macros
[0m17:00:11.911379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd23388bf-2cca-4dd3-b7f7-6980f0d30997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109362e40>]}
[0m17:00:11.914016 [info ] [MainThread]: 
[0m17:00:11.914659 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:00:11.918979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m17:00:11.986822 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:00:11.987295 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m17:00:11.987657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:12.016387 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m17:00:12.017035 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:00:12.017493 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m17:00:12.021915 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m17:00:12.023618 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m17:00:12.024874 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m17:00:12.031373 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:12.031827 [debug] [MainThread]: On master: BEGIN
[0m17:00:12.032174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:12.047926 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m17:00:12.048470 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:12.049018 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:00:12.053733 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m17:00:12.055290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd23388bf-2cca-4dd3-b7f7-6980f0d30997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e02270>]}
[0m17:00:12.056148 [debug] [MainThread]: On master: ROLLBACK
[0m17:00:12.057690 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:12.058159 [debug] [MainThread]: On master: BEGIN
[0m17:00:12.060300 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m17:00:12.060922 [debug] [MainThread]: On master: COMMIT
[0m17:00:12.061336 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:12.061690 [debug] [MainThread]: On master: COMMIT
[0m17:00:12.062909 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:00:12.063339 [debug] [MainThread]: On master: Close
[0m17:00:12.063884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:00:12.064341 [info ] [MainThread]: 
[0m17:00:12.066900 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:00:12.067449 [info ] [Thread-1 (]: 1 of 10 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m17:00:12.068023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m17:00:12.068454 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:00:12.089095 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:00:12.091280 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:00:12.108607 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:00:12.109536 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:00:12.109964 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m17:00:12.110355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:12.128457 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:00:12.129157 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:00:12.129638 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m17:00:12.132176 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:00:12.136989 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m17:00:12.138675 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m17:00:12.139611 [info ] [Thread-1 (]: 1 of 10 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.07s]
[0m17:00:12.140479 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:00:12.141052 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:00:12.141675 [info ] [Thread-1 (]: 2 of 10 START test not_null_stg_pipedrive__activity_due_date ................... [RUN]
[0m17:00:12.142335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5)
[0m17:00:12.142783 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:00:12.147079 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:00:12.147908 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:00:12.150315 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:00:12.151102 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:00:12.151536 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: BEGIN
[0m17:00:12.151935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:12.169382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:00:12.170112 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:00:12.170562 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_date is null



      
    ) dbt_internal_test
[0m17:00:12.173382 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:00:12.175119 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: ROLLBACK
[0m17:00:12.176532 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: Close
[0m17:00:12.178053 [info ] [Thread-1 (]: 2 of 10 PASS not_null_stg_pipedrive__activity_due_date ......................... [[32mPASS[0m in 0.04s]
[0m17:00:12.179536 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:00:12.180417 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:00:12.180959 [info ] [Thread-1 (]: 3 of 10 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m17:00:12.181580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m17:00:12.182040 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:00:12.186277 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:00:12.187319 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:00:12.192928 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:00:12.194697 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:00:12.196070 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m17:00:12.196656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:12.213469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:00:12.214232 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:00:12.214689 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m17:00:12.217059 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:00:12.218757 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m17:00:12.220075 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m17:00:12.220829 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m17:00:12.222050 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:00:12.222781 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:00:12.223296 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m17:00:12.223917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m17:00:12.224361 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:00:12.228664 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:00:12.229541 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:00:12.232540 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:00:12.233985 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:00:12.234591 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m17:00:12.235246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:12.254272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m17:00:12.255129 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:00:12.255631 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m17:00:12.258064 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:00:12.259749 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m17:00:12.260962 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m17:00:12.261931 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m17:00:12.262744 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:00:12.263264 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:00:12.263782 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m17:00:12.264392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m17:00:12.264889 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:00:12.269590 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:00:12.270608 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:00:12.273298 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:00:12.274180 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:00:12.274628 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m17:00:12.275023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:12.293259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:00:12.293918 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:00:12.294394 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m17:00:12.297333 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:00:12.299105 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m17:00:12.300401 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m17:00:12.301112 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.04s]
[0m17:00:12.301910 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:00:12.302450 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269
[0m17:00:12.303107 [info ] [Thread-1 (]: 6 of 10 START test not_null_stg_pipedrive__deal_changes_changed_field_key ...... [RUN]
[0m17:00:12.303731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269)
[0m17:00:12.304188 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269
[0m17:00:12.308396 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269"
[0m17:00:12.309213 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269
[0m17:00:12.311621 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269"
[0m17:00:12.312473 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269"
[0m17:00:12.313036 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269: BEGIN
[0m17:00:12.313536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:12.329110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:00:12.329731 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269"
[0m17:00:12.330245 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select changed_field_key
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where changed_field_key is null



      
    ) dbt_internal_test
[0m17:00:12.333795 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:00:12.335541 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269: ROLLBACK
[0m17:00:12.336762 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269: Close
[0m17:00:12.337459 [info ] [Thread-1 (]: 6 of 10 PASS not_null_stg_pipedrive__deal_changes_changed_field_key ............ [[32mPASS[0m in 0.03s]
[0m17:00:12.338349 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269
[0m17:00:12.338968 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:00:12.339458 [info ] [Thread-1 (]: 7 of 10 START test not_null_stg_pipedrive__deal_changes_id ..................... [RUN]
[0m17:00:12.340087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_changed_field_key.4f93f7d269, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m17:00:12.340545 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:00:12.344694 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:00:12.345497 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:00:12.348227 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:00:12.349160 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:00:12.349586 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m17:00:12.350055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:12.366492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:00:12.367164 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:00:12.367642 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m17:00:12.370379 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:00:12.372072 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m17:00:12.373399 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m17:00:12.374231 [info ] [Thread-1 (]: 7 of 10 PASS not_null_stg_pipedrive__deal_changes_id ........................... [[32mPASS[0m in 0.03s]
[0m17:00:12.375019 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:00:12.375521 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:00:12.376020 [info ] [Thread-1 (]: 8 of 10 START test not_null_stg_pipedrive__deal_changes_new_value .............. [RUN]
[0m17:00:12.376606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m17:00:12.377068 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:00:12.381364 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:00:12.382185 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:00:12.384631 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:00:12.385450 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:00:12.385875 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m17:00:12.386277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:12.402689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:00:12.403299 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:00:12.403762 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m17:00:12.406701 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:00:12.408434 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m17:00:12.409757 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m17:00:12.410497 [info ] [Thread-1 (]: 8 of 10 PASS not_null_stg_pipedrive__deal_changes_new_value .................... [[32mPASS[0m in 0.03s]
[0m17:00:12.411252 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:00:12.411767 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:00:12.412257 [info ] [Thread-1 (]: 9 of 10 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m17:00:12.412891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m17:00:12.413388 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:00:12.422619 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:00:12.423686 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:00:12.428158 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:00:12.429018 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:00:12.429478 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m17:00:12.429880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:12.446598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:00:12.447214 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:00:12.447800 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:00:12.452979 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:00:12.454739 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m17:00:12.456226 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m17:00:12.457024 [info ] [Thread-1 (]: 9 of 10 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m17:00:12.457776 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:00:12.458295 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:00:12.458842 [info ] [Thread-1 (]: 10 of 10 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m17:00:12.459599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m17:00:12.460096 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:00:12.466838 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:00:12.467740 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:00:12.470111 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:00:12.471032 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:00:12.471554 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m17:00:12.472165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:12.489852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:00:12.490436 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:00:12.491018 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:00:12.495767 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:00:12.497497 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m17:00:12.499060 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m17:00:12.499818 [info ] [Thread-1 (]: 10 of 10 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m17:00:12.500658 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:00:12.501959 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:12.502417 [debug] [MainThread]: On master: BEGIN
[0m17:00:12.502771 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:12.519368 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m17:00:12.519982 [debug] [MainThread]: On master: COMMIT
[0m17:00:12.520371 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:12.520723 [debug] [MainThread]: On master: COMMIT
[0m17:00:12.522173 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:00:12.522661 [debug] [MainThread]: On master: Close
[0m17:00:12.523298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:12.523755 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m17:00:12.524176 [info ] [MainThread]: 
[0m17:00:12.524592 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m17:00:12.527032 [debug] [MainThread]: Command end result
[0m17:00:12.560671 [info ] [MainThread]: 
[0m17:00:12.561223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:00:12.561607 [info ] [MainThread]: 
[0m17:00:12.562028 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:00:12.563713 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4993577, "process_in_blocks": "0", "process_kernel_time": 0.355152, "process_mem_max_rss": "110653440", "process_out_blocks": "0", "process_user_time": 2.499718}
[0m17:00:12.564576 [debug] [MainThread]: Command `dbt test` succeeded at 17:00:12.564431 after 1.50 seconds
[0m17:00:12.565064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108257d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a228830>]}
[0m17:00:12.565489 [debug] [MainThread]: Flushing usage events
[0m17:10:24.326550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2f1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddaf140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddaec30>]}


============================== 17:10:24.334433 | e6868176-41b7-423a-acb2-cacdd73345d3 ==============================
[0m17:10:24.334433 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:10:24.335662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:10:24.609271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6868176-41b7-423a-acb2-cacdd73345d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2fe120>]}
[0m17:10:24.675797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6868176-41b7-423a-acb2-cacdd73345d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6c33b0>]}
[0m17:10:24.676953 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:10:24.824382 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:10:24.994739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:10:24.995686 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/schema.yml
[0m17:10:25.256783 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:10:25.257428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e6868176-41b7-423a-acb2-cacdd73345d3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2fcd10>]}
[0m17:10:25.478661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6868176-41b7-423a-acb2-cacdd73345d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eded550>]}
[0m17:10:25.628422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6868176-41b7-423a-acb2-cacdd73345d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f005d30>]}
[0m17:10:25.629002 [info ] [MainThread]: Found 6 models, 10 data tests, 6 sources, 428 macros
[0m17:10:25.629428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6868176-41b7-423a-acb2-cacdd73345d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee96420>]}
[0m17:10:25.632307 [info ] [MainThread]: 
[0m17:10:25.633019 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:25.637935 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m17:10:25.714612 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:10:25.715161 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m17:10:25.715584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:25.767056 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m17:10:25.767681 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:10:25.768144 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m17:10:25.772125 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m17:10:25.773888 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m17:10:25.775273 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m17:10:25.781985 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:25.782425 [debug] [MainThread]: On master: BEGIN
[0m17:10:25.782765 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:25.799667 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m17:10:25.800233 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:25.800748 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:25.805726 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m17:10:25.807318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6868176-41b7-423a-acb2-cacdd73345d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6c2690>]}
[0m17:10:25.807851 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:25.809778 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:25.810366 [debug] [MainThread]: On master: BEGIN
[0m17:10:25.813220 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m17:10:25.813923 [debug] [MainThread]: On master: COMMIT
[0m17:10:25.814362 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:25.814754 [debug] [MainThread]: On master: COMMIT
[0m17:10:25.816240 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:10:25.816738 [debug] [MainThread]: On master: Close
[0m17:10:25.817282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:25.817906 [info ] [MainThread]: 
[0m17:10:25.821241 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m17:10:25.821783 [info ] [Thread-1 (]: 1 of 10 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m17:10:25.822320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m17:10:25.822751 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m17:10:25.835714 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m17:10:25.837213 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m17:10:25.855035 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m17:10:25.856070 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m17:10:25.856524 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m17:10:25.856922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:25.873117 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:10:25.873878 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m17:10:25.874424 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m17:10:25.879606 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:10:25.884203 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m17:10:25.885742 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m17:10:25.886615 [info ] [Thread-1 (]: 1 of 10 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.06s]
[0m17:10:25.887464 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m17:10:25.888017 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:10:25.888526 [info ] [Thread-1 (]: 2 of 10 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m17:10:25.889257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m17:10:25.889713 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:10:25.897125 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:10:25.898054 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:10:25.900415 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:10:25.901259 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:10:25.901665 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m17:10:25.902047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:25.921122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m17:10:25.922399 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:10:25.922969 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m17:10:25.926797 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:10:25.928768 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m17:10:25.930221 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m17:10:25.931190 [info ] [Thread-1 (]: 2 of 10 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.04s]
[0m17:10:25.932336 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:10:25.932933 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:10:25.933489 [info ] [Thread-1 (]: 3 of 10 START test not_null_stg_pipedrive__activity_due_date ................... [RUN]
[0m17:10:25.934445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5)
[0m17:10:25.934936 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:10:25.941579 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:10:25.942634 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:10:25.945214 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:10:25.946044 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:10:25.946463 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: BEGIN
[0m17:10:25.946851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:25.964058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:10:25.964683 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:10:25.965201 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_date is null



      
    ) dbt_internal_test
[0m17:10:25.967685 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:10:25.969396 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: ROLLBACK
[0m17:10:25.970711 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: Close
[0m17:10:25.971513 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stg_pipedrive__activity_due_date ......................... [[32mPASS[0m in 0.04s]
[0m17:10:25.972741 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:10:25.973554 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:10:25.974293 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m17:10:25.975301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m17:10:25.976406 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:10:25.982752 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:10:25.983686 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:10:25.986124 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:10:25.986883 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:10:25.987312 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m17:10:25.987703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:26.004485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:10:26.005091 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:10:26.005621 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m17:10:26.008367 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:10:26.010467 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m17:10:26.011952 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m17:10:26.012711 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m17:10:26.013421 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:10:26.013903 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:10:26.014491 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m17:10:26.015048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m17:10:26.015487 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:10:26.021409 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:10:26.022363 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:10:26.025104 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:10:26.026007 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:10:26.026465 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m17:10:26.026961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:26.043557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:10:26.044138 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:10:26.044591 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m17:10:26.047291 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:10:26.048952 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m17:10:26.050290 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m17:10:26.051022 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m17:10:26.051764 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:10:26.052292 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:10:26.052936 [info ] [Thread-1 (]: 6 of 10 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m17:10:26.053763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m17:10:26.054295 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:10:26.059425 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:10:26.060336 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:10:26.062678 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:10:26.063440 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:10:26.063874 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m17:10:26.064275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:26.080929 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:10:26.081494 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:10:26.082005 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m17:10:26.085814 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:10:26.087551 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m17:10:26.088795 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m17:10:26.089771 [info ] [Thread-1 (]: 6 of 10 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.04s]
[0m17:10:26.090826 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:10:26.091372 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:10:26.092034 [info ] [Thread-1 (]: 7 of 10 START test not_null_stg_pipedrive__deal_changes_id ..................... [RUN]
[0m17:10:26.092642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m17:10:26.093083 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:10:26.097237 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:10:26.098031 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:10:26.100387 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:10:26.101247 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:10:26.101695 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m17:10:26.102096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:26.118628 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:10:26.119255 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:10:26.119745 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m17:10:26.122697 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:10:26.124406 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m17:10:26.125917 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m17:10:26.126757 [info ] [Thread-1 (]: 7 of 10 PASS not_null_stg_pipedrive__deal_changes_id ........................... [[32mPASS[0m in 0.03s]
[0m17:10:26.127560 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:10:26.128132 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:10:26.128611 [info ] [Thread-1 (]: 8 of 10 START test not_null_stg_pipedrive__deal_changes_new_value .............. [RUN]
[0m17:10:26.129243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m17:10:26.129695 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:10:26.133888 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:10:26.134666 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:10:26.136934 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:10:26.137760 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:10:26.138187 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m17:10:26.138631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:26.154996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:10:26.155672 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:10:26.156249 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m17:10:26.160221 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:10:26.162269 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m17:10:26.163989 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m17:10:26.165231 [info ] [Thread-1 (]: 8 of 10 PASS not_null_stg_pipedrive__deal_changes_new_value .................... [[32mPASS[0m in 0.04s]
[0m17:10:26.166355 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:10:26.167086 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:10:26.167904 [info ] [Thread-1 (]: 9 of 10 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m17:10:26.168878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m17:10:26.169373 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:10:26.180327 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:10:26.181365 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:10:26.183829 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:10:26.184828 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:10:26.185338 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m17:10:26.185782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:26.204847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m17:10:26.205606 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:10:26.206256 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:10:26.210784 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:10:26.212535 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m17:10:26.214184 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m17:10:26.215046 [info ] [Thread-1 (]: 9 of 10 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.05s]
[0m17:10:26.216102 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:10:26.216911 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:10:26.217461 [info ] [Thread-1 (]: 10 of 10 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m17:10:26.218236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m17:10:26.218713 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:10:26.224520 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:10:26.225624 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:10:26.228155 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:10:26.229052 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:10:26.229509 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m17:10:26.229932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:26.250842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m17:10:26.251706 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:10:26.252502 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:10:26.257527 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:10:26.260133 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m17:10:26.261827 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m17:10:26.262746 [info ] [Thread-1 (]: 10 of 10 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m17:10:26.263895 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:10:26.265479 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:26.265972 [debug] [MainThread]: On master: BEGIN
[0m17:10:26.266329 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:26.287932 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m17:10:26.288611 [debug] [MainThread]: On master: COMMIT
[0m17:10:26.289163 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:26.289533 [debug] [MainThread]: On master: COMMIT
[0m17:10:26.291261 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:10:26.291721 [debug] [MainThread]: On master: Close
[0m17:10:26.292315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:26.293130 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m17:10:26.293657 [info ] [MainThread]: 
[0m17:10:26.294250 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m17:10:26.297090 [debug] [MainThread]: Command end result
[0m17:10:26.339590 [info ] [MainThread]: 
[0m17:10:26.340194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:26.340718 [info ] [MainThread]: 
[0m17:10:26.341262 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:10:26.344367 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.1137683, "process_in_blocks": "0", "process_kernel_time": 0.535536, "process_mem_max_rss": "116420608", "process_out_blocks": "0", "process_user_time": 3.251488}
[0m17:10:26.345358 [debug] [MainThread]: Command `dbt test` succeeded at 17:10:26.345196 after 2.11 seconds
[0m17:10:26.345937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0bed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d83c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c75ede0>]}
[0m17:10:26.346415 [debug] [MainThread]: Flushing usage events
[0m17:34:22.550641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9d9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115ef320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115eede0>]}


============================== 17:34:22.557519 | bf32a30c-70bd-44ce-94b6-5ebf59d5a531 ==============================
[0m17:34:22.557519 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:34:22.558268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:34:22.838418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf32a30c-70bd-44ce-94b6-5ebf59d5a531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111704fe0>]}
[0m17:34:22.905267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf32a30c-70bd-44ce-94b6-5ebf59d5a531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110688a40>]}
[0m17:34:22.906540 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:34:23.067064 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:34:23.242688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m17:34:23.243422 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://tests/assert_change_user_references_user_id.sql
[0m17:34:23.243856 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://tests/assert_change_stage_references_stage_id.sql
[0m17:34:23.375684 [error] [MainThread]: Encountered an error:
Compilation Error in test assert_change_user_references_user_id (tests/assert_change_user_references_user_id.sql)
  The name argument to ref() must be a string, got <class 'dbt_common.clients.jinja.create_undefined.<locals>.Undefined'>
[0m17:34:23.378349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.91643894, "process_in_blocks": "0", "process_kernel_time": 0.45082, "process_mem_max_rss": "98832384", "process_out_blocks": "0", "process_user_time": 2.272026}
[0m17:34:23.379189 [debug] [MainThread]: Command `dbt run` failed at 17:34:23.379047 after 0.92 seconds
[0m17:34:23.379709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112410f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111721910>]}
[0m17:34:23.380177 [debug] [MainThread]: Flushing usage events
[0m17:34:57.962366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bea7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddcf140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddcec30>]}


============================== 17:34:57.967875 | 91395cfd-1896-46ff-b67d-caf045bd2563 ==============================
[0m17:34:57.967875 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:34:57.968603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:34:58.203633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91395cfd-1896-46ff-b67d-caf045bd2563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e322300>]}
[0m17:34:58.269038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91395cfd-1896-46ff-b67d-caf045bd2563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d44a7e0>]}
[0m17:34:58.269999 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:34:58.410776 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:34:58.549497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m17:34:58.550164 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://tests/assert_change_stage_references_stage_id.sql
[0m17:34:58.550584 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://tests/assert_change_user_references_user_id.sql
[0m17:34:58.782405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91395cfd-1896-46ff-b67d-caf045bd2563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec6e6f0>]}
[0m17:34:58.925287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91395cfd-1896-46ff-b67d-caf045bd2563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaf1fa0>]}
[0m17:34:58.926224 [info ] [MainThread]: Found 6 models, 12 data tests, 6 sources, 428 macros
[0m17:34:58.927466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91395cfd-1896-46ff-b67d-caf045bd2563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec6f6b0>]}
[0m17:34:58.934660 [info ] [MainThread]: 
[0m17:34:58.936066 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:34:58.945320 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:34:59.031350 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:34:59.032444 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:34:59.032880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:59.088065 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.055 seconds
[0m17:34:59.089667 [debug] [ThreadPool]: On list_postgres: Close
[0m17:34:59.091592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m17:34:59.098193 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:34:59.098707 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m17:34:59.099075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:59.114421 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m17:34:59.115132 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:34:59.115579 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m17:34:59.119448 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m17:34:59.121034 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m17:34:59.122190 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m17:34:59.128361 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:59.128815 [debug] [MainThread]: On master: BEGIN
[0m17:34:59.129161 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:59.144054 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m17:34:59.144537 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:59.145052 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:34:59.149760 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m17:34:59.151306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91395cfd-1896-46ff-b67d-caf045bd2563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3b3680>]}
[0m17:34:59.151806 [debug] [MainThread]: On master: ROLLBACK
[0m17:34:59.153010 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:59.153446 [debug] [MainThread]: On master: BEGIN
[0m17:34:59.155285 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:34:59.155774 [debug] [MainThread]: On master: COMMIT
[0m17:34:59.156170 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:59.156521 [debug] [MainThread]: On master: COMMIT
[0m17:34:59.157635 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:34:59.158058 [debug] [MainThread]: On master: Close
[0m17:34:59.158581 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:34:59.159099 [info ] [MainThread]: 
[0m17:34:59.161927 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m17:34:59.162615 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m17:34:59.163178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m17:34:59.163639 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m17:34:59.172686 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:34:59.173533 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m17:34:59.213696 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:34:59.214610 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:34:59.215138 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m17:34:59.215558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:59.230604 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m17:34:59.231322 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:34:59.231850 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m17:34:59.234377 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:34:59.241254 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:34:59.241756 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m17:34:59.243716 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:59.247051 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:34:59.247507 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m17:34:59.249311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:59.269358 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m17:34:59.269877 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:34:59.270297 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m17:34:59.273175 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:34:59.280070 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m17:34:59.285921 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:34:59.286454 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m17:34:59.289131 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:34:59.291926 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m17:34:59.293582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91395cfd-1896-46ff-b67d-caf045bd2563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4bc0e0>]}
[0m17:34:59.294362 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.13s]
[0m17:34:59.295333 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m17:34:59.295880 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m17:34:59.296454 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m17:34:59.297117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m17:34:59.297574 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m17:34:59.300531 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:34:59.301348 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m17:34:59.305327 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:34:59.306164 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:34:59.306659 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m17:34:59.307134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:59.323557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:34:59.324299 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:34:59.324867 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m17:34:59.327739 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:34:59.331091 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:34:59.331544 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m17:34:59.333210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:59.336596 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:34:59.337123 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m17:34:59.338644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:59.340553 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m17:34:59.341030 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:34:59.341487 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m17:34:59.343550 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:34:59.346224 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m17:34:59.347062 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:34:59.347489 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m17:34:59.349996 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:34:59.351608 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m17:34:59.352191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91395cfd-1896-46ff-b67d-caf045bd2563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10effe870>]}
[0m17:34:59.352886 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m17:34:59.353629 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m17:34:59.354146 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m17:34:59.354857 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m17:34:59.355437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m17:34:59.355890 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m17:34:59.358728 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:34:59.359528 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m17:34:59.363524 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:34:59.364376 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:34:59.364831 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m17:34:59.365318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:59.381843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:34:59.382385 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:34:59.382835 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m17:34:59.386138 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:34:59.389535 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:34:59.390015 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m17:34:59.391699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:59.395306 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:34:59.395777 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m17:34:59.397326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:59.399501 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m17:34:59.400036 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:34:59.400479 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m17:34:59.402289 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:34:59.406478 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m17:34:59.407601 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:34:59.408179 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m17:34:59.410749 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:34:59.412339 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m17:34:59.412905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91395cfd-1896-46ff-b67d-caf045bd2563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1bbdd0>]}
[0m17:34:59.413553 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m17:34:59.414404 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m17:34:59.415022 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields
[0m17:34:59.415627 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__fields ... [RUN]
[0m17:34:59.416425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__fields)
[0m17:34:59.416960 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields
[0m17:34:59.419712 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:34:59.420646 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields
[0m17:34:59.424905 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:34:59.425725 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:34:59.426163 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: BEGIN
[0m17:34:59.426556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:59.442293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:34:59.442991 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:34:59.443469 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m17:34:59.446127 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:34:59.449771 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:34:59.450260 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields" rename to "stg_pipedrive__fields__dbt_backup"
[0m17:34:59.451801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:59.454919 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:34:59.455370 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp" rename to "stg_pipedrive__fields"
[0m17:34:59.456836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:59.458825 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m17:34:59.459264 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:34:59.459668 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m17:34:59.461680 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:34:59.464382 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup"
[0m17:34:59.465313 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:34:59.465780 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup" cascade
[0m17:34:59.468342 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:34:59.469913 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: Close
[0m17:34:59.470479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91395cfd-1896-46ff-b67d-caf045bd2563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0a5430>]}
[0m17:34:59.471147 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields  [[32mCREATE VIEW[0m in 0.05s]
[0m17:34:59.471863 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields
[0m17:34:59.472366 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m17:34:59.473010 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m17:34:59.473571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m17:34:59.474010 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m17:34:59.476772 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:34:59.477553 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m17:34:59.481851 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:34:59.482758 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:34:59.483230 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m17:34:59.483631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:59.499410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:34:59.500169 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:34:59.500640 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m17:34:59.503156 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:34:59.506424 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:34:59.506867 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m17:34:59.508324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:59.511550 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:34:59.512091 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m17:34:59.513588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:59.515824 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m17:34:59.516313 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:34:59.516723 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m17:34:59.518672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:34:59.521295 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m17:34:59.522117 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:34:59.522541 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m17:34:59.524931 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:34:59.526518 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m17:34:59.527110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91395cfd-1896-46ff-b67d-caf045bd2563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f162f00>]}
[0m17:34:59.527784 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.05s]
[0m17:34:59.528499 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m17:34:59.528998 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m17:34:59.529651 [info ] [Thread-1 (]: 6 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m17:34:59.530279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m17:34:59.530862 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m17:34:59.533846 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:34:59.534660 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m17:34:59.539891 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:34:59.540700 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:34:59.541126 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m17:34:59.541522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:59.559475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:34:59.560208 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:34:59.560679 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."users"
  );
[0m17:34:59.563209 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:34:59.567056 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:34:59.567559 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m17:34:59.569285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:59.572487 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:34:59.572928 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m17:34:59.574484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:34:59.576355 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m17:34:59.576811 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:34:59.577222 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m17:34:59.579150 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:34:59.581896 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m17:34:59.582847 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:34:59.583310 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m17:34:59.585477 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:34:59.587038 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m17:34:59.587612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91395cfd-1896-46ff-b67d-caf045bd2563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1e4ef0>]}
[0m17:34:59.588273 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m17:34:59.588998 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m17:34:59.590423 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:59.590902 [debug] [MainThread]: On master: BEGIN
[0m17:34:59.591298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:34:59.606480 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m17:34:59.607142 [debug] [MainThread]: On master: COMMIT
[0m17:34:59.607561 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:59.607937 [debug] [MainThread]: On master: COMMIT
[0m17:34:59.609247 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:34:59.609804 [debug] [MainThread]: On master: Close
[0m17:34:59.610504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:59.611138 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__users' was properly closed.
[0m17:34:59.611636 [info ] [MainThread]: 
[0m17:34:59.612140 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m17:34:59.613936 [debug] [MainThread]: Command end result
[0m17:34:59.646807 [info ] [MainThread]: 
[0m17:34:59.647342 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:34:59.647869 [info ] [MainThread]: 
[0m17:34:59.648298 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:34:59.650152 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7715592, "process_in_blocks": "0", "process_kernel_time": 0.368581, "process_mem_max_rss": "111611904", "process_out_blocks": "0", "process_user_time": 2.756066}
[0m17:34:59.650900 [debug] [MainThread]: Command `dbt run` succeeded at 17:34:59.650765 after 1.77 seconds
[0m17:34:59.651361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d842810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddcede0>]}
[0m17:34:59.651786 [debug] [MainThread]: Flushing usage events
[0m17:35:06.234040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fba17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110133290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110132db0>]}


============================== 17:35:06.239263 | c4ade270-8713-426c-b966-a6f5ad1e3877 ==============================
[0m17:35:06.239263 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:35:06.240005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m17:35:06.477447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4ade270-8713-426c-b966-a6f5ad1e3877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110114b30>]}
[0m17:35:06.549350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4ade270-8713-426c-b966-a6f5ad1e3877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fab5d00>]}
[0m17:35:06.550351 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:35:06.691312 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:35:06.842812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:35:06.843277 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:35:06.903041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4ade270-8713-426c-b966-a6f5ad1e3877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110819310>]}
[0m17:35:07.058776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4ade270-8713-426c-b966-a6f5ad1e3877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11116c9b0>]}
[0m17:35:07.059389 [info ] [MainThread]: Found 6 models, 12 data tests, 6 sources, 428 macros
[0m17:35:07.059830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4ade270-8713-426c-b966-a6f5ad1e3877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111307d0>]}
[0m17:35:07.062994 [info ] [MainThread]: 
[0m17:35:07.063807 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:35:07.069723 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m17:35:07.141786 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:35:07.142301 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m17:35:07.142685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:07.172105 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m17:35:07.172656 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:35:07.173173 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m17:35:07.177165 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m17:35:07.178900 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m17:35:07.180259 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m17:35:07.186939 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:07.187404 [debug] [MainThread]: On master: BEGIN
[0m17:35:07.187758 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:07.203849 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m17:35:07.204395 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:07.204878 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:35:07.209575 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m17:35:07.211151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4ade270-8713-426c-b966-a6f5ad1e3877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fa7500>]}
[0m17:35:07.211674 [debug] [MainThread]: On master: ROLLBACK
[0m17:35:07.212972 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:07.213381 [debug] [MainThread]: On master: BEGIN
[0m17:35:07.215381 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m17:35:07.216114 [debug] [MainThread]: On master: COMMIT
[0m17:35:07.216516 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:07.216869 [debug] [MainThread]: On master: COMMIT
[0m17:35:07.218095 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:35:07.218518 [debug] [MainThread]: On master: Close
[0m17:35:07.219068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:07.219536 [info ] [MainThread]: 
[0m17:35:07.222070 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m17:35:07.222641 [info ] [Thread-1 (]: 1 of 12 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m17:35:07.223225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m17:35:07.223731 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m17:35:07.247219 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m17:35:07.249124 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m17:35:07.268179 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m17:35:07.269171 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m17:35:07.269633 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m17:35:07.270047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:07.287077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:35:07.287721 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m17:35:07.288211 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m17:35:07.294143 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:35:07.299207 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m17:35:07.300735 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m17:35:07.301553 [info ] [Thread-1 (]: 1 of 12 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.08s]
[0m17:35:07.302422 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m17:35:07.302984 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m17:35:07.303523 [info ] [Thread-1 (]: 2 of 12 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m17:35:07.304329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m17:35:07.304821 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m17:35:07.308352 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m17:35:07.309412 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m17:35:07.314010 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m17:35:07.315223 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m17:35:07.315830 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m17:35:07.316362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:07.334323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:35:07.335022 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m17:35:07.335631 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL; -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m17:35:07.338018 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: WHERE s.id IS NULL; -- Any non referential values in d will ...
                           ^

[0m17:35:07.338626 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m17:35:07.340536 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m17:35:07.351862 [debug] [Thread-1 (]: Database Error in test assert_change_stage_references_stage_id (tests/assert_change_stage_references_stage_id.sql)
  syntax error at or near ";"
  LINE 17: WHERE s.id IS NULL; -- Any non referential values in d will ...
                             ^
  compiled code at target/run/enpal_assessment_project/tests/assert_change_stage_references_stage_id.sql
[0m17:35:07.352614 [error] [Thread-1 (]: 2 of 12 ERROR assert_change_stage_references_stage_id .......................... [[31mERROR[0m in 0.05s]
[0m17:35:07.353386 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m17:35:07.353997 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m17:35:07.354661 [info ] [Thread-1 (]: 3 of 12 START test assert_change_user_references_user_id ....................... [RUN]
[0m17:35:07.356202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m17:35:07.356697 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m17:35:07.363088 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m17:35:07.363989 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m17:35:07.366564 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m17:35:07.367431 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m17:35:07.367867 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m17:35:07.368306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:07.389009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m17:35:07.389675 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m17:35:07.390175 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL; -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m17:35:07.392860 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: WHERE u.id IS NULL; -- Any non referential values in d will ...
                           ^

[0m17:35:07.393427 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m17:35:07.394996 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m17:35:07.398725 [debug] [Thread-1 (]: Database Error in test assert_change_user_references_user_id (tests/assert_change_user_references_user_id.sql)
  syntax error at or near ";"
  LINE 17: WHERE u.id IS NULL; -- Any non referential values in d will ...
                             ^
  compiled code at target/run/enpal_assessment_project/tests/assert_change_user_references_user_id.sql
[0m17:35:07.399474 [error] [Thread-1 (]: 3 of 12 ERROR assert_change_user_references_user_id ............................ [[31mERROR[0m in 0.04s]
[0m17:35:07.400231 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m17:35:07.400744 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:35:07.401325 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m17:35:07.401858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m17:35:07.402315 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:35:07.410734 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:35:07.411724 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:35:07.414180 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:35:07.414981 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:35:07.415511 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m17:35:07.415927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:07.434082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:35:07.434754 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:35:07.435374 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m17:35:07.437881 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:35:07.439759 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m17:35:07.441061 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m17:35:07.441808 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.04s]
[0m17:35:07.442554 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:35:07.443149 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:35:07.443727 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_pipedrive__activity_due_date ................... [RUN]
[0m17:35:07.444539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5)
[0m17:35:07.445077 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:35:07.449540 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:35:07.450422 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:35:07.452912 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:35:07.454392 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:35:07.455005 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: BEGIN
[0m17:35:07.455593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:07.471549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:35:07.472341 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:35:07.472832 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_date is null



      
    ) dbt_internal_test
[0m17:35:07.475232 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:35:07.476974 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: ROLLBACK
[0m17:35:07.478294 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: Close
[0m17:35:07.479173 [info ] [Thread-1 (]: 5 of 12 PASS not_null_stg_pipedrive__activity_due_date ......................... [[32mPASS[0m in 0.03s]
[0m17:35:07.480223 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:35:07.480877 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:35:07.481429 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m17:35:07.482204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m17:35:07.482683 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:35:07.487159 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:35:07.488095 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:35:07.490655 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:35:07.491574 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:35:07.492044 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m17:35:07.492488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:07.510132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:35:07.510772 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:35:07.511299 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m17:35:07.514479 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:35:07.516215 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m17:35:07.518828 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m17:35:07.519747 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m17:35:07.520602 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:35:07.521146 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:35:07.521780 [info ] [Thread-1 (]: 7 of 12 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m17:35:07.522633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m17:35:07.523100 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:35:07.528021 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:35:07.528948 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:35:07.531478 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:35:07.532313 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:35:07.532746 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m17:35:07.533140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:07.549838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:35:07.550452 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:35:07.550945 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m17:35:07.553263 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:35:07.555052 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m17:35:07.556362 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m17:35:07.557084 [info ] [Thread-1 (]: 7 of 12 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.03s]
[0m17:35:07.557949 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:35:07.558520 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:35:07.559020 [info ] [Thread-1 (]: 8 of 12 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m17:35:07.559623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m17:35:07.560087 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:35:07.564524 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:35:07.565511 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:35:07.568114 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:35:07.568924 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:35:07.569482 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m17:35:07.570063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:07.587095 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:35:07.587769 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:35:07.588374 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m17:35:07.592134 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:35:07.595721 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m17:35:07.597330 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m17:35:07.598319 [info ] [Thread-1 (]: 8 of 12 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.04s]
[0m17:35:07.599196 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:35:07.599719 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:35:07.600292 [info ] [Thread-1 (]: 9 of 12 START test not_null_stg_pipedrive__deal_changes_id ..................... [RUN]
[0m17:35:07.600942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m17:35:07.601609 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:35:07.606708 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:35:07.607732 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:35:07.610156 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:35:07.610947 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:35:07.611383 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m17:35:07.611794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:07.628153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:35:07.628898 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:35:07.629425 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m17:35:07.632597 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:35:07.634773 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m17:35:07.636172 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m17:35:07.637155 [info ] [Thread-1 (]: 9 of 12 PASS not_null_stg_pipedrive__deal_changes_id ........................... [[32mPASS[0m in 0.04s]
[0m17:35:07.638242 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:35:07.638845 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:35:07.639512 [info ] [Thread-1 (]: 10 of 12 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m17:35:07.640174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m17:35:07.640637 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:35:07.644934 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:35:07.645733 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:35:07.648357 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:35:07.649267 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:35:07.649737 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m17:35:07.650156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:07.667534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:35:07.668305 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:35:07.668832 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m17:35:07.672059 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:35:07.673765 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m17:35:07.675272 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m17:35:07.676119 [info ] [Thread-1 (]: 10 of 12 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m17:35:07.677040 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:35:07.677597 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:35:07.678070 [info ] [Thread-1 (]: 11 of 12 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m17:35:07.678777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m17:35:07.679281 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:35:07.689030 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:35:07.689901 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:35:07.692317 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:35:07.693092 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:35:07.693549 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m17:35:07.693979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:07.711466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:35:07.712262 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:35:07.712791 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:35:07.717084 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:35:07.719178 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m17:35:07.721071 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m17:35:07.721956 [info ] [Thread-1 (]: 11 of 12 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m17:35:07.722952 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:35:07.723545 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:35:07.724756 [info ] [Thread-1 (]: 12 of 12 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m17:35:07.725744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m17:35:07.726546 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:35:07.734115 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:35:07.734970 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:35:07.737457 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:35:07.738299 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:35:07.738764 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m17:35:07.739220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:07.757238 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:35:07.757943 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:35:07.758560 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:35:07.762439 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:35:07.764196 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m17:35:07.765767 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m17:35:07.766561 [info ] [Thread-1 (]: 12 of 12 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m17:35:07.767547 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:35:07.768981 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:07.769427 [debug] [MainThread]: On master: BEGIN
[0m17:35:07.769881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:07.785620 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m17:35:07.786380 [debug] [MainThread]: On master: COMMIT
[0m17:35:07.786847 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:07.787403 [debug] [MainThread]: On master: COMMIT
[0m17:35:07.788870 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:35:07.789410 [debug] [MainThread]: On master: Close
[0m17:35:07.790084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:07.790597 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m17:35:07.791019 [info ] [MainThread]: 
[0m17:35:07.791443 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m17:35:07.794203 [debug] [MainThread]: Command end result
[0m17:35:07.827626 [info ] [MainThread]: 
[0m17:35:07.828179 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:35:07.828833 [info ] [MainThread]: 
[0m17:35:07.829429 [error] [MainThread]:   Database Error in test assert_change_stage_references_stage_id (tests/assert_change_stage_references_stage_id.sql)
  syntax error at or near ";"
  LINE 17: WHERE s.id IS NULL; -- Any non referential values in d will ...
                             ^
  compiled code at target/run/enpal_assessment_project/tests/assert_change_stage_references_stage_id.sql
[0m17:35:07.829874 [info ] [MainThread]: 
[0m17:35:07.830347 [error] [MainThread]:   Database Error in test assert_change_user_references_user_id (tests/assert_change_user_references_user_id.sql)
  syntax error at or near ";"
  LINE 17: WHERE u.id IS NULL; -- Any non referential values in d will ...
                             ^
  compiled code at target/run/enpal_assessment_project/tests/assert_change_user_references_user_id.sql
[0m17:35:07.830754 [info ] [MainThread]: 
[0m17:35:07.831172 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m17:35:07.833099 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.6812997, "process_in_blocks": "0", "process_kernel_time": 0.370761, "process_mem_max_rss": "112349184", "process_out_blocks": "0", "process_user_time": 2.681866}
[0m17:35:07.833864 [debug] [MainThread]: Command `dbt test` failed at 17:35:07.833722 after 1.68 seconds
[0m17:35:07.834349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c43ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbbc110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015d880>]}
[0m17:35:07.834773 [debug] [MainThread]: Flushing usage events
[0m17:35:23.341189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054be9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c6c30>]}


============================== 17:35:23.346749 | 6b0afcf3-c3c0-48ec-a0e5-1bce57d63d01 ==============================
[0m17:35:23.346749 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:35:23.347826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:35:23.583865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b0afcf3-c3c0-48ec-a0e5-1bce57d63d01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ce750>]}
[0m17:35:23.649617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b0afcf3-c3c0-48ec-a0e5-1bce57d63d01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ba5a0>]}
[0m17:35:23.650571 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:35:23.778185 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:35:23.941943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:35:23.942723 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://tests/assert_change_user_references_user_id.sql
[0m17:35:23.943217 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://tests/assert_change_stage_references_stage_id.sql
[0m17:35:24.171535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b0afcf3-c3c0-48ec-a0e5-1bce57d63d01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086710a0>]}
[0m17:35:24.311088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b0afcf3-c3c0-48ec-a0e5-1bce57d63d01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d10d0>]}
[0m17:35:24.311662 [info ] [MainThread]: Found 6 models, 12 data tests, 6 sources, 428 macros
[0m17:35:24.312077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b0afcf3-c3c0-48ec-a0e5-1bce57d63d01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d4440>]}
[0m17:35:24.314882 [info ] [MainThread]: 
[0m17:35:24.315855 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:35:24.322408 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m17:35:24.394521 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:35:24.394992 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m17:35:24.395356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:24.425717 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m17:35:24.426356 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:35:24.426898 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m17:35:24.430883 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m17:35:24.432672 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m17:35:24.433986 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m17:35:24.440428 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:24.440882 [debug] [MainThread]: On master: BEGIN
[0m17:35:24.441224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:24.457380 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m17:35:24.457950 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:24.458476 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:35:24.463236 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m17:35:24.464794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b0afcf3-c3c0-48ec-a0e5-1bce57d63d01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108907c50>]}
[0m17:35:24.465296 [debug] [MainThread]: On master: ROLLBACK
[0m17:35:24.467147 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:24.467714 [debug] [MainThread]: On master: BEGIN
[0m17:35:24.470381 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m17:35:24.470925 [debug] [MainThread]: On master: COMMIT
[0m17:35:24.471313 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:24.471662 [debug] [MainThread]: On master: COMMIT
[0m17:35:24.472942 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:35:24.473371 [debug] [MainThread]: On master: Close
[0m17:35:24.473907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:24.474510 [info ] [MainThread]: 
[0m17:35:24.477059 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m17:35:24.477740 [info ] [Thread-1 (]: 1 of 12 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m17:35:24.478310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m17:35:24.478756 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m17:35:24.502332 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m17:35:24.503365 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m17:35:24.524776 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m17:35:24.525756 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m17:35:24.526204 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m17:35:24.526615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:24.542724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:35:24.543391 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m17:35:24.543896 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m17:35:24.548628 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:35:24.553227 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m17:35:24.554953 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m17:35:24.555820 [info ] [Thread-1 (]: 1 of 12 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.08s]
[0m17:35:24.556809 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m17:35:24.557495 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m17:35:24.558083 [info ] [Thread-1 (]: 2 of 12 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m17:35:24.558894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m17:35:24.559365 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m17:35:24.562372 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m17:35:24.563213 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m17:35:24.565919 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m17:35:24.566992 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m17:35:24.567477 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m17:35:24.567885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:24.589408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m17:35:24.590022 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m17:35:24.590546 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m17:35:24.596777 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m17:35:24.598590 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m17:35:24.600033 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m17:35:24.600786 [info ] [Thread-1 (]: 2 of 12 PASS assert_change_stage_references_stage_id ........................... [[32mPASS[0m in 0.04s]
[0m17:35:24.601633 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m17:35:24.602187 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m17:35:24.602686 [info ] [Thread-1 (]: 3 of 12 START test assert_change_user_references_user_id ....................... [RUN]
[0m17:35:24.603451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m17:35:24.603915 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m17:35:24.606601 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m17:35:24.607385 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m17:35:24.609686 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m17:35:24.610464 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m17:35:24.610907 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m17:35:24.611317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:24.627962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:35:24.628684 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m17:35:24.629254 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m17:35:24.634132 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:35:24.635843 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m17:35:24.637325 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m17:35:24.638472 [info ] [Thread-1 (]: 3 of 12 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.03s]
[0m17:35:24.640153 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m17:35:24.641107 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:35:24.641691 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m17:35:24.642458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m17:35:24.642985 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:35:24.651303 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:35:24.652275 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:35:24.655083 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:35:24.656048 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:35:24.656610 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m17:35:24.657295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:24.676580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m17:35:24.683163 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m17:35:24.703332 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m17:35:24.710724 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:35:24.743972 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m17:35:24.763596 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m17:35:24.765139 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.12s]
[0m17:35:24.767526 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m17:35:24.768617 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:35:24.770056 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_pipedrive__activity_due_date ................... [RUN]
[0m17:35:24.771226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5)
[0m17:35:24.771881 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:35:24.777910 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:35:24.779245 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:35:24.782672 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:35:24.783844 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:35:24.784641 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: BEGIN
[0m17:35:24.785384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:24.809767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m17:35:24.810514 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m17:35:24.811006 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_date is null



      
    ) dbt_internal_test
[0m17:35:24.813797 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:35:24.815943 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: ROLLBACK
[0m17:35:24.817639 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: Close
[0m17:35:24.818497 [info ] [Thread-1 (]: 5 of 12 PASS not_null_stg_pipedrive__activity_due_date ......................... [[32mPASS[0m in 0.05s]
[0m17:35:24.819325 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m17:35:24.819869 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:35:24.820411 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m17:35:24.821378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m17:35:24.822107 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:35:24.826465 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:35:24.827331 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:35:24.830058 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:35:24.830967 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:35:24.831557 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m17:35:24.832176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:24.851087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m17:35:24.851704 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m17:35:24.852164 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m17:35:24.854875 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:35:24.857201 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m17:35:24.859376 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m17:35:24.860265 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m17:35:24.861079 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m17:35:24.861700 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:35:24.862234 [info ] [Thread-1 (]: 7 of 12 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m17:35:24.862830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m17:35:24.863290 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:35:24.867812 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:35:24.868669 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:35:24.872834 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:35:24.873710 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:35:24.874146 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m17:35:24.874540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:24.891947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:35:24.892587 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m17:35:24.893048 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m17:35:24.895437 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:35:24.897149 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m17:35:24.898437 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m17:35:24.899207 [info ] [Thread-1 (]: 7 of 12 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m17:35:24.899975 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m17:35:24.900495 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:35:24.900990 [info ] [Thread-1 (]: 8 of 12 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m17:35:24.901600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m17:35:24.902064 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:35:24.906610 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:35:24.907440 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:35:24.909762 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:35:24.910513 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:35:24.910956 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m17:35:24.911358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:24.929596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:35:24.930507 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m17:35:24.931403 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m17:35:24.935561 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:35:24.937746 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m17:35:24.940395 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m17:35:24.941499 [info ] [Thread-1 (]: 8 of 12 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.04s]
[0m17:35:24.942632 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m17:35:24.943197 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:35:24.944002 [info ] [Thread-1 (]: 9 of 12 START test not_null_stg_pipedrive__deal_changes_id ..................... [RUN]
[0m17:35:24.944578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m17:35:24.945116 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:35:24.949742 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:35:24.950602 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:35:24.953245 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:35:24.954070 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:35:24.954620 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m17:35:24.955080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:24.971204 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:35:24.971843 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m17:35:24.972298 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m17:35:24.975537 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:35:24.977281 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m17:35:24.978595 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m17:35:24.979388 [info ] [Thread-1 (]: 9 of 12 PASS not_null_stg_pipedrive__deal_changes_id ........................... [[32mPASS[0m in 0.03s]
[0m17:35:24.980136 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m17:35:24.980691 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:35:24.981236 [info ] [Thread-1 (]: 10 of 12 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m17:35:24.982228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m17:35:24.982702 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:35:24.987042 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:35:24.987899 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:35:24.990322 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:35:24.991492 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:35:24.992035 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m17:35:24.992538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:25.012118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m17:35:25.012981 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m17:35:25.013791 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m17:35:25.017662 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:35:25.019503 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m17:35:25.021401 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m17:35:25.022308 [info ] [Thread-1 (]: 10 of 12 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m17:35:25.023146 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m17:35:25.023758 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:35:25.024343 [info ] [Thread-1 (]: 11 of 12 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m17:35:25.025046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m17:35:25.025569 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:35:25.034936 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:35:25.035782 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:35:25.038530 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:35:25.039398 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:35:25.039851 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m17:35:25.040340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:25.056425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:35:25.056977 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m17:35:25.057507 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:35:25.061417 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:35:25.063128 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m17:35:25.064349 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m17:35:25.065196 [info ] [Thread-1 (]: 11 of 12 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m17:35:25.066174 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m17:35:25.066705 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:35:25.067273 [info ] [Thread-1 (]: 12 of 12 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m17:35:25.067854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m17:35:25.068306 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:35:25.075131 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:35:25.075975 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:35:25.078374 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:35:25.079140 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:35:25.079577 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m17:35:25.079982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:25.095985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:35:25.096607 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m17:35:25.097089 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:35:25.101567 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:35:25.103377 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m17:35:25.104674 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m17:35:25.105501 [info ] [Thread-1 (]: 12 of 12 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m17:35:25.106263 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m17:35:25.107738 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:25.108213 [debug] [MainThread]: On master: BEGIN
[0m17:35:25.108571 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:25.124840 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m17:35:25.125442 [debug] [MainThread]: On master: COMMIT
[0m17:35:25.125869 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:25.126226 [debug] [MainThread]: On master: COMMIT
[0m17:35:25.127515 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:35:25.127946 [debug] [MainThread]: On master: Close
[0m17:35:25.128486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:25.128979 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m17:35:25.129470 [info ] [MainThread]: 
[0m17:35:25.129919 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m17:35:25.133089 [debug] [MainThread]: Command end result
[0m17:35:25.167328 [info ] [MainThread]: 
[0m17:35:25.167886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:35:25.168313 [info ] [MainThread]: 
[0m17:35:25.168791 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m17:35:25.170925 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9106011, "process_in_blocks": "0", "process_kernel_time": 0.362063, "process_mem_max_rss": "114118656", "process_out_blocks": "0", "process_user_time": 2.780071}
[0m17:35:25.171691 [debug] [MainThread]: Command `dbt test` succeeded at 17:35:25.171550 after 1.91 seconds
[0m17:35:25.172196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b46d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd8fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdb980>]}
[0m17:35:25.172659 [debug] [MainThread]: Flushing usage events
[0m17:46:48.959324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ebfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b2cf0>]}


============================== 17:46:48.964799 | 8c950a48-aa8f-499a-9ba0-8a45dc91c678 ==============================
[0m17:46:48.964799 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:46:48.965666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:46:49.190593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c950a48-aa8f-499a-9ba0-8a45dc91c678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058171d0>]}
[0m17:46:49.256741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c950a48-aa8f-499a-9ba0-8a45dc91c678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c5790>]}
[0m17:46:49.257832 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:46:49.386022 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:46:49.534314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m17:46:49.535128 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/schema.yml
[0m17:46:49.535627 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__stages.sql
[0m17:46:49.536094 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__users.sql
[0m17:46:49.536552 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__activity_types.sql
[0m17:46:49.537183 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__deal_changes.sql
[0m17:46:49.808051 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:46:49.808642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8c950a48-aa8f-499a-9ba0-8a45dc91c678', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10919e480>]}
[0m17:46:50.052357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c950a48-aa8f-499a-9ba0-8a45dc91c678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3027b0>]}
[0m17:46:50.180241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c950a48-aa8f-499a-9ba0-8a45dc91c678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0cb2c0>]}
[0m17:46:50.180897 [info ] [MainThread]: Found 6 models, 16 data tests, 6 sources, 428 macros
[0m17:46:50.181312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c950a48-aa8f-499a-9ba0-8a45dc91c678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a180620>]}
[0m17:46:50.183881 [info ] [MainThread]: 
[0m17:46:50.184536 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:46:50.189708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:46:50.254623 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:46:50.255099 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:46:50.255468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:50.284361 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m17:46:50.285971 [debug] [ThreadPool]: On list_postgres: Close
[0m17:46:50.288311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m17:46:50.294990 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:46:50.295435 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m17:46:50.295770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:50.311336 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m17:46:50.311886 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m17:46:50.312384 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m17:46:50.316233 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m17:46:50.317849 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m17:46:50.319033 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m17:46:50.326042 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:50.326490 [debug] [MainThread]: On master: BEGIN
[0m17:46:50.326830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:50.342473 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m17:46:50.343033 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:50.343546 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:46:50.348377 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m17:46:50.349922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c950a48-aa8f-499a-9ba0-8a45dc91c678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093a6060>]}
[0m17:46:50.350421 [debug] [MainThread]: On master: ROLLBACK
[0m17:46:50.352864 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:50.353400 [debug] [MainThread]: On master: BEGIN
[0m17:46:50.355421 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m17:46:50.355915 [debug] [MainThread]: On master: COMMIT
[0m17:46:50.356388 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:50.356756 [debug] [MainThread]: On master: COMMIT
[0m17:46:50.357971 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:46:50.358420 [debug] [MainThread]: On master: Close
[0m17:46:50.358983 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:50.359418 [info ] [MainThread]: 
[0m17:46:50.362214 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m17:46:50.362891 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m17:46:50.363453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m17:46:50.364019 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m17:46:50.374352 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:46:50.375572 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m17:46:50.418516 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:46:50.419442 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:46:50.419992 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m17:46:50.420395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:50.437641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:46:50.438364 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:46:50.438847 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m17:46:50.441468 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:46:50.448253 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:46:50.448733 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m17:46:50.450499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:46:50.453927 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:46:50.454433 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m17:46:50.456199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:46:50.474933 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m17:46:50.475448 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:46:50.475862 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m17:46:50.479780 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:46:50.486881 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m17:46:50.492727 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m17:46:50.493229 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m17:46:50.495882 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:46:50.498645 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m17:46:50.500261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c950a48-aa8f-499a-9ba0-8a45dc91c678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b5d700>]}
[0m17:46:50.501031 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.14s]
[0m17:46:50.502010 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m17:46:50.502596 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m17:46:50.503227 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m17:46:50.503887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m17:46:50.504329 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m17:46:50.508533 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:46:50.509788 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m17:46:50.513855 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:46:50.514709 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:46:50.515209 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m17:46:50.515691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:50.534756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m17:46:50.535439 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:46:50.535907 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m17:46:50.539325 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:46:50.542651 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:46:50.543096 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m17:46:50.544649 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:46:50.547815 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:46:50.548253 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m17:46:50.549825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:46:50.552031 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m17:46:50.552560 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:46:50.552979 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m17:46:50.555216 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:46:50.557929 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m17:46:50.558733 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m17:46:50.559155 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m17:46:50.561565 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:46:50.563157 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m17:46:50.563967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c950a48-aa8f-499a-9ba0-8a45dc91c678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a300f50>]}
[0m17:46:50.565003 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m17:46:50.565802 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m17:46:50.566321 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m17:46:50.567053 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m17:46:50.567647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m17:46:50.568074 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m17:46:50.570991 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:46:50.571906 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m17:46:50.575860 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:46:50.576716 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:46:50.577150 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m17:46:50.577547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:50.593838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:46:50.594489 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:46:50.594947 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m17:46:50.597361 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:46:50.600693 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:46:50.601209 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m17:46:50.603942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:46:50.607800 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:46:50.608254 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m17:46:50.609866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:46:50.611966 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m17:46:50.612457 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:46:50.612867 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m17:46:50.615386 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:46:50.618815 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m17:46:50.620440 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m17:46:50.620968 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m17:46:50.623507 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:46:50.625097 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m17:46:50.625690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c950a48-aa8f-499a-9ba0-8a45dc91c678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a71d6a0>]}
[0m17:46:50.626422 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m17:46:50.627158 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m17:46:50.627728 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields
[0m17:46:50.628462 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__fields ... [RUN]
[0m17:46:50.629050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__fields)
[0m17:46:50.629485 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields
[0m17:46:50.632175 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:46:50.633006 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields
[0m17:46:50.638456 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:46:50.639386 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:46:50.639820 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: BEGIN
[0m17:46:50.640218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:50.660141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m17:46:50.660812 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:46:50.661272 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m17:46:50.663663 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:46:50.666942 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:46:50.667380 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields" rename to "stg_pipedrive__fields__dbt_backup"
[0m17:46:50.668993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:46:50.672468 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:46:50.672940 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_tmp" rename to "stg_pipedrive__fields"
[0m17:46:50.674975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:46:50.677008 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m17:46:50.677445 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:46:50.677848 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: COMMIT
[0m17:46:50.679795 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:46:50.682483 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup"
[0m17:46:50.683293 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields"
[0m17:46:50.683708 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields__dbt_backup" cascade
[0m17:46:50.686074 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:46:50.687732 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields: Close
[0m17:46:50.688334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c950a48-aa8f-499a-9ba0-8a45dc91c678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7fe240>]}
[0m17:46:50.689016 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields  [[32mCREATE VIEW[0m in 0.06s]
[0m17:46:50.689760 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields
[0m17:46:50.690275 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m17:46:50.691027 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m17:46:50.691640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m17:46:50.692076 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m17:46:50.694745 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:46:50.695537 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m17:46:50.699689 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:46:50.700599 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:46:50.701061 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m17:46:50.701464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:50.718381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:46:50.719030 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:46:50.719524 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m17:46:50.723842 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:46:50.727654 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:46:50.728156 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m17:46:50.729864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:46:50.733104 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:46:50.733564 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m17:46:50.735205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:46:50.737431 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m17:46:50.737927 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:46:50.738342 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m17:46:50.740302 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:46:50.743101 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m17:46:50.743923 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m17:46:50.744346 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m17:46:50.746707 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:46:50.748267 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m17:46:50.748845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c950a48-aa8f-499a-9ba0-8a45dc91c678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6a4170>]}
[0m17:46:50.749571 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m17:46:50.750377 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m17:46:50.750903 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m17:46:50.751581 [info ] [Thread-1 (]: 6 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m17:46:50.752178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m17:46:50.752635 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m17:46:50.755769 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:46:50.756593 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m17:46:50.760212 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:46:50.760992 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:46:50.761471 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m17:46:50.761887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:50.779770 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:46:50.780507 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:46:50.780970 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified AS modified_date
FROM "postgres"."public"."users"
  );
[0m17:46:50.783673 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:46:50.787550 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:46:50.788077 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m17:46:50.789748 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:46:50.794725 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:46:50.795231 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m17:46:50.796856 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:46:50.798844 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m17:46:50.799333 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:46:50.799749 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m17:46:50.801607 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:46:50.804359 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m17:46:50.805225 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m17:46:50.805656 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m17:46:50.807902 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:46:50.809573 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m17:46:50.810201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c950a48-aa8f-499a-9ba0-8a45dc91c678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a867230>]}
[0m17:46:50.810894 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m17:46:50.811634 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m17:46:50.813036 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:50.813466 [debug] [MainThread]: On master: BEGIN
[0m17:46:50.813823 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:46:50.829739 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m17:46:50.830387 [debug] [MainThread]: On master: COMMIT
[0m17:46:50.830817 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:50.831239 [debug] [MainThread]: On master: COMMIT
[0m17:46:50.832534 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:46:50.832952 [debug] [MainThread]: On master: Close
[0m17:46:50.833452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:50.833796 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__users' was properly closed.
[0m17:46:50.834252 [info ] [MainThread]: 
[0m17:46:50.834670 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m17:46:50.836631 [debug] [MainThread]: Command end result
[0m17:46:50.868315 [info ] [MainThread]: 
[0m17:46:50.868846 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:46:50.869246 [info ] [MainThread]: 
[0m17:46:50.869657 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:46:50.871587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0859716, "process_in_blocks": "0", "process_kernel_time": 0.371795, "process_mem_max_rss": "115679232", "process_out_blocks": "0", "process_user_time": 3.082123}
[0m17:46:50.872322 [debug] [MainThread]: Command `dbt run` succeeded at 17:46:50.872191 after 2.09 seconds
[0m17:46:50.872796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055bed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109299ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092987a0>]}
[0m17:46:50.873222 [debug] [MainThread]: Flushing usage events
[0m18:18:39.602756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f03020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106962b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac6d50>]}


============================== 18:18:39.610773 | 14e6b1fa-5975-4243-8dd8-389f46bed34c ==============================
[0m18:18:39.610773 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:18:39.612356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:18:39.896103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14e6b1fa-5975-4243-8dd8-389f46bed34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f03b00>]}
[0m18:18:39.964643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14e6b1fa-5975-4243-8dd8-389f46bed34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec5340>]}
[0m18:18:39.966423 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:18:40.109720 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:18:40.287100 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m18:18:40.287814 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/base/base_pipedrive__fields.sql
[0m18:18:40.288209 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/staging/stg_pipedrive__fields.sql
[0m18:18:40.288710 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__stages.sql
[0m18:18:40.584404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14e6b1fa-5975-4243-8dd8-389f46bed34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793d3a0>]}
[0m18:18:40.732386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14e6b1fa-5975-4243-8dd8-389f46bed34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1ed50>]}
[0m18:18:40.733108 [info ] [MainThread]: Found 6 models, 16 data tests, 6 sources, 428 macros
[0m18:18:40.733573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14e6b1fa-5975-4243-8dd8-389f46bed34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd2e70>]}
[0m18:18:40.736319 [info ] [MainThread]: 
[0m18:18:40.737013 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:18:40.741646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:18:40.815837 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:18:40.816433 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:18:40.816840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:40.871777 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.055 seconds
[0m18:18:40.873556 [debug] [ThreadPool]: On list_postgres: Close
[0m18:18:40.875480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m18:18:40.882144 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:18:40.882612 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m18:18:40.883087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:40.898464 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m18:18:40.899253 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:18:40.899754 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m18:18:40.903728 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m18:18:40.905490 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m18:18:40.906765 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m18:18:40.913027 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:40.913520 [debug] [MainThread]: On master: BEGIN
[0m18:18:40.913870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:18:40.932445 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m18:18:40.932970 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:40.933450 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:18:40.939094 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m18:18:40.940656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14e6b1fa-5975-4243-8dd8-389f46bed34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542a210>]}
[0m18:18:40.941162 [debug] [MainThread]: On master: ROLLBACK
[0m18:18:40.942438 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:40.942847 [debug] [MainThread]: On master: BEGIN
[0m18:18:40.944903 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:18:40.945398 [debug] [MainThread]: On master: COMMIT
[0m18:18:40.945835 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:40.946439 [debug] [MainThread]: On master: COMMIT
[0m18:18:40.949519 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m18:18:40.950417 [debug] [MainThread]: On master: Close
[0m18:18:40.951401 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:40.952065 [info ] [MainThread]: 
[0m18:18:40.955835 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m18:18:40.956553 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m18:18:40.957116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m18:18:40.957561 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m18:18:40.968041 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:18:40.969136 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m18:18:41.012091 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:18:41.013672 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:18:41.014265 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m18:18:41.014781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:41.031340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m18:18:41.032234 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:18:41.032740 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m18:18:41.036723 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:18:41.043891 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:18:41.044400 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m18:18:41.046331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:18:41.062903 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m18:18:41.063420 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:18:41.063830 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m18:18:41.068310 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:18:41.075486 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m18:18:41.081269 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:18:41.081768 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m18:18:41.083716 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:18:41.086508 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m18:18:41.088212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14e6b1fa-5975-4243-8dd8-389f46bed34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c55e0>]}
[0m18:18:41.088995 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.13s]
[0m18:18:41.090025 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m18:18:41.090622 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m18:18:41.091186 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m18:18:41.091813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m18:18:41.092272 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m18:18:41.095398 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:18:41.096365 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m18:18:41.101850 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:18:41.102733 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:18:41.103166 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m18:18:41.103563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:41.121563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:18:41.122320 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:18:41.122830 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m18:18:41.125482 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:18:41.129024 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:18:41.129530 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m18:18:41.131187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:18:41.134712 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:18:41.135198 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m18:18:41.136896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:18:41.141331 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m18:18:41.141844 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:18:41.142264 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m18:18:41.145437 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:18:41.148216 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m18:18:41.149073 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:18:41.149637 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m18:18:41.152380 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:18:41.154082 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m18:18:41.154859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14e6b1fa-5975-4243-8dd8-389f46bed34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee3830>]}
[0m18:18:41.155688 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m18:18:41.156557 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m18:18:41.157207 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m18:18:41.157940 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m18:18:41.158509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m18:18:41.158949 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m18:18:41.161881 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:18:41.163087 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m18:18:41.168792 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:18:41.169686 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:18:41.170155 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m18:18:41.170553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:41.188779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:18:41.189415 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:18:41.189895 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m18:18:41.193101 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:18:41.197402 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:18:41.197899 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m18:18:41.199707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:18:41.202985 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:18:41.203441 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m18:18:41.205143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:18:41.207167 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m18:18:41.207658 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:18:41.208079 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m18:18:41.209884 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:18:41.212575 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m18:18:41.213416 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:18:41.213850 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m18:18:41.216818 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:18:41.218436 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m18:18:41.219022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14e6b1fa-5975-4243-8dd8-389f46bed34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efdd60>]}
[0m18:18:41.219720 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m18:18:41.220543 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m18:18:41.221073 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m18:18:41.221751 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m18:18:41.222352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m18:18:41.222799 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m18:18:41.225585 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:18:41.226373 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m18:18:41.230095 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:18:41.230850 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:18:41.231282 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m18:18:41.231691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:41.250268 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:18:41.251085 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:18:41.251554 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m18:18:41.254186 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:18:41.257450 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:18:41.257912 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m18:18:41.259561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:18:41.262925 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:18:41.263401 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m18:18:41.264923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:18:41.266941 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m18:18:41.267410 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:18:41.267823 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m18:18:41.269811 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:18:41.272475 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m18:18:41.273379 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:18:41.273804 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m18:18:41.276317 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:18:41.277913 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m18:18:41.278512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14e6b1fa-5975-4243-8dd8-389f46bed34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd7680>]}
[0m18:18:41.279237 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m18:18:41.279973 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m18:18:41.280513 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m18:18:41.281288 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m18:18:41.281927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m18:18:41.282467 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m18:18:41.285395 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:18:41.286571 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m18:18:41.292359 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:18:41.293339 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:18:41.293753 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m18:18:41.294163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:41.311561 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m18:18:41.312236 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:18:41.312729 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m18:18:41.315501 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:18:41.320005 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:18:41.320479 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m18:18:41.322167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:18:41.325265 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:18:41.325706 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m18:18:41.327439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:18:41.329543 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m18:18:41.330021 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:18:41.330506 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m18:18:41.332810 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:18:41.335467 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m18:18:41.336278 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:18:41.336698 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m18:18:41.339228 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:18:41.340859 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m18:18:41.341454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14e6b1fa-5975-4243-8dd8-389f46bed34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d8eab0>]}
[0m18:18:41.342208 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m18:18:41.342961 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m18:18:41.343554 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m18:18:41.344265 [info ] [Thread-1 (]: 6 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m18:18:41.344937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m18:18:41.345399 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m18:18:41.348685 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:18:41.349608 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m18:18:41.355228 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:18:41.356102 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:18:41.356539 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m18:18:41.356938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:41.376894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m18:18:41.377750 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:18:41.378408 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified AS modified_date
FROM "postgres"."public"."users"
  );
[0m18:18:41.381205 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:18:41.385060 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:18:41.385547 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m18:18:41.387369 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:18:41.390739 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:18:41.391301 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m18:18:41.393711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:18:41.395666 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m18:18:41.396341 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:18:41.396781 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m18:18:41.398743 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:18:41.401768 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m18:18:41.402641 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:18:41.403088 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m18:18:41.405586 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:18:41.407226 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m18:18:41.407870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14e6b1fa-5975-4243-8dd8-389f46bed34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3f860>]}
[0m18:18:41.408726 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m18:18:41.409580 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m18:18:41.411107 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:41.411532 [debug] [MainThread]: On master: BEGIN
[0m18:18:41.411878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:18:41.427515 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m18:18:41.428251 [debug] [MainThread]: On master: COMMIT
[0m18:18:41.428820 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:41.429365 [debug] [MainThread]: On master: COMMIT
[0m18:18:41.431893 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:18:41.432450 [debug] [MainThread]: On master: Close
[0m18:18:41.432962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:41.433432 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__users' was properly closed.
[0m18:18:41.433892 [info ] [MainThread]: 
[0m18:18:41.434453 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m18:18:41.437005 [debug] [MainThread]: Command end result
[0m18:18:41.472559 [info ] [MainThread]: 
[0m18:18:41.473224 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:18:41.473658 [info ] [MainThread]: 
[0m18:18:41.474085 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:18:41.476637 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9656836, "process_in_blocks": "0", "process_kernel_time": 0.556344, "process_mem_max_rss": "113532928", "process_out_blocks": "0", "process_user_time": 3.11733}
[0m18:18:41.477429 [debug] [MainThread]: Command `dbt run` succeeded at 18:18:41.477284 after 1.97 seconds
[0m18:18:41.477934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e3ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106547bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a81e50>]}
[0m18:18:41.478414 [debug] [MainThread]: Flushing usage events
[0m18:22:12.229481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10866f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10866ec30>]}


============================== 18:22:12.237238 | f6e11cac-7bf8-4042-8179-ab50f2a00091 ==============================
[0m18:22:12.237238 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:22:12.238220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:22:12.522668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6e11cac-7bf8-4042-8179-ab50f2a00091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107510260>]}
[0m18:22:12.592087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6e11cac-7bf8-4042-8179-ab50f2a00091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f1a8d0>]}
[0m18:22:12.593470 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:22:12.740404 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:22:12.927268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:22:12.927784 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:22:12.992464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6e11cac-7bf8-4042-8179-ab50f2a00091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c69190>]}
[0m18:22:13.140337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6e11cac-7bf8-4042-8179-ab50f2a00091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109500fb0>]}
[0m18:22:13.141043 [info ] [MainThread]: Found 6 models, 16 data tests, 6 sources, 428 macros
[0m18:22:13.141553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6e11cac-7bf8-4042-8179-ab50f2a00091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ab440>]}
[0m18:22:13.144353 [info ] [MainThread]: 
[0m18:22:13.145077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:22:13.150271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:22:13.229761 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:22:13.230223 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:22:13.230589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:13.282855 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.052 seconds
[0m18:22:13.284551 [debug] [ThreadPool]: On list_postgres: Close
[0m18:22:13.286261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m18:22:13.294031 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:22:13.294473 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m18:22:13.294816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:22:13.310536 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m18:22:13.311042 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:22:13.311502 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m18:22:13.315910 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m18:22:13.317560 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m18:22:13.318846 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m18:22:13.325182 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:13.325622 [debug] [MainThread]: On master: BEGIN
[0m18:22:13.325961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:22:13.341285 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m18:22:13.341892 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:13.342364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:22:13.347319 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m18:22:13.348991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6e11cac-7bf8-4042-8179-ab50f2a00091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986c8f0>]}
[0m18:22:13.349510 [debug] [MainThread]: On master: ROLLBACK
[0m18:22:13.351113 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:13.351586 [debug] [MainThread]: On master: BEGIN
[0m18:22:13.353541 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:22:13.354019 [debug] [MainThread]: On master: COMMIT
[0m18:22:13.354417 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:13.354767 [debug] [MainThread]: On master: COMMIT
[0m18:22:13.355891 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:22:13.356283 [debug] [MainThread]: On master: Close
[0m18:22:13.356813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:22:13.357226 [info ] [MainThread]: 
[0m18:22:13.360388 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m18:22:13.361053 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m18:22:13.361605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m18:22:13.362051 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m18:22:13.371596 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:22:13.372536 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m18:22:13.414890 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:22:13.415871 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:22:13.416353 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m18:22:13.416825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:13.432268 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m18:22:13.433192 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:22:13.433680 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m18:22:13.436160 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:22:13.443085 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:22:13.443583 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m18:22:13.445889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:22:13.449178 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:22:13.449816 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m18:22:13.452646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:22:13.471707 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m18:22:13.472252 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:22:13.472757 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m18:22:13.477228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:22:13.484629 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m18:22:13.490766 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:22:13.491255 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m18:22:13.494890 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:22:13.497641 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m18:22:13.499188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6e11cac-7bf8-4042-8179-ab50f2a00091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f19910>]}
[0m18:22:13.500150 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m18:22:13.501246 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m18:22:13.501875 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m18:22:13.502506 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m18:22:13.503076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m18:22:13.503503 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m18:22:13.506393 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:22:13.507179 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m18:22:13.512842 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:22:13.513744 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:22:13.514184 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m18:22:13.514580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:13.534768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m18:22:13.535436 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:22:13.535890 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m18:22:13.539525 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:22:13.542992 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:22:13.543468 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m18:22:13.545213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:22:13.548453 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:22:13.548963 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m18:22:13.550907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:22:13.552880 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m18:22:13.553441 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:22:13.553876 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m18:22:13.556179 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:22:13.559216 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m18:22:13.560183 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:22:13.560640 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m18:22:13.563265 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:22:13.564899 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m18:22:13.565529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6e11cac-7bf8-4042-8179-ab50f2a00091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109883770>]}
[0m18:22:13.566691 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m18:22:13.567519 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m18:22:13.568144 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m18:22:13.568905 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m18:22:13.569490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m18:22:13.569932 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m18:22:13.572785 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:22:13.573645 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m18:22:13.578148 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:22:13.579052 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:22:13.579484 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m18:22:13.579880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:13.598152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:22:13.598805 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:22:13.599289 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m18:22:13.603559 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:22:13.606882 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:22:13.607330 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m18:22:13.608893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:22:13.612107 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:22:13.612557 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m18:22:13.614164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:22:13.616298 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m18:22:13.616890 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:22:13.617342 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m18:22:13.619188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:22:13.621980 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m18:22:13.622861 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:22:13.623300 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m18:22:13.625759 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:22:13.627332 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m18:22:13.627904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6e11cac-7bf8-4042-8179-ab50f2a00091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10993bb30>]}
[0m18:22:13.628576 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m18:22:13.629301 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m18:22:13.629812 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m18:22:13.630519 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m18:22:13.631091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m18:22:13.631529 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m18:22:13.634442 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:22:13.635253 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m18:22:13.639231 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:22:13.640080 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:22:13.640503 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m18:22:13.640891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:13.656473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m18:22:13.657167 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:22:13.657659 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m18:22:13.660184 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:22:13.663652 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:22:13.664180 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m18:22:13.666146 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:22:13.672799 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:22:13.673609 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m18:22:13.676356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:22:13.678397 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m18:22:13.678905 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:22:13.679302 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m18:22:13.681494 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:22:13.684928 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m18:22:13.685788 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:22:13.686212 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m18:22:13.688861 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:22:13.691113 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m18:22:13.691743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6e11cac-7bf8-4042-8179-ab50f2a00091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b9c70>]}
[0m18:22:13.692445 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m18:22:13.693178 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m18:22:13.693697 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m18:22:13.694377 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m18:22:13.694978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m18:22:13.695519 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m18:22:13.698621 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:22:13.700040 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m18:22:13.703822 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:22:13.704657 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:22:13.705212 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m18:22:13.705902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:13.723634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:22:13.724450 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:22:13.725043 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m18:22:13.727464 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:22:13.730832 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:22:13.731298 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m18:22:13.732907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:22:13.736373 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:22:13.736899 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m18:22:13.738661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:22:13.740699 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m18:22:13.741407 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:22:13.741875 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m18:22:13.743976 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:22:13.746631 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m18:22:13.747488 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:22:13.747922 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m18:22:13.750314 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:22:13.751877 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m18:22:13.752478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6e11cac-7bf8-4042-8179-ab50f2a00091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10950ad20>]}
[0m18:22:13.753244 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m18:22:13.754103 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m18:22:13.754658 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m18:22:13.755400 [info ] [Thread-1 (]: 6 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m18:22:13.755980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m18:22:13.756435 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m18:22:13.759251 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:22:13.760063 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m18:22:13.763980 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:22:13.764778 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:22:13.765219 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m18:22:13.765611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:13.783820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:22:13.784445 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:22:13.784980 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified AS modified_date
FROM "postgres"."public"."users"
  );
[0m18:22:13.787553 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:22:13.790898 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:22:13.791379 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m18:22:13.793283 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:22:13.796578 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:22:13.797058 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m18:22:13.798722 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:22:13.800899 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m18:22:13.801450 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:22:13.801941 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m18:22:13.803964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:22:13.808161 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m18:22:13.809067 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:22:13.809511 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m18:22:13.811869 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:22:13.813441 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m18:22:13.814019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6e11cac-7bf8-4042-8179-ab50f2a00091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109987b30>]}
[0m18:22:13.814683 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m18:22:13.815393 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m18:22:13.816879 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:13.817375 [debug] [MainThread]: On master: BEGIN
[0m18:22:13.817770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:22:13.834266 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m18:22:13.834862 [debug] [MainThread]: On master: COMMIT
[0m18:22:13.835267 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:13.835624 [debug] [MainThread]: On master: COMMIT
[0m18:22:13.836817 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:22:13.837239 [debug] [MainThread]: On master: Close
[0m18:22:13.837744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:22:13.838129 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__users' was properly closed.
[0m18:22:13.838578 [info ] [MainThread]: 
[0m18:22:13.838999 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m18:22:13.841048 [debug] [MainThread]: Command end result
[0m18:22:13.874001 [info ] [MainThread]: 
[0m18:22:13.874512 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:22:13.874905 [info ] [MainThread]: 
[0m18:22:13.875321 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:22:13.877560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7366999, "process_in_blocks": "0", "process_kernel_time": 0.568019, "process_mem_max_rss": "109260800", "process_out_blocks": "0", "process_user_time": 2.951026}
[0m18:22:13.878289 [debug] [MainThread]: Command `dbt run` succeeded at 18:22:13.878148 after 1.74 seconds
[0m18:22:13.878755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104986d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f8320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f8da0>]}
[0m18:22:13.879174 [debug] [MainThread]: Flushing usage events
[0m18:23:44.842056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126506b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be2a80>]}


============================== 18:23:44.847450 | 9c88c8ad-7a82-45c3-bd95-45843b9a76ef ==============================
[0m18:23:44.847450 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:23:44.848350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:23:45.085248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c88c8ad-7a82-45c3-bd95-45843b9a76ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d16ba0>]}
[0m18:23:45.150629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c88c8ad-7a82-45c3-bd95-45843b9a76ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112653860>]}
[0m18:23:45.151700 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:23:45.284397 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:23:45.436266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:23:45.436732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:23:45.494519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c88c8ad-7a82-45c3-bd95-45843b9a76ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131d4c80>]}
[0m18:23:45.622955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c88c8ad-7a82-45c3-bd95-45843b9a76ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a5f530>]}
[0m18:23:45.623517 [info ] [MainThread]: Found 6 models, 16 data tests, 6 sources, 428 macros
[0m18:23:45.623931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c88c8ad-7a82-45c3-bd95-45843b9a76ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cf66c0>]}
[0m18:23:45.626521 [info ] [MainThread]: 
[0m18:23:45.627181 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:23:45.631477 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:23:45.697712 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:23:45.698190 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:23:45.698570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:45.730095 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.031 seconds
[0m18:23:45.731653 [debug] [ThreadPool]: On list_postgres: Close
[0m18:23:45.733547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m18:23:45.741172 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:23:45.741624 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m18:23:45.741965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:45.757653 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m18:23:45.758220 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:23:45.758662 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m18:23:45.762757 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m18:23:45.764368 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m18:23:45.765626 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m18:23:45.772092 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:45.772538 [debug] [MainThread]: On master: BEGIN
[0m18:23:45.772878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:45.788272 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m18:23:45.788780 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:45.789288 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:23:45.794052 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m18:23:45.795594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c88c8ad-7a82-45c3-bd95-45843b9a76ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131af620>]}
[0m18:23:45.796094 [debug] [MainThread]: On master: ROLLBACK
[0m18:23:45.797365 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:45.797770 [debug] [MainThread]: On master: BEGIN
[0m18:23:45.799669 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:23:45.800245 [debug] [MainThread]: On master: COMMIT
[0m18:23:45.800692 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:45.801035 [debug] [MainThread]: On master: COMMIT
[0m18:23:45.802329 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:23:45.802749 [debug] [MainThread]: On master: Close
[0m18:23:45.803296 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:23:45.803780 [info ] [MainThread]: 
[0m18:23:45.806196 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m18:23:45.806868 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m18:23:45.807562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m18:23:45.808061 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m18:23:45.819527 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:23:45.820511 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m18:23:45.860423 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:23:45.861332 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:23:45.861773 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m18:23:45.862171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:45.878242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m18:23:45.878872 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:23:45.879325 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m18:23:45.881790 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:23:45.888893 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:23:45.889417 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m18:23:45.891203 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:45.894394 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:23:45.894841 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m18:23:45.896734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:45.915311 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m18:23:45.915823 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:23:45.916300 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m18:23:45.918904 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:23:45.925617 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m18:23:45.931358 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m18:23:45.931846 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m18:23:45.934816 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:23:45.937575 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m18:23:45.939247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c88c8ad-7a82-45c3-bd95-45843b9a76ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111489670>]}
[0m18:23:45.940021 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.13s]
[0m18:23:45.940957 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m18:23:45.941543 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m18:23:45.942199 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m18:23:45.942981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m18:23:45.943492 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m18:23:45.946458 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:23:45.947284 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m18:23:45.953521 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:23:45.954414 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:23:45.954901 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m18:23:45.956488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:45.975044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:23:45.976399 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:23:45.976968 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m18:23:45.979813 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:23:45.983591 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:23:45.984191 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m18:23:45.986061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:45.989771 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:23:45.990308 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m18:23:45.991923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:45.994460 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m18:23:45.995003 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:23:45.995439 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m18:23:45.997238 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:23:45.999829 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m18:23:46.000799 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m18:23:46.001258 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m18:23:46.003649 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:23:46.005247 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m18:23:46.005843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c88c8ad-7a82-45c3-bd95-45843b9a76ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113913f20>]}
[0m18:23:46.006626 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m18:23:46.007436 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m18:23:46.008545 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m18:23:46.009783 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m18:23:46.010652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m18:23:46.011523 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m18:23:46.015492 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:23:46.018464 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m18:23:46.022660 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:23:46.023529 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:23:46.023962 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m18:23:46.024411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:46.043382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m18:23:46.044201 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:23:46.044882 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m18:23:46.048240 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:23:46.051673 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:23:46.052153 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m18:23:46.054021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:46.057257 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:23:46.057709 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m18:23:46.059322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:46.061215 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m18:23:46.061747 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:23:46.062248 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m18:23:46.064261 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:23:46.067023 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m18:23:46.067885 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m18:23:46.068320 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m18:23:46.070718 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:23:46.072303 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m18:23:46.072888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c88c8ad-7a82-45c3-bd95-45843b9a76ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dc00b0>]}
[0m18:23:46.073635 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m18:23:46.074393 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m18:23:46.074912 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m18:23:46.075636 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m18:23:46.076253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m18:23:46.076697 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m18:23:46.079520 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:23:46.080336 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m18:23:46.084220 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:23:46.085296 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:23:46.085865 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m18:23:46.086284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:46.103030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m18:23:46.103672 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:23:46.104122 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m18:23:46.106579 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:23:46.110094 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:23:46.110723 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m18:23:46.113505 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:23:46.119130 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:23:46.119778 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m18:23:46.122995 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:23:46.126394 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m18:23:46.126964 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:23:46.127400 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m18:23:46.129732 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:23:46.132712 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m18:23:46.133948 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m18:23:46.134496 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m18:23:46.137617 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:23:46.139377 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m18:23:46.140035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c88c8ad-7a82-45c3-bd95-45843b9a76ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ef3fb0>]}
[0m18:23:46.140784 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m18:23:46.141666 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m18:23:46.142218 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m18:23:46.143115 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m18:23:46.143778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m18:23:46.144250 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m18:23:46.148117 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:23:46.149085 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m18:23:46.154166 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:23:46.155444 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:23:46.155940 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m18:23:46.156537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:46.178512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m18:23:46.179437 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:23:46.180020 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m18:23:46.183504 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:23:46.187423 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:23:46.187928 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m18:23:46.189773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:46.209487 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:23:46.210041 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m18:23:46.215339 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m18:23:46.217678 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m18:23:46.218180 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:23:46.218708 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m18:23:46.221196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:23:46.223802 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m18:23:46.224608 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m18:23:46.225037 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m18:23:46.227607 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:23:46.229175 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m18:23:46.229789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c88c8ad-7a82-45c3-bd95-45843b9a76ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ef6c30>]}
[0m18:23:46.230701 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.09s]
[0m18:23:46.231638 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m18:23:46.232171 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m18:23:46.232882 [info ] [Thread-1 (]: 6 of 6 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m18:23:46.233781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m18:23:46.234252 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m18:23:46.237105 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:23:46.237922 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m18:23:46.241755 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:23:46.242512 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:23:46.242962 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m18:23:46.243357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:46.262106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m18:23:46.262904 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:23:46.263485 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified AS modified_date
FROM "postgres"."public"."users"
  );
[0m18:23:46.266472 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:23:46.269723 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:23:46.270173 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m18:23:46.271916 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:46.275151 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:23:46.275635 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m18:23:46.277259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:46.279449 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m18:23:46.279919 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:23:46.280381 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m18:23:46.282606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:23:46.286582 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m18:23:46.287450 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m18:23:46.287885 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m18:23:46.291188 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:23:46.292769 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m18:23:46.293376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c88c8ad-7a82-45c3-bd95-45843b9a76ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ab3b30>]}
[0m18:23:46.294048 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m18:23:46.294767 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m18:23:46.296207 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:46.296634 [debug] [MainThread]: On master: BEGIN
[0m18:23:46.296978 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:23:46.312052 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m18:23:46.312759 [debug] [MainThread]: On master: COMMIT
[0m18:23:46.313443 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:46.313906 [debug] [MainThread]: On master: COMMIT
[0m18:23:46.315307 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:23:46.315858 [debug] [MainThread]: On master: Close
[0m18:23:46.316667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:46.317260 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__users' was properly closed.
[0m18:23:46.317742 [info ] [MainThread]: 
[0m18:23:46.318234 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m18:23:46.319994 [debug] [MainThread]: Command end result
[0m18:23:46.353921 [info ] [MainThread]: 
[0m18:23:46.354452 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:23:46.354847 [info ] [MainThread]: 
[0m18:23:46.355262 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:23:46.357040 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5951395, "process_in_blocks": "0", "process_kernel_time": 0.348519, "process_mem_max_rss": "109092864", "process_out_blocks": "0", "process_user_time": 2.575022}
[0m18:23:46.357781 [debug] [MainThread]: Command `dbt run` succeeded at 18:23:46.357646 after 1.60 seconds
[0m18:23:46.358261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ea4ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11272b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be28d0>]}
[0m18:23:46.358685 [debug] [MainThread]: Flushing usage events
[0m18:23:55.986909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11264ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126870e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112686c00>]}


============================== 18:23:55.992612 | a6975bc0-8212-4f1a-8ff4-588c12261733 ==============================
[0m18:23:55.992612 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:23:55.994090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:23:56.234978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6975bc0-8212-4f1a-8ff4-588c12261733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11152c560>]}
[0m18:23:56.324253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6975bc0-8212-4f1a-8ff4-588c12261733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11152c290>]}
[0m18:23:56.325198 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:23:56.464218 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:23:56.610766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:23:56.611226 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:23:56.671182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6975bc0-8212-4f1a-8ff4-588c12261733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c85670>]}
[0m18:23:56.819169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6975bc0-8212-4f1a-8ff4-588c12261733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136c6c00>]}
[0m18:23:56.819751 [info ] [MainThread]: Found 6 models, 16 data tests, 6 sources, 428 macros
[0m18:23:56.820172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6975bc0-8212-4f1a-8ff4-588c12261733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112526b40>]}
[0m18:23:56.823349 [info ] [MainThread]: 
[0m18:23:56.824438 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:23:56.831644 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m18:23:56.900152 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:23:56.900646 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m18:23:56.901189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:56.929978 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m18:23:56.930730 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m18:23:56.931319 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m18:23:56.935722 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m18:23:56.937453 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m18:23:56.938676 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m18:23:56.945186 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:56.945629 [debug] [MainThread]: On master: BEGIN
[0m18:23:56.945971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:56.964461 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m18:23:56.964977 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:56.965461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:23:56.970340 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m18:23:56.971897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6975bc0-8212-4f1a-8ff4-588c12261733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11367f2c0>]}
[0m18:23:56.972388 [debug] [MainThread]: On master: ROLLBACK
[0m18:23:56.973784 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:56.974197 [debug] [MainThread]: On master: BEGIN
[0m18:23:56.976123 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:23:56.976714 [debug] [MainThread]: On master: COMMIT
[0m18:23:56.977105 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:56.977503 [debug] [MainThread]: On master: COMMIT
[0m18:23:56.978715 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:23:56.979157 [debug] [MainThread]: On master: Close
[0m18:23:56.979689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:23:56.980158 [info ] [MainThread]: 
[0m18:23:56.982910 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m18:23:56.983482 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m18:23:56.984109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m18:23:56.984758 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m18:23:57.008834 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m18:23:57.011232 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m18:23:57.032697 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m18:23:57.034170 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m18:23:57.034709 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m18:23:57.035128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.050939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m18:23:57.051819 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m18:23:57.052335 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m18:23:57.056825 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:23:57.061521 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m18:23:57.062902 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m18:23:57.063693 [info ] [Thread-1 (]: 1 of 16 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.08s]
[0m18:23:57.064486 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m18:23:57.065042 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m18:23:57.065571 [info ] [Thread-1 (]: 2 of 16 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m18:23:57.066240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m18:23:57.066715 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m18:23:57.069933 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m18:23:57.070822 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m18:23:57.073523 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m18:23:57.075033 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m18:23:57.075837 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m18:23:57.076353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.096037 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m18:23:57.096663 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m18:23:57.097117 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m18:23:57.103400 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m18:23:57.105252 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m18:23:57.106714 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m18:23:57.108095 [info ] [Thread-1 (]: 2 of 16 PASS assert_change_stage_references_stage_id ........................... [[32mPASS[0m in 0.04s]
[0m18:23:57.109012 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m18:23:57.109737 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m18:23:57.110362 [info ] [Thread-1 (]: 3 of 16 START test assert_change_user_references_user_id ....................... [RUN]
[0m18:23:57.110994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m18:23:57.111469 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m18:23:57.115561 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m18:23:57.116463 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m18:23:57.119008 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m18:23:57.119877 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m18:23:57.120302 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m18:23:57.120690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.141430 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m18:23:57.142107 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m18:23:57.142576 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m18:23:57.147761 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m18:23:57.149721 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m18:23:57.151221 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m18:23:57.152045 [info ] [Thread-1 (]: 3 of 16 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.04s]
[0m18:23:57.152963 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m18:23:57.153640 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m18:23:57.154155 [info ] [Thread-1 (]: 4 of 16 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m18:23:57.154800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m18:23:57.155291 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m18:23:57.165413 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m18:23:57.166899 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m18:23:57.169659 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m18:23:57.170540 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m18:23:57.171011 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m18:23:57.171451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.189911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:23:57.190558 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m18:23:57.191024 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m18:23:57.194288 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:23:57.196084 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m18:23:57.197339 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m18:23:57.198103 [info ] [Thread-1 (]: 4 of 16 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.04s]
[0m18:23:57.198919 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m18:23:57.199472 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m18:23:57.200015 [info ] [Thread-1 (]: 5 of 16 START test not_null_stg_pipedrive__activity_due_date ................... [RUN]
[0m18:23:57.200835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5)
[0m18:23:57.201325 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m18:23:57.205872 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m18:23:57.207244 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m18:23:57.210239 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m18:23:57.211542 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m18:23:57.211999 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: BEGIN
[0m18:23:57.212407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.228167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m18:23:57.228856 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m18:23:57.229315 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_date is null



      
    ) dbt_internal_test
[0m18:23:57.231989 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:23:57.233667 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: ROLLBACK
[0m18:23:57.234943 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: Close
[0m18:23:57.235683 [info ] [Thread-1 (]: 5 of 16 PASS not_null_stg_pipedrive__activity_due_date ......................... [[32mPASS[0m in 0.03s]
[0m18:23:57.236416 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m18:23:57.237004 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m18:23:57.237575 [info ] [Thread-1 (]: 6 of 16 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m18:23:57.238591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m18:23:57.239295 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m18:23:57.244141 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m18:23:57.244976 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m18:23:57.247351 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m18:23:57.248596 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m18:23:57.249047 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m18:23:57.249450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.266577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m18:23:57.267467 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m18:23:57.268100 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m18:23:57.271033 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:23:57.272919 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m18:23:57.274245 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m18:23:57.274979 [info ] [Thread-1 (]: 6 of 16 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m18:23:57.275708 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m18:23:57.276219 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m18:23:57.276726 [info ] [Thread-1 (]: 7 of 16 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m18:23:57.277415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m18:23:57.278007 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m18:23:57.282424 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m18:23:57.283286 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m18:23:57.286059 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m18:23:57.287323 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m18:23:57.287819 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m18:23:57.288236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.305122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m18:23:57.305760 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m18:23:57.306217 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m18:23:57.308703 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:23:57.310410 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m18:23:57.311751 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m18:23:57.312481 [info ] [Thread-1 (]: 7 of 16 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m18:23:57.313234 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m18:23:57.313813 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m18:23:57.314396 [info ] [Thread-1 (]: 8 of 16 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m18:23:57.315325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m18:23:57.315852 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m18:23:57.321024 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m18:23:57.322249 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m18:23:57.326731 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m18:23:57.327893 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m18:23:57.329031 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m18:23:57.330138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.352679 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m18:23:57.353261 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m18:23:57.353837 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m18:23:57.356905 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:23:57.358882 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m18:23:57.360241 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m18:23:57.361043 [info ] [Thread-1 (]: 8 of 16 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.05s]
[0m18:23:57.362059 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m18:23:57.362606 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m18:23:57.363125 [info ] [Thread-1 (]: 9 of 16 START test not_null_stg_pipedrive__deal_changes_id ..................... [RUN]
[0m18:23:57.363791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m18:23:57.364341 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m18:23:57.370208 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m18:23:57.371403 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m18:23:57.373808 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m18:23:57.374553 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m18:23:57.374986 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m18:23:57.375383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.393864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:23:57.394539 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m18:23:57.394991 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m18:23:57.397981 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:23:57.399735 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m18:23:57.401295 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m18:23:57.402177 [info ] [Thread-1 (]: 9 of 16 PASS not_null_stg_pipedrive__deal_changes_id ........................... [[32mPASS[0m in 0.04s]
[0m18:23:57.402986 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m18:23:57.403568 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m18:23:57.404246 [info ] [Thread-1 (]: 10 of 16 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m18:23:57.404975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m18:23:57.405889 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m18:23:57.411621 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m18:23:57.413012 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m18:23:57.415654 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m18:23:57.416562 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m18:23:57.417028 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m18:23:57.417430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.435368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:23:57.436271 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m18:23:57.437134 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m18:23:57.440832 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:23:57.442851 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m18:23:57.444400 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m18:23:57.445134 [info ] [Thread-1 (]: 10 of 16 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m18:23:57.445963 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m18:23:57.446477 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m18:23:57.446921 [info ] [Thread-1 (]: 11 of 16 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m18:23:57.447613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m18:23:57.448078 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m18:23:57.452494 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m18:23:57.453354 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m18:23:57.455846 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m18:23:57.456721 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m18:23:57.457260 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m18:23:57.457673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.476085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:23:57.476829 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m18:23:57.477284 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m18:23:57.479766 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:23:57.481750 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m18:23:57.483350 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m18:23:57.484076 [info ] [Thread-1 (]: 11 of 16 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m18:23:57.485092 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m18:23:57.485689 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m18:23:57.486143 [info ] [Thread-1 (]: 12 of 16 START test not_null_stg_pipedrive__users_modified_date ................ [RUN]
[0m18:23:57.486837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86)
[0m18:23:57.487303 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m18:23:57.491780 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m18:23:57.492653 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m18:23:57.495154 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m18:23:57.495988 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m18:23:57.496424 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: BEGIN
[0m18:23:57.496824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.514667 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:23:57.515517 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m18:23:57.516020 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_date is null



      
    ) dbt_internal_test
[0m18:23:57.518566 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:23:57.520293 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: ROLLBACK
[0m18:23:57.521763 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: Close
[0m18:23:57.522513 [info ] [Thread-1 (]: 12 of 16 PASS not_null_stg_pipedrive__users_modified_date ...................... [[32mPASS[0m in 0.04s]
[0m18:23:57.523274 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m18:23:57.523975 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m18:23:57.524518 [info ] [Thread-1 (]: 13 of 16 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m18:23:57.525206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m18:23:57.525683 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m18:23:57.530207 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m18:23:57.531082 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m18:23:57.533780 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m18:23:57.534837 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m18:23:57.535441 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m18:23:57.535990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.553691 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:23:57.554453 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m18:23:57.554937 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m18:23:57.557356 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:23:57.559331 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m18:23:57.560711 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m18:23:57.561520 [info ] [Thread-1 (]: 13 of 16 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m18:23:57.562405 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m18:23:57.563056 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m18:23:57.563563 [info ] [Thread-1 (]: 14 of 16 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m18:23:57.564133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m18:23:57.564583 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m18:23:57.568909 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m18:23:57.569766 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m18:23:57.572131 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m18:23:57.572891 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m18:23:57.573327 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m18:23:57.573962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.591298 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m18:23:57.592219 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m18:23:57.592805 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m18:23:57.595287 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:23:57.597176 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m18:23:57.598636 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m18:23:57.599347 [info ] [Thread-1 (]: 14 of 16 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m18:23:57.600259 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m18:23:57.600884 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m18:23:57.601381 [info ] [Thread-1 (]: 15 of 16 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m18:23:57.602104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m18:23:57.602571 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m18:23:57.613288 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m18:23:57.614146 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m18:23:57.617122 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m18:23:57.618066 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m18:23:57.618592 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m18:23:57.619006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.638193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m18:23:57.638888 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m18:23:57.639546 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:23:57.644213 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:23:57.646012 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m18:23:57.647545 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m18:23:57.648292 [info ] [Thread-1 (]: 15 of 16 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.05s]
[0m18:23:57.649125 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m18:23:57.649809 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m18:23:57.650394 [info ] [Thread-1 (]: 16 of 16 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m18:23:57.651437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m18:23:57.651927 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m18:23:57.658756 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m18:23:57.659611 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m18:23:57.662026 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m18:23:57.662854 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m18:23:57.663295 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m18:23:57.663697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:57.680065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m18:23:57.680931 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m18:23:57.681454 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:23:57.685610 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:23:57.687357 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m18:23:57.688725 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m18:23:57.689468 [info ] [Thread-1 (]: 16 of 16 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m18:23:57.690298 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m18:23:57.692063 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:57.692497 [debug] [MainThread]: On master: BEGIN
[0m18:23:57.692833 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:23:57.708168 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m18:23:57.708808 [debug] [MainThread]: On master: COMMIT
[0m18:23:57.709203 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:57.709547 [debug] [MainThread]: On master: COMMIT
[0m18:23:57.710792 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:23:57.711230 [debug] [MainThread]: On master: Close
[0m18:23:57.711747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:57.712134 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m18:23:57.712609 [info ] [MainThread]: 
[0m18:23:57.713027 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m18:23:57.717095 [debug] [MainThread]: Command end result
[0m18:23:57.753080 [info ] [MainThread]: 
[0m18:23:57.753607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:23:57.754004 [info ] [MainThread]: 
[0m18:23:57.754530 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m18:23:57.756272 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.8496327, "process_in_blocks": "0", "process_kernel_time": 0.383495, "process_mem_max_rss": "111673344", "process_out_blocks": "0", "process_user_time": 2.773407}
[0m18:23:57.757095 [debug] [MainThread]: Command `dbt test` succeeded at 18:23:57.756895 after 1.85 seconds
[0m18:23:57.757643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9a2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112686ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112686de0>]}
[0m18:23:57.758144 [debug] [MainThread]: Flushing usage events
[0m19:11:33.255354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3fdeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5932c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f592de0>]}


============================== 19:11:33.262562 | 8c4c933f-be2c-43c4-810a-00d4e79d0dee ==============================
[0m19:11:33.262562 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:11:33.263490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:11:33.544848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c4c933f-be2c-43c4-810a-00d4e79d0dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de426c0>]}
[0m19:11:33.610284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c4c933f-be2c-43c4-810a-00d4e79d0dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5c5490>]}
[0m19:11:33.611878 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:11:33.765524 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:11:33.967843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m19:11:33.968569 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__fields_stages.sql
[0m19:11:33.969012 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_pipedrive__fields_lost_reasons.sql
[0m19:11:34.267657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c4c933f-be2c-43c4-810a-00d4e79d0dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f68b110>]}
[0m19:11:34.415781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c4c933f-be2c-43c4-810a-00d4e79d0dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105103b0>]}
[0m19:11:34.416387 [info ] [MainThread]: Found 8 models, 16 data tests, 6 sources, 428 macros
[0m19:11:34.416828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c4c933f-be2c-43c4-810a-00d4e79d0dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104200b0>]}
[0m19:11:34.419853 [info ] [MainThread]: 
[0m19:11:34.421009 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:11:34.426082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:11:34.507508 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:11:34.508059 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:11:34.508496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:34.569898 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.061 seconds
[0m19:11:34.571855 [debug] [ThreadPool]: On list_postgres: Close
[0m19:11:34.573784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m19:11:34.580558 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:11:34.581021 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m19:11:34.581402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:34.596927 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m19:11:34.597564 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:11:34.598079 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m19:11:34.602116 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m19:11:34.603747 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m19:11:34.605236 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m19:11:34.611753 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:34.612194 [debug] [MainThread]: On master: BEGIN
[0m19:11:34.612531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:34.628195 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:11:34.628780 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:34.629298 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:11:34.634178 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m19:11:34.635737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c4c933f-be2c-43c4-810a-00d4e79d0dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103df1a0>]}
[0m19:11:34.636230 [debug] [MainThread]: On master: ROLLBACK
[0m19:11:34.637490 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:34.638054 [debug] [MainThread]: On master: BEGIN
[0m19:11:34.640303 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:11:34.640874 [debug] [MainThread]: On master: COMMIT
[0m19:11:34.641261 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:34.641607 [debug] [MainThread]: On master: COMMIT
[0m19:11:34.642762 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:11:34.643181 [debug] [MainThread]: On master: Close
[0m19:11:34.643729 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:11:34.644149 [info ] [MainThread]: 
[0m19:11:34.647267 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m19:11:34.647935 [info ] [Thread-1 (]: 1 of 8 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m19:11:34.648541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m19:11:34.649112 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m19:11:34.660930 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:11:34.662065 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m19:11:34.702423 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:11:34.703340 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:11:34.703775 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m19:11:34.704360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:34.721297 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:11:34.722020 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:11:34.722471 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m19:11:34.725226 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:11:34.732201 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:11:34.732711 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m19:11:34.734616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:11:34.737890 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:11:34.738498 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m19:11:34.740575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:11:34.758923 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m19:11:34.759438 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:11:34.759859 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m19:11:34.763977 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m19:11:34.771242 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m19:11:34.777252 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:11:34.777755 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m19:11:34.780674 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:11:34.783384 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m19:11:34.785525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4c933f-be2c-43c4-810a-00d4e79d0dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de41730>]}
[0m19:11:34.786464 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m19:11:34.787822 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m19:11:34.788645 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:11:34.789571 [info ] [Thread-1 (]: 2 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m19:11:34.790411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m19:11:34.791458 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:11:34.795274 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:11:34.796356 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:11:34.801517 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:11:34.802388 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:11:34.802816 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m19:11:34.803211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:34.819823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:11:34.820626 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:11:34.821231 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m19:11:34.823794 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:11:34.827074 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:11:34.827528 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m19:11:34.829121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:11:34.832411 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:11:34.832867 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m19:11:34.834405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:11:34.836274 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m19:11:34.836704 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:11:34.837104 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m19:11:34.839298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:11:34.841943 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m19:11:34.842758 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:11:34.843173 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m19:11:34.845704 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:11:34.847320 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m19:11:34.847965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4c933f-be2c-43c4-810a-00d4e79d0dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110420ad0>]}
[0m19:11:34.848705 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m19:11:34.849448 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:11:34.849983 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:11:34.851095 [info ] [Thread-1 (]: 3 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m19:11:34.851781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m19:11:34.852274 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:11:34.858231 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:11:34.859637 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:11:34.863384 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:11:34.864263 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:11:34.864852 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m19:11:34.865347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:34.881813 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:11:34.882396 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:11:34.882868 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m19:11:34.886019 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:11:34.889669 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:11:34.890178 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m19:11:34.892739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:11:34.896060 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:11:34.896535 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m19:11:34.898190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:11:34.900242 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m19:11:34.900813 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:11:34.901277 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m19:11:34.903038 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:11:34.905683 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m19:11:34.906522 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:11:34.906946 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m19:11:34.909262 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:11:34.910828 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m19:11:34.911414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4c933f-be2c-43c4-810a-00d4e79d0dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c6300>]}
[0m19:11:34.912105 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m19:11:34.912902 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:11:34.913428 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:11:34.914160 [info ] [Thread-1 (]: 4 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m19:11:34.914745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m19:11:34.915180 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:11:34.918293 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:11:34.919205 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:11:34.926152 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:11:34.927265 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:11:34.927881 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m19:11:34.928271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:34.945450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:11:34.946261 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:11:34.946801 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m19:11:34.949402 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:11:34.952580 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:11:34.953030 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m19:11:34.954731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:11:34.958051 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:11:34.958531 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m19:11:34.960078 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:11:34.962162 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m19:11:34.962603 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:11:34.963029 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m19:11:34.965741 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:11:34.968328 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m19:11:34.969135 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:11:34.969571 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m19:11:34.972150 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:11:34.973882 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m19:11:34.974849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4c933f-be2c-43c4-810a-00d4e79d0dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058d3a0>]}
[0m19:11:34.975914 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m19:11:34.976725 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:11:34.977321 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:11:34.978006 [info ] [Thread-1 (]: 5 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m19:11:34.978601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m19:11:34.979057 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:11:34.981776 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:11:34.982872 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:11:34.991229 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:11:34.992151 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:11:34.992585 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m19:11:34.992979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:35.010949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:11:35.011690 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:11:35.012220 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m19:11:35.014918 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:11:35.019189 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:11:35.020027 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m19:11:35.021921 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:11:35.025164 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:11:35.025763 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m19:11:35.028816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:11:35.031150 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m19:11:35.031629 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:11:35.032053 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m19:11:35.034022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:11:35.037277 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m19:11:35.038243 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:11:35.038686 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m19:11:35.041166 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:11:35.042791 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m19:11:35.043380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4c933f-be2c-43c4-810a-00d4e79d0dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108b8b00>]}
[0m19:11:35.044083 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m19:11:35.044824 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:11:35.045349 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m19:11:35.046171 [info ] [Thread-1 (]: 6 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m19:11:35.046782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m19:11:35.047228 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m19:11:35.049915 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:11:35.050762 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m19:11:35.054974 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:11:35.055833 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:11:35.056271 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m19:11:35.056710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:35.075883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m19:11:35.076473 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:11:35.076986 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified AS modified_date
FROM "postgres"."public"."users"
  );
[0m19:11:35.079584 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:11:35.082844 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:11:35.083283 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m19:11:35.085051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:11:35.089615 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:11:35.090241 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m19:11:35.092178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:11:35.094443 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m19:11:35.095054 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:11:35.095471 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m19:11:35.097648 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:11:35.100721 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m19:11:35.101739 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:11:35.102362 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m19:11:35.105592 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:11:35.107213 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m19:11:35.107789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4c933f-be2c-43c4-810a-00d4e79d0dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110838800>]}
[0m19:11:35.108480 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m19:11:35.109227 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m19:11:35.109752 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:11:35.110445 [info ] [Thread-1 (]: 7 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m19:11:35.111056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m19:11:35.111494 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:11:35.114358 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:11:35.115210 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:11:35.118980 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:11:35.119990 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:11:35.120671 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m19:11:35.121285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:35.141613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:11:35.142260 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:11:35.142741 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	field_value_options ->> 'id' AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array;
  );
[0m19:11:35.145082 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: FROM expand_array;
                          ^

[0m19:11:35.145728 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: ROLLBACK
[0m19:11:35.147622 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m19:11:35.158279 [debug] [Thread-1 (]: Database Error in model stg_pipedrive__fields_lost_reasons (models/staging/stg_pipedrive__fields_lost_reasons.sql)
  syntax error at or near ";"
  LINE 17: FROM expand_array;
                            ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__fields_lost_reasons.sql
[0m19:11:35.158868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4c933f-be2c-43c4-810a-00d4e79d0dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110421d00>]}
[0m19:11:35.159645 [error] [Thread-1 (]: 7 of 8 ERROR creating sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[31mERROR[0m in 0.05s]
[0m19:11:35.160434 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:11:35.160937 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:11:35.161476 [info ] [Thread-1 (]: 8 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m19:11:35.162769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m19:11:35.163209 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:11:35.166099 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:11:35.166989 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:11:35.175121 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:11:35.176025 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:11:35.176450 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m19:11:35.176924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:35.193780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:11:35.194372 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:11:35.194857 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	field_value_options ->> 'id' AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array;
  );
[0m19:11:35.196495 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: FROM expand_array;
                          ^

[0m19:11:35.197204 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: ROLLBACK
[0m19:11:35.199211 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m19:11:35.203208 [debug] [Thread-1 (]: Database Error in model stg_pipedrive__fields_stages (models/staging/stg_pipedrive__fields_stages.sql)
  syntax error at or near ";"
  LINE 17: FROM expand_array;
                            ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__fields_stages.sql
[0m19:11:35.204291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4c933f-be2c-43c4-810a-00d4e79d0dee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f4500>]}
[0m19:11:35.205047 [error] [Thread-1 (]: 8 of 8 ERROR creating sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[31mERROR[0m in 0.04s]
[0m19:11:35.205754 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:11:35.207083 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:35.207472 [debug] [MainThread]: On master: BEGIN
[0m19:11:35.207820 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:11:35.224846 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:11:35.225467 [debug] [MainThread]: On master: COMMIT
[0m19:11:35.226226 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:35.227740 [debug] [MainThread]: On master: COMMIT
[0m19:11:35.229332 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:11:35.229873 [debug] [MainThread]: On master: Close
[0m19:11:35.230417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:35.230778 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__fields_stages' was properly closed.
[0m19:11:35.231245 [info ] [MainThread]: 
[0m19:11:35.231666 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m19:11:35.233794 [debug] [MainThread]: Command end result
[0m19:11:35.266435 [info ] [MainThread]: 
[0m19:11:35.266963 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:11:35.267461 [info ] [MainThread]: 
[0m19:11:35.267964 [error] [MainThread]:   Database Error in model stg_pipedrive__fields_lost_reasons (models/staging/stg_pipedrive__fields_lost_reasons.sql)
  syntax error at or near ";"
  LINE 17: FROM expand_array;
                            ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__fields_lost_reasons.sql
[0m19:11:35.268351 [info ] [MainThread]: 
[0m19:11:35.268887 [error] [MainThread]:   Database Error in model stg_pipedrive__fields_stages (models/staging/stg_pipedrive__fields_stages.sql)
  syntax error at or near ";"
  LINE 17: FROM expand_array;
                            ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__fields_stages.sql
[0m19:11:35.269293 [info ] [MainThread]: 
[0m19:11:35.269977 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m19:11:35.273427 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1144342, "process_in_blocks": "0", "process_kernel_time": 0.568972, "process_mem_max_rss": "113508352", "process_out_blocks": "0", "process_user_time": 3.19875}
[0m19:11:35.274596 [debug] [MainThread]: Command `dbt run` failed at 19:11:35.274365 after 2.12 seconds
[0m19:11:35.275351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4379e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3ff8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3fdeb0>]}
[0m19:11:35.275999 [debug] [MainThread]: Flushing usage events
[0m19:12:01.291126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106350260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107401f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2ec30>]}


============================== 19:12:01.299514 | 55a2b911-dd8f-416c-bd90-868b62156727 ==============================
[0m19:12:01.299514 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:12:01.300339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:12:01.564424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55a2b911-dd8f-416c-bd90-868b62156727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067324e0>]}
[0m19:12:01.629426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55a2b911-dd8f-416c-bd90-868b62156727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105570e00>]}
[0m19:12:01.631058 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:12:01.772165 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:12:01.946673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:12:01.947484 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__fields_lost_reasons.sql
[0m19:12:01.948003 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__fields_stages.sql
[0m19:12:02.245823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55a2b911-dd8f-416c-bd90-868b62156727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de3a10>]}
[0m19:12:02.387405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55a2b911-dd8f-416c-bd90-868b62156727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8c3e0>]}
[0m19:12:02.388419 [info ] [MainThread]: Found 8 models, 16 data tests, 6 sources, 428 macros
[0m19:12:02.389043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a2b911-dd8f-416c-bd90-868b62156727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d1b20>]}
[0m19:12:02.392038 [info ] [MainThread]: 
[0m19:12:02.392775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:12:02.397707 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:12:02.474962 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:12:02.475456 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:12:02.475838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:02.531594 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.056 seconds
[0m19:12:02.533312 [debug] [ThreadPool]: On list_postgres: Close
[0m19:12:02.535400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m19:12:02.542265 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:12:02.542718 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m19:12:02.543066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:12:02.558432 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m19:12:02.559101 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:12:02.559635 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m19:12:02.563562 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m19:12:02.565170 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m19:12:02.566358 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m19:12:02.572818 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:02.573274 [debug] [MainThread]: On master: BEGIN
[0m19:12:02.573611 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:12:02.589570 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:12:02.590172 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:02.590675 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:12:02.595385 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m19:12:02.596939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a2b911-dd8f-416c-bd90-868b62156727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108319190>]}
[0m19:12:02.597442 [debug] [MainThread]: On master: ROLLBACK
[0m19:12:02.598722 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:02.599148 [debug] [MainThread]: On master: BEGIN
[0m19:12:02.601688 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:12:02.602297 [debug] [MainThread]: On master: COMMIT
[0m19:12:02.602732 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:02.603107 [debug] [MainThread]: On master: COMMIT
[0m19:12:02.604587 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:12:02.605127 [debug] [MainThread]: On master: Close
[0m19:12:02.605728 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:12:02.606324 [info ] [MainThread]: 
[0m19:12:02.609667 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m19:12:02.610410 [info ] [Thread-1 (]: 1 of 8 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m19:12:02.610979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m19:12:02.611420 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m19:12:02.621523 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:12:02.622535 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m19:12:02.663180 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:12:02.664069 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:12:02.664498 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m19:12:02.664888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:02.680634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:12:02.681331 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:12:02.681803 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m19:12:02.684213 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:12:02.691176 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:12:02.691678 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m19:12:02.693554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:02.696813 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:12:02.697379 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m19:12:02.699224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:02.717478 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m19:12:02.717990 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:12:02.718393 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m19:12:02.721533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:12:02.728511 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m19:12:02.734214 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:12:02.734681 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m19:12:02.737824 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:12:02.740573 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m19:12:02.742199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a2b911-dd8f-416c-bd90-868b62156727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106731520>]}
[0m19:12:02.743048 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.13s]
[0m19:12:02.744163 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m19:12:02.744834 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:12:02.745769 [info ] [Thread-1 (]: 2 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m19:12:02.746487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m19:12:02.746935 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:12:02.751179 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:12:02.752116 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:12:02.756285 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:12:02.757125 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:12:02.757551 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m19:12:02.757941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:02.776573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m19:12:02.777235 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:12:02.777725 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m19:12:02.780558 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:12:02.784026 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:12:02.784843 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m19:12:02.787309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:12:02.790811 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:12:02.791361 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m19:12:02.793165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:02.795392 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m19:12:02.795900 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:12:02.796344 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m19:12:02.798302 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:12:02.801119 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m19:12:02.802113 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:12:02.802641 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m19:12:02.805951 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:12:02.807828 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m19:12:02.808516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a2b911-dd8f-416c-bd90-868b62156727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109254c80>]}
[0m19:12:02.809318 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m19:12:02.810254 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:12:02.810841 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:12:02.811676 [info ] [Thread-1 (]: 3 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m19:12:02.812302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m19:12:02.812766 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:12:02.817068 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:12:02.817924 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:12:02.821955 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:12:02.823048 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:12:02.823606 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m19:12:02.824114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:02.843145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m19:12:02.843803 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:12:02.844285 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m19:12:02.847181 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:12:02.850468 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:12:02.850926 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m19:12:02.852662 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:02.856032 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:12:02.856516 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m19:12:02.858081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:02.859917 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m19:12:02.860350 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:12:02.860750 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m19:12:02.862666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:12:02.865302 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m19:12:02.866098 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:12:02.866521 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m19:12:02.868913 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:12:02.870514 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m19:12:02.871202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a2b911-dd8f-416c-bd90-868b62156727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109243f50>]}
[0m19:12:02.871936 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m19:12:02.872680 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:12:02.873197 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:12:02.873889 [info ] [Thread-1 (]: 4 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m19:12:02.874507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m19:12:02.874940 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:12:02.878001 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:12:02.878877 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:12:02.882728 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:12:02.883520 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:12:02.883944 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m19:12:02.884334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:02.903015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:12:02.903859 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:12:02.904924 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m19:12:02.908096 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:12:02.911270 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:12:02.911708 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m19:12:02.913402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:02.916637 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:12:02.917103 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m19:12:02.918733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:02.920778 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m19:12:02.921377 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:12:02.921855 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m19:12:02.923862 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:12:02.926461 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m19:12:02.927269 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:12:02.927687 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m19:12:02.930086 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:12:02.931645 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m19:12:02.932267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a2b911-dd8f-416c-bd90-868b62156727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917ea20>]}
[0m19:12:02.933094 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m19:12:02.933837 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:12:02.934351 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:12:02.935093 [info ] [Thread-1 (]: 5 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m19:12:02.935653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m19:12:02.936086 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:12:02.939077 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:12:02.939929 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:12:02.945282 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:12:02.946534 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:12:02.947302 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m19:12:02.947796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:02.965406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:12:02.966024 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:12:02.966509 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m19:12:02.968860 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:12:02.972290 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:12:02.972793 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m19:12:02.974625 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:02.978272 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:12:02.978718 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m19:12:02.980389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:02.982469 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m19:12:02.982919 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:12:02.983356 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m19:12:02.985453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:12:02.988155 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m19:12:02.989030 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:12:02.989452 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m19:12:02.991989 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:12:02.993568 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m19:12:02.994159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a2b911-dd8f-416c-bd90-868b62156727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917cd10>]}
[0m19:12:02.994861 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m19:12:02.995591 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:12:02.996103 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m19:12:02.996810 [info ] [Thread-1 (]: 6 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m19:12:02.997427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m19:12:02.997868 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m19:12:03.000668 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:12:03.001501 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m19:12:03.005972 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:12:03.006869 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:12:03.007295 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m19:12:03.007684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:03.028640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:12:03.029715 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:12:03.030196 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified AS modified_date
FROM "postgres"."public"."users"
  );
[0m19:12:03.033060 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:12:03.036316 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:12:03.036758 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m19:12:03.038654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:03.041982 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:12:03.042623 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m19:12:03.044773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:03.046882 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m19:12:03.047450 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:12:03.047862 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m19:12:03.049814 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:12:03.052370 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m19:12:03.053162 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:12:03.053574 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m19:12:03.056381 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:12:03.058181 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m19:12:03.058936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a2b911-dd8f-416c-bd90-868b62156727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917cbc0>]}
[0m19:12:03.059806 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m19:12:03.060709 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m19:12:03.061298 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:12:03.062270 [info ] [Thread-1 (]: 7 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m19:12:03.062902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m19:12:03.063383 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:12:03.066242 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:12:03.067051 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:12:03.070647 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:12:03.071523 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:12:03.072008 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m19:12:03.072412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:03.091770 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m19:12:03.092681 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:12:03.094875 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	field_value_options ->> 'id' AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m19:12:03.100997 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:12:03.105224 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:12:03.105737 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m19:12:03.107959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:12:03.110378 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m19:12:03.111030 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:12:03.111477 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m19:12:03.114572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:12:03.118687 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m19:12:03.119566 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:12:03.120014 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m19:12:03.121737 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:12:03.123543 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m19:12:03.124120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a2b911-dd8f-416c-bd90-868b62156727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b1010>]}
[0m19:12:03.124952 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.06s]
[0m19:12:03.125771 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:12:03.126351 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:12:03.127081 [info ] [Thread-1 (]: 8 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m19:12:03.127668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m19:12:03.128101 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:12:03.130872 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:12:03.131652 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:12:03.135267 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:12:03.136063 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:12:03.136483 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m19:12:03.136880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:03.156240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m19:12:03.156913 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:12:03.157438 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	field_value_options ->> 'id' AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m19:12:03.162789 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:12:03.166115 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:12:03.166619 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m19:12:03.168453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:03.170490 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m19:12:03.171313 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:12:03.171957 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m19:12:03.174779 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:12:03.177927 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m19:12:03.178789 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:12:03.179212 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m19:12:03.180861 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:12:03.182420 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m19:12:03.183002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a2b911-dd8f-416c-bd90-868b62156727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109286000>]}
[0m19:12:03.183705 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.06s]
[0m19:12:03.184460 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:12:03.185957 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:03.186428 [debug] [MainThread]: On master: BEGIN
[0m19:12:03.186768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:12:03.202477 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:12:03.228662 [debug] [MainThread]: On master: COMMIT
[0m19:12:03.229178 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:03.229596 [debug] [MainThread]: On master: COMMIT
[0m19:12:03.231236 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:12:03.231748 [debug] [MainThread]: On master: Close
[0m19:12:03.232392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:03.232897 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__fields_stages' was properly closed.
[0m19:12:03.233461 [info ] [MainThread]: 
[0m19:12:03.233952 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m19:12:03.236760 [debug] [MainThread]: Command end result
[0m19:12:03.271304 [info ] [MainThread]: 
[0m19:12:03.271883 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:12:03.272283 [info ] [MainThread]: 
[0m19:12:03.272699 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:12:03.275039 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0802054, "process_in_blocks": "0", "process_kernel_time": 0.511274, "process_mem_max_rss": "112513024", "process_out_blocks": "0", "process_user_time": 3.148745}
[0m19:12:03.276662 [debug] [MainThread]: Command `dbt run` succeeded at 19:12:03.276375 after 2.08 seconds
[0m19:12:03.277355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041aad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106796420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106795dc0>]}
[0m19:12:03.277855 [debug] [MainThread]: Flushing usage events
[0m19:14:34.575605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106498530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd6c00>]}


============================== 19:14:34.581207 | de014390-1046-4231-ba90-741c9074c4b9 ==============================
[0m19:14:34.581207 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:14:34.582466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:14:34.822090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de014390-1046-4231-ba90-741c9074c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10852aa50>]}
[0m19:14:34.887214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de014390-1046-4231-ba90-741c9074c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd6630>]}
[0m19:14:34.888348 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:14:35.017749 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:14:35.172297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:14:35.172993 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://tests/assert_change_stage_references_lost_reason_id.sql
[0m19:14:35.173487 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://tests/assert_change_stage_references_stage_id.sql
[0m19:14:35.396648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de014390-1046-4231-ba90-741c9074c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9eb70>]}
[0m19:14:35.530022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de014390-1046-4231-ba90-741c9074c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ebf140>]}
[0m19:14:35.530602 [info ] [MainThread]: Found 8 models, 17 data tests, 6 sources, 428 macros
[0m19:14:35.531026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de014390-1046-4231-ba90-741c9074c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e2ab40>]}
[0m19:14:35.533698 [info ] [MainThread]: 
[0m19:14:35.534346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:14:35.539211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:14:35.602859 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:14:35.603348 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:14:35.603732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:35.632792 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m19:14:35.634361 [debug] [ThreadPool]: On list_postgres: Close
[0m19:14:35.636190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m19:14:35.642786 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:14:35.643237 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m19:14:35.643580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:35.658805 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m19:14:35.659346 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:14:35.659811 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m19:14:35.664900 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m19:14:35.666952 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m19:14:35.668490 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m19:14:35.675334 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:35.675780 [debug] [MainThread]: On master: BEGIN
[0m19:14:35.676115 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:35.691817 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:14:35.692396 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:35.692929 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:14:35.697598 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m19:14:35.699735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de014390-1046-4231-ba90-741c9074c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d090a0>]}
[0m19:14:35.700229 [debug] [MainThread]: On master: ROLLBACK
[0m19:14:35.701545 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:35.701965 [debug] [MainThread]: On master: BEGIN
[0m19:14:35.705190 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:14:35.705823 [debug] [MainThread]: On master: COMMIT
[0m19:14:35.706221 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:35.706592 [debug] [MainThread]: On master: COMMIT
[0m19:14:35.707888 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:14:35.708342 [debug] [MainThread]: On master: Close
[0m19:14:35.708918 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:35.709457 [info ] [MainThread]: 
[0m19:14:35.712140 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m19:14:35.712839 [info ] [Thread-1 (]: 1 of 8 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m19:14:35.713607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m19:14:35.714221 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m19:14:35.724515 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:14:35.725487 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m19:14:35.768655 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:14:35.769645 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:14:35.770088 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m19:14:35.770485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:35.786389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:14:35.787193 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:14:35.787663 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m19:14:35.790130 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:14:35.799053 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:14:35.799581 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m19:14:35.801275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:14:35.804773 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:14:35.805275 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m19:14:35.807165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:14:35.826279 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m19:14:35.826789 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:14:35.827198 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m19:14:35.830371 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:14:35.837243 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m19:14:35.843078 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:14:35.843589 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m19:14:35.847848 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:14:35.850793 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m19:14:35.852612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de014390-1046-4231-ba90-741c9074c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106885940>]}
[0m19:14:35.853461 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m19:14:35.854806 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m19:14:35.855529 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:14:35.856382 [info ] [Thread-1 (]: 2 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m19:14:35.857079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m19:14:35.857548 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:14:35.862086 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:14:35.863005 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:14:35.867432 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:14:35.868483 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:14:35.868936 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m19:14:35.869332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:35.888438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m19:14:35.889032 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:14:35.889517 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m19:14:35.892202 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:14:35.895488 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:14:35.895944 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m19:14:35.897597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:14:35.900882 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:14:35.901359 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m19:14:35.903006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:14:35.905007 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m19:14:35.905494 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:14:35.905987 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m19:14:35.908179 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:14:35.910909 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m19:14:35.911824 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:14:35.912263 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m19:14:35.916181 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:14:35.918207 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m19:14:35.918963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de014390-1046-4231-ba90-741c9074c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092850d0>]}
[0m19:14:35.919947 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m19:14:35.920943 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:14:35.921626 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:14:35.922437 [info ] [Thread-1 (]: 3 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m19:14:35.923068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m19:14:35.923534 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:14:35.926362 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:14:35.927224 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:14:35.931734 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:14:35.932726 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:14:35.933266 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m19:14:35.934061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:35.954553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:14:35.955210 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:14:35.955680 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m19:14:35.958619 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:14:35.963105 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:14:35.963719 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m19:14:35.965510 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:14:35.968668 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:14:35.969146 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m19:14:35.971243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:14:35.973544 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m19:14:35.974044 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:14:35.974452 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m19:14:35.976517 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:14:35.979213 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m19:14:35.980089 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:14:35.980558 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m19:14:35.983886 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:14:35.985525 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m19:14:35.986108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de014390-1046-4231-ba90-741c9074c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d3ef0>]}
[0m19:14:35.987051 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m19:14:35.987921 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:14:35.988448 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:14:35.989163 [info ] [Thread-1 (]: 4 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m19:14:35.989781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m19:14:35.990252 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:14:35.993406 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:14:35.994622 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:14:36.000338 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:14:36.001343 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:14:36.001831 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m19:14:36.002243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:36.020792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:14:36.021402 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:14:36.021909 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m19:14:36.025379 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:14:36.028951 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:14:36.029455 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m19:14:36.031320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:14:36.034588 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:14:36.035043 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m19:14:36.036732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:14:36.038694 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m19:14:36.039232 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:14:36.039648 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m19:14:36.041605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:14:36.044284 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m19:14:36.045158 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:14:36.045588 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m19:14:36.048209 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:14:36.050333 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m19:14:36.050948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de014390-1046-4231-ba90-741c9074c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10933f4d0>]}
[0m19:14:36.051711 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m19:14:36.052457 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:14:36.052982 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:14:36.053929 [info ] [Thread-1 (]: 5 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m19:14:36.054589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m19:14:36.055043 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:14:36.057832 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:14:36.058789 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:14:36.064510 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:14:36.065428 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:14:36.065862 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m19:14:36.066256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:36.083672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:14:36.084744 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:14:36.085239 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m19:14:36.087784 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:14:36.091274 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:14:36.091757 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m19:14:36.094669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:14:36.098351 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:14:36.098967 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m19:14:36.100684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:14:36.103056 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m19:14:36.104026 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:14:36.104676 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m19:14:36.106875 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:14:36.110752 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m19:14:36.111594 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:14:36.112026 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m19:14:36.114699 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:14:36.116679 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m19:14:36.117376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de014390-1046-4231-ba90-741c9074c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f82f0>]}
[0m19:14:36.118306 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m19:14:36.119097 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:14:36.119669 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m19:14:36.120705 [info ] [Thread-1 (]: 6 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m19:14:36.121493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m19:14:36.121981 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m19:14:36.126524 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:14:36.127440 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m19:14:36.131339 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:14:36.132883 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:14:36.133473 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m19:14:36.133981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:36.155829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m19:14:36.156495 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:14:36.157029 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified AS modified_date
FROM "postgres"."public"."users"
  );
[0m19:14:36.159726 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:14:36.163016 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:14:36.163588 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m19:14:36.165330 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:14:36.168653 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:14:36.169117 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m19:14:36.171032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:14:36.173062 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m19:14:36.173517 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:14:36.173969 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m19:14:36.176103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:14:36.178738 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m19:14:36.179536 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:14:36.179956 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m19:14:36.183281 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:14:36.184934 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m19:14:36.185516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de014390-1046-4231-ba90-741c9074c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092c0860>]}
[0m19:14:36.186244 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m19:14:36.187222 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m19:14:36.187808 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:14:36.188508 [info ] [Thread-1 (]: 7 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m19:14:36.189109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m19:14:36.189551 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:14:36.192390 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:14:36.193186 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:14:36.197140 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:14:36.198041 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:14:36.198532 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m19:14:36.199086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:36.219055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:14:36.219734 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:14:36.220211 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	field_value_options ->> 'id' AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m19:14:36.223391 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:14:36.226725 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:14:36.227187 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m19:14:36.228984 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:14:36.230869 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m19:14:36.231373 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:14:36.231787 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m19:14:36.233766 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:14:36.236352 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m19:14:36.237445 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:14:36.237959 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m19:14:36.239542 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:14:36.241146 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m19:14:36.241726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de014390-1046-4231-ba90-741c9074c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f0ec0>]}
[0m19:14:36.242436 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.05s]
[0m19:14:36.243184 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:14:36.243704 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:14:36.244347 [info ] [Thread-1 (]: 8 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m19:14:36.244938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m19:14:36.245382 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:14:36.249140 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:14:36.250422 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:14:36.255950 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:14:36.256849 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:14:36.257286 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m19:14:36.257685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:36.275191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:14:36.275999 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:14:36.276507 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	field_value_options ->> 'id' AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m19:14:36.280166 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:14:36.285617 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:14:36.286134 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m19:14:36.288090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:14:36.289923 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m19:14:36.290369 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:14:36.290778 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m19:14:36.292909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:14:36.295625 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m19:14:36.296509 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:14:36.297012 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m19:14:36.299506 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:14:36.301137 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m19:14:36.301755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de014390-1046-4231-ba90-741c9074c4b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943c2c0>]}
[0m19:14:36.302509 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.06s]
[0m19:14:36.303459 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:14:36.305228 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:36.305698 [debug] [MainThread]: On master: BEGIN
[0m19:14:36.306077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:14:36.323177 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:14:36.323920 [debug] [MainThread]: On master: COMMIT
[0m19:14:36.324378 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:36.324737 [debug] [MainThread]: On master: COMMIT
[0m19:14:36.325977 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:14:36.326477 [debug] [MainThread]: On master: Close
[0m19:14:36.327061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:36.327463 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__fields_stages' was properly closed.
[0m19:14:36.327941 [info ] [MainThread]: 
[0m19:14:36.328380 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m19:14:36.330791 [debug] [MainThread]: Command end result
[0m19:14:36.364698 [info ] [MainThread]: 
[0m19:14:36.365236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:36.365626 [info ] [MainThread]: 
[0m19:14:36.366035 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:14:36.367813 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8766204, "process_in_blocks": "0", "process_kernel_time": 0.428627, "process_mem_max_rss": "111595520", "process_out_blocks": "0", "process_user_time": 2.988058}
[0m19:14:36.368591 [debug] [MainThread]: Command `dbt run` succeeded at 19:14:36.368441 after 1.88 seconds
[0m19:14:36.369092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b24b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9a5a0>]}
[0m19:14:36.369541 [debug] [MainThread]: Flushing usage events
[0m19:14:43.498467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e7de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111016fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111016ab0>]}


============================== 19:14:43.504018 | db889bd8-2a9a-4078-8d61-c22948ba2ed9 ==============================
[0m19:14:43.504018 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:14:43.505269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:14:43.739457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db889bd8-2a9a-4078-8d61-c22948ba2ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111014530>]}
[0m19:14:43.805008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db889bd8-2a9a-4078-8d61-c22948ba2ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b84770>]}
[0m19:14:43.805954 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:14:43.936040 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:14:44.089595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:44.090055 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:44.149023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db889bd8-2a9a-4078-8d61-c22948ba2ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11112db50>]}
[0m19:14:44.299772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db889bd8-2a9a-4078-8d61-c22948ba2ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112072360>]}
[0m19:14:44.300353 [info ] [MainThread]: Found 8 models, 17 data tests, 6 sources, 428 macros
[0m19:14:44.300814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db889bd8-2a9a-4078-8d61-c22948ba2ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ec2690>]}
[0m19:14:44.303897 [info ] [MainThread]: 
[0m19:14:44.304766 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:14:44.309516 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m19:14:44.378405 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:14:44.378879 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m19:14:44.379243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:44.411135 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m19:14:44.411797 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:14:44.412256 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m19:14:44.416269 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m19:14:44.418041 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m19:14:44.419230 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m19:14:44.426247 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:44.426702 [debug] [MainThread]: On master: BEGIN
[0m19:14:44.427047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:44.442940 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:14:44.443450 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:44.443926 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:14:44.448680 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m19:14:44.450770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db889bd8-2a9a-4078-8d61-c22948ba2ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112053e30>]}
[0m19:14:44.451253 [debug] [MainThread]: On master: ROLLBACK
[0m19:14:44.452597 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:44.453022 [debug] [MainThread]: On master: BEGIN
[0m19:14:44.455268 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:14:44.455837 [debug] [MainThread]: On master: COMMIT
[0m19:14:44.456228 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:44.456576 [debug] [MainThread]: On master: COMMIT
[0m19:14:44.457703 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:14:44.458101 [debug] [MainThread]: On master: Close
[0m19:14:44.458648 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:44.459113 [info ] [MainThread]: 
[0m19:14:44.461717 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:14:44.462278 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m19:14:44.463017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m19:14:44.463566 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:14:44.486081 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:14:44.488396 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:14:44.507089 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:14:44.508020 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:14:44.508464 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m19:14:44.508872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:44.525740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:14:44.526378 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:14:44.526886 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m19:14:44.531808 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:14:44.536610 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m19:14:44.538308 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m19:14:44.539151 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.08s]
[0m19:14:44.539964 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:14:44.540525 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:14:44.541045 [info ] [Thread-1 (]: 2 of 17 START test assert_change_stage_references_lost_reason_id ............... [RUN]
[0m19:14:44.541658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m19:14:44.542140 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:14:44.545157 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:14:44.546360 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:14:44.548726 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:14:44.549712 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:14:44.550182 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m19:14:44.550581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:44.569049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:14:44.569638 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:14:44.570342 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m19:14:44.575911 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: integer = text
LINE 16: ON CAST(d.new_value AS INTEGER) = s.id
                                         ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m19:14:44.576469 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m19:14:44.578478 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m19:14:44.590114 [debug] [Thread-1 (]: Database Error in test assert_change_stage_references_lost_reason_id (tests/assert_change_stage_references_lost_reason_id.sql)
  operator does not exist: integer = text
  LINE 16: ON CAST(d.new_value AS INTEGER) = s.id
                                           ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/tests/assert_change_stage_references_lost_reason_id.sql
[0m19:14:44.590847 [error] [Thread-1 (]: 2 of 17 ERROR assert_change_stage_references_lost_reason_id .................... [[31mERROR[0m in 0.05s]
[0m19:14:44.591662 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:14:44.592163 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:14:44.592599 [info ] [Thread-1 (]: 3 of 17 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m19:14:44.595387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m19:14:44.595900 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:14:44.598486 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:14:44.599256 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:14:44.601574 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:14:44.602359 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:14:44.602780 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m19:14:44.603214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:44.621476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:14:44.622158 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:14:44.622633 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m19:14:44.626219 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: integer = text
LINE 16: ON CAST(d.new_value AS INTEGER) = s.id
                                         ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m19:14:44.627274 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m19:14:44.628944 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m19:14:44.632505 [debug] [Thread-1 (]: Database Error in test assert_change_stage_references_stage_id (tests/assert_change_stage_references_stage_id.sql)
  operator does not exist: integer = text
  LINE 16: ON CAST(d.new_value AS INTEGER) = s.id
                                           ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/tests/assert_change_stage_references_stage_id.sql
[0m19:14:44.633372 [error] [Thread-1 (]: 3 of 17 ERROR assert_change_stage_references_stage_id .......................... [[31mERROR[0m in 0.04s]
[0m19:14:44.634530 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:14:44.635136 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:14:44.635771 [info ] [Thread-1 (]: 4 of 17 START test assert_change_user_references_user_id ....................... [RUN]
[0m19:14:44.636427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m19:14:44.637173 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:14:44.640486 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:14:44.641616 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:14:44.644969 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:14:44.646093 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:14:44.646813 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m19:14:44.647260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:44.671151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m19:14:44.671934 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:14:44.672455 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m19:14:44.678706 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m19:14:44.680534 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m19:14:44.681962 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m19:14:44.682827 [info ] [Thread-1 (]: 4 of 17 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.05s]
[0m19:14:44.683789 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:14:44.684342 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:14:44.684937 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m19:14:44.685560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m19:14:44.686012 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:14:44.694293 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:14:44.695555 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:14:44.698105 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:14:44.698906 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:14:44.699364 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m19:14:44.699792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:44.718008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:14:44.718715 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:14:44.719191 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m19:14:44.721665 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:14:44.723398 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m19:14:44.724732 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m19:14:44.725579 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.04s]
[0m19:14:44.726452 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:14:44.727158 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:14:44.727703 [info ] [Thread-1 (]: 6 of 17 START test not_null_stg_pipedrive__activity_due_date ................... [RUN]
[0m19:14:44.728374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5)
[0m19:14:44.728838 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:14:44.733170 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:14:44.734122 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:14:44.738978 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:14:44.740115 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:14:44.740567 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: BEGIN
[0m19:14:44.740950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:44.758698 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:14:44.759284 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:14:44.759755 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_date is null



      
    ) dbt_internal_test
[0m19:14:44.762304 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:14:44.764192 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: ROLLBACK
[0m19:14:44.765543 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: Close
[0m19:14:44.766317 [info ] [Thread-1 (]: 6 of 17 PASS not_null_stg_pipedrive__activity_due_date ......................... [[32mPASS[0m in 0.04s]
[0m19:14:44.767111 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:14:44.767651 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:14:44.768162 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m19:14:44.768808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m19:14:44.769264 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:14:44.773855 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:14:44.774797 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:14:44.777326 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:14:44.778689 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:14:44.779399 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m19:14:44.780023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:44.799137 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m19:14:44.799798 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:14:44.800306 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m19:14:44.803190 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:14:44.805247 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m19:14:44.806680 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m19:14:44.807417 [info ] [Thread-1 (]: 7 of 17 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m19:14:44.808172 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:14:44.808884 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:14:44.809406 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m19:14:44.810231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m19:14:44.810994 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:14:44.815689 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:14:44.817060 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:14:44.819409 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:14:44.820300 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:14:44.820892 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m19:14:44.821305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:44.841756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:14:44.842376 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:14:44.842941 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m19:14:44.847556 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:14:44.849304 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m19:14:44.850726 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m19:14:44.851485 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m19:14:44.852255 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:14:44.852801 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:14:44.853300 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m19:14:44.854188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m19:14:44.854712 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:14:44.863442 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:14:44.864739 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:14:44.867119 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:14:44.867867 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:14:44.868294 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m19:14:44.868690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:44.886261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:14:44.887388 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:14:44.888069 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m19:14:44.891646 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:14:44.894244 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m19:14:44.896590 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m19:14:44.897496 [info ] [Thread-1 (]: 9 of 17 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.04s]
[0m19:14:44.898381 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:14:44.899271 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:14:44.899880 [info ] [Thread-1 (]: 10 of 17 START test not_null_stg_pipedrive__deal_changes_id .................... [RUN]
[0m19:14:44.900692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m19:14:44.901242 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:14:44.906328 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:14:44.908353 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:14:44.911265 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:14:44.912762 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:14:44.913331 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m19:14:44.913794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:44.932239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:14:44.932970 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:14:44.933471 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m19:14:44.936857 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:14:44.938652 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m19:14:44.940163 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m19:14:44.940962 [info ] [Thread-1 (]: 10 of 17 PASS not_null_stg_pipedrive__deal_changes_id .......................... [[32mPASS[0m in 0.04s]
[0m19:14:44.941865 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:14:44.942434 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:14:44.943034 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m19:14:44.943783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m19:14:44.944278 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:14:44.948486 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:14:44.949300 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:14:44.951844 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:14:44.952679 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:14:44.953117 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m19:14:44.953515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:44.971166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:14:44.971940 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:14:44.972429 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m19:14:44.975726 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:14:44.977552 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m19:14:44.978982 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m19:14:44.979903 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m19:14:44.980842 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:14:44.981376 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:14:44.981872 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m19:14:44.982595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m19:14:44.983066 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:14:44.987663 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:14:44.988590 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:14:44.991022 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:14:44.991883 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:14:44.992411 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m19:14:44.993002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:45.009859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:14:45.010657 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:14:45.011277 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m19:14:45.013748 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:14:45.015554 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m19:14:45.017025 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m19:14:45.017765 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m19:14:45.018546 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:14:45.019241 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:14:45.019811 [info ] [Thread-1 (]: 13 of 17 START test not_null_stg_pipedrive__users_modified_date ................ [RUN]
[0m19:14:45.020620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86)
[0m19:14:45.021361 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:14:45.026041 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:14:45.027136 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:14:45.029762 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:14:45.030606 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:14:45.031127 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: BEGIN
[0m19:14:45.031538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:45.049737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:14:45.050340 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:14:45.050816 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_date is null



      
    ) dbt_internal_test
[0m19:14:45.054666 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:14:45.056396 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: ROLLBACK
[0m19:14:45.057795 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: Close
[0m19:14:45.058581 [info ] [Thread-1 (]: 13 of 17 PASS not_null_stg_pipedrive__users_modified_date ...................... [[32mPASS[0m in 0.04s]
[0m19:14:45.059427 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:14:45.059952 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:14:45.060407 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m19:14:45.061272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m19:14:45.061772 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:14:45.066231 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:14:45.067096 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:14:45.069596 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:14:45.070431 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:14:45.070969 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m19:14:45.071391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:45.087902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:14:45.088807 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:14:45.089617 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m19:14:45.093603 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:14:45.096195 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m19:14:45.098221 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m19:14:45.099067 [info ] [Thread-1 (]: 14 of 17 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m19:14:45.100053 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:14:45.100769 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:14:45.101409 [info ] [Thread-1 (]: 15 of 17 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m19:14:45.102298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m19:14:45.102925 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:14:45.110468 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:14:45.111436 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:14:45.113832 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:14:45.114640 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:14:45.115083 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m19:14:45.115480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:45.133377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:14:45.134172 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:14:45.134691 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m19:14:45.137184 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:14:45.138917 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m19:14:45.140334 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m19:14:45.141217 [info ] [Thread-1 (]: 15 of 17 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m19:14:45.142152 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:14:45.142701 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:14:45.143375 [info ] [Thread-1 (]: 16 of 17 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m19:14:45.144070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m19:14:45.144543 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:14:45.153728 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:14:45.154573 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:14:45.156971 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:14:45.157717 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:14:45.158167 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m19:14:45.158617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:45.176650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:14:45.177546 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:14:45.178323 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:14:45.182559 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:14:45.184341 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m19:14:45.185852 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m19:14:45.186935 [info ] [Thread-1 (]: 16 of 17 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m19:14:45.187714 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:14:45.188227 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:14:45.188670 [info ] [Thread-1 (]: 17 of 17 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m19:14:45.189453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m19:14:45.190060 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:14:45.197208 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:14:45.198061 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:14:45.200468 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:14:45.201227 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:14:45.201669 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m19:14:45.202132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:45.218694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:14:45.219356 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:14:45.219902 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:14:45.224832 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:14:45.226771 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m19:14:45.228326 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m19:14:45.229292 [info ] [Thread-1 (]: 17 of 17 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m19:14:45.230090 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:14:45.231401 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:45.231855 [debug] [MainThread]: On master: BEGIN
[0m19:14:45.232208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:14:45.248940 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:14:45.249492 [debug] [MainThread]: On master: COMMIT
[0m19:14:45.249914 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:45.250285 [debug] [MainThread]: On master: COMMIT
[0m19:14:45.251602 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:14:45.252091 [debug] [MainThread]: On master: Close
[0m19:14:45.252596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:45.253042 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m19:14:45.253481 [info ] [MainThread]: 
[0m19:14:45.254308 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m19:14:45.258651 [debug] [MainThread]: Command end result
[0m19:14:45.294663 [info ] [MainThread]: 
[0m19:14:45.295314 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:14:45.295752 [info ] [MainThread]: 
[0m19:14:45.296278 [error] [MainThread]:   Database Error in test assert_change_stage_references_lost_reason_id (tests/assert_change_stage_references_lost_reason_id.sql)
  operator does not exist: integer = text
  LINE 16: ON CAST(d.new_value AS INTEGER) = s.id
                                           ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/tests/assert_change_stage_references_lost_reason_id.sql
[0m19:14:45.296694 [info ] [MainThread]: 
[0m19:14:45.297171 [error] [MainThread]:   Database Error in test assert_change_stage_references_stage_id (tests/assert_change_stage_references_stage_id.sql)
  operator does not exist: integer = text
  LINE 16: ON CAST(d.new_value AS INTEGER) = s.id
                                           ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/tests/assert_change_stage_references_stage_id.sql
[0m19:14:45.297589 [info ] [MainThread]: 
[0m19:14:45.298015 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=2 SKIP=0 TOTAL=17
[0m19:14:45.300246 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.8856157, "process_in_blocks": "0", "process_kernel_time": 0.374352, "process_mem_max_rss": "111296512", "process_out_blocks": "0", "process_user_time": 2.745672}
[0m19:14:45.301069 [debug] [MainThread]: Command `dbt test` failed at 19:14:45.300929 after 1.89 seconds
[0m19:14:45.301558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105558e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aa40e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e91790>]}
[0m19:14:45.302142 [debug] [MainThread]: Flushing usage events
[0m19:17:13.967513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd862a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdcb080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdcaab0>]}


============================== 19:17:13.975779 | 293440b8-bbcf-4655-b3ef-d2dd885e35c5 ==============================
[0m19:17:13.975779 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:17:13.976488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m19:17:14.243651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '293440b8-bbcf-4655-b3ef-d2dd885e35c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd85c40>]}
[0m19:17:14.311203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '293440b8-bbcf-4655-b3ef-d2dd885e35c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd86120>]}
[0m19:17:14.312793 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:17:14.459608 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:17:14.643666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:17:14.644790 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__fields_lost_reasons.sql
[0m19:17:14.645680 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__fields_stages.sql
[0m19:17:14.966650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '293440b8-bbcf-4655-b3ef-d2dd885e35c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd27dd0>]}
[0m19:17:15.131054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '293440b8-bbcf-4655-b3ef-d2dd885e35c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf4a270>]}
[0m19:17:15.131663 [info ] [MainThread]: Found 8 models, 17 data tests, 6 sources, 428 macros
[0m19:17:15.132105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '293440b8-bbcf-4655-b3ef-d2dd885e35c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf2ed80>]}
[0m19:17:15.135209 [info ] [MainThread]: 
[0m19:17:15.135887 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:17:15.140611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m19:17:15.213178 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:17:15.213708 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m19:17:15.214075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:15.274510 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m19:17:15.275327 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:17:15.275975 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m19:17:15.281832 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m19:17:15.285290 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m19:17:15.287913 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m19:17:15.299512 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:15.299965 [debug] [MainThread]: On master: BEGIN
[0m19:17:15.300332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:17:15.316199 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:17:15.316823 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:15.317301 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:17:15.322182 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m19:17:15.324316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '293440b8-bbcf-4655-b3ef-d2dd885e35c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6d6900>]}
[0m19:17:15.324799 [debug] [MainThread]: On master: ROLLBACK
[0m19:17:15.326084 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:15.326563 [debug] [MainThread]: On master: BEGIN
[0m19:17:15.329653 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:17:15.330249 [debug] [MainThread]: On master: COMMIT
[0m19:17:15.330664 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:15.331029 [debug] [MainThread]: On master: COMMIT
[0m19:17:15.332487 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:17:15.332982 [debug] [MainThread]: On master: Close
[0m19:17:15.333547 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:17:15.333976 [info ] [MainThread]: 
[0m19:17:15.337497 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:17:15.338066 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m19:17:15.338812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m19:17:15.339322 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:17:15.362917 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:17:15.364135 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:17:15.383624 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:17:15.384621 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:17:15.385107 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m19:17:15.385526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:15.402266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:17:15.402909 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:17:15.403610 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m19:17:15.409464 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:17:15.414255 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m19:17:15.415709 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m19:17:15.416479 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.08s]
[0m19:17:15.417272 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:17:15.417825 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:17:15.418345 [info ] [Thread-1 (]: 2 of 17 START test assert_change_stage_references_lost_reason_id ............... [RUN]
[0m19:17:15.418971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m19:17:15.419446 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:17:15.422727 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:17:15.423564 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:17:15.425842 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:17:15.426701 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:17:15.427250 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m19:17:15.427713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:15.447571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:17:15.448154 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:17:15.448614 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m19:17:15.451608 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: integer = text
LINE 16: ON CAST(d.new_value AS INTEGER) = s.id
                                         ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m19:17:15.452344 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m19:17:15.454534 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m19:17:15.465388 [debug] [Thread-1 (]: Database Error in test assert_change_stage_references_lost_reason_id (tests/assert_change_stage_references_lost_reason_id.sql)
  operator does not exist: integer = text
  LINE 16: ON CAST(d.new_value AS INTEGER) = s.id
                                           ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/tests/assert_change_stage_references_lost_reason_id.sql
[0m19:17:15.466041 [error] [Thread-1 (]: 2 of 17 ERROR assert_change_stage_references_lost_reason_id .................... [[31mERROR[0m in 0.05s]
[0m19:17:15.466772 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:17:15.467271 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:17:15.467714 [info ] [Thread-1 (]: 3 of 17 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m19:17:15.469030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m19:17:15.469479 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:17:15.473120 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:17:15.474073 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:17:15.476607 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:17:15.477446 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:17:15.477863 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m19:17:15.478252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:15.497777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m19:17:15.498720 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:17:15.499255 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m19:17:15.503521 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: integer = text
LINE 16: ON CAST(d.new_value AS INTEGER) = s.id
                                         ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m19:17:15.504333 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m19:17:15.506633 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m19:17:15.510833 [debug] [Thread-1 (]: Database Error in test assert_change_stage_references_stage_id (tests/assert_change_stage_references_stage_id.sql)
  operator does not exist: integer = text
  LINE 16: ON CAST(d.new_value AS INTEGER) = s.id
                                           ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/tests/assert_change_stage_references_stage_id.sql
[0m19:17:15.511497 [error] [Thread-1 (]: 3 of 17 ERROR assert_change_stage_references_stage_id .......................... [[31mERROR[0m in 0.04s]
[0m19:17:15.512275 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:17:15.512780 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:17:15.513210 [info ] [Thread-1 (]: 4 of 17 START test assert_change_user_references_user_id ....................... [RUN]
[0m19:17:15.513809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m19:17:15.514243 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:17:15.517161 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:17:15.517989 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:17:15.520529 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:17:15.521389 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:17:15.521910 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m19:17:15.522501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:15.539001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:17:15.539720 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:17:15.540201 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m19:17:15.545623 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:17:15.548506 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m19:17:15.550050 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m19:17:15.550847 [info ] [Thread-1 (]: 4 of 17 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.04s]
[0m19:17:15.551708 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:17:15.552332 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:17:15.553232 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m19:17:15.554000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m19:17:15.554462 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:17:15.566154 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:17:15.567416 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:17:15.570216 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:17:15.571093 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:17:15.571526 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m19:17:15.571925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:15.587928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:17:15.588605 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:17:15.589063 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m19:17:15.591608 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:17:15.593412 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m19:17:15.594792 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m19:17:15.595548 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.04s]
[0m19:17:15.596485 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:17:15.597040 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:17:15.597672 [info ] [Thread-1 (]: 6 of 17 START test not_null_stg_pipedrive__activity_due_date ................... [RUN]
[0m19:17:15.598446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5)
[0m19:17:15.598974 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:17:15.604206 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:17:15.605163 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:17:15.607803 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:17:15.608677 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:17:15.609128 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: BEGIN
[0m19:17:15.609612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:15.628306 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m19:17:15.628999 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:17:15.629472 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_date is null



      
    ) dbt_internal_test
[0m19:17:15.633148 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:17:15.635721 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: ROLLBACK
[0m19:17:15.637857 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: Close
[0m19:17:15.639398 [info ] [Thread-1 (]: 6 of 17 PASS not_null_stg_pipedrive__activity_due_date ......................... [[32mPASS[0m in 0.04s]
[0m19:17:15.640384 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:17:15.640947 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:17:15.641586 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m19:17:15.642294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m19:17:15.642762 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:17:15.647416 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:17:15.648508 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:17:15.651624 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:17:15.652477 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:17:15.652910 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m19:17:15.653313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:15.673261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:17:15.673896 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:17:15.674372 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m19:17:15.677080 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:17:15.678930 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m19:17:15.680727 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m19:17:15.681680 [info ] [Thread-1 (]: 7 of 17 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m19:17:15.682646 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:17:15.683208 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:17:15.683785 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m19:17:15.684554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m19:17:15.685066 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:17:15.690363 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:17:15.691461 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:17:15.695148 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:17:15.696057 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:17:15.696487 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m19:17:15.696881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:15.716736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m19:17:15.717410 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:17:15.717888 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m19:17:15.720547 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:17:15.722685 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m19:17:15.724824 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m19:17:15.725991 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m19:17:15.727313 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:17:15.728020 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:17:15.728650 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m19:17:15.729318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m19:17:15.729789 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:17:15.734733 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:17:15.735694 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:17:15.738534 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:17:15.740643 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:17:15.741180 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m19:17:15.741640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:15.758608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:17:15.759252 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:17:15.759751 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m19:17:15.762617 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:17:15.764429 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m19:17:15.765939 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m19:17:15.767097 [info ] [Thread-1 (]: 9 of 17 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.04s]
[0m19:17:15.768008 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:17:15.768663 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:17:15.769204 [info ] [Thread-1 (]: 10 of 17 START test not_null_stg_pipedrive__deal_changes_id .................... [RUN]
[0m19:17:15.769925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m19:17:15.770424 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:17:15.774743 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:17:15.775553 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:17:15.778069 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:17:15.778955 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:17:15.779406 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m19:17:15.779810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:15.796537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:17:15.797248 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:17:15.797723 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m19:17:15.800505 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:17:15.802300 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m19:17:15.803838 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m19:17:15.804682 [info ] [Thread-1 (]: 10 of 17 PASS not_null_stg_pipedrive__deal_changes_id .......................... [[32mPASS[0m in 0.03s]
[0m19:17:15.805532 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:17:15.806064 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:17:15.806553 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m19:17:15.807123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m19:17:15.807583 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:17:15.813962 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:17:15.815076 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:17:15.817622 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:17:15.818533 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:17:15.818963 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m19:17:15.819398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:15.837238 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:17:15.837878 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:17:15.838329 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m19:17:15.841403 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:17:15.843150 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m19:17:15.844505 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m19:17:15.845329 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m19:17:15.846194 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:17:15.846803 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:17:15.847514 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m19:17:15.848227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m19:17:15.848702 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:17:15.853009 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:17:15.853937 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:17:15.856406 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:17:15.857241 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:17:15.857684 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m19:17:15.858083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:15.874497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:17:15.875094 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:17:15.875578 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m19:17:15.877610 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:17:15.879334 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m19:17:15.880688 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m19:17:15.881577 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.03s]
[0m19:17:15.882539 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:17:15.883136 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:17:15.883746 [info ] [Thread-1 (]: 13 of 17 START test not_null_stg_pipedrive__users_modified_date ................ [RUN]
[0m19:17:15.884325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86)
[0m19:17:15.884768 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:17:15.889153 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:17:15.890060 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:17:15.892475 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:17:15.893254 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:17:15.893696 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: BEGIN
[0m19:17:15.894165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:15.910928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:17:15.911541 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:17:15.912003 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_date is null



      
    ) dbt_internal_test
[0m19:17:15.914975 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:17:15.916705 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: ROLLBACK
[0m19:17:15.917951 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: Close
[0m19:17:15.918668 [info ] [Thread-1 (]: 13 of 17 PASS not_null_stg_pipedrive__users_modified_date ...................... [[32mPASS[0m in 0.03s]
[0m19:17:15.919411 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:17:15.919929 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:17:15.920509 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m19:17:15.921259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m19:17:15.921743 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:17:15.926218 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:17:15.927056 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:17:15.929901 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:17:15.931135 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:17:15.931660 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m19:17:15.932089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:15.947320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m19:17:15.948001 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:17:15.948531 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m19:17:15.950767 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:17:15.952531 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m19:17:15.953966 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m19:17:15.954775 [info ] [Thread-1 (]: 14 of 17 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.03s]
[0m19:17:15.955569 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:17:15.956130 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:17:15.956706 [info ] [Thread-1 (]: 15 of 17 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m19:17:15.957651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m19:17:15.958202 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:17:15.963372 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:17:15.964252 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:17:15.966777 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:17:15.967628 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:17:15.968077 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m19:17:15.968497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:16.023042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m19:17:16.023916 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:17:16.024742 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m19:17:16.034819 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m19:17:16.037894 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m19:17:16.050539 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m19:17:16.051825 [info ] [Thread-1 (]: 15 of 17 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.09s]
[0m19:17:16.053883 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:17:16.054787 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:17:16.055814 [info ] [Thread-1 (]: 16 of 17 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m19:17:16.056726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m19:17:16.057506 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:17:16.080262 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:17:16.081594 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:17:16.087355 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:17:16.088664 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:17:16.089433 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m19:17:16.090191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:16.444541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.354 seconds
[0m19:17:16.445406 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:17:16.446247 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:17:16.453631 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m19:17:16.457673 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m19:17:16.460215 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m19:17:16.461932 [info ] [Thread-1 (]: 16 of 17 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.41s]
[0m19:17:16.463184 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:17:16.464065 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:17:16.466076 [info ] [Thread-1 (]: 17 of 17 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m19:17:16.467147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m19:17:16.467955 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:17:16.519603 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:17:16.521486 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:17:16.526796 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:17:16.528272 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:17:16.529879 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m19:17:16.568550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:16.713157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.182 seconds
[0m19:17:16.713966 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:17:16.714695 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:17:16.720857 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:17:16.723893 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m19:17:16.726180 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m19:17:16.727402 [info ] [Thread-1 (]: 17 of 17 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.26s]
[0m19:17:16.728770 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:17:16.731206 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:16.731928 [debug] [MainThread]: On master: BEGIN
[0m19:17:16.732655 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:17:16.758654 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m19:17:16.759460 [debug] [MainThread]: On master: COMMIT
[0m19:17:16.760114 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:16.760761 [debug] [MainThread]: On master: COMMIT
[0m19:17:16.762581 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:17:16.763383 [debug] [MainThread]: On master: Close
[0m19:17:16.764354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:16.764968 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m19:17:16.765674 [info ] [MainThread]: 
[0m19:17:16.766395 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m19:17:16.773391 [debug] [MainThread]: Command end result
[0m19:17:16.832109 [info ] [MainThread]: 
[0m19:17:16.832948 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:17:16.834087 [info ] [MainThread]: 
[0m19:17:16.834942 [error] [MainThread]:   Database Error in test assert_change_stage_references_lost_reason_id (tests/assert_change_stage_references_lost_reason_id.sql)
  operator does not exist: integer = text
  LINE 16: ON CAST(d.new_value AS INTEGER) = s.id
                                           ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/tests/assert_change_stage_references_lost_reason_id.sql
[0m19:17:16.835547 [info ] [MainThread]: 
[0m19:17:16.836648 [error] [MainThread]:   Database Error in test assert_change_stage_references_stage_id (tests/assert_change_stage_references_stage_id.sql)
  operator does not exist: integer = text
  LINE 16: ON CAST(d.new_value AS INTEGER) = s.id
                                           ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enpal_assessment_project/tests/assert_change_stage_references_stage_id.sql
[0m19:17:16.837386 [info ] [MainThread]: 
[0m19:17:16.838115 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=2 SKIP=0 TOTAL=17
[0m19:17:16.841213 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.9604027, "process_in_blocks": "0", "process_kernel_time": 0.521419, "process_mem_max_rss": "115634176", "process_out_blocks": "0", "process_user_time": 3.291668}
[0m19:17:16.842370 [debug] [MainThread]: Command `dbt test` failed at 19:17:16.842124 after 2.96 seconds
[0m19:17:16.843181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d2d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd96750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bed84d0>]}
[0m19:17:16.843884 [debug] [MainThread]: Flushing usage events
[0m19:17:22.626004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102e8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111122f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111122a80>]}


============================== 19:17:22.632208 | 10bd5dcd-e53c-4ca1-9a4e-a177a42ee164 ==============================
[0m19:17:22.632208 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:17:22.632922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:17:22.886992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10bd5dcd-e53c-4ca1-9a4e-a177a42ee164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11166d3d0>]}
[0m19:17:22.957574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10bd5dcd-e53c-4ca1-9a4e-a177a42ee164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fba810>]}
[0m19:17:22.958511 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:17:23.099346 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:17:23.256444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:17:23.256928 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:17:23.317499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10bd5dcd-e53c-4ca1-9a4e-a177a42ee164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111231250>]}
[0m19:17:23.454583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10bd5dcd-e53c-4ca1-9a4e-a177a42ee164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f87fb0>]}
[0m19:17:23.455215 [info ] [MainThread]: Found 8 models, 17 data tests, 6 sources, 428 macros
[0m19:17:23.455687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10bd5dcd-e53c-4ca1-9a4e-a177a42ee164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f535c0>]}
[0m19:17:23.458524 [info ] [MainThread]: 
[0m19:17:23.459202 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:17:23.464301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:17:23.530953 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:17:23.531432 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:17:23.531807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:23.561696 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.030 seconds
[0m19:17:23.563279 [debug] [ThreadPool]: On list_postgres: Close
[0m19:17:23.565158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m19:17:23.573505 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:17:23.573965 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m19:17:23.574366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:17:23.590376 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m19:17:23.590957 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:17:23.591395 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m19:17:23.595289 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m19:17:23.596962 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m19:17:23.598313 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m19:17:23.605658 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:23.606112 [debug] [MainThread]: On master: BEGIN
[0m19:17:23.606454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:17:23.622131 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:17:23.622809 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:23.623288 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:17:23.628825 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m19:17:23.631649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10bd5dcd-e53c-4ca1-9a4e-a177a42ee164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112300b00>]}
[0m19:17:23.632404 [debug] [MainThread]: On master: ROLLBACK
[0m19:17:23.634045 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:23.634524 [debug] [MainThread]: On master: BEGIN
[0m19:17:23.637152 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:17:23.637758 [debug] [MainThread]: On master: COMMIT
[0m19:17:23.638182 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:23.638555 [debug] [MainThread]: On master: COMMIT
[0m19:17:23.640094 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:17:23.640670 [debug] [MainThread]: On master: Close
[0m19:17:23.641945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:17:23.643166 [info ] [MainThread]: 
[0m19:17:23.645759 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m19:17:23.646486 [info ] [Thread-1 (]: 1 of 8 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m19:17:23.647114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m19:17:23.647614 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m19:17:23.660723 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:17:23.661666 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m19:17:23.705874 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:17:23.706830 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:17:23.707267 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m19:17:23.707672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:23.723844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:17:23.724496 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:17:23.724952 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m19:17:23.727644 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:17:23.735146 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:17:23.735658 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m19:17:23.737497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:23.740751 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:17:23.741197 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m19:17:23.743175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:23.762252 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m19:17:23.762787 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:17:23.763199 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m19:17:23.767049 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:17:23.774602 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m19:17:23.780750 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:17:23.781269 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m19:17:23.784523 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:17:23.787479 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m19:17:23.789227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10bd5dcd-e53c-4ca1-9a4e-a177a42ee164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106cd9d0>]}
[0m19:17:23.790067 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m19:17:23.791047 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m19:17:23.791617 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:17:23.792178 [info ] [Thread-1 (]: 2 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m19:17:23.793044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m19:17:23.793568 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:17:23.796732 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:17:23.797586 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:17:23.802820 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:17:23.803780 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:17:23.804282 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m19:17:23.804953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:23.826022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m19:17:23.826691 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:17:23.827185 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m19:17:23.831198 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:17:23.834548 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:17:23.835023 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m19:17:23.836841 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:23.840359 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:17:23.840873 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m19:17:23.842597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:23.844753 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m19:17:23.845238 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:17:23.845657 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m19:17:23.848288 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:17:23.850967 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m19:17:23.851836 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:17:23.852271 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m19:17:23.856018 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:17:23.857660 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m19:17:23.858271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10bd5dcd-e53c-4ca1-9a4e-a177a42ee164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123c7920>]}
[0m19:17:23.859001 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.07s]
[0m19:17:23.859767 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:17:23.860331 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:17:23.861484 [info ] [Thread-1 (]: 3 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m19:17:23.862238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m19:17:23.862689 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:17:23.865535 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:17:23.866330 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:17:23.870031 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:17:23.871239 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:17:23.871761 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m19:17:23.872174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:23.891103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m19:17:23.891734 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:17:23.892214 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m19:17:23.895618 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:17:23.898942 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:17:23.899402 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m19:17:23.901130 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:23.904669 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:17:23.905178 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m19:17:23.906744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:23.908649 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m19:17:23.909089 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:17:23.909596 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m19:17:23.911754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:17:23.914470 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m19:17:23.915294 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:17:23.915720 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m19:17:23.919023 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:17:23.920746 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m19:17:23.921391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10bd5dcd-e53c-4ca1-9a4e-a177a42ee164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123c5910>]}
[0m19:17:23.922147 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m19:17:23.922896 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:17:23.923427 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:17:23.924295 [info ] [Thread-1 (]: 4 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m19:17:23.924913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m19:17:23.925366 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:17:23.928411 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:17:23.929306 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:17:23.933157 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:17:23.933945 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:17:23.934378 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m19:17:23.934782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:23.952796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:17:23.953642 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:17:23.954107 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m19:17:23.956572 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:17:23.959944 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:17:23.960431 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m19:17:23.963278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:17:23.968128 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:17:23.968606 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m19:17:23.970483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:23.972785 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m19:17:23.973282 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:17:23.973797 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m19:17:23.975771 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:17:23.978533 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m19:17:23.979362 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:17:23.979809 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m19:17:23.982389 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:17:23.984060 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m19:17:23.984741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10bd5dcd-e53c-4ca1-9a4e-a177a42ee164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112430bf0>]}
[0m19:17:23.985536 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m19:17:23.986292 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:17:23.986823 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:17:23.987920 [info ] [Thread-1 (]: 5 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m19:17:23.988527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m19:17:23.988965 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:17:23.991934 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:17:23.992741 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:17:23.996991 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:17:23.997879 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:17:23.998316 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m19:17:23.998737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:24.016692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:17:24.017354 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:17:24.017853 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m19:17:24.020447 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:17:24.023847 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:17:24.024314 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m19:17:24.026045 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:24.029920 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:17:24.030423 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m19:17:24.031982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:24.033917 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m19:17:24.034435 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:17:24.034914 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m19:17:24.036950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:17:24.039730 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m19:17:24.040580 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:17:24.041008 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m19:17:24.043530 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:17:24.045121 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m19:17:24.045816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10bd5dcd-e53c-4ca1-9a4e-a177a42ee164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fb9f40>]}
[0m19:17:24.046539 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m19:17:24.047271 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:17:24.047802 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m19:17:24.048475 [info ] [Thread-1 (]: 6 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m19:17:24.049098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m19:17:24.049762 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m19:17:24.052954 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:17:24.054034 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m19:17:24.058129 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:17:24.058958 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:17:24.059396 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m19:17:24.059795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:24.075816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:17:24.076511 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:17:24.076985 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified AS modified_date
FROM "postgres"."public"."users"
  );
[0m19:17:24.079352 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:17:24.082610 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:17:24.083082 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m19:17:24.084667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:24.088242 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:17:24.088740 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m19:17:24.090304 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:17:24.092439 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m19:17:24.092904 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:17:24.093422 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m19:17:24.095499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:17:24.099646 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m19:17:24.100769 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:17:24.101299 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m19:17:24.103976 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:17:24.105660 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m19:17:24.106361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10bd5dcd-e53c-4ca1-9a4e-a177a42ee164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124140b0>]}
[0m19:17:24.107069 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m19:17:24.107869 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m19:17:24.108402 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:17:24.108944 [info ] [Thread-1 (]: 7 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m19:17:24.109774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m19:17:24.110269 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:17:24.113074 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:17:24.113902 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:17:24.118586 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:17:24.119541 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:17:24.120056 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m19:17:24.120485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:24.136670 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:17:24.137293 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:17:24.137779 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id', INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m19:17:24.139407 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 15:  CAST(field_value_options ->> 'id', INTEGER) AS id,
                                           ^

[0m19:17:24.139963 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: ROLLBACK
[0m19:17:24.141705 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m19:17:24.147946 [debug] [Thread-1 (]: Database Error in model stg_pipedrive__fields_lost_reasons (models/staging/stg_pipedrive__fields_lost_reasons.sql)
  syntax error at or near ","
  LINE 15:  CAST(field_value_options ->> 'id', INTEGER) AS id,
                                             ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__fields_lost_reasons.sql
[0m19:17:24.148548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10bd5dcd-e53c-4ca1-9a4e-a177a42ee164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112421a60>]}
[0m19:17:24.149297 [error] [Thread-1 (]: 7 of 8 ERROR creating sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[31mERROR[0m in 0.04s]
[0m19:17:24.150054 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:17:24.150582 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:17:24.152160 [info ] [Thread-1 (]: 8 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m19:17:24.152803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m19:17:24.153260 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:17:24.156466 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:17:24.157278 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:17:24.161506 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:17:24.162398 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:17:24.163016 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m19:17:24.163587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:24.179598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:17:24.180257 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:17:24.180756 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id', INTEGER),
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m19:17:24.182197 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 15:  CAST(field_value_options ->> 'id', INTEGER),
                                           ^

[0m19:17:24.182827 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: ROLLBACK
[0m19:17:24.184475 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m19:17:24.187723 [debug] [Thread-1 (]: Database Error in model stg_pipedrive__fields_stages (models/staging/stg_pipedrive__fields_stages.sql)
  syntax error at or near ","
  LINE 15:  CAST(field_value_options ->> 'id', INTEGER),
                                             ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__fields_stages.sql
[0m19:17:24.188532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10bd5dcd-e53c-4ca1-9a4e-a177a42ee164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123cee70>]}
[0m19:17:24.189233 [error] [Thread-1 (]: 8 of 8 ERROR creating sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[31mERROR[0m in 0.04s]
[0m19:17:24.189952 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:17:24.191295 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:24.191720 [debug] [MainThread]: On master: BEGIN
[0m19:17:24.192072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:17:24.208268 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:17:24.208966 [debug] [MainThread]: On master: COMMIT
[0m19:17:24.209489 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:24.209867 [debug] [MainThread]: On master: COMMIT
[0m19:17:24.211134 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:17:24.211588 [debug] [MainThread]: On master: Close
[0m19:17:24.212092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:24.212469 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__fields_stages' was properly closed.
[0m19:17:24.212930 [info ] [MainThread]: 
[0m19:17:24.213474 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m19:17:24.215679 [debug] [MainThread]: Command end result
[0m19:17:24.250671 [info ] [MainThread]: 
[0m19:17:24.251215 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:17:24.251726 [info ] [MainThread]: 
[0m19:17:24.252237 [error] [MainThread]:   Database Error in model stg_pipedrive__fields_lost_reasons (models/staging/stg_pipedrive__fields_lost_reasons.sql)
  syntax error at or near ","
  LINE 15:  CAST(field_value_options ->> 'id', INTEGER) AS id,
                                             ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__fields_lost_reasons.sql
[0m19:17:24.252742 [info ] [MainThread]: 
[0m19:17:24.253588 [error] [MainThread]:   Database Error in model stg_pipedrive__fields_stages (models/staging/stg_pipedrive__fields_stages.sql)
  syntax error at or near ","
  LINE 15:  CAST(field_value_options ->> 'id', INTEGER),
                                             ^
  compiled code at target/run/enpal_assessment_project/models/staging/stg_pipedrive__fields_stages.sql
[0m19:17:24.254467 [info ] [MainThread]: 
[0m19:17:24.255098 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m19:17:24.257048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7154219, "process_in_blocks": "0", "process_kernel_time": 0.419991, "process_mem_max_rss": "109993984", "process_out_blocks": "0", "process_user_time": 2.798211}
[0m19:17:24.257994 [debug] [MainThread]: Command `dbt run` failed at 19:17:24.257814 after 1.72 seconds
[0m19:17:24.258639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11100a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102e8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f9a5d0>]}
[0m19:17:24.259120 [debug] [MainThread]: Flushing usage events
[0m19:18:03.143569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1cb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc83110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc82c30>]}


============================== 19:18:03.148713 | be086f09-985e-4fca-a3d1-cde06311fac3 ==============================
[0m19:18:03.148713 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:18:03.149411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:18:03.388278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be086f09-985e-4fca-a3d1-cde06311fac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dda3fe0>]}
[0m19:18:03.452996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be086f09-985e-4fca-a3d1-cde06311fac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d717f20>]}
[0m19:18:03.453923 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:18:03.585871 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:18:03.734919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:18:03.735746 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__fields_lost_reasons.sql
[0m19:18:03.736236 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__fields_stages.sql
[0m19:18:04.030358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be086f09-985e-4fca-a3d1-cde06311fac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e27d160>]}
[0m19:18:04.159380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be086f09-985e-4fca-a3d1-cde06311fac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea6a060>]}
[0m19:18:04.159959 [info ] [MainThread]: Found 8 models, 17 data tests, 6 sources, 428 macros
[0m19:18:04.160378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be086f09-985e-4fca-a3d1-cde06311fac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e27cb90>]}
[0m19:18:04.163065 [info ] [MainThread]: 
[0m19:18:04.163718 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:18:04.168189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:18:04.231922 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:18:04.232394 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:18:04.232767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:04.267381 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.035 seconds
[0m19:18:04.269145 [debug] [ThreadPool]: On list_postgres: Close
[0m19:18:04.271774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m19:18:04.279793 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:18:04.280315 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m19:18:04.280754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:04.296430 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m19:18:04.297329 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:18:04.297914 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m19:18:04.301830 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m19:18:04.303469 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m19:18:04.304661 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m19:18:04.311041 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:04.311487 [debug] [MainThread]: On master: BEGIN
[0m19:18:04.311826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:04.326963 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m19:18:04.327521 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:04.328002 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:18:04.332727 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m19:18:04.334280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be086f09-985e-4fca-a3d1-cde06311fac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efbdfd0>]}
[0m19:18:04.334782 [debug] [MainThread]: On master: ROLLBACK
[0m19:18:04.336105 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:04.336536 [debug] [MainThread]: On master: BEGIN
[0m19:18:04.338303 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:18:04.338784 [debug] [MainThread]: On master: COMMIT
[0m19:18:04.339223 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:04.339576 [debug] [MainThread]: On master: COMMIT
[0m19:18:04.340729 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:18:04.341242 [debug] [MainThread]: On master: Close
[0m19:18:04.341836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:18:04.342270 [info ] [MainThread]: 
[0m19:18:04.344872 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m19:18:04.345647 [info ] [Thread-1 (]: 1 of 8 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m19:18:04.346251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m19:18:04.346708 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m19:18:04.362580 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:18:04.364429 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m19:18:04.404669 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:18:04.405581 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:18:04.406012 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m19:18:04.406413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:04.422373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:18:04.422972 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:18:04.423436 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m19:18:04.426766 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:18:04.433516 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:18:04.433999 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m19:18:04.435700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:18:04.439007 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:18:04.439486 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m19:18:04.441406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:18:04.460890 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m19:18:04.461457 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:18:04.461873 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m19:18:04.464261 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:18:04.471243 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m19:18:04.477072 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:18:04.477710 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m19:18:04.480794 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:18:04.483583 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m19:18:04.485389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be086f09-985e-4fca-a3d1-cde06311fac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c531850>]}
[0m19:18:04.486183 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m19:18:04.487027 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m19:18:04.487591 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:18:04.488184 [info ] [Thread-1 (]: 2 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m19:18:04.488936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m19:18:04.489384 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:18:04.492419 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:18:04.493264 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:18:04.497121 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:18:04.497906 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:18:04.498325 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m19:18:04.498726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:04.518055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m19:18:04.518635 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:18:04.519126 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m19:18:04.521759 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:18:04.525033 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:18:04.525596 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m19:18:04.527341 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:18:04.530708 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:18:04.531223 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m19:18:04.533966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:18:04.536343 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m19:18:04.536887 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:18:04.537330 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m19:18:04.539372 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:18:04.542547 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m19:18:04.543568 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:18:04.544086 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m19:18:04.547406 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:18:04.549239 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m19:18:04.549922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be086f09-985e-4fca-a3d1-cde06311fac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0a3ec0>]}
[0m19:18:04.550813 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m19:18:04.551913 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:18:04.552633 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:18:04.553430 [info ] [Thread-1 (]: 3 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m19:18:04.554032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m19:18:04.554492 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:18:04.559316 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:18:04.560358 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:18:04.564743 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:18:04.565652 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:18:04.567255 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m19:18:04.567958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:04.586059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:18:04.586703 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:18:04.587185 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m19:18:04.591364 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:18:04.594744 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:18:04.595274 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m19:18:04.597751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:18:04.601139 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:18:04.601609 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m19:18:04.603624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:18:04.605727 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m19:18:04.606195 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:18:04.608180 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m19:18:04.610597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:18:04.613324 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m19:18:04.614179 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:18:04.614617 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m19:18:04.617275 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:18:04.618870 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m19:18:04.619483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be086f09-985e-4fca-a3d1-cde06311fac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0c0080>]}
[0m19:18:04.620185 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.07s]
[0m19:18:04.620928 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:18:04.621448 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:18:04.622364 [info ] [Thread-1 (]: 4 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m19:18:04.623178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m19:18:04.623803 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:18:04.627261 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:18:04.628192 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:18:04.633730 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:18:04.635195 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:18:04.635751 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m19:18:04.636251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:04.653101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:18:04.653699 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:18:04.654193 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m19:18:04.656856 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:18:04.660254 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:18:04.660746 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m19:18:04.662402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:18:04.665680 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:18:04.666144 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m19:18:04.668318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:18:04.670446 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m19:18:04.670886 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:18:04.671383 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m19:18:04.673343 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:18:04.676023 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m19:18:04.676861 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:18:04.677289 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m19:18:04.679671 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:18:04.681260 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m19:18:04.681839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be086f09-985e-4fca-a3d1-cde06311fac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0c07d0>]}
[0m19:18:04.682598 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m19:18:04.683445 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:18:04.683993 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:18:04.684642 [info ] [Thread-1 (]: 5 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m19:18:04.685264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m19:18:04.685705 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:18:04.688509 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:18:04.689606 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:18:04.698535 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:18:04.699950 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:18:04.700501 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m19:18:04.701063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:04.718712 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:18:04.719454 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:18:04.719972 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m19:18:04.722521 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:18:04.726197 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:18:04.726709 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m19:18:04.728373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:18:04.731477 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:18:04.731916 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m19:18:04.733517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:18:04.736141 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m19:18:04.736632 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:18:04.737051 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m19:18:04.739095 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:18:04.741814 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m19:18:04.742700 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:18:04.743134 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m19:18:04.745652 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:18:04.747253 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m19:18:04.747838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be086f09-985e-4fca-a3d1-cde06311fac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0ee1b0>]}
[0m19:18:04.748521 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m19:18:04.749428 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:18:04.750007 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m19:18:04.751019 [info ] [Thread-1 (]: 6 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m19:18:04.751708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m19:18:04.752275 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m19:18:04.756339 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:18:04.757239 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m19:18:04.761734 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:18:04.762627 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:18:04.763060 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m19:18:04.763460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:04.785611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m19:18:04.786934 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:18:04.787522 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified AS modified_date
FROM "postgres"."public"."users"
  );
[0m19:18:04.790356 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:18:04.794001 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:18:04.794497 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m19:18:04.796299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:18:04.799934 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:18:04.800968 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m19:18:04.803200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:18:04.805670 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m19:18:04.806212 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:18:04.806658 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m19:18:04.809650 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:18:04.812336 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m19:18:04.813691 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:18:04.814362 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m19:18:04.817967 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:18:04.819986 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m19:18:04.821084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be086f09-985e-4fca-a3d1-cde06311fac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0eef30>]}
[0m19:18:04.822497 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.07s]
[0m19:18:04.824076 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m19:18:04.825378 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:18:04.826474 [info ] [Thread-1 (]: 7 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m19:18:04.827357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m19:18:04.828003 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:18:04.833328 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:18:04.836206 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:18:04.841427 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:18:04.842491 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:18:04.843078 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m19:18:04.843529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:04.870838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m19:18:04.871665 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:18:04.872587 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m19:18:04.877600 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:18:04.883348 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:18:04.884136 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m19:18:04.887159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:18:04.890211 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m19:18:04.890947 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:18:04.891416 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m19:18:04.894094 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:18:04.900081 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m19:18:04.901800 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:18:04.902726 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m19:18:04.905739 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:18:04.907853 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m19:18:04.908867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be086f09-985e-4fca-a3d1-cde06311fac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0d5280>]}
[0m19:18:04.910055 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.08s]
[0m19:18:04.911151 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:18:04.912125 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:18:04.913083 [info ] [Thread-1 (]: 8 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m19:18:04.913695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m19:18:04.914221 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:18:04.917493 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:18:04.918719 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:18:04.925172 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:18:04.926128 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:18:04.926845 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m19:18:04.927559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:04.951902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m19:18:04.952866 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:18:04.953649 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m19:18:04.958133 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:18:04.962933 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:18:04.963685 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m19:18:04.965708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:18:04.968547 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m19:18:04.969196 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:18:04.969741 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m19:18:04.972054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:18:04.974967 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m19:18:04.975956 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:18:04.976431 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m19:18:04.978153 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:18:04.980383 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m19:18:04.981255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be086f09-985e-4fca-a3d1-cde06311fac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0c1580>]}
[0m19:18:04.982097 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.07s]
[0m19:18:04.982910 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:18:04.984435 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:04.984870 [debug] [MainThread]: On master: BEGIN
[0m19:18:04.985221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:18:05.001806 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:18:05.002297 [debug] [MainThread]: On master: COMMIT
[0m19:18:05.002723 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:05.003091 [debug] [MainThread]: On master: COMMIT
[0m19:18:05.004287 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:18:05.004686 [debug] [MainThread]: On master: Close
[0m19:18:05.005195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:05.005555 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__fields_stages' was properly closed.
[0m19:18:05.006059 [info ] [MainThread]: 
[0m19:18:05.006481 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m19:18:05.008811 [debug] [MainThread]: Command end result
[0m19:18:05.041669 [info ] [MainThread]: 
[0m19:18:05.042193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:18:05.042582 [info ] [MainThread]: 
[0m19:18:05.042995 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:18:05.044808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9860045, "process_in_blocks": "0", "process_kernel_time": 0.363064, "process_mem_max_rss": "112881664", "process_out_blocks": "0", "process_user_time": 2.951452}
[0m19:18:05.045561 [debug] [MainThread]: Command `dbt run` succeeded at 19:18:05.045408 after 1.99 seconds
[0m19:18:05.046185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f92d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcb4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6fbf20>]}
[0m19:18:05.046772 [debug] [MainThread]: Flushing usage events
[0m19:18:10.555128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10493c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641ad80>]}


============================== 19:18:10.560311 | 9f62fb27-a69f-4a56-9aed-c71ff0154095 ==============================
[0m19:18:10.560311 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:18:10.561056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:18:10.797519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f62fb27-a69f-4a56-9aed-c71ff0154095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068bd6a0>]}
[0m19:18:10.863848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f62fb27-a69f-4a56-9aed-c71ff0154095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641af90>]}
[0m19:18:10.864777 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:18:10.994642 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:18:11.148001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:18:11.148460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:18:11.208277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f62fb27-a69f-4a56-9aed-c71ff0154095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641b1d0>]}
[0m19:18:11.433767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f62fb27-a69f-4a56-9aed-c71ff0154095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a108c0>]}
[0m19:18:11.434445 [info ] [MainThread]: Found 8 models, 17 data tests, 6 sources, 428 macros
[0m19:18:11.434939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f62fb27-a69f-4a56-9aed-c71ff0154095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b9760>]}
[0m19:18:11.438783 [info ] [MainThread]: 
[0m19:18:11.439567 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:18:11.444394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m19:18:11.512319 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:18:11.512780 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m19:18:11.513141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:11.542692 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m19:18:11.543322 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:18:11.543772 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m19:18:11.547718 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m19:18:11.549436 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m19:18:11.550637 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m19:18:11.557909 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:11.558364 [debug] [MainThread]: On master: BEGIN
[0m19:18:11.558707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:11.574819 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:18:11.575888 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:11.576661 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:18:11.582024 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m19:18:11.584282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f62fb27-a69f-4a56-9aed-c71ff0154095', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10729d7c0>]}
[0m19:18:11.584810 [debug] [MainThread]: On master: ROLLBACK
[0m19:18:11.586190 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:11.586612 [debug] [MainThread]: On master: BEGIN
[0m19:18:11.588910 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:18:11.589466 [debug] [MainThread]: On master: COMMIT
[0m19:18:11.589849 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:11.590200 [debug] [MainThread]: On master: COMMIT
[0m19:18:11.592772 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m19:18:11.593284 [debug] [MainThread]: On master: Close
[0m19:18:11.594792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:18:11.595408 [info ] [MainThread]: 
[0m19:18:11.598046 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:18:11.598638 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m19:18:11.599376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m19:18:11.599850 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:18:11.624077 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:18:11.624977 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:18:11.643839 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:18:11.644778 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:18:11.645224 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m19:18:11.645627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:11.661477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:18:11.662125 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:18:11.662635 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m19:18:11.667746 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:18:11.672587 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m19:18:11.674038 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m19:18:11.674865 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.08s]
[0m19:18:11.675698 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:18:11.676285 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:18:11.676876 [info ] [Thread-1 (]: 2 of 17 START test assert_change_stage_references_lost_reason_id ............... [RUN]
[0m19:18:11.677540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m19:18:11.677997 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:18:11.681097 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:18:11.681955 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:18:11.684360 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:18:11.685196 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:18:11.685620 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m19:18:11.686018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:11.702595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:18:11.703326 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:18:11.703804 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m19:18:11.708605 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:18:11.710334 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m19:18:11.711705 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m19:18:11.712565 [info ] [Thread-1 (]: 2 of 17 PASS assert_change_stage_references_lost_reason_id ..................... [[32mPASS[0m in 0.03s]
[0m19:18:11.713614 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:18:11.714492 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:18:11.715763 [info ] [Thread-1 (]: 3 of 17 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m19:18:11.716946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m19:18:11.717527 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:18:11.721599 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:18:11.722552 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:18:11.725216 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:18:11.726170 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:18:11.726667 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m19:18:11.728264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:11.746117 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:18:11.746910 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:18:11.747432 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m19:18:11.753700 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m19:18:11.755685 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m19:18:11.757201 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m19:18:11.757987 [info ] [Thread-1 (]: 3 of 17 PASS assert_change_stage_references_stage_id ........................... [[32mPASS[0m in 0.04s]
[0m19:18:11.758709 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:18:11.759305 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:18:11.759803 [info ] [Thread-1 (]: 4 of 17 START test assert_change_user_references_user_id ....................... [RUN]
[0m19:18:11.760424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m19:18:11.761104 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:18:11.764968 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:18:11.765886 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:18:11.768286 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:18:11.769077 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:18:11.769503 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m19:18:11.769897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:11.788452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:18:11.789073 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:18:11.789538 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m19:18:11.795219 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:18:11.797264 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m19:18:11.799247 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m19:18:11.800052 [info ] [Thread-1 (]: 4 of 17 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.04s]
[0m19:18:11.800849 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:18:11.801382 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:18:11.801865 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m19:18:11.802553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m19:18:11.803037 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:18:11.810334 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:18:11.811197 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:18:11.813734 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:18:11.814544 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:18:11.815045 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m19:18:11.815494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:11.836688 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m19:18:11.837435 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:18:11.837893 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m19:18:11.840648 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:18:11.842417 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m19:18:11.843818 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m19:18:11.844670 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.04s]
[0m19:18:11.845475 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:18:11.846232 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:18:11.846745 [info ] [Thread-1 (]: 6 of 17 START test not_null_stg_pipedrive__activity_due_date ................... [RUN]
[0m19:18:11.847582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5)
[0m19:18:11.848115 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:18:11.852306 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:18:11.853106 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:18:11.855714 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:18:11.856645 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:18:11.857078 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: BEGIN
[0m19:18:11.857467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:11.874463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:18:11.875121 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:18:11.875586 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_date is null



      
    ) dbt_internal_test
[0m19:18:11.878065 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:18:11.879894 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: ROLLBACK
[0m19:18:11.881936 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: Close
[0m19:18:11.883231 [info ] [Thread-1 (]: 6 of 17 PASS not_null_stg_pipedrive__activity_due_date ......................... [[32mPASS[0m in 0.04s]
[0m19:18:11.884330 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:18:11.884852 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:18:11.885341 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m19:18:11.886083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m19:18:11.886617 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:18:11.891518 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:18:11.892395 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:18:11.894965 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:18:11.895993 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:18:11.896724 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m19:18:11.898912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:11.917200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:18:11.917848 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:18:11.918323 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m19:18:11.921678 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:18:11.923623 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m19:18:11.925095 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m19:18:11.925942 [info ] [Thread-1 (]: 7 of 17 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m19:18:11.926789 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:18:11.927357 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:18:11.927851 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m19:18:11.928589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m19:18:11.929142 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:18:11.934004 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:18:11.934886 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:18:11.937509 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:18:11.938407 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:18:11.938891 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m19:18:11.939351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:11.957543 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:18:11.958417 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:18:11.958887 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m19:18:11.961351 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:18:11.963243 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m19:18:11.965054 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m19:18:11.966388 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m19:18:11.967557 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:18:11.968110 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:18:11.968602 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m19:18:11.969439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m19:18:11.969956 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:18:11.975968 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:18:11.976851 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:18:11.979378 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:18:11.980167 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:18:11.980606 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m19:18:11.981002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:11.998108 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:18:11.998912 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:18:11.999397 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m19:18:12.002570 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:18:12.004651 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m19:18:12.006351 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m19:18:12.007245 [info ] [Thread-1 (]: 9 of 17 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.04s]
[0m19:18:12.008137 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:18:12.008663 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:18:12.009279 [info ] [Thread-1 (]: 10 of 17 START test not_null_stg_pipedrive__deal_changes_id .................... [RUN]
[0m19:18:12.010138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m19:18:12.010616 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:18:12.014996 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:18:12.015823 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:18:12.018236 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:18:12.019087 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:18:12.019549 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m19:18:12.019949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:12.037020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:18:12.037721 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:18:12.038582 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m19:18:12.042205 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:18:12.043998 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m19:18:12.046579 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m19:18:12.047520 [info ] [Thread-1 (]: 10 of 17 PASS not_null_stg_pipedrive__deal_changes_id .......................... [[32mPASS[0m in 0.04s]
[0m19:18:12.048389 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:18:12.048928 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:18:12.049431 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m19:18:12.050171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m19:18:12.050751 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:18:12.055498 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:18:12.056377 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:18:12.058834 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:18:12.059615 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:18:12.060046 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m19:18:12.060445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:12.077562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:18:12.078309 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:18:12.078859 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m19:18:12.082205 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:18:12.084019 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m19:18:12.085469 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m19:18:12.086386 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m19:18:12.087375 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:18:12.088196 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:18:12.088934 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m19:18:12.089665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m19:18:12.090239 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:18:12.094756 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:18:12.095759 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:18:12.098364 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:18:12.099220 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:18:12.099660 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m19:18:12.100060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:12.118662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:18:12.119359 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:18:12.119817 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m19:18:12.122290 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:18:12.124023 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m19:18:12.125457 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m19:18:12.126246 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m19:18:12.127064 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:18:12.127578 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:18:12.128330 [info ] [Thread-1 (]: 13 of 17 START test not_null_stg_pipedrive__users_modified_date ................ [RUN]
[0m19:18:12.129114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86)
[0m19:18:12.129623 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:18:12.134172 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:18:12.135048 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:18:12.137598 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:18:12.138762 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:18:12.139387 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: BEGIN
[0m19:18:12.139846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:12.156416 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:18:12.157125 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:18:12.157600 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_date is null



      
    ) dbt_internal_test
[0m19:18:12.160106 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:18:12.161918 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: ROLLBACK
[0m19:18:12.163566 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: Close
[0m19:18:12.164429 [info ] [Thread-1 (]: 13 of 17 PASS not_null_stg_pipedrive__users_modified_date ...................... [[32mPASS[0m in 0.04s]
[0m19:18:12.165292 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:18:12.165834 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:18:12.166325 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m19:18:12.167052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m19:18:12.167642 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:18:12.172489 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:18:12.173493 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:18:12.175939 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:18:12.176730 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:18:12.177161 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m19:18:12.177555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:12.194334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:18:12.194982 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:18:12.195510 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m19:18:12.198614 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:18:12.200399 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m19:18:12.201706 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m19:18:12.202557 [info ] [Thread-1 (]: 14 of 17 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m19:18:12.203504 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:18:12.204187 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:18:12.205043 [info ] [Thread-1 (]: 15 of 17 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m19:18:12.205847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m19:18:12.206324 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:18:12.212335 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:18:12.213180 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:18:12.215553 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:18:12.216353 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:18:12.216842 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m19:18:12.217243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:12.235638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:18:12.236360 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:18:12.236824 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m19:18:12.239449 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:18:12.241163 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m19:18:12.242496 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m19:18:12.243215 [info ] [Thread-1 (]: 15 of 17 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m19:18:12.244033 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:18:12.244543 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:18:12.245055 [info ] [Thread-1 (]: 16 of 17 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m19:18:12.245855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m19:18:12.246356 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:18:12.255691 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:18:12.256566 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:18:12.258988 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:18:12.259766 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:18:12.260254 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m19:18:12.260715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:12.278530 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:18:12.279377 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:18:12.279903 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:18:12.284124 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:18:12.285856 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m19:18:12.287338 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m19:18:12.288313 [info ] [Thread-1 (]: 16 of 17 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m19:18:12.289093 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:18:12.289611 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:18:12.290055 [info ] [Thread-1 (]: 17 of 17 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m19:18:12.290750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m19:18:12.291265 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:18:12.298293 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:18:12.299279 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:18:12.301829 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:18:12.302886 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:18:12.303509 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m19:18:12.304190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:12.321993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:18:12.322737 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:18:12.323254 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:18:12.327022 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:18:12.328736 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m19:18:12.330208 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m19:18:12.331136 [info ] [Thread-1 (]: 17 of 17 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m19:18:12.331964 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:18:12.333371 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:12.333899 [debug] [MainThread]: On master: BEGIN
[0m19:18:12.334256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:18:12.350418 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:18:12.351087 [debug] [MainThread]: On master: COMMIT
[0m19:18:12.351506 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:12.351864 [debug] [MainThread]: On master: COMMIT
[0m19:18:12.353031 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:18:12.353440 [debug] [MainThread]: On master: Close
[0m19:18:12.353933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:12.354396 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m19:18:12.354914 [info ] [MainThread]: 
[0m19:18:12.355351 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m19:18:12.359177 [debug] [MainThread]: Command end result
[0m19:18:12.399473 [info ] [MainThread]: 
[0m19:18:12.400004 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:18:12.400400 [info ] [MainThread]: 
[0m19:18:12.400818 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m19:18:12.402489 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9397336, "process_in_blocks": "0", "process_kernel_time": 0.383025, "process_mem_max_rss": "111546368", "process_out_blocks": "0", "process_user_time": 2.784124}
[0m19:18:12.403280 [debug] [MainThread]: Command `dbt test` succeeded at 19:18:12.403133 after 1.94 seconds
[0m19:18:12.403824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102796d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728d7f0>]}
[0m19:18:12.404297 [debug] [MainThread]: Flushing usage events
[0m19:24:40.715994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0e23c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f287230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f286d50>]}


============================== 19:24:40.723045 | c74e99fb-66c0-4152-88c5-d5391fca0581 ==============================
[0m19:24:40.723045 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:24:40.723870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:24:40.999896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c74e99fb-66c0-4152-88c5-d5391fca0581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f378830>]}
[0m19:24:41.067853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c74e99fb-66c0-4152-88c5-d5391fca0581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f37aa50>]}
[0m19:24:41.069178 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:24:41.221929 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:24:41.435712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:24:41.436954 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__fields_stages.sql
[0m19:24:41.438044 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__fields_lost_reasons.sql
[0m19:24:41.776581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c74e99fb-66c0-4152-88c5-d5391fca0581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110129940>]}
[0m19:24:41.953693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c74e99fb-66c0-4152-88c5-d5391fca0581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101066c0>]}
[0m19:24:41.954320 [info ] [MainThread]: Found 8 models, 17 data tests, 6 sources, 428 macros
[0m19:24:41.954829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c74e99fb-66c0-4152-88c5-d5391fca0581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f99d4f0>]}
[0m19:24:41.957777 [info ] [MainThread]: 
[0m19:24:41.958505 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:24:41.963494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:24:42.035284 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:24:42.035759 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:24:42.036135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:42.089615 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.053 seconds
[0m19:24:42.092072 [debug] [ThreadPool]: On list_postgres: Close
[0m19:24:42.094824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m19:24:42.102156 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:24:42.102589 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m19:24:42.102935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:42.120058 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m19:24:42.120606 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:24:42.121039 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m19:24:42.125047 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m19:24:42.126644 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m19:24:42.127943 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m19:24:42.134719 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:42.135142 [debug] [MainThread]: On master: BEGIN
[0m19:24:42.135483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:24:42.152759 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:24:42.153372 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:42.153916 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:24:42.158972 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m19:24:42.161052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c74e99fb-66c0-4152-88c5-d5391fca0581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105e1880>]}
[0m19:24:42.161548 [debug] [MainThread]: On master: ROLLBACK
[0m19:24:42.162924 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:42.163354 [debug] [MainThread]: On master: BEGIN
[0m19:24:42.165613 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:24:42.166087 [debug] [MainThread]: On master: COMMIT
[0m19:24:42.166558 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:42.166919 [debug] [MainThread]: On master: COMMIT
[0m19:24:42.168205 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:24:42.168642 [debug] [MainThread]: On master: Close
[0m19:24:42.169184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:24:42.169628 [info ] [MainThread]: 
[0m19:24:42.172767 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m19:24:42.173465 [info ] [Thread-1 (]: 1 of 8 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m19:24:42.174192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m19:24:42.174809 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m19:24:42.186312 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:24:42.187602 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m19:24:42.226993 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:24:42.227884 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:24:42.228325 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m19:24:42.228728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:42.246966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:24:42.247736 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:24:42.248356 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m19:24:42.250911 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:24:42.258134 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:24:42.258695 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m19:24:42.260446 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:42.263765 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:24:42.264229 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m19:24:42.266167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:42.285533 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m19:24:42.286048 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:24:42.286471 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m19:24:42.292459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m19:24:42.299901 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m19:24:42.305649 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m19:24:42.306180 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m19:24:42.309549 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:24:42.312377 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m19:24:42.314332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c74e99fb-66c0-4152-88c5-d5391fca0581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db2deb0>]}
[0m19:24:42.315166 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m19:24:42.316070 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m19:24:42.316632 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:24:42.317279 [info ] [Thread-1 (]: 2 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m19:24:42.317912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m19:24:42.318383 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:24:42.321344 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:24:42.322194 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:24:42.326175 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:24:42.326947 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:24:42.327380 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m19:24:42.327778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:42.344359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:24:42.344982 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:24:42.345633 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m19:24:42.348990 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:24:42.352309 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:24:42.352943 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m19:24:42.354691 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:42.358240 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:24:42.358731 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m19:24:42.360298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:42.362221 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m19:24:42.362759 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:24:42.363186 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m19:24:42.365111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:42.368059 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m19:24:42.368937 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m19:24:42.369370 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m19:24:42.371720 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:24:42.373402 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m19:24:42.374128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c74e99fb-66c0-4152-88c5-d5391fca0581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106cf110>]}
[0m19:24:42.374872 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m19:24:42.375672 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m19:24:42.376188 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:24:42.376933 [info ] [Thread-1 (]: 3 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m19:24:42.377555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m19:24:42.378077 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:24:42.382745 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:24:42.383903 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:24:42.387693 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:24:42.388537 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:24:42.389021 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m19:24:42.389432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:42.408166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m19:24:42.408824 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:24:42.409411 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m19:24:42.412209 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:24:42.415731 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:24:42.416238 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m19:24:42.417770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:42.421124 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:24:42.423267 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m19:24:42.424918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:42.427036 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m19:24:42.427553 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:24:42.428003 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m19:24:42.429847 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:42.432822 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m19:24:42.433775 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m19:24:42.434235 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m19:24:42.436533 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:24:42.438113 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m19:24:42.438701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c74e99fb-66c0-4152-88c5-d5391fca0581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11069eff0>]}
[0m19:24:42.439498 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m19:24:42.440578 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m19:24:42.441426 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:24:42.442144 [info ] [Thread-1 (]: 4 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m19:24:42.442700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m19:24:42.443144 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:24:42.446009 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:24:42.447045 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:24:42.450967 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:24:42.451804 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:24:42.452244 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m19:24:42.452646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:42.468981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:24:42.469653 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:24:42.470134 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m19:24:42.473011 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:24:42.476442 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:24:42.476924 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m19:24:42.478572 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:42.481981 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:24:42.482468 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m19:24:42.484075 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:42.486133 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m19:24:42.486719 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:24:42.487259 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m19:24:42.489114 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:42.491794 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m19:24:42.492715 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m19:24:42.493222 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m19:24:42.495779 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:24:42.497374 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m19:24:42.498266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c74e99fb-66c0-4152-88c5-d5391fca0581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102906b0>]}
[0m19:24:42.499020 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m19:24:42.499749 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m19:24:42.500349 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:24:42.501100 [info ] [Thread-1 (]: 5 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m19:24:42.501799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m19:24:42.502284 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:24:42.505348 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:24:42.507498 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:24:42.513173 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:24:42.516724 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:24:42.517268 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m19:24:42.517687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:42.535020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:24:42.535688 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:24:42.536182 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m19:24:42.538686 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:24:42.542170 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:24:42.542662 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m19:24:42.544460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:42.547602 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:24:42.548237 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m19:24:42.549894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:42.552196 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m19:24:42.552673 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:24:42.553224 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m19:24:42.555641 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:24:42.558264 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m19:24:42.559106 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m19:24:42.559544 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m19:24:42.561893 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:24:42.563505 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m19:24:42.564119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c74e99fb-66c0-4152-88c5-d5391fca0581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11071f980>]}
[0m19:24:42.565087 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m19:24:42.565884 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m19:24:42.566404 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m19:24:42.567047 [info ] [Thread-1 (]: 6 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m19:24:42.567734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m19:24:42.568183 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m19:24:42.570920 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:24:42.571780 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m19:24:42.576468 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:24:42.577439 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:24:42.577884 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m19:24:42.578303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:42.602977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m19:24:42.603696 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:24:42.604260 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified AS modified_date
FROM "postgres"."public"."users"
  );
[0m19:24:42.606922 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:24:42.610491 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:24:42.610964 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m19:24:42.612694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:42.616220 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:24:42.616728 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m19:24:42.618416 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:42.620300 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m19:24:42.620743 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:24:42.621196 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m19:24:42.623380 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:24:42.626000 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m19:24:42.626841 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m19:24:42.627269 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m19:24:42.629744 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:24:42.631299 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m19:24:42.631944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c74e99fb-66c0-4152-88c5-d5391fca0581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11071f620>]}
[0m19:24:42.632689 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m19:24:42.633423 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m19:24:42.633978 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:24:42.634553 [info ] [Thread-1 (]: 7 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m19:24:42.635311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m19:24:42.635789 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:24:42.638692 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:24:42.639917 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:24:42.643810 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:24:42.644647 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:24:42.645077 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m19:24:42.645476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:42.662564 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:24:42.663168 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:24:42.663705 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m19:24:42.667624 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:24:42.670868 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:24:42.671339 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m19:24:42.673100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:42.675073 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m19:24:42.675539 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:24:42.676014 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m19:24:42.678132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:24:42.682272 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m19:24:42.683155 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m19:24:42.683601 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m19:24:42.685223 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:24:42.686772 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m19:24:42.687367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c74e99fb-66c0-4152-88c5-d5391fca0581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f4e60>]}
[0m19:24:42.688095 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.05s]
[0m19:24:42.688925 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m19:24:42.689553 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:24:42.690265 [info ] [Thread-1 (]: 8 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m19:24:42.690824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m19:24:42.691271 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:24:42.694068 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:24:42.694877 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:24:42.698846 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:24:42.699679 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:24:42.700123 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m19:24:42.700525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:42.719471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m19:24:42.720175 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:24:42.720806 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m19:24:42.724380 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:24:42.727746 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:24:42.728218 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m19:24:42.729892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:42.731720 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m19:24:42.732216 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:24:42.732647 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m19:24:42.735577 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:24:42.738252 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m19:24:42.739185 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m19:24:42.739729 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m19:24:42.741427 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:24:42.743026 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m19:24:42.743715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c74e99fb-66c0-4152-88c5-d5391fca0581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106edd90>]}
[0m19:24:42.744424 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.05s]
[0m19:24:42.745176 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m19:24:42.746595 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:42.747021 [debug] [MainThread]: On master: BEGIN
[0m19:24:42.747371 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:24:42.763740 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:24:42.764291 [debug] [MainThread]: On master: COMMIT
[0m19:24:42.764875 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:42.765265 [debug] [MainThread]: On master: COMMIT
[0m19:24:42.766508 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:24:42.766963 [debug] [MainThread]: On master: Close
[0m19:24:42.767590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:42.768072 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__fields_stages' was properly closed.
[0m19:24:42.768541 [info ] [MainThread]: 
[0m19:24:42.768972 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m19:24:42.771439 [debug] [MainThread]: Command end result
[0m19:24:42.809142 [info ] [MainThread]: 
[0m19:24:42.809958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:42.810441 [info ] [MainThread]: 
[0m19:24:42.810890 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:24:42.813214 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1858156, "process_in_blocks": "0", "process_kernel_time": 0.553125, "process_mem_max_rss": "113332224", "process_out_blocks": "0", "process_user_time": 3.259646}
[0m19:24:42.813982 [debug] [MainThread]: Command `dbt run` succeeded at 19:24:42.813845 after 2.19 seconds
[0m19:24:42.814459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b59ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101c00b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2b4ec0>]}
[0m19:24:42.815260 [debug] [MainThread]: Flushing usage events
[0m19:24:48.228492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106918a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10779ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10779e990>]}


============================== 19:24:48.234662 | 5a402ef5-98ea-4b37-9765-2d0d4b438cd6 ==============================
[0m19:24:48.234662 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:24:48.235427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:24:48.470413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a402ef5-98ea-4b37-9765-2d0d4b438cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720eb70>]}
[0m19:24:48.537004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a402ef5-98ea-4b37-9765-2d0d4b438cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107458860>]}
[0m19:24:48.537994 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:24:48.680326 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:24:48.832432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:48.832902 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:48.890816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a402ef5-98ea-4b37-9765-2d0d4b438cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d20c0>]}
[0m19:24:49.040057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a402ef5-98ea-4b37-9765-2d0d4b438cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f1fd0>]}
[0m19:24:49.040612 [info ] [MainThread]: Found 8 models, 17 data tests, 6 sources, 428 macros
[0m19:24:49.041027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a402ef5-98ea-4b37-9765-2d0d4b438cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e7440>]}
[0m19:24:49.044030 [info ] [MainThread]: 
[0m19:24:49.044678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:24:49.049491 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m19:24:49.120434 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:24:49.120906 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m19:24:49.121267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:49.150374 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m19:24:49.151009 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m19:24:49.151497 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m19:24:49.155448 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m19:24:49.157185 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m19:24:49.158933 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m19:24:49.168572 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:49.169251 [debug] [MainThread]: On master: BEGIN
[0m19:24:49.169676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:24:49.185707 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:24:49.186315 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:49.186910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:24:49.192308 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m19:24:49.194569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a402ef5-98ea-4b37-9765-2d0d4b438cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ae1b0>]}
[0m19:24:49.195425 [debug] [MainThread]: On master: ROLLBACK
[0m19:24:49.196918 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:49.197370 [debug] [MainThread]: On master: BEGIN
[0m19:24:49.199825 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:24:49.200448 [debug] [MainThread]: On master: COMMIT
[0m19:24:49.200826 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:49.201176 [debug] [MainThread]: On master: COMMIT
[0m19:24:49.202401 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:24:49.202833 [debug] [MainThread]: On master: Close
[0m19:24:49.203418 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:24:49.204109 [info ] [MainThread]: 
[0m19:24:49.206738 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:24:49.207308 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m19:24:49.208058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m19:24:49.208610 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:24:49.230915 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:24:49.233101 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:24:49.255806 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:24:49.257116 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:24:49.257571 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m19:24:49.257981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.275938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:24:49.276600 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m19:24:49.277111 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m19:24:49.281974 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:24:49.286819 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m19:24:49.288477 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m19:24:49.289286 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.08s]
[0m19:24:49.290103 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m19:24:49.290667 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:24:49.291191 [info ] [Thread-1 (]: 2 of 17 START test assert_change_stage_references_lost_reason_id ............... [RUN]
[0m19:24:49.291834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m19:24:49.292304 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:24:49.295392 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:24:49.296586 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:24:49.299334 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:24:49.300637 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:24:49.301104 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m19:24:49.301502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.320435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m19:24:49.321027 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m19:24:49.321492 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m19:24:49.327501 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:24:49.329446 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m19:24:49.331759 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m19:24:49.332819 [info ] [Thread-1 (]: 2 of 17 PASS assert_change_stage_references_lost_reason_id ..................... [[32mPASS[0m in 0.04s]
[0m19:24:49.333659 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m19:24:49.334196 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:24:49.334807 [info ] [Thread-1 (]: 3 of 17 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m19:24:49.335569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m19:24:49.336032 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:24:49.340281 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:24:49.341732 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:24:49.344137 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:24:49.345166 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:24:49.345607 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m19:24:49.345992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.363042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:24:49.363840 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m19:24:49.364363 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m19:24:49.372795 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m19:24:49.374534 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m19:24:49.375940 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m19:24:49.376706 [info ] [Thread-1 (]: 3 of 17 PASS assert_change_stage_references_stage_id ........................... [[32mPASS[0m in 0.04s]
[0m19:24:49.377515 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m19:24:49.378053 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:24:49.378577 [info ] [Thread-1 (]: 4 of 17 START test assert_change_user_references_user_id ....................... [RUN]
[0m19:24:49.379216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m19:24:49.379782 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:24:49.382952 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:24:49.383813 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:24:49.386165 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:24:49.387307 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:24:49.387765 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m19:24:49.388165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.405126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:24:49.405824 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m19:24:49.406310 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m19:24:49.411417 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m19:24:49.413217 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m19:24:49.415909 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m19:24:49.418104 [info ] [Thread-1 (]: 4 of 17 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.04s]
[0m19:24:49.419206 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m19:24:49.419944 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:24:49.420587 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m19:24:49.421507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m19:24:49.422024 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:24:49.436737 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:24:49.438667 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:24:49.442882 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:24:49.444160 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:24:49.444884 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m19:24:49.445532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.468671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m19:24:49.469566 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m19:24:49.470159 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m19:24:49.473750 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:24:49.475740 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m19:24:49.477808 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m19:24:49.478786 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.06s]
[0m19:24:49.480103 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m19:24:49.480720 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:24:49.481298 [info ] [Thread-1 (]: 6 of 17 START test not_null_stg_pipedrive__activity_due_date ................... [RUN]
[0m19:24:49.482173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5)
[0m19:24:49.482651 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:24:49.487008 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:24:49.487942 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:24:49.490642 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:24:49.492826 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:24:49.493548 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: BEGIN
[0m19:24:49.494016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.512547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m19:24:49.513261 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m19:24:49.513817 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_date is null



      
    ) dbt_internal_test
[0m19:24:49.516439 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:24:49.518187 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: ROLLBACK
[0m19:24:49.519579 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: Close
[0m19:24:49.520461 [info ] [Thread-1 (]: 6 of 17 PASS not_null_stg_pipedrive__activity_due_date ......................... [[32mPASS[0m in 0.04s]
[0m19:24:49.521399 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m19:24:49.522163 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:24:49.522744 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m19:24:49.523420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m19:24:49.524184 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:24:49.528597 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:24:49.529800 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:24:49.534218 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:24:49.535803 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:24:49.536265 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m19:24:49.536670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.554738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:24:49.555379 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m19:24:49.555851 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m19:24:49.558137 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:24:49.559864 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m19:24:49.561162 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m19:24:49.562074 [info ] [Thread-1 (]: 7 of 17 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m19:24:49.563014 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m19:24:49.563711 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:24:49.564562 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m19:24:49.565639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m19:24:49.566143 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:24:49.570929 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:24:49.572267 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:24:49.574936 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:24:49.575809 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:24:49.576258 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m19:24:49.576657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.593375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:24:49.594026 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m19:24:49.594552 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m19:24:49.596908 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:24:49.598741 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m19:24:49.600118 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m19:24:49.600906 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m19:24:49.601943 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m19:24:49.602503 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:24:49.603126 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m19:24:49.603946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m19:24:49.604512 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:24:49.611608 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:24:49.612726 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:24:49.616016 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:24:49.616892 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:24:49.617339 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m19:24:49.617746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.634825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:24:49.635527 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m19:24:49.636008 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m19:24:49.640142 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:24:49.641878 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m19:24:49.643203 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m19:24:49.643928 [info ] [Thread-1 (]: 9 of 17 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.04s]
[0m19:24:49.644849 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m19:24:49.645370 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:24:49.645814 [info ] [Thread-1 (]: 10 of 17 START test not_null_stg_pipedrive__deal_changes_id .................... [RUN]
[0m19:24:49.646589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m19:24:49.647069 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:24:49.651436 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:24:49.652258 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:24:49.654589 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:24:49.655374 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:24:49.655836 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m19:24:49.656403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.673816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:24:49.674457 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m19:24:49.674935 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m19:24:49.678027 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:24:49.679823 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m19:24:49.681525 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m19:24:49.682281 [info ] [Thread-1 (]: 10 of 17 PASS not_null_stg_pipedrive__deal_changes_id .......................... [[32mPASS[0m in 0.04s]
[0m19:24:49.683133 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m19:24:49.683766 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:24:49.684225 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m19:24:49.684974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m19:24:49.685448 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:24:49.689653 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:24:49.690458 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:24:49.692995 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:24:49.693808 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:24:49.694261 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m19:24:49.694667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.712216 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:24:49.713004 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m19:24:49.713567 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m19:24:49.717066 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:24:49.718803 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m19:24:49.720299 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m19:24:49.721008 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m19:24:49.721789 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m19:24:49.722307 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:24:49.722805 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m19:24:49.723487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m19:24:49.724003 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:24:49.729010 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:24:49.730319 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:24:49.732902 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:24:49.733901 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:24:49.734356 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m19:24:49.734758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.750943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:24:49.751615 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m19:24:49.752110 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m19:24:49.754394 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:24:49.756322 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m19:24:49.757714 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m19:24:49.758569 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m19:24:49.759539 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m19:24:49.760092 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:24:49.760725 [info ] [Thread-1 (]: 13 of 17 START test not_null_stg_pipedrive__users_modified_date ................ [RUN]
[0m19:24:49.761304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86)
[0m19:24:49.761759 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:24:49.766350 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:24:49.767198 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:24:49.769606 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:24:49.770451 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:24:49.770918 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: BEGIN
[0m19:24:49.771338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.787969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:24:49.788753 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m19:24:49.789226 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_date is null



      
    ) dbt_internal_test
[0m19:24:49.791664 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:24:49.793498 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: ROLLBACK
[0m19:24:49.795026 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: Close
[0m19:24:49.795755 [info ] [Thread-1 (]: 13 of 17 PASS not_null_stg_pipedrive__users_modified_date ...................... [[32mPASS[0m in 0.03s]
[0m19:24:49.796569 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m19:24:49.797094 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:24:49.797660 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m19:24:49.798582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m19:24:49.799187 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:24:49.803708 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:24:49.804581 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:24:49.807025 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:24:49.807804 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:24:49.808248 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m19:24:49.808654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.825556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:24:49.826241 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m19:24:49.826794 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m19:24:49.830036 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:24:49.832019 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m19:24:49.833485 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m19:24:49.834266 [info ] [Thread-1 (]: 14 of 17 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m19:24:49.835115 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m19:24:49.835633 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:24:49.836151 [info ] [Thread-1 (]: 15 of 17 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m19:24:49.836997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m19:24:49.837488 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:24:49.843310 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:24:49.844139 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:24:49.846678 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:24:49.847474 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:24:49.848060 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m19:24:49.848496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.865156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:24:49.865822 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m19:24:49.866360 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m19:24:49.868905 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:24:49.870675 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m19:24:49.872255 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m19:24:49.872983 [info ] [Thread-1 (]: 15 of 17 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m19:24:49.873792 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m19:24:49.874365 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:24:49.874853 [info ] [Thread-1 (]: 16 of 17 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m19:24:49.875550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m19:24:49.876056 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:24:49.885453 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:24:49.886318 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:24:49.888678 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:24:49.889450 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:24:49.889899 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m19:24:49.890350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.907330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:24:49.908174 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m19:24:49.908755 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:24:49.913638 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m19:24:49.915586 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m19:24:49.917044 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m19:24:49.917840 [info ] [Thread-1 (]: 16 of 17 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m19:24:49.918647 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m19:24:49.919170 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:24:49.919656 [info ] [Thread-1 (]: 17 of 17 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m19:24:49.920308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m19:24:49.920797 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:24:49.926772 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:24:49.927621 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:24:49.929968 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:24:49.930731 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:24:49.931335 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m19:24:49.931818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:49.948988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:24:49.949695 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m19:24:49.950373 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:24:49.954380 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:24:49.956203 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m19:24:49.957741 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m19:24:49.958508 [info ] [Thread-1 (]: 17 of 17 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m19:24:49.959261 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m19:24:49.960609 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:49.961082 [debug] [MainThread]: On master: BEGIN
[0m19:24:49.961445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:24:49.977451 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:24:49.977947 [debug] [MainThread]: On master: COMMIT
[0m19:24:49.978349 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:49.978711 [debug] [MainThread]: On master: COMMIT
[0m19:24:49.979879 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:24:49.980324 [debug] [MainThread]: On master: Close
[0m19:24:49.980883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:49.981336 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m19:24:49.981975 [info ] [MainThread]: 
[0m19:24:49.982448 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m19:24:49.986379 [debug] [MainThread]: Command end result
[0m19:24:50.021519 [info ] [MainThread]: 
[0m19:24:50.022044 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:50.022486 [info ] [MainThread]: 
[0m19:24:50.022905 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m19:24:50.024798 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.8811617, "process_in_blocks": "0", "process_kernel_time": 0.418071, "process_mem_max_rss": "111157248", "process_out_blocks": "0", "process_user_time": 2.841044}
[0m19:24:50.025559 [debug] [MainThread]: Command `dbt test` succeeded at 19:24:50.025414 after 1.88 seconds
[0m19:24:50.026052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103abad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107228530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107892120>]}
[0m19:24:50.026500 [debug] [MainThread]: Flushing usage events
[0m10:44:15.780713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b14170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ecb0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ecabd0>]}


============================== 10:44:15.790032 | cb00a443-001c-4659-ab5b-fa2c6c46018c ==============================
[0m10:44:15.790032 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:44:15.790996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:44:16.091276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb00a443-001c-4659-ab5b-fa2c6c46018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eca900>]}
[0m10:44:16.158279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb00a443-001c-4659-ab5b-fa2c6c46018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100b0200>]}
[0m10:44:16.159884 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:44:16.310977 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:44:16.522245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:16.522811 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:16.585400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb00a443-001c-4659-ab5b-fa2c6c46018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d0b9e0>]}
[0m10:44:16.744229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb00a443-001c-4659-ab5b-fa2c6c46018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f92c260>]}
[0m10:44:16.744864 [info ] [MainThread]: Found 8 models, 17 data tests, 6 sources, 428 macros
[0m10:44:16.745322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb00a443-001c-4659-ab5b-fa2c6c46018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fe0ce0>]}
[0m10:44:16.748177 [info ] [MainThread]: 
[0m10:44:16.748887 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:44:16.753925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:44:16.850304 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:44:16.850836 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:44:16.851615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:16.919346 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.068 seconds
[0m10:44:16.921050 [debug] [ThreadPool]: On list_postgres: Close
[0m10:44:16.922889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m10:44:16.930603 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m10:44:16.931049 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m10:44:16.931419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:16.947060 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m10:44:16.947720 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m10:44:16.948210 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m10:44:16.952312 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m10:44:16.953968 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m10:44:16.955233 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m10:44:16.962037 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:16.962476 [debug] [MainThread]: On master: BEGIN
[0m10:44:16.962823 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:16.978867 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:44:16.979585 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:16.980083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:44:16.985713 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m10:44:16.987778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb00a443-001c-4659-ab5b-fa2c6c46018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f92c260>]}
[0m10:44:16.988254 [debug] [MainThread]: On master: ROLLBACK
[0m10:44:16.989552 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:16.989964 [debug] [MainThread]: On master: BEGIN
[0m10:44:16.991897 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:44:16.992429 [debug] [MainThread]: On master: COMMIT
[0m10:44:16.992815 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:16.993167 [debug] [MainThread]: On master: COMMIT
[0m10:44:16.994379 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:44:16.994817 [debug] [MainThread]: On master: Close
[0m10:44:16.995359 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:44:16.995815 [info ] [MainThread]: 
[0m10:44:16.999175 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m10:44:16.999841 [info ] [Thread-1 (]: 1 of 8 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m10:44:17.000383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m10:44:17.000822 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m10:44:17.009587 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m10:44:17.011265 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m10:44:17.053656 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m10:44:17.054597 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m10:44:17.055031 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m10:44:17.055429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:17.071272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m10:44:17.071984 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m10:44:17.072530 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m10:44:17.075360 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:44:17.082391 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m10:44:17.082883 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m10:44:17.084919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:17.088628 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m10:44:17.089201 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m10:44:17.091057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:17.109822 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m10:44:17.110354 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m10:44:17.110754 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m10:44:17.116173 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:44:17.123797 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m10:44:17.129960 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m10:44:17.130466 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m10:44:17.135574 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m10:44:17.139077 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m10:44:17.140944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb00a443-001c-4659-ab5b-fa2c6c46018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112152060>]}
[0m10:44:17.141731 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m10:44:17.142718 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m10:44:17.143305 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m10:44:17.143868 [info ] [Thread-1 (]: 2 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m10:44:17.144413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m10:44:17.144841 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m10:44:17.147741 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m10:44:17.149566 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m10:44:17.155639 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m10:44:17.157772 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m10:44:17.158273 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m10:44:17.158693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:17.174434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m10:44:17.175002 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m10:44:17.175483 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to AS due_date
FROM "postgres"."public"."activity"
  );
[0m10:44:17.179200 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:44:17.182683 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m10:44:17.183186 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m10:44:17.185118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:17.188688 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m10:44:17.189190 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m10:44:17.190994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:17.192984 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m10:44:17.193473 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m10:44:17.193883 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m10:44:17.195827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:44:17.198436 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m10:44:17.199312 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m10:44:17.199834 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m10:44:17.202751 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:44:17.204388 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m10:44:17.204977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb00a443-001c-4659-ab5b-fa2c6c46018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120be540>]}
[0m10:44:17.205668 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m10:44:17.206412 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m10:44:17.206940 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m10:44:17.207653 [info ] [Thread-1 (]: 3 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m10:44:17.208239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m10:44:17.208676 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m10:44:17.211471 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m10:44:17.212712 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m10:44:17.218681 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m10:44:17.220004 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m10:44:17.220656 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m10:44:17.221325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:17.238737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m10:44:17.239373 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m10:44:17.239850 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m10:44:17.243411 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:44:17.246747 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m10:44:17.247212 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m10:44:17.248849 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:17.252147 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m10:44:17.252624 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m10:44:17.254170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:17.256067 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m10:44:17.256520 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m10:44:17.257006 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m10:44:17.258924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:44:17.261763 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m10:44:17.262620 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m10:44:17.263051 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m10:44:17.265439 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:44:17.267055 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m10:44:17.267646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb00a443-001c-4659-ab5b-fa2c6c46018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d50a40>]}
[0m10:44:17.268599 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m10:44:17.269432 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m10:44:17.269972 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m10:44:17.270629 [info ] [Thread-1 (]: 4 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m10:44:17.271184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m10:44:17.271620 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m10:44:17.274407 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m10:44:17.275174 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m10:44:17.279047 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m10:44:17.279960 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m10:44:17.281645 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m10:44:17.282431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:17.363419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.081 seconds
[0m10:44:17.364341 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m10:44:17.364890 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m10:44:17.367692 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:44:17.371382 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m10:44:17.371835 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m10:44:17.373906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:44:17.378793 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m10:44:17.379265 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m10:44:17.381330 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:44:17.383292 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m10:44:17.383749 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m10:44:17.384169 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m10:44:17.386680 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:44:17.389409 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m10:44:17.390270 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m10:44:17.390705 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m10:44:17.393194 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:44:17.394826 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m10:44:17.395439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb00a443-001c-4659-ab5b-fa2c6c46018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122083b0>]}
[0m10:44:17.396144 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.12s]
[0m10:44:17.396910 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m10:44:17.397440 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m10:44:17.398065 [info ] [Thread-1 (]: 5 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m10:44:17.398636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m10:44:17.399090 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m10:44:17.402206 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m10:44:17.403459 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m10:44:17.407430 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m10:44:17.408749 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m10:44:17.409224 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m10:44:17.409647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:17.425973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m10:44:17.426657 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m10:44:17.427134 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m10:44:17.430003 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:44:17.433537 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m10:44:17.434041 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m10:44:17.436070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:44:17.439476 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m10:44:17.439968 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m10:44:17.441478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:17.443339 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m10:44:17.443815 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m10:44:17.444316 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m10:44:17.446195 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:44:17.448819 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m10:44:17.449669 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m10:44:17.450104 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m10:44:17.452988 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:44:17.454600 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m10:44:17.455189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb00a443-001c-4659-ab5b-fa2c6c46018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d6d100>]}
[0m10:44:17.455851 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m10:44:17.456604 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m10:44:17.457116 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m10:44:17.457847 [info ] [Thread-1 (]: 6 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m10:44:17.458415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m10:44:17.458865 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m10:44:17.461863 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m10:44:17.463001 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m10:44:17.466806 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m10:44:17.467670 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m10:44:17.468149 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m10:44:17.468548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:17.485222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m10:44:17.485840 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m10:44:17.486304 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified AS modified_date
FROM "postgres"."public"."users"
  );
[0m10:44:17.488700 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:44:17.491864 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m10:44:17.492312 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m10:44:17.493813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:17.497074 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m10:44:17.497531 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m10:44:17.499037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:17.501091 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m10:44:17.501659 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m10:44:17.502088 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m10:44:17.503963 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:44:17.507913 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m10:44:17.508787 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m10:44:17.509222 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m10:44:17.511854 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:44:17.513437 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m10:44:17.514016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb00a443-001c-4659-ab5b-fa2c6c46018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121e23f0>]}
[0m10:44:17.514682 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m10:44:17.515461 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m10:44:17.515966 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m10:44:17.516635 [info ] [Thread-1 (]: 7 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m10:44:17.517180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m10:44:17.517649 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m10:44:17.520443 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m10:44:17.521687 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m10:44:17.525712 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m10:44:17.526978 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m10:44:17.527491 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m10:44:17.527929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:17.544621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m10:44:17.545889 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m10:44:17.546467 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m10:44:17.550724 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:44:17.554307 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m10:44:17.554977 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m10:44:17.556955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:17.558707 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m10:44:17.559157 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m10:44:17.559569 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m10:44:17.561454 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:44:17.564320 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m10:44:17.565204 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m10:44:17.565642 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m10:44:17.568381 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:44:17.570051 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m10:44:17.570664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb00a443-001c-4659-ab5b-fa2c6c46018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121b8f80>]}
[0m10:44:17.571365 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.05s]
[0m10:44:17.572125 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m10:44:17.572744 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m10:44:17.573598 [info ] [Thread-1 (]: 8 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m10:44:17.574198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m10:44:17.574716 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m10:44:17.577495 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m10:44:17.578678 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m10:44:17.583346 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m10:44:17.584725 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m10:44:17.585211 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m10:44:17.585616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:17.603083 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m10:44:17.603909 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m10:44:17.604428 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m10:44:17.607614 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:44:17.610986 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m10:44:17.611553 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m10:44:17.613395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:17.615416 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m10:44:17.615909 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m10:44:17.616329 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m10:44:17.618808 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:44:17.623010 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m10:44:17.624201 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m10:44:17.624863 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m10:44:17.626877 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:44:17.629084 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m10:44:17.629914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb00a443-001c-4659-ab5b-fa2c6c46018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aadca0>]}
[0m10:44:17.630700 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.06s]
[0m10:44:17.631535 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m10:44:17.633114 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:17.633560 [debug] [MainThread]: On master: BEGIN
[0m10:44:17.633911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:17.651980 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m10:44:17.652551 [debug] [MainThread]: On master: COMMIT
[0m10:44:17.652982 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:17.653433 [debug] [MainThread]: On master: COMMIT
[0m10:44:17.654888 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:44:17.655326 [debug] [MainThread]: On master: Close
[0m10:44:17.655840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:17.656260 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__fields_stages' was properly closed.
[0m10:44:17.656840 [info ] [MainThread]: 
[0m10:44:17.657433 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m10:44:17.659711 [debug] [MainThread]: Command end result
[0m10:44:17.695410 [info ] [MainThread]: 
[0m10:44:17.695937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:44:17.696391 [info ] [MainThread]: 
[0m10:44:17.696896 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m10:44:17.699330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0190263, "process_in_blocks": "0", "process_kernel_time": 0.610245, "process_mem_max_rss": "109203456", "process_out_blocks": "0", "process_user_time": 3.005449}
[0m10:44:17.700097 [debug] [MainThread]: Command `dbt run` succeeded at 10:44:17.699956 after 2.02 seconds
[0m10:44:17.700575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1ded50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7718b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121fc590>]}
[0m10:44:17.701041 [debug] [MainThread]: Flushing usage events
[0m11:04:04.422462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6220f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7cb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7cafc0>]}


============================== 11:04:04.428952 | 89a0adee-7793-4a68-a3ff-a5489f601cbb ==============================
[0m11:04:04.428952 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:04:04.429851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:04:04.714987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7aa330>]}
[0m11:04:04.786768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6ae6c0>]}
[0m11:04:04.788144 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:04:04.932727 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:04:05.113499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m11:04:05.114379 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__deal_changes.sql
[0m11:04:05.114933 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__activity.sql
[0m11:04:05.115434 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__users.sql
[0m11:04:05.388804 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:04:05.389797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8f8ef0>]}
[0m11:04:05.660418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c633770>]}
[0m11:04:05.818034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5f2960>]}
[0m11:04:05.818700 [info ] [MainThread]: Found 17 data tests, 8 models, 6 sources, 428 macros
[0m11:04:05.819188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c61f5c0>]}
[0m11:04:05.822244 [info ] [MainThread]: 
[0m11:04:05.823167 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:04:05.828635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:04:05.909547 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:04:05.910134 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:04:05.910527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:05.968701 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.058 seconds
[0m11:04:05.970544 [debug] [ThreadPool]: On list_postgres: Close
[0m11:04:05.972917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m11:04:05.979709 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:04:05.980156 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m11:04:05.980503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:04:05.996229 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m11:04:05.996745 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:04:05.997169 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m11:04:06.001142 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m11:04:06.002875 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m11:04:06.004256 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m11:04:06.011199 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:06.011638 [debug] [MainThread]: On master: BEGIN
[0m11:04:06.011974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:04:06.027993 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:04:06.028583 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:06.029077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:04:06.034050 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m11:04:06.036162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c70d910>]}
[0m11:04:06.036657 [debug] [MainThread]: On master: ROLLBACK
[0m11:04:06.037937 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:06.038404 [debug] [MainThread]: On master: BEGIN
[0m11:04:06.040577 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:04:06.041150 [debug] [MainThread]: On master: COMMIT
[0m11:04:06.041562 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:06.041911 [debug] [MainThread]: On master: COMMIT
[0m11:04:06.043094 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:04:06.043506 [debug] [MainThread]: On master: Close
[0m11:04:06.044037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:04:06.044502 [info ] [MainThread]: 
[0m11:04:06.047872 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m11:04:06.048722 [info ] [Thread-1 (]: 1 of 8 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m11:04:06.049402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m11:04:06.049897 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m11:04:06.059926 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:04:06.060832 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m11:04:06.104394 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:04:06.105314 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:04:06.105947 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m11:04:06.106365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:06.126110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m11:04:06.126862 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:04:06.127310 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m11:04:06.129880 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:04:06.136774 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:04:06.137275 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m11:04:06.139085 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:06.142546 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:04:06.143010 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m11:04:06.144724 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:06.163643 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m11:04:06.164189 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:04:06.164607 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m11:04:06.170042 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m11:04:06.178663 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m11:04:06.184349 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:04:06.184834 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m11:04:06.188800 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:04:06.191696 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m11:04:06.193287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a071430>]}
[0m11:04:06.194054 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m11:04:06.194918 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m11:04:06.195663 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:04:06.196347 [info ] [Thread-1 (]: 2 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m11:04:06.196997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m11:04:06.197449 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:04:06.200295 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:04:06.201103 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:04:06.205087 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:04:06.206287 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:04:06.206758 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m11:04:06.207165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:06.226107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:04:06.226790 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:04:06.227281 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to::TIMESTAMP AS due_time
FROM "postgres"."public"."activity"
  );
[0m11:04:06.231962 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m11:04:06.235652 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:04:06.236295 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m11:04:06.238013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:06.241669 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:04:06.242171 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m11:04:06.244051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:06.246143 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m11:04:06.246623 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:04:06.247031 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m11:04:06.249003 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:04:06.251669 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m11:04:06.252492 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:04:06.252915 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m11:04:06.255463 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:04:06.257155 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m11:04:06.257794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c818470>]}
[0m11:04:06.258512 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m11:04:06.259271 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:04:06.259809 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:04:06.260519 [info ] [Thread-1 (]: 3 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m11:04:06.261121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m11:04:06.261563 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:04:06.264389 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:04:06.265261 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:04:06.269186 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:04:06.270372 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:04:06.270848 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m11:04:06.271259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:06.290697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:04:06.291473 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:04:06.291950 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m11:04:06.294863 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:04:06.298090 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:04:06.298578 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m11:04:06.300443 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:06.303712 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:04:06.304156 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m11:04:06.305961 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:06.307996 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m11:04:06.308445 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:04:06.308852 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m11:04:06.311159 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:04:06.313798 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m11:04:06.314684 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:04:06.315119 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m11:04:06.317893 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:04:06.319561 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m11:04:06.320153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd64d10>]}
[0m11:04:06.320922 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m11:04:06.321709 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:04:06.322420 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:04:06.323295 [info ] [Thread-1 (]: 4 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m11:04:06.323938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m11:04:06.324385 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:04:06.327085 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:04:06.327922 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:04:06.333399 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:04:06.334762 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:04:06.335263 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m11:04:06.335669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:06.354685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:04:06.355452 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:04:06.356023 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time::TIMESTAMP AS change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m11:04:06.358803 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:04:06.363097 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:04:06.363579 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m11:04:06.365232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:06.368409 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:04:06.368859 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m11:04:06.370631 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:06.372830 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m11:04:06.373413 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:04:06.373854 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m11:04:06.375790 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:04:06.378383 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m11:04:06.379335 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:04:06.379768 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m11:04:06.382284 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:04:06.383879 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m11:04:06.384482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd7f080>]}
[0m11:04:06.385290 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m11:04:06.386053 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:04:06.386578 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:04:06.387278 [info ] [Thread-1 (]: 5 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m11:04:06.387878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m11:04:06.388317 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:04:06.391269 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:04:06.392088 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:04:06.395922 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:04:06.396695 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:04:06.397127 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m11:04:06.397524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:06.414103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:04:06.415001 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:04:06.415551 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m11:04:06.418264 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:04:06.421831 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:04:06.422603 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m11:04:06.425966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:04:06.429412 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:04:06.429918 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m11:04:06.432905 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:04:06.435064 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m11:04:06.435507 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:04:06.435916 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m11:04:06.437934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:04:06.440572 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m11:04:06.441407 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:04:06.441830 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m11:04:06.444370 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:04:06.445972 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m11:04:06.446646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc12fc0>]}
[0m11:04:06.447419 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m11:04:06.448204 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:04:06.448731 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m11:04:06.449454 [info ] [Thread-1 (]: 6 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m11:04:06.450030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m11:04:06.450468 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m11:04:06.453271 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:04:06.454053 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m11:04:06.457912 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:04:06.458769 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:04:06.459193 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m11:04:06.459589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:06.478195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:04:06.478928 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:04:06.479447 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified::TIMESTAMP AS modified_time
FROM "postgres"."public"."users"
  );
[0m11:04:06.484450 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m11:04:06.489448 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:04:06.490050 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m11:04:06.491673 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:06.494910 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:04:06.495414 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m11:04:06.497221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:06.499632 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m11:04:06.500115 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:04:06.500525 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m11:04:06.503130 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:04:06.505769 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m11:04:06.506673 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:04:06.507107 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m11:04:06.509964 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:04:06.511681 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m11:04:06.512297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc58b30>]}
[0m11:04:06.513026 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m11:04:06.513836 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m11:04:06.514367 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:04:06.514974 [info ] [Thread-1 (]: 7 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m11:04:06.515629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m11:04:06.516077 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:04:06.518916 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:04:06.519702 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:04:06.523615 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:04:06.524533 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:04:06.524975 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m11:04:06.525479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:06.546128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m11:04:06.547059 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:04:06.547642 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m11:04:06.550955 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:04:06.554196 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:04:06.554655 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m11:04:06.556592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:06.558414 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m11:04:06.558907 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:04:06.559331 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m11:04:06.561261 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:04:06.563850 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m11:04:06.565434 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:04:06.566001 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m11:04:06.567542 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:04:06.569124 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m11:04:06.569733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc414f0>]}
[0m11:04:06.570538 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.05s]
[0m11:04:06.571368 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:04:06.571903 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:04:06.573013 [info ] [Thread-1 (]: 8 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m11:04:06.573728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m11:04:06.574236 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:04:06.578626 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:04:06.579544 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:04:06.584326 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:04:06.585249 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:04:06.585735 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m11:04:06.586141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:06.606347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m11:04:06.607040 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:04:06.607591 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m11:04:06.611600 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:04:06.615144 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:04:06.615639 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m11:04:06.617288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:06.619002 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m11:04:06.619505 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:04:06.619938 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m11:04:06.621776 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:04:06.624612 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m11:04:06.625594 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:04:06.626031 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m11:04:06.627534 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:04:06.629113 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m11:04:06.629698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89a0adee-7793-4a68-a3ff-a5489f601cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd47dd0>]}
[0m11:04:06.630420 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.06s]
[0m11:04:06.631278 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:04:06.633269 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:06.633724 [debug] [MainThread]: On master: BEGIN
[0m11:04:06.634070 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:04:06.653663 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m11:04:06.654293 [debug] [MainThread]: On master: COMMIT
[0m11:04:06.654720 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:06.655091 [debug] [MainThread]: On master: COMMIT
[0m11:04:06.656487 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:04:06.656962 [debug] [MainThread]: On master: Close
[0m11:04:06.657486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:06.657929 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__fields_stages' was properly closed.
[0m11:04:06.658538 [info ] [MainThread]: 
[0m11:04:06.659003 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m11:04:06.661218 [debug] [MainThread]: Command end result
[0m11:04:06.769521 [info ] [MainThread]: 
[0m11:04:06.770284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:04:06.771210 [info ] [MainThread]: 
[0m11:04:06.772069 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m11:04:06.774696 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.445641, "process_in_blocks": "0", "process_kernel_time": 0.582807, "process_mem_max_rss": "114864128", "process_out_blocks": "0", "process_user_time": 3.563278}
[0m11:04:06.775456 [debug] [MainThread]: Command `dbt run` succeeded at 11:04:06.775317 after 2.45 seconds
[0m11:04:06.775940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aced20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a20d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a20ce30>]}
[0m11:04:06.776384 [debug] [MainThread]: Flushing usage events
[0m11:04:13.398007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11254e420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b130e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b12c00>]}


============================== 11:04:13.403098 | 70b54c4b-4c16-4ebb-9bb0-73836684369b ==============================
[0m11:04:13.403098 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:04:13.403772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:04:13.642839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70b54c4b-4c16-4ebb-9bb0-73836684369b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11305e2a0>]}
[0m11:04:13.708390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70b54c4b-4c16-4ebb-9bb0-73836684369b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101aa420>]}
[0m11:04:13.709441 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:04:13.844973 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:04:13.998204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:04:13.998680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:04:14.059174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70b54c4b-4c16-4ebb-9bb0-73836684369b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11305d5e0>]}
[0m11:04:14.212121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70b54c4b-4c16-4ebb-9bb0-73836684369b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b6a7e0>]}
[0m11:04:14.212723 [info ] [MainThread]: Found 17 data tests, 8 models, 6 sources, 428 macros
[0m11:04:14.213150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70b54c4b-4c16-4ebb-9bb0-73836684369b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b41850>]}
[0m11:04:14.216261 [info ] [MainThread]: 
[0m11:04:14.216964 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:04:14.222134 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m11:04:14.292338 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:04:14.292842 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m11:04:14.293224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:14.328317 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m11:04:14.328912 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:04:14.329432 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m11:04:14.333330 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m11:04:14.335095 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m11:04:14.336374 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m11:04:14.343500 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:14.343950 [debug] [MainThread]: On master: BEGIN
[0m11:04:14.344294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:04:14.360092 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:04:14.360952 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:14.361470 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:04:14.366544 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m11:04:14.368717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70b54c4b-4c16-4ebb-9bb0-73836684369b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139b0d10>]}
[0m11:04:14.369225 [debug] [MainThread]: On master: ROLLBACK
[0m11:04:14.370750 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:14.371199 [debug] [MainThread]: On master: BEGIN
[0m11:04:14.373794 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:04:14.374479 [debug] [MainThread]: On master: COMMIT
[0m11:04:14.374923 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:14.375279 [debug] [MainThread]: On master: COMMIT
[0m11:04:14.376649 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:04:14.377093 [debug] [MainThread]: On master: Close
[0m11:04:14.377626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:04:14.378045 [info ] [MainThread]: 
[0m11:04:14.381193 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:04:14.381768 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m11:04:14.382467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m11:04:14.382923 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:04:14.405490 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:04:14.407090 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:04:14.426141 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:04:14.427707 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:04:14.428425 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m11:04:14.428878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:14.445044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:04:14.445760 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:04:14.446286 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m11:04:14.451066 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:04:14.455903 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m11:04:14.457392 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m11:04:14.458197 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.08s]
[0m11:04:14.459004 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:04:14.459567 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:04:14.460095 [info ] [Thread-1 (]: 2 of 17 START test assert_change_stage_references_lost_reason_id ............... [RUN]
[0m11:04:14.460781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m11:04:14.461253 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:04:14.464452 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:04:14.465395 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:04:14.467836 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:04:14.468646 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:04:14.469082 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m11:04:14.469485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:14.487740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:04:14.488444 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:04:14.488935 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:04:14.494352 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m11:04:14.496182 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m11:04:14.498308 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m11:04:14.499152 [info ] [Thread-1 (]: 2 of 17 PASS assert_change_stage_references_lost_reason_id ..................... [[32mPASS[0m in 0.04s]
[0m11:04:14.499945 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:04:14.500471 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:04:14.500969 [info ] [Thread-1 (]: 3 of 17 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m11:04:14.501646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m11:04:14.502126 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:04:14.506366 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:04:14.508038 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:04:14.510637 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:04:14.511631 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:04:14.512071 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m11:04:14.512529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:14.529087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:04:14.529730 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:04:14.530388 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:04:14.539231 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m11:04:14.541207 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m11:04:14.542745 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m11:04:14.543572 [info ] [Thread-1 (]: 3 of 17 PASS assert_change_stage_references_stage_id ........................... [[32mPASS[0m in 0.04s]
[0m11:04:14.544379 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:04:14.545003 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:04:14.545536 [info ] [Thread-1 (]: 4 of 17 START test assert_change_user_references_user_id ....................... [RUN]
[0m11:04:14.546434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m11:04:14.546912 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:04:14.549781 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:04:14.550590 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:04:14.552844 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:04:14.553623 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:04:14.554049 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m11:04:14.554446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:14.571888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:04:14.572743 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:04:14.573242 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:04:14.578050 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:04:14.579890 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m11:04:14.582157 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m11:04:14.583516 [info ] [Thread-1 (]: 4 of 17 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.04s]
[0m11:04:14.584422 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:04:14.584983 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:04:14.585540 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m11:04:14.586173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m11:04:14.586683 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:04:14.594333 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:04:14.597256 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:04:14.600812 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:04:14.601776 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:04:14.602200 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m11:04:14.602704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:14.620468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:04:14.621151 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:04:14.621672 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m11:04:14.624292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:04:14.626040 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m11:04:14.627367 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m11:04:14.628127 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.04s]
[0m11:04:14.628964 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:04:14.629652 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m11:04:14.630277 [info ] [Thread-1 (]: 6 of 17 START test not_null_stg_pipedrive__activity_due_date ................... [RUN]
[0m11:04:14.631827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5)
[0m11:04:14.632533 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m11:04:14.636942 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m11:04:14.637956 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m11:04:14.641160 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m11:04:14.644072 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m11:04:14.644979 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: BEGIN
[0m11:04:14.645422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:14.665437 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m11:04:14.666108 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"
[0m11:04:14.666609 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_date is null



      
    ) dbt_internal_test
[0m11:04:14.669511 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "due_date" does not exist
LINE 13: select due_date
                ^
HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.due_time".

[0m11:04:14.670094 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: ROLLBACK
[0m11:04:14.672173 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5: Close
[0m11:04:14.685303 [debug] [Thread-1 (]: Database Error in test not_null_stg_pipedrive__activity_due_date (models/staging/schema.yml)
  column "due_date" does not exist
  LINE 13: select due_date
                  ^
  HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.due_time".
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/not_null_stg_pipedrive__activity_due_date.sql
[0m11:04:14.686023 [error] [Thread-1 (]: 6 of 17 ERROR not_null_stg_pipedrive__activity_due_date ........................ [[31mERROR[0m in 0.05s]
[0m11:04:14.686748 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5
[0m11:04:14.687245 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:04:14.687735 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m11:04:14.689146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_date.34a6e1c8f5, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m11:04:14.689689 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:04:14.694015 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:04:14.695333 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:04:14.697975 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:04:14.700137 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:04:14.700743 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m11:04:14.701184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:14.721269 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m11:04:14.721944 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:04:14.722406 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m11:04:14.724919 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:04:14.726715 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m11:04:14.728030 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m11:04:14.728768 [info ] [Thread-1 (]: 7 of 17 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m11:04:14.729661 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:04:14.730236 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:04:14.731107 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m11:04:14.732156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m11:04:14.732684 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:04:14.737518 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:04:14.740630 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:04:14.743329 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:04:14.744971 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:04:14.745553 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m11:04:14.746088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:14.765571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:04:14.766261 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:04:14.766796 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m11:04:14.769207 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:04:14.770971 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m11:04:14.772478 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m11:04:14.773423 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m11:04:14.774208 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:04:14.774823 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:04:14.775413 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m11:04:14.775995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m11:04:14.776452 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:04:14.782918 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:04:14.784466 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:04:14.786899 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:04:14.788169 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:04:14.788618 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m11:04:14.789020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:14.810456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m11:04:14.811084 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:04:14.811575 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m11:04:14.815016 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:04:14.817094 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m11:04:14.818913 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m11:04:14.820021 [info ] [Thread-1 (]: 9 of 17 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.04s]
[0m11:04:14.821289 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:04:14.822315 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:04:14.823564 [info ] [Thread-1 (]: 10 of 17 START test not_null_stg_pipedrive__deal_changes_id .................... [RUN]
[0m11:04:14.824804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m11:04:14.825469 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:04:14.833625 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:04:14.834541 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:04:14.836963 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:04:14.838224 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:04:14.838700 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m11:04:14.839105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:14.857130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:04:14.858021 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:04:14.859864 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m11:04:14.863607 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:04:14.866297 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m11:04:14.868667 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m11:04:14.869533 [info ] [Thread-1 (]: 10 of 17 PASS not_null_stg_pipedrive__deal_changes_id .......................... [[32mPASS[0m in 0.04s]
[0m11:04:14.870329 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:04:14.870874 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:04:14.871441 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m11:04:14.872310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m11:04:14.872953 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:04:14.877241 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:04:14.878083 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:04:14.880643 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:04:14.881498 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:04:14.881959 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m11:04:14.882382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:14.906816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m11:04:14.907694 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:04:14.908427 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m11:04:14.912018 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:04:14.913989 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m11:04:14.916005 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m11:04:14.917058 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m11:04:14.918076 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:04:14.918681 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:04:14.919141 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m11:04:14.919904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m11:04:14.920389 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:04:14.925765 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:04:14.927012 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:04:14.929429 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:04:14.930302 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:04:14.931061 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m11:04:14.932008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:14.953766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m11:04:14.954620 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:04:14.955260 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m11:04:14.958575 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:04:14.960596 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m11:04:14.962367 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m11:04:14.963365 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m11:04:14.964704 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:04:14.965449 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m11:04:14.965987 [info ] [Thread-1 (]: 13 of 17 START test not_null_stg_pipedrive__users_modified_date ................ [RUN]
[0m11:04:14.966624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86)
[0m11:04:14.967126 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m11:04:14.971333 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m11:04:14.972169 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m11:04:14.974756 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m11:04:14.975589 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m11:04:14.976018 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: BEGIN
[0m11:04:14.976414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:14.997435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m11:04:14.998699 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"
[0m11:04:14.999332 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_date
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_date is null



      
    ) dbt_internal_test
[0m11:04:15.002200 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "modified_date" does not exist
LINE 13: select modified_date
                ^
HINT:  Perhaps you meant to reference the column "stg_pipedrive__users.modified_time".

[0m11:04:15.003089 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: ROLLBACK
[0m11:04:15.005145 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86: Close
[0m11:04:15.009609 [debug] [Thread-1 (]: Database Error in test not_null_stg_pipedrive__users_modified_date (models/staging/schema.yml)
  column "modified_date" does not exist
  LINE 13: select modified_date
                  ^
  HINT:  Perhaps you meant to reference the column "stg_pipedrive__users.modified_time".
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/not_null_stg_pipedrive__users_modified_date.sql
[0m11:04:15.010338 [error] [Thread-1 (]: 13 of 17 ERROR not_null_stg_pipedrive__users_modified_date ..................... [[31mERROR[0m in 0.04s]
[0m11:04:15.011089 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86
[0m11:04:15.011591 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:04:15.012019 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m11:04:15.012751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_date.47e8280b86, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m11:04:15.013208 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:04:15.017607 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:04:15.018806 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:04:15.021222 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:04:15.022756 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:04:15.023275 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m11:04:15.023683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:15.042023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:04:15.042854 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:04:15.043423 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m11:04:15.045945 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:04:15.047873 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m11:04:15.049337 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m11:04:15.050174 [info ] [Thread-1 (]: 14 of 17 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m11:04:15.050922 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:04:15.051442 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:04:15.051926 [info ] [Thread-1 (]: 15 of 17 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m11:04:15.052538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m11:04:15.053006 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:04:15.059140 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:04:15.060744 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:04:15.063555 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:04:15.064597 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:04:15.065172 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m11:04:15.065595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:15.081790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:04:15.082552 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:04:15.083108 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m11:04:15.085893 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:04:15.087652 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m11:04:15.089353 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m11:04:15.090132 [info ] [Thread-1 (]: 15 of 17 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m11:04:15.090999 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:04:15.091519 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:04:15.092025 [info ] [Thread-1 (]: 16 of 17 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m11:04:15.092709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m11:04:15.093207 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:04:15.102846 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:04:15.104179 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:04:15.107171 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:04:15.108120 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:04:15.108619 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m11:04:15.109065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:15.128066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:04:15.128754 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:04:15.129283 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:04:15.133718 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:04:15.135634 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m11:04:15.137269 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m11:04:15.138187 [info ] [Thread-1 (]: 16 of 17 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.05s]
[0m11:04:15.139066 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:04:15.139986 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:04:15.140691 [info ] [Thread-1 (]: 17 of 17 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m11:04:15.141370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m11:04:15.141857 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:04:15.148046 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:04:15.148970 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:04:15.151379 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:04:15.152174 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:04:15.152625 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m11:04:15.153034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:15.170199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:04:15.170933 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:04:15.171440 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:04:15.175403 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:04:15.177178 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m11:04:15.178406 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m11:04:15.179330 [info ] [Thread-1 (]: 17 of 17 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m11:04:15.180110 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:04:15.181467 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:15.181908 [debug] [MainThread]: On master: BEGIN
[0m11:04:15.182276 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:04:15.197540 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m11:04:15.198155 [debug] [MainThread]: On master: COMMIT
[0m11:04:15.198661 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:15.199039 [debug] [MainThread]: On master: COMMIT
[0m11:04:15.200164 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:04:15.200601 [debug] [MainThread]: On master: Close
[0m11:04:15.201107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:15.201460 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m11:04:15.201869 [info ] [MainThread]: 
[0m11:04:15.202315 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m11:04:15.207040 [debug] [MainThread]: Command end result
[0m11:04:15.242903 [info ] [MainThread]: 
[0m11:04:15.243435 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:04:15.243828 [info ] [MainThread]: 
[0m11:04:15.244312 [error] [MainThread]:   Database Error in test not_null_stg_pipedrive__activity_due_date (models/staging/schema.yml)
  column "due_date" does not exist
  LINE 13: select due_date
                  ^
  HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.due_time".
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/not_null_stg_pipedrive__activity_due_date.sql
[0m11:04:15.244701 [info ] [MainThread]: 
[0m11:04:15.245194 [error] [MainThread]:   Database Error in test not_null_stg_pipedrive__users_modified_date (models/staging/schema.yml)
  column "modified_date" does not exist
  LINE 13: select modified_date
                  ^
  HINT:  Perhaps you meant to reference the column "stg_pipedrive__users.modified_time".
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/not_null_stg_pipedrive__users_modified_date.sql
[0m11:04:15.245630 [info ] [MainThread]: 
[0m11:04:15.246162 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=2 SKIP=0 TOTAL=17
[0m11:04:15.249190 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.9383101, "process_in_blocks": "0", "process_kernel_time": 0.46734, "process_mem_max_rss": "111775744", "process_out_blocks": "0", "process_user_time": 2.944674}
[0m11:04:15.250089 [debug] [MainThread]: Command `dbt test` failed at 11:04:15.249935 after 1.94 seconds
[0m11:04:15.250602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee32d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139857f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113985070>]}
[0m11:04:15.251037 [debug] [MainThread]: Flushing usage events
[0m11:05:01.767588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11095c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113af140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113aec90>]}


============================== 11:05:01.774843 | 5d718f2e-d283-4c61-8a86-29cebc4f1c0d ==============================
[0m11:05:01.774843 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:05:01.775804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:05:02.063975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d718f2e-d283-4c61-8a86-29cebc4f1c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d5c6b0>]}
[0m11:05:02.132506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d718f2e-d283-4c61-8a86-29cebc4f1c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a39e0>]}
[0m11:05:02.134017 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:05:02.276945 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:05:02.478757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:05:02.480029 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/schema.yml
[0m11:05:02.747229 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:05:02.747863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5d718f2e-d283-4c61-8a86-29cebc4f1c0d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f4a10>]}
[0m11:05:03.003324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d718f2e-d283-4c61-8a86-29cebc4f1c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124137a0>]}
[0m11:05:03.169083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d718f2e-d283-4c61-8a86-29cebc4f1c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112410e60>]}
[0m11:05:03.169699 [info ] [MainThread]: Found 17 data tests, 8 models, 6 sources, 428 macros
[0m11:05:03.170237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d718f2e-d283-4c61-8a86-29cebc4f1c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124be780>]}
[0m11:05:03.174560 [info ] [MainThread]: 
[0m11:05:03.175416 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:05:03.181732 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m11:05:03.260672 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:05:03.261176 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m11:05:03.261585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:03.325033 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m11:05:03.325821 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:05:03.326362 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m11:05:03.331260 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m11:05:03.333244 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m11:05:03.334780 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m11:05:03.341985 [debug] [MainThread]: Using postgres connection "master"
[0m11:05:03.342443 [debug] [MainThread]: On master: BEGIN
[0m11:05:03.342791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:05:03.359797 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m11:05:03.360443 [debug] [MainThread]: Using postgres connection "master"
[0m11:05:03.360925 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:05:03.365718 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m11:05:03.367840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d718f2e-d283-4c61-8a86-29cebc4f1c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11222d4c0>]}
[0m11:05:03.368334 [debug] [MainThread]: On master: ROLLBACK
[0m11:05:03.369599 [debug] [MainThread]: Using postgres connection "master"
[0m11:05:03.370014 [debug] [MainThread]: On master: BEGIN
[0m11:05:03.372775 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:05:03.373482 [debug] [MainThread]: On master: COMMIT
[0m11:05:03.373888 [debug] [MainThread]: Using postgres connection "master"
[0m11:05:03.374243 [debug] [MainThread]: On master: COMMIT
[0m11:05:03.375515 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:05:03.375968 [debug] [MainThread]: On master: Close
[0m11:05:03.376511 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:05:03.377025 [info ] [MainThread]: 
[0m11:05:03.380419 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:05:03.380969 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m11:05:03.381678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m11:05:03.382127 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:05:03.400097 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:05:03.400957 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:05:03.419292 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:05:03.420253 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:05:03.420696 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m11:05:03.421108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.438160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:05:03.438752 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:05:03.439487 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m11:05:03.444671 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m11:05:03.449519 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m11:05:03.450988 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m11:05:03.451870 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.07s]
[0m11:05:03.452724 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:05:03.453270 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:05:03.454103 [info ] [Thread-1 (]: 2 of 17 START test assert_change_stage_references_lost_reason_id ............... [RUN]
[0m11:05:03.454979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m11:05:03.455557 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:05:03.460107 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:05:03.460997 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:05:03.463449 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:05:03.464244 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:05:03.464672 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m11:05:03.465064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.483005 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:05:03.483790 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:05:03.484266 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:05:03.488823 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:05:03.491034 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m11:05:03.493920 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m11:05:03.495244 [info ] [Thread-1 (]: 2 of 17 PASS assert_change_stage_references_lost_reason_id ..................... [[32mPASS[0m in 0.04s]
[0m11:05:03.496048 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:05:03.496581 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:05:03.497075 [info ] [Thread-1 (]: 3 of 17 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m11:05:03.497690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m11:05:03.498185 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:05:03.502704 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:05:03.503649 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:05:03.508260 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:05:03.510052 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:05:03.511492 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m11:05:03.512379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.528717 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:05:03.529409 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:05:03.529895 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:05:03.536341 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m11:05:03.538069 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m11:05:03.539644 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m11:05:03.540624 [info ] [Thread-1 (]: 3 of 17 PASS assert_change_stage_references_stage_id ........................... [[32mPASS[0m in 0.04s]
[0m11:05:03.541831 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:05:03.542804 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:05:03.543380 [info ] [Thread-1 (]: 4 of 17 START test assert_change_user_references_user_id ....................... [RUN]
[0m11:05:03.544056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m11:05:03.544547 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:05:03.547703 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:05:03.548537 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:05:03.550970 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:05:03.551756 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:05:03.552183 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m11:05:03.552571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.569609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:05:03.570339 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:05:03.570856 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:05:03.576956 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m11:05:03.578991 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m11:05:03.580536 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m11:05:03.581449 [info ] [Thread-1 (]: 4 of 17 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.04s]
[0m11:05:03.582295 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:05:03.582848 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:05:03.583394 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m11:05:03.584241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m11:05:03.584761 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:05:03.594243 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:05:03.595288 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:05:03.597733 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:05:03.598568 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:05:03.599008 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m11:05:03.599409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.615585 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:05:03.616399 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:05:03.616906 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m11:05:03.620073 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:05:03.621954 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m11:05:03.623808 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m11:05:03.624722 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.04s]
[0m11:05:03.625768 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:05:03.626521 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:05:03.627192 [info ] [Thread-1 (]: 6 of 17 START test not_null_stg_pipedrive__activity_due_time ................... [RUN]
[0m11:05:03.627921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191)
[0m11:05:03.628403 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:05:03.633165 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:05:03.634351 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:05:03.637327 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:05:03.638393 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:05:03.638983 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: BEGIN
[0m11:05:03.639422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.663287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m11:05:03.663908 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:05:03.664406 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_time is null



      
    ) dbt_internal_test
[0m11:05:03.667580 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:05:03.669630 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: ROLLBACK
[0m11:05:03.671076 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: Close
[0m11:05:03.671841 [info ] [Thread-1 (]: 6 of 17 PASS not_null_stg_pipedrive__activity_due_time ......................... [[32mPASS[0m in 0.04s]
[0m11:05:03.673020 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:05:03.673600 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:05:03.674269 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m11:05:03.675897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m11:05:03.676568 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:05:03.681231 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:05:03.682114 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:05:03.684438 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:05:03.685176 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:05:03.685592 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m11:05:03.685984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.705026 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:05:03.705924 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:05:03.706512 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m11:05:03.711303 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:05:03.713226 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m11:05:03.714840 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m11:05:03.715747 [info ] [Thread-1 (]: 7 of 17 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m11:05:03.716627 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:05:03.717226 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:05:03.717826 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m11:05:03.718634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m11:05:03.719207 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:05:03.724924 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:05:03.727641 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:05:03.730345 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:05:03.731364 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:05:03.731931 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m11:05:03.732355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.754474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m11:05:03.755302 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:05:03.756062 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m11:05:03.759008 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:05:03.760854 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m11:05:03.762375 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m11:05:03.763341 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m11:05:03.764580 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:05:03.765215 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:05:03.766026 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m11:05:03.766929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m11:05:03.767656 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:05:03.776763 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:05:03.777655 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:05:03.780415 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:05:03.781369 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:05:03.781833 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m11:05:03.782249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.800767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:05:03.801541 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:05:03.802062 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m11:05:03.805275 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:05:03.807429 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m11:05:03.809518 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m11:05:03.810585 [info ] [Thread-1 (]: 9 of 17 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.04s]
[0m11:05:03.811644 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:05:03.812188 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:05:03.812892 [info ] [Thread-1 (]: 10 of 17 START test not_null_stg_pipedrive__deal_changes_id .................... [RUN]
[0m11:05:03.813707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m11:05:03.814232 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:05:03.819177 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:05:03.820106 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:05:03.822522 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:05:03.823404 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:05:03.823874 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m11:05:03.824285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.844792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m11:05:03.845632 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:05:03.846115 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m11:05:03.849562 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:05:03.851392 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m11:05:03.852976 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m11:05:03.853741 [info ] [Thread-1 (]: 10 of 17 PASS not_null_stg_pipedrive__deal_changes_id .......................... [[32mPASS[0m in 0.04s]
[0m11:05:03.854548 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:05:03.855056 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:05:03.855496 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m11:05:03.856549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m11:05:03.857089 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:05:03.861533 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:05:03.862393 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:05:03.865444 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:05:03.866561 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:05:03.867067 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m11:05:03.867474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.884846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:05:03.885574 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:05:03.886094 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m11:05:03.889233 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:05:03.891041 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m11:05:03.892470 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m11:05:03.893202 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m11:05:03.894009 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:05:03.894549 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:05:03.895046 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m11:05:03.895641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m11:05:03.896099 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:05:03.900326 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:05:03.901139 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:05:03.903496 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:05:03.904269 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:05:03.904699 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m11:05:03.905162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.922041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:05:03.922826 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:05:03.923480 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m11:05:03.925722 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:05:03.927406 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m11:05:03.928699 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m11:05:03.929422 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.03s]
[0m11:05:03.930153 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:05:03.930670 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:05:03.931152 [info ] [Thread-1 (]: 13 of 17 START test not_null_stg_pipedrive__users_modified_time ................ [RUN]
[0m11:05:03.931926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5)
[0m11:05:03.932401 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:05:03.936663 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:05:03.937483 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:05:03.940253 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:05:03.941337 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:05:03.941855 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: BEGIN
[0m11:05:03.942420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.959201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:05:03.959745 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:05:03.960199 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_time is null



      
    ) dbt_internal_test
[0m11:05:03.962566 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:05:03.964272 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: ROLLBACK
[0m11:05:03.965695 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: Close
[0m11:05:03.966421 [info ] [Thread-1 (]: 13 of 17 PASS not_null_stg_pipedrive__users_modified_time ...................... [[32mPASS[0m in 0.03s]
[0m11:05:03.967150 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:05:03.967668 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:05:03.968153 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m11:05:03.968818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m11:05:03.969284 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:05:03.973908 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:05:03.974769 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:05:03.977242 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:05:03.978118 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:05:03.978578 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m11:05:03.978986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.996904 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:05:03.997609 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:05:03.998096 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m11:05:04.000628 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:05:04.002442 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m11:05:04.004060 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m11:05:04.004895 [info ] [Thread-1 (]: 14 of 17 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m11:05:04.006090 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:05:04.006946 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:05:04.007599 [info ] [Thread-1 (]: 15 of 17 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m11:05:04.008525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m11:05:04.009183 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:05:04.015849 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:05:04.016727 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:05:04.019114 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:05:04.019865 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:05:04.020373 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m11:05:04.020820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:04.037642 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:05:04.038576 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:05:04.039098 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m11:05:04.042426 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:05:04.044166 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m11:05:04.045704 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m11:05:04.046504 [info ] [Thread-1 (]: 15 of 17 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m11:05:04.047294 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:05:04.047838 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:05:04.048395 [info ] [Thread-1 (]: 16 of 17 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m11:05:04.049088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m11:05:04.049611 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:05:04.055139 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:05:04.056417 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:05:04.059424 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:05:04.060265 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:05:04.060749 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m11:05:04.061249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:04.078037 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:05:04.078773 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:05:04.079277 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:05:04.083301 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:05:04.085097 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m11:05:04.086604 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m11:05:04.087407 [info ] [Thread-1 (]: 16 of 17 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m11:05:04.088160 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:05:04.088686 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:05:04.089217 [info ] [Thread-1 (]: 17 of 17 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m11:05:04.090454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m11:05:04.090949 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:05:04.096255 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:05:04.097110 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:05:04.099413 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:05:04.100217 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:05:04.100669 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m11:05:04.101136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:04.120791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m11:05:04.121569 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:05:04.122545 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:05:04.127115 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:05:04.128935 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m11:05:04.130550 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m11:05:04.131316 [info ] [Thread-1 (]: 17 of 17 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m11:05:04.132184 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:05:04.133523 [debug] [MainThread]: Using postgres connection "master"
[0m11:05:04.133968 [debug] [MainThread]: On master: BEGIN
[0m11:05:04.134323 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:05:04.150971 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m11:05:04.151670 [debug] [MainThread]: On master: COMMIT
[0m11:05:04.152110 [debug] [MainThread]: Using postgres connection "master"
[0m11:05:04.152538 [debug] [MainThread]: On master: COMMIT
[0m11:05:04.153858 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:05:04.154341 [debug] [MainThread]: On master: Close
[0m11:05:04.154892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:05:04.155272 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m11:05:04.155681 [info ] [MainThread]: 
[0m11:05:04.156467 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m11:05:04.160705 [debug] [MainThread]: Command end result
[0m11:05:04.252020 [info ] [MainThread]: 
[0m11:05:04.252537 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:05:04.252932 [info ] [MainThread]: 
[0m11:05:04.253345 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m11:05:04.255820 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.5792017, "process_in_blocks": "0", "process_kernel_time": 0.488752, "process_mem_max_rss": "116842496", "process_out_blocks": "0", "process_user_time": 3.387813}
[0m11:05:04.256579 [debug] [MainThread]: Command `dbt test` succeeded at 11:05:04.256440 after 2.58 seconds
[0m11:05:04.257056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6ced50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d927290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f16210>]}
[0m11:05:04.257492 [debug] [MainThread]: Flushing usage events
[0m11:40:57.809000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941e7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a70c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109536db0>]}


============================== 11:40:57.817284 | 3975f344-b852-4610-99a1-d863c82ac221 ==============================
[0m11:40:57.817284 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:40:57.818144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:40:58.100452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3975f344-b852-4610-99a1-d863c82ac221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ffe30>]}
[0m11:40:58.169202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3975f344-b852-4610-99a1-d863c82ac221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109561790>]}
[0m11:40:58.170718 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:40:58.323011 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:40:58.517443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:40:58.518388 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__activity_types.sql
[0m11:40:59.007925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3975f344-b852-4610-99a1-d863c82ac221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a497b90>]}
[0m11:40:59.166273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3975f344-b852-4610-99a1-d863c82ac221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a8290>]}
[0m11:40:59.166991 [info ] [MainThread]: Found 17 data tests, 8 models, 6 sources, 428 macros
[0m11:40:59.167505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3975f344-b852-4610-99a1-d863c82ac221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b00920>]}
[0m11:40:59.171302 [info ] [MainThread]: 
[0m11:40:59.172246 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:40:59.177584 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:40:59.253864 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:40:59.254607 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:40:59.255503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:59.316578 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.061 seconds
[0m11:40:59.319038 [debug] [ThreadPool]: On list_postgres: Close
[0m11:40:59.321708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m11:40:59.328759 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:40:59.329210 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m11:40:59.329558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:40:59.345867 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m11:40:59.346405 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:40:59.346982 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m11:40:59.351429 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m11:40:59.353253 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m11:40:59.354564 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m11:40:59.361139 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:59.361574 [debug] [MainThread]: On master: BEGIN
[0m11:40:59.361916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:40:59.378667 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m11:40:59.379138 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:59.379695 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:40:59.385363 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m11:40:59.387470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3975f344-b852-4610-99a1-d863c82ac221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4aff20>]}
[0m11:40:59.387968 [debug] [MainThread]: On master: ROLLBACK
[0m11:40:59.389243 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:59.389652 [debug] [MainThread]: On master: BEGIN
[0m11:40:59.392693 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:40:59.393166 [debug] [MainThread]: On master: COMMIT
[0m11:40:59.393610 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:59.393983 [debug] [MainThread]: On master: COMMIT
[0m11:40:59.395180 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:40:59.395619 [debug] [MainThread]: On master: Close
[0m11:40:59.396180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:40:59.396617 [info ] [MainThread]: 
[0m11:40:59.400557 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m11:40:59.401211 [info ] [Thread-1 (]: 1 of 8 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m11:40:59.402469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m11:40:59.403020 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m11:40:59.413389 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:40:59.414330 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m11:40:59.457934 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:40:59.458844 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:40:59.459286 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m11:40:59.459690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:59.476012 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:40:59.476629 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:40:59.477092 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m11:40:59.479700 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:40:59.487512 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:40:59.488025 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m11:40:59.489620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:40:59.492966 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:40:59.493569 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m11:40:59.495187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:40:59.515680 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m11:40:59.516347 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:40:59.516860 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m11:40:59.522544 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m11:40:59.530624 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m11:40:59.538005 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:40:59.538505 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m11:40:59.544086 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m11:40:59.546870 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m11:40:59.549012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3975f344-b852-4610-99a1-d863c82ac221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ddd5b0>]}
[0m11:40:59.550312 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.15s]
[0m11:40:59.552970 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m11:40:59.553681 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:40:59.554509 [info ] [Thread-1 (]: 2 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m11:40:59.555381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m11:40:59.556532 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:40:59.561182 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:40:59.562294 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:40:59.568234 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:40:59.569371 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:40:59.569857 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m11:40:59.570260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:59.587659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:40:59.588201 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:40:59.588662 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to::TIMESTAMP AS due_time
FROM "postgres"."public"."activity"
  );
[0m11:40:59.591480 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:40:59.594927 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:40:59.595428 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m11:40:59.596990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:40:59.600786 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:40:59.601279 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m11:40:59.603364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:40:59.606418 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m11:40:59.606930 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:40:59.607349 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m11:40:59.609453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:40:59.613056 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m11:40:59.614349 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:40:59.615016 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m11:40:59.617739 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:40:59.620264 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m11:40:59.620939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3975f344-b852-4610-99a1-d863c82ac221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a938560>]}
[0m11:40:59.622120 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.07s]
[0m11:40:59.623285 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:40:59.624030 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:40:59.624850 [info ] [Thread-1 (]: 3 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m11:40:59.625542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m11:40:59.626135 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:40:59.631665 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:40:59.632887 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:40:59.638309 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:40:59.639664 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:40:59.640181 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m11:40:59.640598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:59.658569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:40:59.659202 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:40:59.659833 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS activity_is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m11:40:59.663237 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:40:59.667929 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:40:59.669112 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m11:40:59.671259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:40:59.674633 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:40:59.675134 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m11:40:59.677012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:40:59.679594 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m11:40:59.680209 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:40:59.680774 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m11:40:59.683160 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:40:59.686935 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m11:40:59.687846 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:40:59.688300 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m11:40:59.691757 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:40:59.693464 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m11:40:59.694103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3975f344-b852-4610-99a1-d863c82ac221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a92c260>]}
[0m11:40:59.694946 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.07s]
[0m11:40:59.695880 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:40:59.696692 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:40:59.697713 [info ] [Thread-1 (]: 4 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m11:40:59.698342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m11:40:59.699727 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:40:59.704077 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:40:59.705200 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:40:59.709845 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:40:59.711854 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:40:59.712328 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m11:40:59.712816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:59.729696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:40:59.730321 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:40:59.730821 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time::TIMESTAMP AS change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m11:40:59.733480 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:40:59.737121 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:40:59.737634 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m11:40:59.740231 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:40:59.743532 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:40:59.743994 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m11:40:59.745455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:40:59.747601 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m11:40:59.748150 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:40:59.748605 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m11:40:59.751773 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:40:59.754420 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m11:40:59.755255 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:40:59.755690 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m11:40:59.758747 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:40:59.760368 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m11:40:59.760955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3975f344-b852-4610-99a1-d863c82ac221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8fbc50>]}
[0m11:40:59.761685 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m11:40:59.762434 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:40:59.762962 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:40:59.763758 [info ] [Thread-1 (]: 5 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m11:40:59.764422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m11:40:59.764920 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:40:59.768443 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:40:59.769762 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:40:59.775359 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:40:59.776246 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:40:59.776733 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m11:40:59.777139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:59.793453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:40:59.794063 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:40:59.794537 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m11:40:59.797057 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:40:59.800748 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:40:59.801374 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m11:40:59.803891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:40:59.807096 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:40:59.807580 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m11:40:59.809060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:40:59.811191 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m11:40:59.811849 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:40:59.812379 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m11:40:59.814356 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:40:59.817178 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m11:40:59.818300 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:40:59.818874 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m11:40:59.821960 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:40:59.823646 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m11:40:59.824288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3975f344-b852-4610-99a1-d863c82ac221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a99a5a0>]}
[0m11:40:59.825026 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m11:40:59.826029 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:40:59.826666 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m11:40:59.827300 [info ] [Thread-1 (]: 6 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m11:40:59.827832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m11:40:59.828280 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m11:40:59.831726 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:40:59.832868 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m11:40:59.837794 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:40:59.838656 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:40:59.839105 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m11:40:59.839512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:59.857961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:40:59.858554 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:40:59.859036 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified::TIMESTAMP AS modified_time
FROM "postgres"."public"."users"
  );
[0m11:40:59.861746 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:40:59.865247 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:40:59.865801 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m11:40:59.868027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:40:59.872039 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:40:59.872553 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m11:40:59.874046 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:40:59.875921 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m11:40:59.876450 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:40:59.876873 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m11:40:59.878973 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:40:59.881611 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m11:40:59.882465 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:40:59.882923 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m11:40:59.885923 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:40:59.887546 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m11:40:59.888158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3975f344-b852-4610-99a1-d863c82ac221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a99a090>]}
[0m11:40:59.888909 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m11:40:59.889677 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m11:40:59.890207 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:40:59.890915 [info ] [Thread-1 (]: 7 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m11:40:59.891462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m11:40:59.891902 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:40:59.895074 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:40:59.896223 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:40:59.900218 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:40:59.901173 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:40:59.902124 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m11:40:59.902573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:59.919784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:40:59.920473 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:40:59.920975 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m11:40:59.924150 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:40:59.927803 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:40:59.928304 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m11:40:59.929910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:40:59.931791 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m11:40:59.932286 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:40:59.932889 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m11:40:59.935352 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:40:59.939575 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m11:40:59.940512 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:40:59.941034 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m11:40:59.942711 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:40:59.944385 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m11:40:59.944979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3975f344-b852-4610-99a1-d863c82ac221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9920f0>]}
[0m11:40:59.945727 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.05s]
[0m11:40:59.946447 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:40:59.946953 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:40:59.947704 [info ] [Thread-1 (]: 8 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m11:40:59.948273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m11:40:59.948912 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:40:59.952103 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:40:59.953132 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:40:59.957246 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:40:59.958217 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:40:59.958673 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m11:40:59.959076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:59.976039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:40:59.976660 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:40:59.977138 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m11:40:59.980188 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:40:59.983583 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:40:59.984059 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m11:40:59.985892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:40:59.987646 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m11:40:59.988090 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:40:59.988503 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m11:40:59.990393 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:40:59.992975 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m11:40:59.993795 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:40:59.994223 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m11:40:59.995726 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:40:59.997363 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m11:40:59.998017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3975f344-b852-4610-99a1-d863c82ac221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a97cd70>]}
[0m11:40:59.998718 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.05s]
[0m11:40:59.999509 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:41:00.001517 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:00.002109 [debug] [MainThread]: On master: BEGIN
[0m11:41:00.002668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:00.019748 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m11:41:00.020216 [debug] [MainThread]: On master: COMMIT
[0m11:41:00.020673 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:00.021041 [debug] [MainThread]: On master: COMMIT
[0m11:41:00.022251 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:41:00.022691 [debug] [MainThread]: On master: Close
[0m11:41:00.023195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:00.023646 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__fields_stages' was properly closed.
[0m11:41:00.024109 [info ] [MainThread]: 
[0m11:41:00.024610 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m11:41:00.027008 [debug] [MainThread]: Command end result
[0m11:41:00.060565 [info ] [MainThread]: 
[0m11:41:00.061085 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:41:00.061483 [info ] [MainThread]: 
[0m11:41:00.061903 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m11:41:00.064462 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.352679, "process_in_blocks": "0", "process_kernel_time": 0.593533, "process_mem_max_rss": "113319936", "process_out_blocks": "0", "process_user_time": 3.378169}
[0m11:41:00.065265 [debug] [MainThread]: Command `dbt run` succeeded at 11:41:00.065112 after 2.35 seconds
[0m11:41:00.066051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb8860>]}
[0m11:41:00.066536 [debug] [MainThread]: Flushing usage events
[0m11:41:34.373860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806b140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806ab70>]}


============================== 11:41:34.380958 | 71c9bb64-9ef0-4491-973a-d388dcdc902a ==============================
[0m11:41:34.380958 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:41:34.381923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:41:34.629802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f48350>]}
[0m11:41:34.696210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b54050>]}
[0m11:41:34.697227 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:41:34.834872 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:41:34.986400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:41:34.987261 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__activity.sql
[0m11:41:35.279653 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:41:35.280248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108661310>]}
[0m11:41:35.526372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090dbb90>]}
[0m11:41:35.689418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109008110>]}
[0m11:41:35.690011 [info ] [MainThread]: Found 17 data tests, 8 models, 6 sources, 428 macros
[0m11:41:35.690430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cf4d0>]}
[0m11:41:35.693139 [info ] [MainThread]: 
[0m11:41:35.693822 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:41:35.698601 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:41:35.763195 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:41:35.763673 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:41:35.764053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:35.800470 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m11:41:35.802438 [debug] [ThreadPool]: On list_postgres: Close
[0m11:41:35.804488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m11:41:35.813055 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:41:35.813566 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m11:41:35.813953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:35.831370 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m11:41:35.831949 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:41:35.832391 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m11:41:35.839773 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.007 seconds
[0m11:41:35.841472 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m11:41:35.843000 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m11:41:35.849502 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:35.849924 [debug] [MainThread]: On master: BEGIN
[0m11:41:35.850329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:35.867238 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m11:41:35.867993 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:35.868603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:41:35.873444 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m11:41:35.875554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e8ce0>]}
[0m11:41:35.876047 [debug] [MainThread]: On master: ROLLBACK
[0m11:41:35.878134 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:35.878580 [debug] [MainThread]: On master: BEGIN
[0m11:41:35.881073 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:41:35.881652 [debug] [MainThread]: On master: COMMIT
[0m11:41:35.882059 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:35.882430 [debug] [MainThread]: On master: COMMIT
[0m11:41:35.883720 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:41:35.884282 [debug] [MainThread]: On master: Close
[0m11:41:35.884906 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:35.885433 [info ] [MainThread]: 
[0m11:41:35.887753 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m11:41:35.888451 [info ] [Thread-1 (]: 1 of 8 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m11:41:35.889024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m11:41:35.889571 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m11:41:35.898544 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:41:35.899420 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m11:41:35.940192 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:41:35.941076 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:41:35.941517 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m11:41:35.941920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:35.958876 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:41:35.959514 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:41:35.959983 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m11:41:35.962299 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:41:35.969545 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:41:35.970063 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m11:41:35.971744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:35.975071 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:41:35.975542 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m11:41:35.977221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:35.995617 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m11:41:35.996129 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:41:35.996553 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m11:41:35.998965 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:41:36.006002 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m11:41:36.011858 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:41:36.012373 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m11:41:36.015732 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:41:36.018852 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m11:41:36.020537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10804fc20>]}
[0m11:41:36.021286 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.13s]
[0m11:41:36.022124 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m11:41:36.022690 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:41:36.023442 [info ] [Thread-1 (]: 2 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m11:41:36.024022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m11:41:36.024461 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:41:36.027408 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:41:36.028175 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:41:36.033666 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:41:36.034735 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:41:36.035359 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m11:41:36.035968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:36.051857 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:41:36.052469 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:41:36.052972 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_name,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to::TIMESTAMP AS due_time
FROM "postgres"."public"."activity"
  );
[0m11:41:36.055405 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:41:36.058735 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:41:36.059196 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m11:41:36.060761 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:36.064036 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:41:36.064491 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m11:41:36.065999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:36.068136 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m11:41:36.068618 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:41:36.069035 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m11:41:36.070959 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:41:36.073585 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m11:41:36.074418 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:41:36.074857 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m11:41:36.077161 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:41:36.078755 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m11:41:36.079434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109008b00>]}
[0m11:41:36.080450 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m11:41:36.081182 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:41:36.081691 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:41:36.082362 [info ] [Thread-1 (]: 3 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m11:41:36.082932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m11:41:36.083379 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:41:36.086522 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:41:36.087351 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:41:36.091235 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:41:36.092025 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:41:36.092531 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m11:41:36.092965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:36.109133 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:41:36.109855 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:41:36.110340 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS activity_is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m11:41:36.113017 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:41:36.116358 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:41:36.116844 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m11:41:36.118679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:36.121965 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:41:36.122411 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m11:41:36.124055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:36.125940 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m11:41:36.126366 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:41:36.126850 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m11:41:36.129092 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:41:36.131699 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m11:41:36.132596 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:41:36.133031 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m11:41:36.135527 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:41:36.137134 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m11:41:36.137744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109514a40>]}
[0m11:41:36.138471 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.05s]
[0m11:41:36.139294 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:41:36.139822 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:41:36.140447 [info ] [Thread-1 (]: 4 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m11:41:36.140999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m11:41:36.141439 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:41:36.144142 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:41:36.144888 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:41:36.148841 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:41:36.149644 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:41:36.150083 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m11:41:36.150549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:36.169190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:41:36.170058 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:41:36.170953 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time::TIMESTAMP AS change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m11:41:36.173395 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:41:36.177919 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:41:36.178391 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m11:41:36.180114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:36.183328 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:41:36.183790 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m11:41:36.185657 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:36.187789 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m11:41:36.188271 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:41:36.188688 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m11:41:36.190594 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:41:36.193206 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m11:41:36.194033 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:41:36.194461 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m11:41:36.196882 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:41:36.198471 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m11:41:36.199101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096307d0>]}
[0m11:41:36.199907 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m11:41:36.200909 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:41:36.201474 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:41:36.202208 [info ] [Thread-1 (]: 5 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m11:41:36.202862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m11:41:36.203328 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:41:36.206360 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:41:36.207317 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:41:36.211459 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:41:36.212338 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:41:36.212794 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m11:41:36.213204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:36.232640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:41:36.233453 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:41:36.233971 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m11:41:36.237631 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:41:36.241111 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:41:36.241597 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m11:41:36.243433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:36.246996 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:41:36.247485 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m11:41:36.249160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:36.251542 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m11:41:36.252202 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:41:36.252671 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m11:41:36.254642 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:41:36.257264 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m11:41:36.258111 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:41:36.258550 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m11:41:36.261230 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:41:36.262825 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m11:41:36.263417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10962f620>]}
[0m11:41:36.264191 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m11:41:36.264990 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:41:36.265513 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m11:41:36.266237 [info ] [Thread-1 (]: 6 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m11:41:36.266864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m11:41:36.267317 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m11:41:36.270498 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:41:36.271352 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m11:41:36.275132 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:41:36.275932 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:41:36.276373 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m11:41:36.276776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:36.294921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:41:36.295550 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:41:36.296043 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified::TIMESTAMP AS modified_time
FROM "postgres"."public"."users"
  );
[0m11:41:36.298457 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:41:36.301853 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:41:36.302354 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m11:41:36.303925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:36.307196 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:41:36.307684 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m11:41:36.309332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:36.311252 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m11:41:36.311691 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:41:36.312094 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m11:41:36.313934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:41:36.318689 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m11:41:36.319693 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:41:36.320157 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m11:41:36.322638 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:41:36.324202 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m11:41:36.324793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966ae10>]}
[0m11:41:36.325556 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m11:41:36.326278 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m11:41:36.326786 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:41:36.327498 [info ] [Thread-1 (]: 7 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m11:41:36.328045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m11:41:36.328480 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:41:36.331349 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:41:36.332137 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:41:36.336109 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:41:36.336948 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:41:36.337472 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m11:41:36.337904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:36.356546 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:41:36.357119 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:41:36.357720 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m11:41:36.361045 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:41:36.364338 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:41:36.364795 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m11:41:36.366432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:36.368255 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m11:41:36.368746 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:41:36.369169 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m11:41:36.371113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:41:36.373681 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m11:41:36.374491 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:41:36.375062 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m11:41:36.376633 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:41:36.378199 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m11:41:36.378787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10964b980>]}
[0m11:41:36.379593 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.05s]
[0m11:41:36.380326 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:41:36.380832 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:41:36.381491 [info ] [Thread-1 (]: 8 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m11:41:36.382080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m11:41:36.382529 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:41:36.385477 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:41:36.386285 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:41:36.389971 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:41:36.390727 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:41:36.391168 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m11:41:36.391579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:36.407912 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:41:36.408564 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:41:36.409160 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m11:41:36.412142 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:41:36.415749 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:41:36.416265 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m11:41:36.417981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:36.419744 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m11:41:36.420221 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:41:36.420641 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m11:41:36.422438 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:41:36.425196 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m11:41:36.426038 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:41:36.426480 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m11:41:36.427871 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:41:36.429455 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m11:41:36.430025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c9bb64-9ef0-4491-973a-d388dcdc902a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109625850>]}
[0m11:41:36.430683 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.05s]
[0m11:41:36.431400 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:41:36.432933 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:36.433373 [debug] [MainThread]: On master: BEGIN
[0m11:41:36.433733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:36.449002 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m11:41:36.449663 [debug] [MainThread]: On master: COMMIT
[0m11:41:36.450072 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:36.450427 [debug] [MainThread]: On master: COMMIT
[0m11:41:36.452141 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:41:36.452687 [debug] [MainThread]: On master: Close
[0m11:41:36.453234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:36.453695 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__fields_stages' was properly closed.
[0m11:41:36.454188 [info ] [MainThread]: 
[0m11:41:36.454658 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m11:41:36.456878 [debug] [MainThread]: Command end result
[0m11:41:36.547211 [info ] [MainThread]: 
[0m11:41:36.547729 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:41:36.548125 [info ] [MainThread]: 
[0m11:41:36.548536 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m11:41:36.550309 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.270253, "process_in_blocks": "0", "process_kernel_time": 0.380448, "process_mem_max_rss": "115552256", "process_out_blocks": "0", "process_user_time": 3.237579}
[0m11:41:36.551035 [debug] [MainThread]: Command `dbt run` succeeded at 11:41:36.550893 after 2.27 seconds
[0m11:41:36.551704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b08770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e77020>]}
[0m11:41:36.552263 [debug] [MainThread]: Flushing usage events
[0m11:41:41.149275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a31a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a2c00>]}


============================== 11:41:41.155160 | 441bb421-c897-4683-a8c0-ab437c7ebcf8 ==============================
[0m11:41:41.155160 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:41:41.156467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m11:41:41.394029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '441bb421-c897-4683-a8c0-ab437c7ebcf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a2f30>]}
[0m11:41:41.461705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '441bb421-c897-4683-a8c0-ab437c7ebcf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a4d9d0>]}
[0m11:41:41.462655 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:41:41.603403 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:41:41.756698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:41.757196 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:41.816805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '441bb421-c897-4683-a8c0-ab437c7ebcf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b0710>]}
[0m11:41:41.971154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '441bb421-c897-4683-a8c0-ab437c7ebcf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a616750>]}
[0m11:41:41.971797 [info ] [MainThread]: Found 17 data tests, 8 models, 6 sources, 428 macros
[0m11:41:41.972240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '441bb421-c897-4683-a8c0-ab437c7ebcf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b09e120>]}
[0m11:41:41.975392 [info ] [MainThread]: 
[0m11:41:41.976119 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:41:41.981082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m11:41:42.054020 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:41:42.054498 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m11:41:42.054867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:42.084748 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m11:41:42.085369 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:41:42.085930 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m11:41:42.090292 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m11:41:42.092027 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m11:41:42.093264 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m11:41:42.100352 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:42.100842 [debug] [MainThread]: On master: BEGIN
[0m11:41:42.101223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:42.117113 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:41:42.117880 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:42.118555 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:41:42.123494 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m11:41:42.125573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '441bb421-c897-4683-a8c0-ab437c7ebcf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b09c590>]}
[0m11:41:42.126055 [debug] [MainThread]: On master: ROLLBACK
[0m11:41:42.127424 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:42.127885 [debug] [MainThread]: On master: BEGIN
[0m11:41:42.129754 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:41:42.130227 [debug] [MainThread]: On master: COMMIT
[0m11:41:42.130689 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:42.131035 [debug] [MainThread]: On master: COMMIT
[0m11:41:42.132226 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:41:42.132659 [debug] [MainThread]: On master: Close
[0m11:41:42.133203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:42.133653 [info ] [MainThread]: 
[0m11:41:42.136534 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:41:42.137117 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m11:41:42.137842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m11:41:42.138295 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:41:42.162183 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:41:42.163929 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:41:42.185333 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:41:42.186283 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:41:42.186731 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m11:41:42.187138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.204929 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:41:42.205635 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:41:42.206159 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m11:41:42.210840 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:41:42.215522 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m11:41:42.216958 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m11:41:42.217889 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.08s]
[0m11:41:42.218817 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:41:42.219395 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:41:42.219865 [info ] [Thread-1 (]: 2 of 17 START test assert_change_stage_references_lost_reason_id ............... [RUN]
[0m11:41:42.220603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m11:41:42.221084 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:41:42.224633 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:41:42.226020 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:41:42.229953 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:41:42.230960 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:41:42.231544 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m11:41:42.231978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.249132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:41:42.249797 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:41:42.250269 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:41:42.255478 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m11:41:42.257311 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m11:41:42.258750 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m11:41:42.259539 [info ] [Thread-1 (]: 2 of 17 PASS assert_change_stage_references_lost_reason_id ..................... [[32mPASS[0m in 0.04s]
[0m11:41:42.260318 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:41:42.260845 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:41:42.261341 [info ] [Thread-1 (]: 3 of 17 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m11:41:42.262021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m11:41:42.262489 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:41:42.266553 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:41:42.267761 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:41:42.270377 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:41:42.271301 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:41:42.271820 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m11:41:42.273283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.289046 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:41:42.289903 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:41:42.290511 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:41:42.298677 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m11:41:42.300394 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m11:41:42.302252 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m11:41:42.303038 [info ] [Thread-1 (]: 3 of 17 PASS assert_change_stage_references_stage_id ........................... [[32mPASS[0m in 0.04s]
[0m11:41:42.303815 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:41:42.304350 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:41:42.304841 [info ] [Thread-1 (]: 4 of 17 START test assert_change_user_references_user_id ....................... [RUN]
[0m11:41:42.305563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m11:41:42.306071 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:41:42.308928 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:41:42.309726 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:41:42.311974 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:41:42.312732 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:41:42.313154 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m11:41:42.313545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.330245 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:41:42.330941 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:41:42.331407 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:41:42.336648 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m11:41:42.338372 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m11:41:42.339831 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m11:41:42.340904 [info ] [Thread-1 (]: 4 of 17 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.04s]
[0m11:41:42.342324 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:41:42.343138 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:41:42.343710 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m11:41:42.344302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m11:41:42.344906 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:41:42.352491 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:41:42.353833 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:41:42.356290 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:41:42.357315 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:41:42.357750 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m11:41:42.358141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.379040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m11:41:42.379823 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:41:42.380279 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m11:41:42.382825 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:41:42.384997 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m11:41:42.386473 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m11:41:42.387247 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.04s]
[0m11:41:42.388025 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:41:42.388556 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:41:42.389056 [info ] [Thread-1 (]: 6 of 17 START test not_null_stg_pipedrive__activity_due_time ................... [RUN]
[0m11:41:42.389795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191)
[0m11:41:42.390324 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:41:42.396729 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:41:42.397635 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:41:42.400068 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:41:42.401008 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:41:42.401502 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: BEGIN
[0m11:41:42.401931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.419533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:41:42.420131 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:41:42.420588 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_time is null



      
    ) dbt_internal_test
[0m11:41:42.422987 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:41:42.424804 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: ROLLBACK
[0m11:41:42.426242 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: Close
[0m11:41:42.427038 [info ] [Thread-1 (]: 6 of 17 PASS not_null_stg_pipedrive__activity_due_time ......................... [[32mPASS[0m in 0.04s]
[0m11:41:42.427891 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:41:42.428427 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:41:42.429039 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m11:41:42.429926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m11:41:42.430419 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:41:42.435035 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:41:42.436003 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:41:42.438668 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:41:42.440022 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:41:42.440509 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m11:41:42.440915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.461844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m11:41:42.463352 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:41:42.463883 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m11:41:42.468199 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:41:42.470819 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m11:41:42.472878 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m11:41:42.473744 [info ] [Thread-1 (]: 7 of 17 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m11:41:42.474782 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:41:42.475347 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:41:42.475812 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m11:41:42.476529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m11:41:42.477040 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:41:42.481253 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:41:42.482781 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:41:42.485942 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:41:42.486948 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:41:42.487429 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m11:41:42.487848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.506253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:41:42.506901 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:41:42.507367 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m11:41:42.510225 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:41:42.512647 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m11:41:42.514011 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m11:41:42.514741 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m11:41:42.515561 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:41:42.516106 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:41:42.516601 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m11:41:42.517340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m11:41:42.518031 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:41:42.523992 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:41:42.525462 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:41:42.529782 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:41:42.530702 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:41:42.531137 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m11:41:42.531537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.550499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:41:42.551464 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:41:42.551994 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m11:41:42.556099 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:41:42.558276 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m11:41:42.560210 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m11:41:42.561436 [info ] [Thread-1 (]: 9 of 17 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.04s]
[0m11:41:42.562440 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:41:42.563042 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:41:42.563571 [info ] [Thread-1 (]: 10 of 17 START test not_null_stg_pipedrive__deal_changes_id .................... [RUN]
[0m11:41:42.564410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m11:41:42.565115 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:41:42.569865 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:41:42.570866 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:41:42.573266 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:41:42.574130 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:41:42.574564 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m11:41:42.574960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.594095 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:41:42.594956 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:41:42.595611 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m11:41:42.600790 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:41:42.602612 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m11:41:42.604154 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m11:41:42.604926 [info ] [Thread-1 (]: 10 of 17 PASS not_null_stg_pipedrive__deal_changes_id .......................... [[32mPASS[0m in 0.04s]
[0m11:41:42.605793 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:41:42.606354 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:41:42.606813 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m11:41:42.607553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m11:41:42.608037 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:41:42.612774 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:41:42.613740 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:41:42.616354 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:41:42.617244 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:41:42.617786 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m11:41:42.618280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.635961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:41:42.636708 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:41:42.637201 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m11:41:42.640638 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:41:42.642376 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m11:41:42.643882 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m11:41:42.644752 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m11:41:42.646223 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:41:42.647461 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:41:42.648254 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m11:41:42.648974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m11:41:42.649484 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:41:42.654088 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:41:42.655353 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:41:42.658088 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:41:42.659108 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:41:42.659602 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m11:41:42.660014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.677011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:41:42.677712 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:41:42.678194 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m11:41:42.681105 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:41:42.683016 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m11:41:42.684897 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m11:41:42.685821 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m11:41:42.686828 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:41:42.687368 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:41:42.688053 [info ] [Thread-1 (]: 13 of 17 START test not_null_stg_pipedrive__users_modified_time ................ [RUN]
[0m11:41:42.688763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5)
[0m11:41:42.689229 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:41:42.693488 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:41:42.694382 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:41:42.697027 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:41:42.697902 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:41:42.698351 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: BEGIN
[0m11:41:42.698753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.715242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:41:42.716080 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:41:42.716646 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_time is null



      
    ) dbt_internal_test
[0m11:41:42.720452 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:41:42.722217 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: ROLLBACK
[0m11:41:42.723519 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: Close
[0m11:41:42.724286 [info ] [Thread-1 (]: 13 of 17 PASS not_null_stg_pipedrive__users_modified_time ...................... [[32mPASS[0m in 0.04s]
[0m11:41:42.725086 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:41:42.725601 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:41:42.726081 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m11:41:42.726736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m11:41:42.727210 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:41:42.731758 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:41:42.732632 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:41:42.735435 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:41:42.736448 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:41:42.737064 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m11:41:42.737508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.753812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:41:42.754599 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:41:42.755124 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m11:41:42.757534 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:41:42.759298 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m11:41:42.760796 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m11:41:42.761541 [info ] [Thread-1 (]: 14 of 17 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.03s]
[0m11:41:42.762284 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:41:42.762807 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:41:42.763303 [info ] [Thread-1 (]: 15 of 17 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m11:41:42.764032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m11:41:42.764490 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:41:42.770778 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:41:42.771628 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:41:42.773960 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:41:42.774706 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:41:42.775139 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m11:41:42.775534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.791976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:41:42.792628 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:41:42.793114 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m11:41:42.795626 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:41:42.797447 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m11:41:42.799000 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m11:41:42.799747 [info ] [Thread-1 (]: 15 of 17 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m11:41:42.801075 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:41:42.802079 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:41:42.802976 [info ] [Thread-1 (]: 16 of 17 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m11:41:42.803750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m11:41:42.804241 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:41:42.813146 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:41:42.814005 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:41:42.816792 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:41:42.817796 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:41:42.818397 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m11:41:42.818831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.835374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:41:42.836228 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:41:42.836817 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:41:42.839596 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "activity_type" does not exist
LINE 12:     select activity_type as from_field
                    ^
HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.activity_name".

[0m11:41:42.840139 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m11:41:42.841977 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m11:41:42.854523 [debug] [Thread-1 (]: Database Error in test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_ (models/staging/schema.yml)
  column "activity_type" does not exist
  LINE 12:     select activity_type as from_field
                      ^
  HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.activity_name".
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/relationships_stg_pipedrive__a_3f73663604b5399ab0c08dc16d6c52a2.sql
[0m11:41:42.855185 [error] [Thread-1 (]: 16 of 17 ERROR relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[31mERROR[0m in 0.05s]
[0m11:41:42.855918 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:41:42.856422 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:41:42.856862 [info ] [Thread-1 (]: 17 of 17 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m11:41:42.858179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m11:41:42.858702 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:41:42.865000 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:41:42.865940 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:41:42.869679 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:41:42.870690 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:41:42.871156 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m11:41:42.871560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:42.889586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:41:42.890239 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:41:42.891009 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:41:42.895561 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:41:42.897813 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m11:41:42.899435 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m11:41:42.900303 [info ] [Thread-1 (]: 17 of 17 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m11:41:42.901833 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:41:42.903606 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:42.904133 [debug] [MainThread]: On master: BEGIN
[0m11:41:42.904568 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:42.921027 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:41:42.921572 [debug] [MainThread]: On master: COMMIT
[0m11:41:42.921999 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:42.922360 [debug] [MainThread]: On master: COMMIT
[0m11:41:42.923618 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:41:42.924032 [debug] [MainThread]: On master: Close
[0m11:41:42.924543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:42.924919 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m11:41:42.925332 [info ] [MainThread]: 
[0m11:41:42.925787 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m11:41:42.929607 [debug] [MainThread]: Command end result
[0m11:41:42.965617 [info ] [MainThread]: 
[0m11:41:42.966167 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:41:42.966582 [info ] [MainThread]: 
[0m11:41:42.967215 [error] [MainThread]:   Database Error in test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_ (models/staging/schema.yml)
  column "activity_type" does not exist
  LINE 12:     select activity_type as from_field
                      ^
  HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.activity_name".
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/relationships_stg_pipedrive__a_3f73663604b5399ab0c08dc16d6c52a2.sql
[0m11:41:42.967928 [info ] [MainThread]: 
[0m11:41:42.968497 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=1 SKIP=0 TOTAL=17
[0m11:41:42.970547 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.9123433, "process_in_blocks": "0", "process_kernel_time": 0.400259, "process_mem_max_rss": "111808512", "process_out_blocks": "0", "process_user_time": 2.816614}
[0m11:41:42.971317 [debug] [MainThread]: Command `dbt test` failed at 11:41:42.971173 after 1.91 seconds
[0m11:41:42.971822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063aad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b2c080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a694620>]}
[0m11:41:42.972277 [debug] [MainThread]: Flushing usage events
[0m11:42:11.210787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11016f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110792f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110792a50>]}


============================== 11:42:11.217885 | a2a01a07-0f1d-45a9-9e76-dcf05e1e2e49 ==============================
[0m11:42:11.217885 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:42:11.219059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:42:11.455053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2a01a07-0f1d-45a9-9e76-dcf05e1e2e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f04a1b0>]}
[0m11:42:11.521508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2a01a07-0f1d-45a9-9e76-dcf05e1e2e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11016d010>]}
[0m11:42:11.522527 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:42:11.655458 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:42:11.809763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:42:11.810855 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/schema.yml
[0m11:42:12.075556 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:42:12.076197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a2a01a07-0f1d-45a9-9e76-dcf05e1e2e49', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115ef080>]}
[0m11:42:12.321251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2a01a07-0f1d-45a9-9e76-dcf05e1e2e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111805d60>]}
[0m11:42:12.466557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2a01a07-0f1d-45a9-9e76-dcf05e1e2e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11181d490>]}
[0m11:42:12.467302 [info ] [MainThread]: Found 17 data tests, 8 models, 6 sources, 428 macros
[0m11:42:12.467788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2a01a07-0f1d-45a9-9e76-dcf05e1e2e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ce210>]}
[0m11:42:12.471630 [info ] [MainThread]: 
[0m11:42:12.472478 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:42:12.479282 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m11:42:12.545555 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:42:12.546068 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m11:42:12.546479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:12.581248 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m11:42:12.581975 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:42:12.582443 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m11:42:12.586547 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m11:42:12.588283 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m11:42:12.589464 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m11:42:12.596692 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:12.597141 [debug] [MainThread]: On master: BEGIN
[0m11:42:12.597481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:42:12.613924 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:42:12.614464 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:12.614940 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:42:12.620210 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m11:42:12.622570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2a01a07-0f1d-45a9-9e76-dcf05e1e2e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11181d400>]}
[0m11:42:12.623095 [debug] [MainThread]: On master: ROLLBACK
[0m11:42:12.624426 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:12.624901 [debug] [MainThread]: On master: BEGIN
[0m11:42:12.626845 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:42:12.627350 [debug] [MainThread]: On master: COMMIT
[0m11:42:12.627742 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:12.628093 [debug] [MainThread]: On master: COMMIT
[0m11:42:12.629294 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:42:12.629728 [debug] [MainThread]: On master: Close
[0m11:42:12.630276 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:42:12.630716 [info ] [MainThread]: 
[0m11:42:12.633385 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:42:12.633988 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m11:42:12.634754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m11:42:12.635227 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:42:12.652856 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:42:12.653871 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:42:12.673483 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:42:12.674446 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:42:12.674890 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m11:42:12.675289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:12.693167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:42:12.693764 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:42:12.694253 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m11:42:12.699482 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m11:42:12.704667 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m11:42:12.706298 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m11:42:12.707152 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.07s]
[0m11:42:12.708084 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:42:12.708685 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:42:12.709251 [info ] [Thread-1 (]: 2 of 17 START test assert_change_stage_references_lost_reason_id ............... [RUN]
[0m11:42:12.710033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m11:42:12.710502 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:42:12.713514 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:42:12.714357 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:42:12.716691 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:42:12.717696 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:42:12.718142 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m11:42:12.718541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:12.736344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:42:12.737384 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:42:12.737887 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:42:12.742628 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:42:12.744377 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m11:42:12.745910 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m11:42:12.746711 [info ] [Thread-1 (]: 2 of 17 PASS assert_change_stage_references_lost_reason_id ..................... [[32mPASS[0m in 0.04s]
[0m11:42:12.747490 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:42:12.748023 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:42:12.748523 [info ] [Thread-1 (]: 3 of 17 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m11:42:12.749115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m11:42:12.749585 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:42:12.752666 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:42:12.753639 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:42:12.757425 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:42:12.758356 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:42:12.758892 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m11:42:12.760470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:12.777434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:42:12.778155 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:42:12.778716 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:42:12.786526 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m11:42:12.788422 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m11:42:12.790365 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m11:42:12.791217 [info ] [Thread-1 (]: 3 of 17 PASS assert_change_stage_references_stage_id ........................... [[32mPASS[0m in 0.04s]
[0m11:42:12.792066 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:42:12.792598 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:42:12.793108 [info ] [Thread-1 (]: 4 of 17 START test assert_change_user_references_user_id ....................... [RUN]
[0m11:42:12.793924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m11:42:12.794387 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:42:12.797286 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:42:12.798199 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:42:12.800557 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:42:12.801585 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:42:12.802240 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m11:42:12.802674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:12.820860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:42:12.821579 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:42:12.822203 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:42:12.828407 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m11:42:12.830210 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m11:42:12.831627 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m11:42:12.832395 [info ] [Thread-1 (]: 4 of 17 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.04s]
[0m11:42:12.833304 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:42:12.833943 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:42:12.834479 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m11:42:12.835102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m11:42:12.835559 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:42:12.843525 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:42:12.844397 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:42:12.846753 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:42:12.847501 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:42:12.847927 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m11:42:12.848319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:12.866382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:42:12.867179 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:42:12.867755 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m11:42:12.870211 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:42:12.871990 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m11:42:12.874783 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m11:42:12.875632 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.04s]
[0m11:42:12.876415 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:42:12.876965 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:42:12.877454 [info ] [Thread-1 (]: 6 of 17 START test not_null_stg_pipedrive__activity_due_time ................... [RUN]
[0m11:42:12.878158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191)
[0m11:42:12.878636 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:42:12.882781 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:42:12.883708 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:42:12.886203 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:42:12.887128 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:42:12.887587 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: BEGIN
[0m11:42:12.888023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:12.906819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:42:12.907927 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:42:12.908573 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_time is null



      
    ) dbt_internal_test
[0m11:42:12.911100 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:42:12.912838 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: ROLLBACK
[0m11:42:12.914078 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: Close
[0m11:42:12.914875 [info ] [Thread-1 (]: 6 of 17 PASS not_null_stg_pipedrive__activity_due_time ......................... [[32mPASS[0m in 0.04s]
[0m11:42:12.915744 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:42:12.916274 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:42:12.916773 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m11:42:12.917656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m11:42:12.918157 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:42:12.922663 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:42:12.923544 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:42:12.926393 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:42:12.927483 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:42:12.928821 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m11:42:12.929817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:12.946039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:42:12.946675 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:42:12.947142 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m11:42:12.950452 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:42:12.952297 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m11:42:12.953746 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m11:42:12.954528 [info ] [Thread-1 (]: 7 of 17 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m11:42:12.955431 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:42:12.956095 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:42:12.956589 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m11:42:12.957306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m11:42:12.957771 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:42:12.962284 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:42:12.963148 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:42:12.965957 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:42:12.967133 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:42:12.967739 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m11:42:12.968182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:12.987426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:42:12.988189 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:42:12.988848 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m11:42:12.992584 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:42:12.994380 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m11:42:12.995798 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m11:42:12.996670 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m11:42:12.997462 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:42:12.997997 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:42:12.998500 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m11:42:12.999180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m11:42:12.999665 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:42:13.004551 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:42:13.006030 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:42:13.011388 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:42:13.012262 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:42:13.012698 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m11:42:13.013090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:13.030272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:42:13.031061 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:42:13.031554 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m11:42:13.034848 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:42:13.036618 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m11:42:13.038350 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m11:42:13.039822 [info ] [Thread-1 (]: 9 of 17 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.04s]
[0m11:42:13.040749 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:42:13.041295 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:42:13.041793 [info ] [Thread-1 (]: 10 of 17 START test not_null_stg_pipedrive__deal_changes_id .................... [RUN]
[0m11:42:13.042437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m11:42:13.042964 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:42:13.047147 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:42:13.047994 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:42:13.051095 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:42:13.052061 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:42:13.052524 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m11:42:13.052923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:13.075126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m11:42:13.076160 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:42:13.076831 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m11:42:13.080116 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:42:13.081951 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m11:42:13.083867 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m11:42:13.084845 [info ] [Thread-1 (]: 10 of 17 PASS not_null_stg_pipedrive__deal_changes_id .......................... [[32mPASS[0m in 0.04s]
[0m11:42:13.085792 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:42:13.086414 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:42:13.087096 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m11:42:13.088109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m11:42:13.088974 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:42:13.096209 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:42:13.097204 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:42:13.099783 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:42:13.101010 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:42:13.101601 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m11:42:13.102057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:13.125114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m11:42:13.125768 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:42:13.126288 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m11:42:13.129456 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:42:13.131182 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m11:42:13.132559 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m11:42:13.133357 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.05s]
[0m11:42:13.134191 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:42:13.135148 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:42:13.136042 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m11:42:13.137508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m11:42:13.138383 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:42:13.146465 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:42:13.147430 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:42:13.150242 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:42:13.151314 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:42:13.151852 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m11:42:13.152284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:13.170356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:42:13.171314 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:42:13.172082 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m11:42:13.174723 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:42:13.176591 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m11:42:13.178275 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m11:42:13.179023 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m11:42:13.179804 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:42:13.180323 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:42:13.180844 [info ] [Thread-1 (]: 13 of 17 START test not_null_stg_pipedrive__users_modified_time ................ [RUN]
[0m11:42:13.181513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5)
[0m11:42:13.182055 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:42:13.186634 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:42:13.187617 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:42:13.190202 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:42:13.191027 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:42:13.191479 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: BEGIN
[0m11:42:13.191880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:13.209028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:42:13.209837 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:42:13.210358 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_time is null



      
    ) dbt_internal_test
[0m11:42:13.213138 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:42:13.214873 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: ROLLBACK
[0m11:42:13.216353 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: Close
[0m11:42:13.217267 [info ] [Thread-1 (]: 13 of 17 PASS not_null_stg_pipedrive__users_modified_time ...................... [[32mPASS[0m in 0.04s]
[0m11:42:13.218065 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:42:13.218581 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:42:13.219028 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m11:42:13.219697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m11:42:13.220325 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:42:13.224637 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:42:13.225451 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:42:13.227858 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:42:13.228678 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:42:13.229136 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m11:42:13.229541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:13.248174 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:42:13.248960 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:42:13.249429 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m11:42:13.252001 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:42:13.253865 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m11:42:13.255503 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m11:42:13.256338 [info ] [Thread-1 (]: 14 of 17 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m11:42:13.257263 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:42:13.257896 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:42:13.258491 [info ] [Thread-1 (]: 15 of 17 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m11:42:13.259462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m11:42:13.260130 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:42:13.265856 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:42:13.266960 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:42:13.271241 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:42:13.272121 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:42:13.272575 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m11:42:13.272984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:13.292347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:42:13.293122 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:42:13.293580 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m11:42:13.296509 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:42:13.298324 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m11:42:13.299771 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m11:42:13.300832 [info ] [Thread-1 (]: 15 of 17 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m11:42:13.302352 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:42:13.303164 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72
[0m11:42:13.304051 [info ] [Thread-1 (]: 16 of 17 START test relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_  [RUN]
[0m11:42:13.304908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72)
[0m11:42:13.305466 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72
[0m11:42:13.311534 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72"
[0m11:42:13.312431 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72
[0m11:42:13.314759 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72"
[0m11:42:13.315515 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72"
[0m11:42:13.315987 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72: BEGIN
[0m11:42:13.316400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:13.334129 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:42:13.334874 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72"
[0m11:42:13.335377 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_name as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_name is not null
),

parent as (
    select activity_name as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:42:13.339578 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:42:13.341477 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72: ROLLBACK
[0m11:42:13.342924 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72: Close
[0m11:42:13.343673 [error] [Thread-1 (]: 16 of 17 FAIL 4579 relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_  [[31mFAIL 4579[0m in 0.04s]
[0m11:42:13.344515 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72
[0m11:42:13.345113 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:42:13.345636 [info ] [Thread-1 (]: 17 of 17 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m11:42:13.346422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_.3b107e2f72, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m11:42:13.346910 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:42:13.352570 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:42:13.353514 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:42:13.356013 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:42:13.356792 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:42:13.357235 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m11:42:13.357642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:13.375065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:42:13.375784 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:42:13.376340 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:42:13.380066 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:42:13.381797 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m11:42:13.383150 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m11:42:13.383859 [info ] [Thread-1 (]: 17 of 17 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m11:42:13.384880 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:42:13.386333 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:13.386834 [debug] [MainThread]: On master: BEGIN
[0m11:42:13.387278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:42:13.402853 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:42:13.403333 [debug] [MainThread]: On master: COMMIT
[0m11:42:13.403722 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:13.404075 [debug] [MainThread]: On master: COMMIT
[0m11:42:13.405392 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:42:13.405849 [debug] [MainThread]: On master: Close
[0m11:42:13.406352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:13.406701 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m11:42:13.407107 [info ] [MainThread]: 
[0m11:42:13.407663 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m11:42:13.411498 [debug] [MainThread]: Command end result
[0m11:42:13.504064 [info ] [MainThread]: 
[0m11:42:13.504589 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:42:13.505109 [info ] [MainThread]: 
[0m11:42:13.505702 [error] [MainThread]: [31mFailure in test relationships_stg_pipedrive__activity_activity_name__activity_name__ref_stg_pipedrive__activity_types_ (models/staging/schema.yml)[0m
[0m11:42:13.506177 [error] [MainThread]:   Got 4579 results, configured to fail if != 0
[0m11:42:13.506554 [info ] [MainThread]: 
[0m11:42:13.507055 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/staging/schema.yml/relationships_stg_pipedrive__a_06a40516aa5de6f3c995cdb66c324f0b.sql
[0m11:42:13.507479 [info ] [MainThread]: 
[0m11:42:13.507925 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=1 SKIP=0 TOTAL=17
[0m11:42:13.510565 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.4030638, "process_in_blocks": "0", "process_kernel_time": 0.395815, "process_mem_max_rss": "117370880", "process_out_blocks": "0", "process_user_time": 3.276748}
[0m11:42:13.511362 [debug] [MainThread]: Command `dbt test` failed at 11:42:13.511217 after 2.40 seconds
[0m11:42:13.511851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caaed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11177b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a543e0>]}
[0m11:42:13.512303 [debug] [MainThread]: Flushing usage events
[0m11:43:20.493942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10437c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec2c30>]}


============================== 11:43:20.499295 | 1dd55110-233e-43f4-9959-2afb22f9c1dd ==============================
[0m11:43:20.499295 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:43:20.500470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:43:20.737373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dd55110-233e-43f4-9959-2afb22f9c1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594da60>]}
[0m11:43:20.803489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dd55110-233e-43f4-9959-2afb22f9c1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec2a50>]}
[0m11:43:20.804513 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:43:20.934905 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:43:21.085576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:43:21.086574 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/schema.yml
[0m11:43:21.087011 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__activity.sql
[0m11:43:21.349119 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:43:21.349863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1dd55110-233e-43f4-9959-2afb22f9c1dd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d581d0>]}
[0m11:43:21.588529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dd55110-233e-43f4-9959-2afb22f9c1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2af90>]}
[0m11:43:21.733020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dd55110-233e-43f4-9959-2afb22f9c1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d45a30>]}
[0m11:43:21.733764 [info ] [MainThread]: Found 17 data tests, 8 models, 6 sources, 428 macros
[0m11:43:21.734208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd55110-233e-43f4-9959-2afb22f9c1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715b980>]}
[0m11:43:21.737336 [info ] [MainThread]: 
[0m11:43:21.738011 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:43:21.743476 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m11:43:21.808926 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:43:21.809389 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m11:43:21.809746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:21.840257 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m11:43:21.840913 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:43:21.841378 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m11:43:21.845725 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m11:43:21.847531 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m11:43:21.848943 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m11:43:21.856532 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:21.856971 [debug] [MainThread]: On master: BEGIN
[0m11:43:21.857312 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:21.872833 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m11:43:21.873446 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:21.874079 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:43:21.879412 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m11:43:21.881535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd55110-233e-43f4-9959-2afb22f9c1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa2e10>]}
[0m11:43:21.882035 [debug] [MainThread]: On master: ROLLBACK
[0m11:43:21.883539 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:21.884002 [debug] [MainThread]: On master: BEGIN
[0m11:43:21.886142 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:43:21.886643 [debug] [MainThread]: On master: COMMIT
[0m11:43:21.887022 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:21.887373 [debug] [MainThread]: On master: COMMIT
[0m11:43:21.888491 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:43:21.888921 [debug] [MainThread]: On master: Close
[0m11:43:21.889501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:43:21.889952 [info ] [MainThread]: 
[0m11:43:21.892625 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:43:21.893198 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m11:43:21.893946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m11:43:21.894446 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:43:21.911869 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:43:21.912777 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:43:21.931917 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:43:21.932886 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:43:21.933461 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m11:43:21.933883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:21.950239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:43:21.950897 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:43:21.951377 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m11:43:21.956045 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:43:21.960842 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m11:43:21.962325 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m11:43:21.963190 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.07s]
[0m11:43:21.964034 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:43:21.964590 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:43:21.965156 [info ] [Thread-1 (]: 2 of 17 START test assert_change_stage_references_lost_reason_id ............... [RUN]
[0m11:43:21.965898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m11:43:21.966374 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:43:21.969467 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:43:21.970350 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:43:21.972734 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:43:21.973505 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:43:21.973932 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m11:43:21.974329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:21.992412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:43:21.993768 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:43:21.994369 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:43:21.999034 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:43:22.000891 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m11:43:22.002471 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m11:43:22.003301 [info ] [Thread-1 (]: 2 of 17 PASS assert_change_stage_references_lost_reason_id ..................... [[32mPASS[0m in 0.04s]
[0m11:43:22.004227 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:43:22.004832 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:43:22.005375 [info ] [Thread-1 (]: 3 of 17 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m11:43:22.006168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m11:43:22.006684 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:43:22.009624 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:43:22.010546 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:43:22.014155 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:43:22.015201 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:43:22.015675 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m11:43:22.016075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.032625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:43:22.033683 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:43:22.035497 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:43:22.042586 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m11:43:22.044353 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m11:43:22.046568 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m11:43:22.048120 [info ] [Thread-1 (]: 3 of 17 PASS assert_change_stage_references_stage_id ........................... [[32mPASS[0m in 0.04s]
[0m11:43:22.049118 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:43:22.049667 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:43:22.050121 [info ] [Thread-1 (]: 4 of 17 START test assert_change_user_references_user_id ....................... [RUN]
[0m11:43:22.050997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m11:43:22.051579 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:43:22.054407 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:43:22.055204 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:43:22.057431 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:43:22.058179 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:43:22.058603 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m11:43:22.058998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.075898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:43:22.076550 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:43:22.077056 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:43:22.083270 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m11:43:22.085061 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m11:43:22.086606 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m11:43:22.087351 [info ] [Thread-1 (]: 4 of 17 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.04s]
[0m11:43:22.088254 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:43:22.088801 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:43:22.089300 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m11:43:22.089931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m11:43:22.090426 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:43:22.098121 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:43:22.099055 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:43:22.103278 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:43:22.104191 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:43:22.104622 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m11:43:22.105018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.120855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:43:22.121472 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:43:22.121926 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m11:43:22.125493 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:43:22.127312 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m11:43:22.128918 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m11:43:22.129871 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.04s]
[0m11:43:22.131008 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:43:22.131624 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:43:22.132161 [info ] [Thread-1 (]: 6 of 17 START test not_null_stg_pipedrive__activity_due_time ................... [RUN]
[0m11:43:22.132894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191)
[0m11:43:22.133567 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:43:22.138242 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:43:22.139118 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:43:22.141457 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:43:22.142281 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:43:22.142693 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: BEGIN
[0m11:43:22.143080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.161375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:43:22.162000 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:43:22.163263 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_time is null



      
    ) dbt_internal_test
[0m11:43:22.167849 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:43:22.169623 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: ROLLBACK
[0m11:43:22.171263 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: Close
[0m11:43:22.172137 [info ] [Thread-1 (]: 6 of 17 PASS not_null_stg_pipedrive__activity_due_time ......................... [[32mPASS[0m in 0.04s]
[0m11:43:22.173005 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:43:22.173551 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:43:22.174107 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m11:43:22.174728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m11:43:22.175226 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:43:22.179679 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:43:22.180735 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:43:22.183188 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:43:22.184112 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:43:22.184585 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m11:43:22.184988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.202085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:43:22.202822 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:43:22.203308 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m11:43:22.206477 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:43:22.208433 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m11:43:22.210044 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m11:43:22.211031 [info ] [Thread-1 (]: 7 of 17 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m11:43:22.212250 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:43:22.212997 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:43:22.213809 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m11:43:22.215270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m11:43:22.216307 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:43:22.221285 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:43:22.222292 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:43:22.226107 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:43:22.227115 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:43:22.227585 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m11:43:22.228011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.247802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m11:43:22.248379 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:43:22.248860 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m11:43:22.251561 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:43:22.253349 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m11:43:22.254686 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m11:43:22.255445 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m11:43:22.256233 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:43:22.256819 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:43:22.257332 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m11:43:22.257961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m11:43:22.258466 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:43:22.262793 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:43:22.263646 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:43:22.268250 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:43:22.269182 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:43:22.269645 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m11:43:22.270054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.290423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m11:43:22.291134 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:43:22.291642 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m11:43:22.294998 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:43:22.296738 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m11:43:22.298334 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m11:43:22.299338 [info ] [Thread-1 (]: 9 of 17 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.04s]
[0m11:43:22.300366 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:43:22.300959 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:43:22.301465 [info ] [Thread-1 (]: 10 of 17 START test not_null_stg_pipedrive__deal_changes_id .................... [RUN]
[0m11:43:22.302215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m11:43:22.302717 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:43:22.307092 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:43:22.307912 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:43:22.310222 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:43:22.310987 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:43:22.311418 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m11:43:22.311819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.330213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:43:22.331062 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:43:22.331628 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m11:43:22.337472 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m11:43:22.339205 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m11:43:22.340645 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m11:43:22.341396 [info ] [Thread-1 (]: 10 of 17 PASS not_null_stg_pipedrive__deal_changes_id .......................... [[32mPASS[0m in 0.04s]
[0m11:43:22.342210 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:43:22.342748 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:43:22.343203 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m11:43:22.343995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m11:43:22.344479 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:43:22.348672 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:43:22.349675 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:43:22.352271 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:43:22.353165 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:43:22.353606 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m11:43:22.354013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.372839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:43:22.373611 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:43:22.374264 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m11:43:22.378039 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:43:22.380124 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m11:43:22.381950 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m11:43:22.383295 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m11:43:22.385090 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:43:22.387453 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:43:22.388583 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m11:43:22.389341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m11:43:22.389867 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:43:22.394244 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:43:22.395091 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:43:22.397528 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:43:22.398472 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:43:22.398962 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m11:43:22.399367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.421586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m11:43:22.422554 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:43:22.423044 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m11:43:22.425544 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:43:22.427299 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m11:43:22.428866 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m11:43:22.429616 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m11:43:22.430401 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:43:22.430995 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:43:22.431520 [info ] [Thread-1 (]: 13 of 17 START test not_null_stg_pipedrive__users_modified_time ................ [RUN]
[0m11:43:22.432235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5)
[0m11:43:22.432749 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:43:22.437268 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:43:22.438279 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:43:22.442174 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:43:22.443434 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:43:22.443961 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: BEGIN
[0m11:43:22.444406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.465661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m11:43:22.466511 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:43:22.467076 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_time is null



      
    ) dbt_internal_test
[0m11:43:22.470492 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:43:22.472387 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: ROLLBACK
[0m11:43:22.474117 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: Close
[0m11:43:22.475189 [info ] [Thread-1 (]: 13 of 17 PASS not_null_stg_pipedrive__users_modified_time ...................... [[32mPASS[0m in 0.04s]
[0m11:43:22.476146 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:43:22.476736 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:43:22.477217 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m11:43:22.477998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m11:43:22.478534 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:43:22.483602 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:43:22.484704 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:43:22.487567 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:43:22.488625 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:43:22.489156 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m11:43:22.489584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.508873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:43:22.509606 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:43:22.510102 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m11:43:22.512728 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:43:22.514518 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m11:43:22.516063 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m11:43:22.516912 [info ] [Thread-1 (]: 14 of 17 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m11:43:22.518417 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:43:22.519079 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:43:22.520032 [info ] [Thread-1 (]: 15 of 17 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m11:43:22.522802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m11:43:22.523630 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:43:22.527987 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:43:22.528851 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:43:22.533313 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:43:22.535252 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:43:22.536144 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m11:43:22.536734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.556219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:43:22.557148 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:43:22.557671 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m11:43:22.560100 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:43:22.561818 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m11:43:22.563275 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m11:43:22.564000 [info ] [Thread-1 (]: 15 of 17 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m11:43:22.564889 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:43:22.565490 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:43:22.565993 [info ] [Thread-1 (]: 16 of 17 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m11:43:22.566920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m11:43:22.567442 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:43:22.573537 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:43:22.574666 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:43:22.577453 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:43:22.578343 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:43:22.578794 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m11:43:22.579210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.596082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:43:22.596777 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:43:22.597369 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:43:22.599449 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "activity_type" does not exist
LINE 12:     select activity_type as from_field
                    ^
HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.activity_name".

[0m11:43:22.600162 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m11:43:22.602125 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m11:43:22.611543 [debug] [Thread-1 (]: Database Error in test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_ (models/staging/schema.yml)
  column "activity_type" does not exist
  LINE 12:     select activity_type as from_field
                      ^
  HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.activity_name".
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/relationships_stg_pipedrive__a_3f73663604b5399ab0c08dc16d6c52a2.sql
[0m11:43:22.612211 [error] [Thread-1 (]: 16 of 17 ERROR relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[31mERROR[0m in 0.05s]
[0m11:43:22.612951 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:43:22.613475 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:43:22.614677 [info ] [Thread-1 (]: 17 of 17 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m11:43:22.615226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m11:43:22.615673 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:43:22.621253 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:43:22.622099 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:43:22.624602 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:43:22.625460 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:43:22.625911 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m11:43:22.626315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:22.643895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:43:22.644675 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:43:22.645308 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:43:22.649188 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:43:22.651146 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m11:43:22.652643 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m11:43:22.653404 [info ] [Thread-1 (]: 17 of 17 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m11:43:22.654210 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:43:22.655835 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:22.656562 [debug] [MainThread]: On master: BEGIN
[0m11:43:22.656953 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:22.672600 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:43:22.673212 [debug] [MainThread]: On master: COMMIT
[0m11:43:22.673614 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:22.674016 [debug] [MainThread]: On master: COMMIT
[0m11:43:22.675325 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:43:22.675770 [debug] [MainThread]: On master: Close
[0m11:43:22.676295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:22.676756 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m11:43:22.677210 [info ] [MainThread]: 
[0m11:43:22.677634 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m11:43:22.682461 [debug] [MainThread]: Command end result
[0m11:43:22.779609 [info ] [MainThread]: 
[0m11:43:22.780121 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:43:22.780504 [info ] [MainThread]: 
[0m11:43:22.781034 [error] [MainThread]:   Database Error in test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_ (models/staging/schema.yml)
  column "activity_type" does not exist
  LINE 12:     select activity_type as from_field
                      ^
  HINT:  Perhaps you meant to reference the column "stg_pipedrive__activity.activity_name".
  compiled code at target/run/enpal_assessment_project/models/staging/schema.yml/relationships_stg_pipedrive__a_3f73663604b5399ab0c08dc16d6c52a2.sql
[0m11:43:22.781471 [info ] [MainThread]: 
[0m11:43:22.781895 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=1 SKIP=0 TOTAL=17
[0m11:43:22.784476 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.3724005, "process_in_blocks": "0", "process_kernel_time": 0.402096, "process_mem_max_rss": "117862400", "process_out_blocks": "0", "process_user_time": 3.260287}
[0m11:43:22.785198 [debug] [MainThread]: Command `dbt test` failed at 11:43:22.785063 after 2.37 seconds
[0m11:43:22.785654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021ded50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7bef0>]}
[0m11:43:22.786144 [debug] [MainThread]: Flushing usage events
[0m11:43:40.186162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a275fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a413140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a412c30>]}


============================== 11:43:40.191096 | 1b180a4b-7bd4-44df-adc1-8ffd10c312cd ==============================
[0m11:43:40.191096 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:43:40.191852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:43:40.424519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b180a4b-7bd4-44df-adc1-8ffd10c312cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a525370>]}
[0m11:43:40.490526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b180a4b-7bd4-44df-adc1-8ffd10c312cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109deb8c0>]}
[0m11:43:40.491670 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:43:40.628422 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:43:40.782866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:43:40.783460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:43:40.843155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b180a4b-7bd4-44df-adc1-8ffd10c312cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f7b90>]}
[0m11:43:40.977622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b180a4b-7bd4-44df-adc1-8ffd10c312cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994f950>]}
[0m11:43:40.978198 [info ] [MainThread]: Found 17 data tests, 8 models, 6 sources, 428 macros
[0m11:43:40.978623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b180a4b-7bd4-44df-adc1-8ffd10c312cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9f0d40>]}
[0m11:43:40.981395 [info ] [MainThread]: 
[0m11:43:40.982082 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:43:40.986978 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:43:41.057117 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:43:41.057634 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:43:41.058010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:41.093757 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m11:43:41.095581 [debug] [ThreadPool]: On list_postgres: Close
[0m11:43:41.097995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m11:43:41.106350 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:43:41.106807 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m11:43:41.107155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:41.122477 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m11:43:41.123037 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:43:41.123489 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m11:43:41.127329 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m11:43:41.128988 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m11:43:41.130193 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m11:43:41.137125 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:41.137577 [debug] [MainThread]: On master: BEGIN
[0m11:43:41.137920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:41.154008 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:43:41.154581 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:41.155084 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:43:41.160985 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m11:43:41.163213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b180a4b-7bd4-44df-adc1-8ffd10c312cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b615070>]}
[0m11:43:41.163750 [debug] [MainThread]: On master: ROLLBACK
[0m11:43:41.165099 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:41.165513 [debug] [MainThread]: On master: BEGIN
[0m11:43:41.167890 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:43:41.168524 [debug] [MainThread]: On master: COMMIT
[0m11:43:41.168939 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:41.169300 [debug] [MainThread]: On master: COMMIT
[0m11:43:41.170598 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:43:41.171143 [debug] [MainThread]: On master: Close
[0m11:43:41.171725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:43:41.172271 [info ] [MainThread]: 
[0m11:43:41.174862 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m11:43:41.175550 [info ] [Thread-1 (]: 1 of 8 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m11:43:41.176105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m11:43:41.176535 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m11:43:41.186787 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:41.187664 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m11:43:41.229002 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:41.229923 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:41.230357 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m11:43:41.230753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:41.246967 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:43:41.247663 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:41.248141 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m11:43:41.252243 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m11:43:41.259412 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:41.259942 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m11:43:41.261931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:41.265093 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:41.265669 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m11:43:41.268145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:43:41.286976 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m11:43:41.287533 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:41.287945 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m11:43:41.290695 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:43:41.297970 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m11:43:41.304880 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:41.305434 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m11:43:41.309144 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:43:41.312190 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m11:43:41.314022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b180a4b-7bd4-44df-adc1-8ffd10c312cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cb9e20>]}
[0m11:43:41.314907 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m11:43:41.316185 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m11:43:41.317009 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:43:41.317801 [info ] [Thread-1 (]: 2 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m11:43:41.318411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m11:43:41.318852 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:43:41.322368 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:41.323278 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:43:41.330132 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:41.331117 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:41.331589 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m11:43:41.331995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:41.348589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:43:41.349231 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:41.349696 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to::TIMESTAMP AS due_time
FROM "postgres"."public"."activity"
  );
[0m11:43:41.352561 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:43:41.355942 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:41.356435 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m11:43:41.358208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:41.361667 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:41.362167 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m11:43:41.363710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:41.365578 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m11:43:41.366020 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:41.366425 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m11:43:41.368821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:43:41.371643 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m11:43:41.372535 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:41.372964 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m11:43:41.375409 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:43:41.377025 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m11:43:41.377637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b180a4b-7bd4-44df-adc1-8ffd10c312cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71b320>]}
[0m11:43:41.378448 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m11:43:41.379310 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:43:41.379917 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:43:41.380675 [info ] [Thread-1 (]: 3 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m11:43:41.381243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m11:43:41.381675 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:43:41.385039 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:41.385983 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:43:41.391250 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:41.392224 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:41.392733 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m11:43:41.393246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:41.409891 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:43:41.410505 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:41.411021 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS activity_is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m11:43:41.415203 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m11:43:41.419062 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:41.419602 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m11:43:41.421357 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:41.424681 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:41.425138 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m11:43:41.426683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:41.428659 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m11:43:41.429144 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:41.429558 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m11:43:41.431331 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:43:41.434059 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m11:43:41.434925 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:41.435357 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m11:43:41.437726 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:43:41.439331 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m11:43:41.439929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b180a4b-7bd4-44df-adc1-8ffd10c312cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b1490>]}
[0m11:43:41.440671 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m11:43:41.441475 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:43:41.442004 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:43:41.442734 [info ] [Thread-1 (]: 4 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m11:43:41.443367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m11:43:41.443813 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:43:41.446778 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:41.447742 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:43:41.453772 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:41.454670 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:41.455114 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m11:43:41.455518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:41.473467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:43:41.474246 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:41.474730 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time::TIMESTAMP AS change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m11:43:41.477730 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:43:41.481170 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:41.481638 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m11:43:41.483365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:41.488032 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:41.488503 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m11:43:41.490080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:41.491957 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m11:43:41.492548 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:41.492990 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m11:43:41.494857 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:43:41.497471 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m11:43:41.498298 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:41.498732 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m11:43:41.501389 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:43:41.503017 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m11:43:41.503985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b180a4b-7bd4-44df-adc1-8ffd10c312cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b754560>]}
[0m11:43:41.504784 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m11:43:41.505571 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:43:41.506105 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:43:41.506775 [info ] [Thread-1 (]: 5 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m11:43:41.507326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m11:43:41.507756 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:43:41.510800 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:41.511863 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:43:41.517735 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:41.518685 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:41.519151 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m11:43:41.519544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:41.536689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:43:41.537331 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:41.537803 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m11:43:41.540630 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:43:41.543986 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:41.544457 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m11:43:41.546133 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:41.549516 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:41.549992 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m11:43:41.551839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:41.553745 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m11:43:41.554316 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:41.554798 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m11:43:41.557074 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:43:41.559804 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m11:43:41.560641 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:41.561074 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m11:43:41.563536 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:43:41.565138 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m11:43:41.565734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b180a4b-7bd4-44df-adc1-8ffd10c312cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b308800>]}
[0m11:43:41.566712 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m11:43:41.567531 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:43:41.568119 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m11:43:41.568796 [info ] [Thread-1 (]: 6 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m11:43:41.569379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m11:43:41.569820 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m11:43:41.572985 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:41.573878 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m11:43:41.579295 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:41.580198 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:41.580632 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m11:43:41.581024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:41.600068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:43:41.600656 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:41.601122 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified::TIMESTAMP AS modified_time
FROM "postgres"."public"."users"
  );
[0m11:43:41.604679 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:43:41.608174 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:41.608663 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m11:43:41.610349 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:41.613605 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:41.614058 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m11:43:41.615558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:41.617796 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m11:43:41.618340 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:41.618770 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m11:43:41.621855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:43:41.625866 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m11:43:41.626704 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:41.627127 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m11:43:41.630087 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:43:41.631744 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m11:43:41.632340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b180a4b-7bd4-44df-adc1-8ffd10c312cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b76f860>]}
[0m11:43:41.633283 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m11:43:41.634199 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m11:43:41.634783 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:43:41.635498 [info ] [Thread-1 (]: 7 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m11:43:41.636106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m11:43:41.636559 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:43:41.639401 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:43:41.640208 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:43:41.644000 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:43:41.644846 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:43:41.645335 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m11:43:41.645741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:41.666060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m11:43:41.666988 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:43:41.667752 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m11:43:41.671935 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:43:41.675217 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:43:41.675692 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m11:43:41.677639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:41.679778 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m11:43:41.680313 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:43:41.680782 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m11:43:41.683221 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:43:41.686336 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m11:43:41.687235 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:43:41.687674 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m11:43:41.689095 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:43:41.690662 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m11:43:41.691301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b180a4b-7bd4-44df-adc1-8ffd10c312cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b72ffe0>]}
[0m11:43:41.692280 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.06s]
[0m11:43:41.693382 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:43:41.694218 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:43:41.695147 [info ] [Thread-1 (]: 8 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m11:43:41.695779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m11:43:41.696246 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:43:41.698993 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:43:41.699781 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:43:41.703776 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:43:41.705239 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:43:41.705909 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m11:43:41.706330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:41.725935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:43:41.726591 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:43:41.727156 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m11:43:41.731811 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m11:43:41.735490 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:43:41.736032 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m11:43:41.739002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:43:41.741382 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m11:43:41.741867 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:43:41.742292 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m11:43:41.744553 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:43:41.747185 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m11:43:41.748049 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:43:41.748492 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m11:43:41.750222 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:43:41.751852 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m11:43:41.752552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b180a4b-7bd4-44df-adc1-8ffd10c312cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b29e9c0>]}
[0m11:43:41.753338 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.06s]
[0m11:43:41.754918 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:43:41.756475 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:41.756933 [debug] [MainThread]: On master: BEGIN
[0m11:43:41.757297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:41.773034 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:43:41.773626 [debug] [MainThread]: On master: COMMIT
[0m11:43:41.774124 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:41.774740 [debug] [MainThread]: On master: COMMIT
[0m11:43:41.777332 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:43:41.777849 [debug] [MainThread]: On master: Close
[0m11:43:41.778530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:41.779036 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__fields_stages' was properly closed.
[0m11:43:41.779531 [info ] [MainThread]: 
[0m11:43:41.780025 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m11:43:41.782235 [debug] [MainThread]: Command end result
[0m11:43:41.819716 [info ] [MainThread]: 
[0m11:43:41.820637 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:41.821734 [info ] [MainThread]: 
[0m11:43:41.822337 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m11:43:41.824304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7282642, "process_in_blocks": "0", "process_kernel_time": 0.381811, "process_mem_max_rss": "109502464", "process_out_blocks": "0", "process_user_time": 2.706735}
[0m11:43:41.825225 [debug] [MainThread]: Command `dbt run` succeeded at 11:43:41.825028 after 1.73 seconds
[0m11:43:41.825793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d73d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfa960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa5d00>]}
[0m11:43:41.826317 [debug] [MainThread]: Flushing usage events
[0m11:43:46.202690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104455100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a7260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a6c60>]}


============================== 11:43:46.207720 | 8354a381-aa3b-4cfe-b35e-be27c8e38b3f ==============================
[0m11:43:46.207720 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:43:46.208421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:43:46.444653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8354a381-aa3b-4cfe-b35e-be27c8e38b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061953d0>]}
[0m11:43:46.511525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8354a381-aa3b-4cfe-b35e-be27c8e38b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d57f0>]}
[0m11:43:46.512562 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:43:46.645718 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:43:46.795040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:43:46.795526 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:43:46.856046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8354a381-aa3b-4cfe-b35e-be27c8e38b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d75970>]}
[0m11:43:46.989210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8354a381-aa3b-4cfe-b35e-be27c8e38b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b94c0>]}
[0m11:43:46.989783 [info ] [MainThread]: Found 17 data tests, 8 models, 6 sources, 428 macros
[0m11:43:46.990209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8354a381-aa3b-4cfe-b35e-be27c8e38b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106218ad0>]}
[0m11:43:46.992849 [info ] [MainThread]: 
[0m11:43:46.993608 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:43:46.999823 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:43:47.056935 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:43:47.057420 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:43:47.057792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:47.087543 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.030 seconds
[0m11:43:47.089141 [debug] [ThreadPool]: On list_postgres: Close
[0m11:43:47.091071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m11:43:47.099103 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:43:47.099555 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m11:43:47.099898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:47.115176 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m11:43:47.115863 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:43:47.116645 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m11:43:47.120758 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m11:43:47.122420 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m11:43:47.123631 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m11:43:47.130672 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:47.131123 [debug] [MainThread]: On master: BEGIN
[0m11:43:47.131460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:47.147574 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:43:47.148260 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:47.148785 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:43:47.153939 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m11:43:47.156023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8354a381-aa3b-4cfe-b35e-be27c8e38b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b6420>]}
[0m11:43:47.156507 [debug] [MainThread]: On master: ROLLBACK
[0m11:43:47.157857 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:47.158274 [debug] [MainThread]: On master: BEGIN
[0m11:43:47.160232 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:43:47.160717 [debug] [MainThread]: On master: COMMIT
[0m11:43:47.161116 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:47.161470 [debug] [MainThread]: On master: COMMIT
[0m11:43:47.162616 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:43:47.163010 [debug] [MainThread]: On master: Close
[0m11:43:47.163540 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:43:47.164007 [info ] [MainThread]: 
[0m11:43:47.166428 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m11:43:47.167950 [info ] [Thread-1 (]: 1 of 8 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m11:43:47.169056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m11:43:47.169886 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m11:43:47.181903 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:47.182899 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m11:43:47.228471 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:47.229385 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:47.229807 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m11:43:47.230207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:47.248927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m11:43:47.249547 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:47.250107 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m11:43:47.252802 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:43:47.259807 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:47.260324 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m11:43:47.262086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:47.265365 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:47.265820 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m11:43:47.267953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:47.286295 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m11:43:47.286840 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:47.287257 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m11:43:47.289574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:43:47.296636 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m11:43:47.302841 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m11:43:47.303374 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m11:43:47.307064 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:43:47.309959 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m11:43:47.311610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8354a381-aa3b-4cfe-b35e-be27c8e38b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105051640>]}
[0m11:43:47.312444 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m11:43:47.313252 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m11:43:47.313969 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:43:47.314699 [info ] [Thread-1 (]: 2 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m11:43:47.315284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m11:43:47.315710 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:43:47.318817 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:47.319637 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:43:47.325292 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:47.326194 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:47.326634 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m11:43:47.327082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:47.345064 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:43:47.345774 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:47.346396 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to::TIMESTAMP AS due_time
FROM "postgres"."public"."activity"
  );
[0m11:43:47.350472 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:43:47.353751 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:47.354258 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m11:43:47.355845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:47.359060 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:47.359521 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m11:43:47.361108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:47.362955 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m11:43:47.363488 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:47.363989 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m11:43:47.366215 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:43:47.368873 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m11:43:47.369716 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m11:43:47.370169 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m11:43:47.373785 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:43:47.375410 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m11:43:47.376012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8354a381-aa3b-4cfe-b35e-be27c8e38b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a88080>]}
[0m11:43:47.376713 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m11:43:47.377453 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m11:43:47.377989 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:43:47.379102 [info ] [Thread-1 (]: 3 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m11:43:47.379708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m11:43:47.380144 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:43:47.382970 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:47.383944 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:43:47.388023 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:47.389009 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:47.390602 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m11:43:47.391349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:47.407983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:43:47.408554 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:47.409038 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS activity_is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m11:43:47.413169 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m11:43:47.416782 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:47.417492 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m11:43:47.419183 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:47.422431 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:47.422887 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m11:43:47.424493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:47.426362 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m11:43:47.426905 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:47.427331 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m11:43:47.429226 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:43:47.431820 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m11:43:47.432638 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m11:43:47.433080 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m11:43:47.436774 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:43:47.438488 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m11:43:47.439101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8354a381-aa3b-4cfe-b35e-be27c8e38b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076378c0>]}
[0m11:43:47.439819 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m11:43:47.440596 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m11:43:47.441137 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:43:47.441802 [info ] [Thread-1 (]: 4 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m11:43:47.442418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m11:43:47.442856 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:43:47.445676 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:47.446492 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:43:47.450759 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:47.451742 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:47.452496 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m11:43:47.453965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:47.471949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:43:47.472507 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:47.473039 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- Renaming a id column to standardise
SELECT
    deal_id AS id,
    change_time::TIMESTAMP AS change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m11:43:47.475416 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:43:47.478732 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:47.479209 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m11:43:47.480790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:47.485608 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:47.486229 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m11:43:47.487776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:47.489639 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m11:43:47.490080 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:47.490546 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m11:43:47.492392 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:43:47.495022 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m11:43:47.495862 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m11:43:47.496295 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m11:43:47.499026 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:43:47.500716 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m11:43:47.501353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8354a381-aa3b-4cfe-b35e-be27c8e38b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac0980>]}
[0m11:43:47.502118 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m11:43:47.502869 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m11:43:47.503397 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:43:47.504147 [info ] [Thread-1 (]: 5 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m11:43:47.504742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m11:43:47.505175 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:43:47.507999 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:47.508760 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:43:47.512928 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:47.513976 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:47.515770 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m11:43:47.516577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:47.533658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:43:47.534380 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:47.534873 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m11:43:47.537452 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:43:47.541001 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:47.541499 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m11:43:47.543280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:47.546547 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:47.547043 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m11:43:47.548683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:47.550720 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m11:43:47.551231 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:47.551716 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m11:43:47.553739 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:43:47.556503 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m11:43:47.557426 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m11:43:47.557890 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m11:43:47.560744 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:43:47.562346 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m11:43:47.562971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8354a381-aa3b-4cfe-b35e-be27c8e38b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107634350>]}
[0m11:43:47.563712 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m11:43:47.564486 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m11:43:47.565068 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m11:43:47.565866 [info ] [Thread-1 (]: 6 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m11:43:47.566576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m11:43:47.567081 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m11:43:47.569969 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:47.570730 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m11:43:47.574534 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:47.575336 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:47.575769 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m11:43:47.576166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:47.591870 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:43:47.592462 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:47.592932 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified::TIMESTAMP AS modified_time
FROM "postgres"."public"."users"
  );
[0m11:43:47.595560 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:43:47.599015 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:47.599518 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m11:43:47.602614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:43:47.605939 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:47.606399 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m11:43:47.607993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:47.610071 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m11:43:47.610551 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:47.611055 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m11:43:47.612996 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:43:47.617209 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m11:43:47.618130 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m11:43:47.618581 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m11:43:47.621642 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:43:47.624146 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m11:43:47.624805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8354a381-aa3b-4cfe-b35e-be27c8e38b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107adf650>]}
[0m11:43:47.625549 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m11:43:47.626308 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m11:43:47.626825 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:43:47.627555 [info ] [Thread-1 (]: 7 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m11:43:47.628124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m11:43:47.628555 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:43:47.631245 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:43:47.632020 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:43:47.636092 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:43:47.636925 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:43:47.637365 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m11:43:47.637762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:47.653991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:43:47.654665 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:43:47.655142 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m11:43:47.658418 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:43:47.663288 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:43:47.663817 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m11:43:47.665458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:47.667464 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m11:43:47.667965 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:43:47.668383 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m11:43:47.670199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:43:47.672838 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m11:43:47.673747 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m11:43:47.674303 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m11:43:47.676731 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:43:47.678300 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m11:43:47.678887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8354a381-aa3b-4cfe-b35e-be27c8e38b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a86db0>]}
[0m11:43:47.679751 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.05s]
[0m11:43:47.681089 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m11:43:47.681670 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:43:47.682588 [info ] [Thread-1 (]: 8 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m11:43:47.683706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m11:43:47.684224 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:43:47.687517 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:43:47.688833 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:43:47.693933 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:43:47.694851 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:43:47.695296 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m11:43:47.695683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:47.718620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m11:43:47.719397 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:43:47.719898 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m11:43:47.722747 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:43:47.726181 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:43:47.726644 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m11:43:47.728361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:47.730087 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m11:43:47.730524 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:43:47.730938 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m11:43:47.732991 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:43:47.735575 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m11:43:47.736389 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m11:43:47.736820 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m11:43:47.738465 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:43:47.740053 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m11:43:47.740650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8354a381-aa3b-4cfe-b35e-be27c8e38b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761e300>]}
[0m11:43:47.741519 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.06s]
[0m11:43:47.743157 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m11:43:47.744966 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:47.745439 [debug] [MainThread]: On master: BEGIN
[0m11:43:47.745803 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:47.764270 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m11:43:47.764888 [debug] [MainThread]: On master: COMMIT
[0m11:43:47.765346 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:47.765712 [debug] [MainThread]: On master: COMMIT
[0m11:43:47.767135 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:43:47.767580 [debug] [MainThread]: On master: Close
[0m11:43:47.768077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:47.768422 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_pipedrive__fields_stages' was properly closed.
[0m11:43:47.768888 [info ] [MainThread]: 
[0m11:43:47.769314 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m11:43:47.771563 [debug] [MainThread]: Command end result
[0m11:43:47.808110 [info ] [MainThread]: 
[0m11:43:47.809078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:47.809943 [info ] [MainThread]: 
[0m11:43:47.810432 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m11:43:47.812341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6932724, "process_in_blocks": "0", "process_kernel_time": 0.351647, "process_mem_max_rss": "109473792", "process_out_blocks": "0", "process_user_time": 2.703373}
[0m11:43:47.813185 [debug] [MainThread]: Command `dbt run` succeeded at 11:43:47.813028 after 1.69 seconds
[0m11:43:47.813712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104455100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106606150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b9160>]}
[0m11:43:47.814178 [debug] [MainThread]: Flushing usage events
[0m11:43:54.226746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064cf170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f67020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f66b10>]}


============================== 11:43:54.232257 | b6af21e9-f716-4e72-8a64-ee5213b6bacc ==============================
[0m11:43:54.232257 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:43:54.233512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:43:54.466939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6af21e9-f716-4e72-8a64-ee5213b6bacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4d940>]}
[0m11:43:54.547176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6af21e9-f716-4e72-8a64-ee5213b6bacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106492840>]}
[0m11:43:54.548235 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:43:54.683616 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:43:54.836775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:43:54.837288 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:43:54.896682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6af21e9-f716-4e72-8a64-ee5213b6bacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745d5b0>]}
[0m11:43:55.041601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6af21e9-f716-4e72-8a64-ee5213b6bacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc2360>]}
[0m11:43:55.042330 [info ] [MainThread]: Found 17 data tests, 8 models, 6 sources, 428 macros
[0m11:43:55.043006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6af21e9-f716-4e72-8a64-ee5213b6bacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064cd940>]}
[0m11:43:55.046629 [info ] [MainThread]: 
[0m11:43:55.047365 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:43:55.052803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m11:43:55.121305 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:43:55.121775 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m11:43:55.122143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:55.151703 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m11:43:55.152379 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:43:55.152808 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m11:43:55.156690 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m11:43:55.158471 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m11:43:55.159794 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m11:43:55.166705 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:55.167166 [debug] [MainThread]: On master: BEGIN
[0m11:43:55.167514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:55.184865 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m11:43:55.185462 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:55.186032 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:43:55.190920 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m11:43:55.193035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6af21e9-f716-4e72-8a64-ee5213b6bacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc2a20>]}
[0m11:43:55.193529 [debug] [MainThread]: On master: ROLLBACK
[0m11:43:55.194923 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:55.195355 [debug] [MainThread]: On master: BEGIN
[0m11:43:55.197425 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:43:55.197972 [debug] [MainThread]: On master: COMMIT
[0m11:43:55.198375 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:55.198728 [debug] [MainThread]: On master: COMMIT
[0m11:43:55.200104 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:43:55.200572 [debug] [MainThread]: On master: Close
[0m11:43:55.201115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:43:55.201550 [info ] [MainThread]: 
[0m11:43:55.204231 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:43:55.204818 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m11:43:55.205571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m11:43:55.206194 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:43:55.228984 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:43:55.229861 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:43:55.250045 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:43:55.251176 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:43:55.251652 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m11:43:55.252289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.269575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:43:55.270317 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m11:43:55.270803 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m11:43:55.276098 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m11:43:55.280890 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m11:43:55.282396 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m11:43:55.283725 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.08s]
[0m11:43:55.284614 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m11:43:55.285181 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:43:55.285809 [info ] [Thread-1 (]: 2 of 17 START test assert_change_stage_references_lost_reason_id ............... [RUN]
[0m11:43:55.286469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m11:43:55.287058 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:43:55.290114 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:43:55.290944 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:43:55.293264 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:43:55.294084 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:43:55.294528 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m11:43:55.294933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.311736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:43:55.312443 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m11:43:55.312918 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:43:55.317882 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:43:55.319634 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m11:43:55.321729 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m11:43:55.322778 [info ] [Thread-1 (]: 2 of 17 PASS assert_change_stage_references_lost_reason_id ..................... [[32mPASS[0m in 0.04s]
[0m11:43:55.324441 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m11:43:55.325385 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:43:55.326051 [info ] [Thread-1 (]: 3 of 17 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m11:43:55.326710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m11:43:55.327245 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:43:55.331933 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:43:55.333055 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:43:55.337519 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:43:55.338852 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:43:55.339480 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m11:43:55.340190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.359961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m11:43:55.360820 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m11:43:55.361348 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:43:55.368588 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m11:43:55.370530 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m11:43:55.372181 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m11:43:55.373107 [info ] [Thread-1 (]: 3 of 17 PASS assert_change_stage_references_stage_id ........................... [[32mPASS[0m in 0.05s]
[0m11:43:55.374227 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m11:43:55.374847 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:43:55.375541 [info ] [Thread-1 (]: 4 of 17 START test assert_change_user_references_user_id ....................... [RUN]
[0m11:43:55.376293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m11:43:55.376755 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:43:55.379701 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:43:55.380543 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:43:55.382842 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:43:55.383843 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:43:55.384293 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m11:43:55.384692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.401111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:43:55.401747 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m11:43:55.402273 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m11:43:55.407130 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:43:55.408891 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m11:43:55.410336 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m11:43:55.411565 [info ] [Thread-1 (]: 4 of 17 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.04s]
[0m11:43:55.413384 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m11:43:55.414048 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:43:55.414517 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m11:43:55.415178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m11:43:55.415723 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:43:55.423250 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:43:55.424138 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:43:55.428092 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:43:55.429130 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:43:55.429578 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m11:43:55.429984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.448010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:43:55.448625 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m11:43:55.449088 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m11:43:55.452675 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:43:55.454540 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m11:43:55.455894 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m11:43:55.456674 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.04s]
[0m11:43:55.457505 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m11:43:55.458081 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:43:55.458604 [info ] [Thread-1 (]: 6 of 17 START test not_null_stg_pipedrive__activity_due_time ................... [RUN]
[0m11:43:55.459531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191)
[0m11:43:55.460028 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:43:55.464358 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:43:55.465236 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:43:55.467964 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:43:55.469078 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:43:55.469640 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: BEGIN
[0m11:43:55.470088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.487751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:43:55.488392 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m11:43:55.488887 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_time is null



      
    ) dbt_internal_test
[0m11:43:55.491684 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:43:55.493406 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: ROLLBACK
[0m11:43:55.494665 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: Close
[0m11:43:55.495552 [info ] [Thread-1 (]: 6 of 17 PASS not_null_stg_pipedrive__activity_due_time ......................... [[32mPASS[0m in 0.04s]
[0m11:43:55.496409 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m11:43:55.496957 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:43:55.497538 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m11:43:55.498283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m11:43:55.498746 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:43:55.503677 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:43:55.504618 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:43:55.508805 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:43:55.509709 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:43:55.510143 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m11:43:55.510538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.528450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:43:55.529230 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m11:43:55.529699 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m11:43:55.532047 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:43:55.533924 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m11:43:55.535425 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m11:43:55.536213 [info ] [Thread-1 (]: 7 of 17 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m11:43:55.536992 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m11:43:55.537531 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:43:55.538150 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m11:43:55.538911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m11:43:55.539408 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:43:55.543647 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:43:55.544603 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:43:55.548659 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:43:55.550576 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:43:55.551306 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m11:43:55.551959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.575460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m11:43:55.576414 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m11:43:55.577088 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m11:43:55.580295 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:43:55.582248 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m11:43:55.584296 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m11:43:55.585368 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.05s]
[0m11:43:55.586721 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m11:43:55.587420 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:43:55.588289 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m11:43:55.589002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m11:43:55.589503 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:43:55.596989 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:43:55.598067 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:43:55.600978 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:43:55.601997 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:43:55.602674 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m11:43:55.603299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.639576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m11:43:55.640535 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m11:43:55.641023 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m11:43:55.652128 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m11:43:55.655055 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m11:43:55.656961 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m11:43:55.657939 [info ] [Thread-1 (]: 9 of 17 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.07s]
[0m11:43:55.658810 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m11:43:55.659372 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:43:55.659897 [info ] [Thread-1 (]: 10 of 17 START test not_null_stg_pipedrive__deal_changes_id .................... [RUN]
[0m11:43:55.660589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f)
[0m11:43:55.661194 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:43:55.666075 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:43:55.667133 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:43:55.671496 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:43:55.672642 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:43:55.673159 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: BEGIN
[0m11:43:55.673582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.695113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m11:43:55.695750 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"
[0m11:43:55.696304 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where id is null



      
    ) dbt_internal_test
[0m11:43:55.700878 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:43:55.702868 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: ROLLBACK
[0m11:43:55.704503 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f: Close
[0m11:43:55.705398 [info ] [Thread-1 (]: 10 of 17 PASS not_null_stg_pipedrive__deal_changes_id .......................... [[32mPASS[0m in 0.04s]
[0m11:43:55.706219 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f
[0m11:43:55.706752 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:43:55.707260 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m11:43:55.707919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_id.f7666d095f, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m11:43:55.708466 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:43:55.712934 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:43:55.713805 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:43:55.716337 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:43:55.717233 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:43:55.717674 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m11:43:55.718147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.740300 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m11:43:55.741100 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m11:43:55.741639 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m11:43:55.745133 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:43:55.746940 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m11:43:55.750178 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m11:43:55.751600 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m11:43:55.752675 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m11:43:55.753680 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:43:55.754840 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m11:43:55.755984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m11:43:55.756616 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:43:55.764930 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:43:55.766674 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:43:55.773530 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:43:55.774658 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:43:55.775170 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m11:43:55.775682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.796533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m11:43:55.797341 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m11:43:55.797878 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m11:43:55.801588 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:43:55.804425 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m11:43:55.806169 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m11:43:55.807304 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.05s]
[0m11:43:55.808421 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m11:43:55.809227 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:43:55.810011 [info ] [Thread-1 (]: 13 of 17 START test not_null_stg_pipedrive__users_modified_time ................ [RUN]
[0m11:43:55.810775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5)
[0m11:43:55.811268 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:43:55.815847 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:43:55.817173 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:43:55.819950 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:43:55.820997 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:43:55.821551 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: BEGIN
[0m11:43:55.822191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.839813 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:43:55.840647 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m11:43:55.841150 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_time is null



      
    ) dbt_internal_test
[0m11:43:55.843428 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:43:55.845174 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: ROLLBACK
[0m11:43:55.846494 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: Close
[0m11:43:55.847239 [info ] [Thread-1 (]: 13 of 17 PASS not_null_stg_pipedrive__users_modified_time ...................... [[32mPASS[0m in 0.04s]
[0m11:43:55.848210 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m11:43:55.848757 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:43:55.849645 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m11:43:55.850337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m11:43:55.850803 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:43:55.855693 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:43:55.856533 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:43:55.859053 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:43:55.859938 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:43:55.860393 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m11:43:55.860796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.876978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:43:55.877549 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m11:43:55.878026 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m11:43:55.880360 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:43:55.882087 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m11:43:55.883560 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m11:43:55.884327 [info ] [Thread-1 (]: 14 of 17 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.03s]
[0m11:43:55.885218 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m11:43:55.885725 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:43:55.886246 [info ] [Thread-1 (]: 15 of 17 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m11:43:55.886996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m11:43:55.887471 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:43:55.893489 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:43:55.894394 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:43:55.896861 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:43:55.897677 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:43:55.898174 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m11:43:55.898581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.915995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:43:55.916796 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m11:43:55.917458 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m11:43:55.920130 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m11:43:55.921897 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m11:43:55.923360 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m11:43:55.924097 [info ] [Thread-1 (]: 15 of 17 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m11:43:55.924827 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m11:43:55.925349 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:43:55.925859 [info ] [Thread-1 (]: 16 of 17 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m11:43:55.926568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m11:43:55.927297 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:43:55.938825 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:43:55.939728 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:43:55.942147 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:43:55.942941 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:43:55.943398 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m11:43:55.943811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:55.961679 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m11:43:55.962442 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m11:43:55.963142 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:43:55.967663 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:43:55.969753 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m11:43:55.971309 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m11:43:55.972078 [info ] [Thread-1 (]: 16 of 17 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.05s]
[0m11:43:55.972834 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m11:43:55.973348 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:43:55.973830 [info ] [Thread-1 (]: 17 of 17 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m11:43:55.974386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m11:43:55.974874 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:43:55.980839 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:43:55.981659 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:43:55.984162 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:43:55.985050 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:43:55.985505 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m11:43:55.985916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:56.002554 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m11:43:56.003357 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m11:43:56.003956 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:43:56.008189 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m11:43:56.009940 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m11:43:56.011389 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m11:43:56.012145 [info ] [Thread-1 (]: 17 of 17 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m11:43:56.012902 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m11:43:56.014191 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:56.014622 [debug] [MainThread]: On master: BEGIN
[0m11:43:56.014984 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:56.031987 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m11:43:56.032703 [debug] [MainThread]: On master: COMMIT
[0m11:43:56.033349 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:56.033792 [debug] [MainThread]: On master: COMMIT
[0m11:43:56.035161 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:43:56.035618 [debug] [MainThread]: On master: Close
[0m11:43:56.036183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:56.036606 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m11:43:56.037028 [info ] [MainThread]: 
[0m11:43:56.037443 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m11:43:56.041280 [debug] [MainThread]: Command end result
[0m11:43:56.076436 [info ] [MainThread]: 
[0m11:43:56.076969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:56.077368 [info ] [MainThread]: 
[0m11:43:56.077794 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m11:43:56.080055 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.937987, "process_in_blocks": "0", "process_kernel_time": 0.385285, "process_mem_max_rss": "111857664", "process_out_blocks": "0", "process_user_time": 2.799646}
[0m11:43:56.080838 [debug] [MainThread]: Command `dbt test` succeeded at 11:43:56.080694 after 1.94 seconds
[0m11:43:56.081354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032e6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f67020>]}
[0m11:43:56.081814 [debug] [MainThread]: Flushing usage events
[0m12:08:57.927132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c690d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7f7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7f6e70>]}


============================== 12:08:57.933966 | 2ccbd453-e56c-4915-aed0-46a610bac615 ==============================
[0m12:08:57.933966 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:08:57.934851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:08:58.213631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7f6ff0>]}
[0m12:08:58.280861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c911100>]}
[0m12:08:58.282700 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:08:58.432650 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:08:58.625183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m12:08:58.625950 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/intermediate/int_activity_join_activity_types.sql
[0m12:08:58.626676 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/schema.yml
[0m12:08:58.627118 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_pipedrive__deal_changes.sql
[0m12:08:58.902798 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:08:58.903407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c408f80>]}
[0m12:08:59.142264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d845070>]}
[0m12:08:59.290224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be0d640>]}
[0m12:08:59.290806 [info ] [MainThread]: Found 17 data tests, 9 models, 6 sources, 428 macros
[0m12:08:59.291235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8440b0>]}
[0m12:08:59.294150 [info ] [MainThread]: 
[0m12:08:59.294873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:08:59.300060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:08:59.379128 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:08:59.379816 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:08:59.380446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:59.437092 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.057 seconds
[0m12:08:59.438722 [debug] [ThreadPool]: On list_postgres: Close
[0m12:08:59.440664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m12:08:59.447242 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:08:59.447789 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m12:08:59.448441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:59.464787 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m12:08:59.465387 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:08:59.465867 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m12:08:59.469730 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m12:08:59.471394 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m12:08:59.472615 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m12:08:59.479422 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:59.479860 [debug] [MainThread]: On master: BEGIN
[0m12:08:59.480224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:59.496709 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m12:08:59.497648 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:59.498185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:08:59.503180 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m12:08:59.505270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d845760>]}
[0m12:08:59.505761 [debug] [MainThread]: On master: ROLLBACK
[0m12:08:59.507141 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:59.507576 [debug] [MainThread]: On master: BEGIN
[0m12:08:59.509479 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:08:59.510003 [debug] [MainThread]: On master: COMMIT
[0m12:08:59.510462 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:59.510810 [debug] [MainThread]: On master: COMMIT
[0m12:08:59.512048 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:08:59.512480 [debug] [MainThread]: On master: Close
[0m12:08:59.513033 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:08:59.513480 [info ] [MainThread]: 
[0m12:08:59.516940 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m12:08:59.517603 [info ] [Thread-1 (]: 1 of 8 START sql view model public_pipedrive_analytics.base_pipedrive__fields .. [RUN]
[0m12:08:59.518158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m12:08:59.518589 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m12:08:59.527670 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m12:08:59.529256 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m12:08:59.570460 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m12:08:59.571391 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m12:08:59.571823 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m12:08:59.572220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:59.588627 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m12:08:59.589507 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m12:08:59.590168 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m12:08:59.592911 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:08:59.600023 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m12:08:59.600542 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m12:08:59.602311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:59.605693 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m12:08:59.606301 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m12:08:59.608180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:59.627395 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m12:08:59.627935 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m12:08:59.628351 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m12:08:59.631634 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:08:59.638729 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m12:08:59.646487 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m12:08:59.647305 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m12:08:59.650742 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:08:59.653803 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m12:08:59.656067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a54c0>]}
[0m12:08:59.657018 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m12:08:59.658125 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m12:08:59.658684 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m12:08:59.659382 [info ] [Thread-1 (]: 2 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity . [RUN]
[0m12:08:59.659948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m12:08:59.660402 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m12:08:59.663454 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m12:08:59.664780 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m12:08:59.672984 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m12:08:59.674013 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m12:08:59.674483 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m12:08:59.674902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:59.698526 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m12:08:59.699363 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m12:08:59.699932 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to::TIMESTAMP AS due_time
FROM "postgres"."public"."activity"
  );
[0m12:08:59.702860 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:08:59.706483 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m12:08:59.707004 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m12:08:59.708855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:59.712533 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m12:08:59.713066 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m12:08:59.716468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:08:59.719311 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m12:08:59.719994 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m12:08:59.720588 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m12:08:59.723084 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:59.725875 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m12:08:59.726791 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m12:08:59.727394 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m12:08:59.730044 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:08:59.732217 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m12:08:59.732951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd37650>]}
[0m12:08:59.733720 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.07s]
[0m12:08:59.734639 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m12:08:59.735431 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m12:08:59.736114 [info ] [Thread-1 (]: 3 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m12:08:59.736864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m12:08:59.737536 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m12:08:59.740575 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m12:08:59.742720 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m12:08:59.747250 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m12:08:59.765921 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m12:08:59.767576 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m12:08:59.768850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:59.786132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m12:08:59.786762 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m12:08:59.787310 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS activity_is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m12:08:59.791422 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:08:59.794816 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m12:08:59.795298 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m12:08:59.796939 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:59.800216 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m12:08:59.800691 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m12:08:59.802229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:59.804094 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m12:08:59.804561 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m12:08:59.805076 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m12:08:59.806995 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:08:59.809626 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m12:08:59.810533 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m12:08:59.811026 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m12:08:59.815117 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:08:59.816734 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m12:08:59.817353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc3de20>]}
[0m12:08:59.818033 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.08s]
[0m12:08:59.818761 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m12:08:59.819266 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m12:08:59.820051 [info ] [Thread-1 (]: 4 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m12:08:59.820764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m12:08:59.821216 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m12:08:59.823971 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m12:08:59.824794 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m12:08:59.828700 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m12:08:59.829493 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m12:08:59.829932 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m12:08:59.830338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:59.846096 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m12:08:59.846769 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m12:08:59.847301 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- This is not a source deals table, and deal_id is not a PK (UNIQUE), so leave deal_id named as is
SELECT
    deal_id,
    change_time::TIMESTAMP AS change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m12:08:59.849880 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:08:59.854705 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m12:08:59.855212 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m12:08:59.856771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:59.859934 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m12:08:59.860383 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m12:08:59.862034 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:59.863909 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m12:08:59.864377 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m12:08:59.865028 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m12:08:59.867040 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:59.869792 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m12:08:59.870636 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m12:08:59.871083 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m12:08:59.873405 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:08:59.874977 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m12:08:59.875554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc3f9b0>]}
[0m12:08:59.876221 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.05s]
[0m12:08:59.876932 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m12:08:59.877428 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m12:08:59.878109 [info ] [Thread-1 (]: 5 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__stages ... [RUN]
[0m12:08:59.878704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m12:08:59.879154 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m12:08:59.881952 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m12:08:59.882760 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m12:08:59.887249 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m12:08:59.888365 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m12:08:59.888847 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m12:08:59.889310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:59.905211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m12:08:59.905759 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m12:08:59.906255 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m12:08:59.908740 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:08:59.912042 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m12:08:59.912505 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m12:08:59.914230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:59.917476 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m12:08:59.917927 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m12:08:59.919549 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:59.921472 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m12:08:59.921919 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m12:08:59.922327 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m12:08:59.924425 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:59.927194 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m12:08:59.928062 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m12:08:59.928502 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m12:08:59.930877 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:08:59.932527 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m12:08:59.933114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd92330>]}
[0m12:08:59.933822 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.05s]
[0m12:08:59.934688 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m12:08:59.935222 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m12:08:59.935865 [info ] [Thread-1 (]: 6 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__users .... [RUN]
[0m12:08:59.936441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m12:08:59.936886 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m12:08:59.939788 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m12:08:59.940595 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m12:08:59.944366 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m12:08:59.945202 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m12:08:59.945767 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m12:08:59.946235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:59.963631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m12:08:59.964341 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m12:08:59.964813 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified::TIMESTAMP AS modified_time
FROM "postgres"."public"."users"
  );
[0m12:08:59.967928 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:08:59.971431 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m12:08:59.971927 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m12:08:59.973467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:59.976678 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m12:08:59.977139 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m12:08:59.978622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:59.980509 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m12:08:59.980952 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m12:08:59.981670 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m12:08:59.983540 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:08:59.987533 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m12:08:59.988366 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m12:08:59.988826 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m12:08:59.991511 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:08:59.993086 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m12:08:59.993655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddbf3b0>]}
[0m12:08:59.994419 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m12:08:59.995167 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m12:08:59.995679 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m12:08:59.996360 [info ] [Thread-1 (]: 7 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m12:08:59.996928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m12:08:59.997488 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m12:09:00.000379 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m12:09:00.001211 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m12:09:00.005031 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m12:09:00.005839 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m12:09:00.006290 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m12:09:00.006715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:00.024189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m12:09:00.024910 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m12:09:00.025562 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m12:09:00.029190 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:09:00.032853 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m12:09:00.033339 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m12:09:00.034904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:09:00.036611 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m12:09:00.037048 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m12:09:00.037456 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m12:09:00.039680 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:09:00.042414 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m12:09:00.043327 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m12:09:00.043789 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m12:09:00.045292 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:09:00.046856 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m12:09:00.047518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd04c50>]}
[0m12:09:00.048336 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.05s]
[0m12:09:00.049232 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m12:09:00.049862 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m12:09:00.050582 [info ] [Thread-1 (]: 8 of 8 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m12:09:00.051174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m12:09:00.051631 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m12:09:00.054461 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m12:09:00.055266 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m12:09:00.058985 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m12:09:00.059767 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m12:09:00.060202 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m12:09:00.060612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:00.077761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m12:09:00.078483 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m12:09:00.078986 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m12:09:00.082480 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:09:00.085830 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m12:09:00.086315 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m12:09:00.089115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:09:00.090932 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m12:09:00.091416 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m12:09:00.092066 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m12:09:00.094087 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:09:00.096859 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m12:09:00.097722 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m12:09:00.098240 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m12:09:00.099672 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:09:00.101228 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m12:09:00.101834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ccbd453-e56c-4915-aed0-46a610bac615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc3d550>]}
[0m12:09:00.102664 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.05s]
[0m12:09:00.103417 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m12:09:00.103934 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity_join_activity_types
[0m12:09:00.104730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_stages, now model.enpal_assessment_project.int_activity_join_activity_types)
[0m12:09:00.105197 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity_join_activity_types
[0m12:09:00.108602 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity_join_activity_types"
[0m12:09:00.109883 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity_join_activity_types
[0m12:09:00.111310 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:00.111744 [debug] [MainThread]: On master: BEGIN
[0m12:09:00.112095 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:00.130044 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m12:09:00.130851 [debug] [MainThread]: On master: COMMIT
[0m12:09:00.131578 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:00.131950 [debug] [MainThread]: On master: COMMIT
[0m12:09:00.133416 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:09:00.133869 [debug] [MainThread]: On master: Close
[0m12:09:00.134473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:00.134847 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_activity_join_activity_types' was properly closed.
[0m12:09:00.135371 [info ] [MainThread]: 
[0m12:09:00.135791 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m12:09:00.138074 [debug] [MainThread]: Command end result
[0m12:09:00.234652 [info ] [MainThread]: 
[0m12:09:00.235195 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:00.235685 [info ] [MainThread]: 
[0m12:09:00.236140 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:09:00.238701 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4009523, "process_in_blocks": "0", "process_kernel_time": 0.551418, "process_mem_max_rss": "115367936", "process_out_blocks": "0", "process_user_time": 3.466788}
[0m12:09:00.239505 [debug] [MainThread]: Command `dbt run` succeeded at 12:09:00.239304 after 2.40 seconds
[0m12:09:00.239998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b91f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b91f680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7924b0>]}
[0m12:09:00.240446 [debug] [MainThread]: Flushing usage events
[0m12:09:04.864501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105422f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105903110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105902c30>]}


============================== 12:09:04.869805 | 48714935-4984-456d-b839-025574b780ac ==============================
[0m12:09:04.869805 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:09:04.870500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:09:05.105615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48714935-4984-456d-b839-025574b780ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479da30>]}
[0m12:09:05.172230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48714935-4984-456d-b839-025574b780ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105513ef0>]}
[0m12:09:05.173218 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:09:05.306917 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:09:05.460665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:09:05.461114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:09:05.520931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48714935-4984-456d-b839-025574b780ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef0680>]}
[0m12:09:05.673808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48714935-4984-456d-b839-025574b780ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694e900>]}
[0m12:09:05.674409 [info ] [MainThread]: Found 17 data tests, 9 models, 6 sources, 428 macros
[0m12:09:05.674838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48714935-4984-456d-b839-025574b780ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef0200>]}
[0m12:09:05.678468 [info ] [MainThread]: 
[0m12:09:05.679354 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:09:05.685821 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m12:09:05.745732 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:09:05.746200 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m12:09:05.746565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:05.780340 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m12:09:05.781129 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:09:05.781792 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m12:09:05.787535 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m12:09:05.789859 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m12:09:05.791620 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m12:09:05.801829 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:05.802421 [debug] [MainThread]: On master: BEGIN
[0m12:09:05.802797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:05.822689 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m12:09:05.823287 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:05.823843 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:09:05.828638 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m12:09:05.830743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48714935-4984-456d-b839-025574b780ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e0440>]}
[0m12:09:05.831236 [debug] [MainThread]: On master: ROLLBACK
[0m12:09:05.833036 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:05.833510 [debug] [MainThread]: On master: BEGIN
[0m12:09:05.835539 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:09:05.836116 [debug] [MainThread]: On master: COMMIT
[0m12:09:05.836521 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:05.836872 [debug] [MainThread]: On master: COMMIT
[0m12:09:05.838070 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:09:05.838478 [debug] [MainThread]: On master: Close
[0m12:09:05.839011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:09:05.839506 [info ] [MainThread]: 
[0m12:09:05.842076 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m12:09:05.842653 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m12:09:05.843368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m12:09:05.843821 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m12:09:05.866356 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m12:09:05.867267 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m12:09:05.885849 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m12:09:05.886794 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m12:09:05.887254 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m12:09:05.887663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:05.903716 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m12:09:05.904432 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m12:09:05.904918 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m12:09:05.909545 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:09:05.914893 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m12:09:05.916451 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m12:09:05.917257 [info ] [Thread-1 (]: 1 of 17 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.07s]
[0m12:09:05.918068 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m12:09:05.918627 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m12:09:05.919244 [info ] [Thread-1 (]: 2 of 17 START test assert_change_stage_references_lost_reason_id ............... [RUN]
[0m12:09:05.919873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m12:09:05.920348 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m12:09:05.925279 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m12:09:05.926815 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m12:09:05.931406 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m12:09:05.934610 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m12:09:05.935306 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m12:09:05.935769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:05.957378 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m12:09:05.958238 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m12:09:05.958777 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m12:09:05.964635 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:09:05.967113 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m12:09:05.968880 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m12:09:05.969865 [info ] [Thread-1 (]: 2 of 17 PASS assert_change_stage_references_lost_reason_id ..................... [[32mPASS[0m in 0.05s]
[0m12:09:05.971435 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m12:09:05.972162 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m12:09:05.972797 [info ] [Thread-1 (]: 3 of 17 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m12:09:05.973640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m12:09:05.974388 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m12:09:05.982413 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m12:09:05.983498 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m12:09:05.986068 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m12:09:05.986985 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m12:09:05.987483 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m12:09:05.987899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.032423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m12:09:06.033229 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m12:09:06.033760 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m12:09:06.040659 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:09:06.042394 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m12:09:06.043832 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m12:09:06.044572 [info ] [Thread-1 (]: 3 of 17 PASS assert_change_stage_references_stage_id ........................... [[32mPASS[0m in 0.07s]
[0m12:09:06.045343 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m12:09:06.045883 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m12:09:06.046338 [info ] [Thread-1 (]: 4 of 17 START test assert_change_user_references_user_id ....................... [RUN]
[0m12:09:06.046979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m12:09:06.047543 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m12:09:06.050605 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m12:09:06.051621 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m12:09:06.054382 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m12:09:06.055309 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m12:09:06.056970 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m12:09:06.057637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.076089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m12:09:06.076684 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m12:09:06.077164 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m12:09:06.082487 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:09:06.084254 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m12:09:06.085765 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m12:09:06.086578 [info ] [Thread-1 (]: 4 of 17 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.04s]
[0m12:09:06.087425 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m12:09:06.087986 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m12:09:06.088525 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m12:09:06.089213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m12:09:06.089700 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m12:09:06.096920 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m12:09:06.097788 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m12:09:06.100538 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m12:09:06.101410 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m12:09:06.101849 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m12:09:06.102257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.121545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m12:09:06.122359 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m12:09:06.122904 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m12:09:06.125419 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:09:06.127135 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m12:09:06.128445 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m12:09:06.129230 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.04s]
[0m12:09:06.130198 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m12:09:06.130941 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m12:09:06.132011 [info ] [Thread-1 (]: 6 of 17 START test not_null_stg_pipedrive__activity_due_time ................... [RUN]
[0m12:09:06.133243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191)
[0m12:09:06.133922 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m12:09:06.138741 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m12:09:06.139679 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m12:09:06.142164 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m12:09:06.142959 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m12:09:06.143386 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: BEGIN
[0m12:09:06.143786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.162790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m12:09:06.163542 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m12:09:06.164063 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_time is null



      
    ) dbt_internal_test
[0m12:09:06.166892 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:09:06.168683 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: ROLLBACK
[0m12:09:06.171060 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: Close
[0m12:09:06.172860 [info ] [Thread-1 (]: 6 of 17 PASS not_null_stg_pipedrive__activity_due_time ......................... [[32mPASS[0m in 0.04s]
[0m12:09:06.174049 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m12:09:06.174666 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m12:09:06.175181 [info ] [Thread-1 (]: 7 of 17 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m12:09:06.175814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m12:09:06.176324 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m12:09:06.180650 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m12:09:06.181718 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m12:09:06.184275 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m12:09:06.185364 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m12:09:06.185892 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m12:09:06.186314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.212598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m12:09:06.213400 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m12:09:06.213910 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m12:09:06.216779 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:09:06.218761 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m12:09:06.220859 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m12:09:06.222284 [info ] [Thread-1 (]: 7 of 17 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.05s]
[0m12:09:06.223154 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m12:09:06.223767 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m12:09:06.224283 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m12:09:06.224987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m12:09:06.225523 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m12:09:06.229834 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m12:09:06.230885 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m12:09:06.233766 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m12:09:06.234783 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m12:09:06.235262 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m12:09:06.235681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.260202 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m12:09:06.260818 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m12:09:06.261338 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m12:09:06.264323 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:09:06.266331 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m12:09:06.267988 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m12:09:06.269074 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m12:09:06.270443 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m12:09:06.271378 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m12:09:06.271924 [info ] [Thread-1 (]: 9 of 17 START test not_null_stg_pipedrive__deal_changes_change_time ............ [RUN]
[0m12:09:06.272739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m12:09:06.273222 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m12:09:06.279575 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m12:09:06.280459 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m12:09:06.283635 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m12:09:06.284597 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m12:09:06.285358 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m12:09:06.285828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.308064 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m12:09:06.308727 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m12:09:06.309236 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m12:09:06.312432 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:09:06.314370 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m12:09:06.316262 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m12:09:06.317099 [info ] [Thread-1 (]: 9 of 17 PASS not_null_stg_pipedrive__deal_changes_change_time .................. [[32mPASS[0m in 0.04s]
[0m12:09:06.317902 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m12:09:06.318795 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m12:09:06.319482 [info ] [Thread-1 (]: 10 of 17 START test not_null_stg_pipedrive__deal_changes_deal_id ............... [RUN]
[0m12:09:06.320228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d)
[0m12:09:06.320827 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m12:09:06.325749 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m12:09:06.326898 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m12:09:06.329526 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m12:09:06.330442 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m12:09:06.330906 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: BEGIN
[0m12:09:06.331530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.354671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m12:09:06.355639 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m12:09:06.356170 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where deal_id is null



      
    ) dbt_internal_test
[0m12:09:06.359676 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:09:06.361828 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: ROLLBACK
[0m12:09:06.363440 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: Close
[0m12:09:06.364269 [info ] [Thread-1 (]: 10 of 17 PASS not_null_stg_pipedrive__deal_changes_deal_id ..................... [[32mPASS[0m in 0.04s]
[0m12:09:06.365563 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m12:09:06.366153 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m12:09:06.366627 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m12:09:06.367483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m12:09:06.367982 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m12:09:06.372925 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m12:09:06.373876 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m12:09:06.376356 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m12:09:06.377232 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m12:09:06.377770 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m12:09:06.378208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.399832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m12:09:06.400501 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m12:09:06.401014 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m12:09:06.404589 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:09:06.406343 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m12:09:06.407857 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m12:09:06.408747 [info ] [Thread-1 (]: 11 of 17 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m12:09:06.409597 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m12:09:06.410121 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m12:09:06.410574 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m12:09:06.411254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m12:09:06.411770 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m12:09:06.416540 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m12:09:06.417420 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m12:09:06.419966 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m12:09:06.420788 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m12:09:06.421236 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m12:09:06.421640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.441281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m12:09:06.442094 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m12:09:06.442657 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m12:09:06.444984 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:09:06.446713 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m12:09:06.448249 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m12:09:06.448999 [info ] [Thread-1 (]: 12 of 17 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m12:09:06.449738 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m12:09:06.450323 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m12:09:06.451062 [info ] [Thread-1 (]: 13 of 17 START test not_null_stg_pipedrive__users_modified_time ................ [RUN]
[0m12:09:06.451968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5)
[0m12:09:06.452453 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m12:09:06.457051 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m12:09:06.458342 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m12:09:06.461878 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m12:09:06.462881 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m12:09:06.463361 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: BEGIN
[0m12:09:06.463779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.482135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m12:09:06.482809 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m12:09:06.483282 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_time is null



      
    ) dbt_internal_test
[0m12:09:06.485751 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:09:06.487489 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: ROLLBACK
[0m12:09:06.488927 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: Close
[0m12:09:06.489674 [info ] [Thread-1 (]: 13 of 17 PASS not_null_stg_pipedrive__users_modified_time ...................... [[32mPASS[0m in 0.04s]
[0m12:09:06.490493 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m12:09:06.491010 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m12:09:06.491544 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m12:09:06.492161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m12:09:06.492700 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m12:09:06.497015 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m12:09:06.497841 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m12:09:06.500336 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m12:09:06.501178 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m12:09:06.501629 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m12:09:06.502038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.521933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m12:09:06.522774 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m12:09:06.523238 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m12:09:06.525596 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:09:06.527392 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m12:09:06.529943 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m12:09:06.530906 [info ] [Thread-1 (]: 14 of 17 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m12:09:06.532105 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m12:09:06.532778 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m12:09:06.533536 [info ] [Thread-1 (]: 15 of 17 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m12:09:06.534205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m12:09:06.534711 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m12:09:06.542039 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m12:09:06.542911 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m12:09:06.545336 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m12:09:06.546125 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m12:09:06.546559 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m12:09:06.546962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.564446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m12:09:06.565482 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m12:09:06.565982 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m12:09:06.568787 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:09:06.570604 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m12:09:06.572247 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m12:09:06.573278 [info ] [Thread-1 (]: 15 of 17 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m12:09:06.574468 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m12:09:06.575019 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m12:09:06.575854 [info ] [Thread-1 (]: 16 of 17 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m12:09:06.576575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m12:09:06.577090 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m12:09:06.586653 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m12:09:06.587597 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m12:09:06.590183 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m12:09:06.591028 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m12:09:06.591555 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m12:09:06.592073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.610299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m12:09:06.610931 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m12:09:06.611453 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:09:06.616957 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:09:06.618810 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m12:09:06.620318 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m12:09:06.621137 [info ] [Thread-1 (]: 16 of 17 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m12:09:06.622022 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m12:09:06.622579 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m12:09:06.623114 [info ] [Thread-1 (]: 17 of 17 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m12:09:06.623895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m12:09:06.624389 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m12:09:06.630717 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m12:09:06.631847 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m12:09:06.634320 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m12:09:06.635481 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m12:09:06.636145 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m12:09:06.636760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.655170 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m12:09:06.656009 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m12:09:06.656518 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:09:06.660290 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:09:06.662008 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m12:09:06.663701 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m12:09:06.664583 [info ] [Thread-1 (]: 17 of 17 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m12:09:06.666052 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m12:09:06.667671 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:06.668113 [debug] [MainThread]: On master: BEGIN
[0m12:09:06.668590 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:06.685655 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m12:09:06.686331 [debug] [MainThread]: On master: COMMIT
[0m12:09:06.686786 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:06.687145 [debug] [MainThread]: On master: COMMIT
[0m12:09:06.688521 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:09:06.689004 [debug] [MainThread]: On master: Close
[0m12:09:06.689531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:06.689932 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m12:09:06.690372 [info ] [MainThread]: 
[0m12:09:06.690804 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m12:09:06.694723 [debug] [MainThread]: Command end result
[0m12:09:06.731589 [info ] [MainThread]: 
[0m12:09:06.732169 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:06.732678 [info ] [MainThread]: 
[0m12:09:06.733113 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m12:09:06.734932 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9538121, "process_in_blocks": "0", "process_kernel_time": 0.375839, "process_mem_max_rss": "111718400", "process_out_blocks": "0", "process_user_time": 2.791779}
[0m12:09:06.735702 [debug] [MainThread]: Command `dbt test` succeeded at 12:09:06.735562 after 1.95 seconds
[0m12:09:06.736192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101c1ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e77290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106936a50>]}
[0m12:09:06.736715 [debug] [MainThread]: Flushing usage events
[0m12:45:26.428681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fdb5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f17170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f16c90>]}


============================== 12:45:26.436912 | 91878217-305c-43f2-ac07-c1e58a4937de ==============================
[0m12:45:26.436912 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:45:26.437898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:26.748663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91878217-305c-43f2-ac07-c1e58a4937de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10502a150>]}
[0m12:45:26.814873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91878217-305c-43f2-ac07-c1e58a4937de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e02ae0>]}
[0m12:45:26.816997 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:45:26.966371 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:45:27.184446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:45:27.185281 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://tests/assert_timestamp_equal_add_time_new_value.sql
[0m12:45:27.185796 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/intermediate/int_deal_changes_filter_new_deals.sql
[0m12:45:27.693388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91878217-305c-43f2-ac07-c1e58a4937de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4b4d0>]}
[0m12:45:27.883741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91878217-305c-43f2-ac07-c1e58a4937de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106140a40>]}
[0m12:45:27.885557 [info ] [MainThread]: Found 18 data tests, 10 models, 6 sources, 428 macros
[0m12:45:27.886082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91878217-305c-43f2-ac07-c1e58a4937de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df6900>]}
[0m12:45:27.889442 [info ] [MainThread]: 
[0m12:45:27.890178 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:45:27.894811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m12:45:27.974982 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:45:27.975479 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m12:45:27.975870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:28.034081 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m12:45:28.034784 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:45:28.035277 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m12:45:28.039450 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m12:45:28.041289 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m12:45:28.042507 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m12:45:28.049712 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:28.050160 [debug] [MainThread]: On master: BEGIN
[0m12:45:28.050500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:28.066887 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m12:45:28.067482 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:28.067973 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:45:28.072705 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m12:45:28.074995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91878217-305c-43f2-ac07-c1e58a4937de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f8530>]}
[0m12:45:28.075810 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:28.077655 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:28.078143 [debug] [MainThread]: On master: BEGIN
[0m12:45:28.080153 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:45:28.080674 [debug] [MainThread]: On master: COMMIT
[0m12:45:28.081193 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:28.081569 [debug] [MainThread]: On master: COMMIT
[0m12:45:28.082761 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:45:28.083166 [debug] [MainThread]: On master: Close
[0m12:45:28.083769 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:28.084305 [info ] [MainThread]: 
[0m12:45:28.087786 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m12:45:28.088510 [info ] [Thread-1 (]: 1 of 18 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m12:45:28.089067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m12:45:28.089512 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m12:45:28.114978 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m12:45:28.117199 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m12:45:28.137276 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m12:45:28.138205 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m12:45:28.138647 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m12:45:28.139048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.156006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m12:45:28.156683 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m12:45:28.157178 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m12:45:28.162545 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:45:28.167909 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m12:45:28.169836 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m12:45:28.170669 [info ] [Thread-1 (]: 1 of 18 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.08s]
[0m12:45:28.171562 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m12:45:28.172119 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m12:45:28.172683 [info ] [Thread-1 (]: 2 of 18 START test assert_change_stage_references_lost_reason_id ............... [RUN]
[0m12:45:28.173409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m12:45:28.173888 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m12:45:28.177039 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m12:45:28.178670 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m12:45:28.181917 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m12:45:28.183587 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m12:45:28.184077 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m12:45:28.184597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.200726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m12:45:28.201378 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m12:45:28.201875 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m12:45:28.206377 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:45:28.208129 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m12:45:28.209645 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m12:45:28.210582 [info ] [Thread-1 (]: 2 of 18 PASS assert_change_stage_references_lost_reason_id ..................... [[32mPASS[0m in 0.04s]
[0m12:45:28.211608 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m12:45:28.212212 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m12:45:28.212738 [info ] [Thread-1 (]: 3 of 18 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m12:45:28.213342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m12:45:28.213798 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m12:45:28.216669 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m12:45:28.217929 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m12:45:28.220862 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m12:45:28.221795 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m12:45:28.222249 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m12:45:28.222896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.244072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m12:45:28.245193 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m12:45:28.246793 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m12:45:28.254081 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:45:28.255842 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m12:45:28.257366 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m12:45:28.258116 [info ] [Thread-1 (]: 3 of 18 PASS assert_change_stage_references_stage_id ........................... [[32mPASS[0m in 0.04s]
[0m12:45:28.258838 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m12:45:28.259338 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m12:45:28.259920 [info ] [Thread-1 (]: 4 of 18 START test assert_change_user_references_user_id ....................... [RUN]
[0m12:45:28.260637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m12:45:28.261141 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m12:45:28.265295 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m12:45:28.266159 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m12:45:28.268711 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m12:45:28.269569 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m12:45:28.269999 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m12:45:28.270394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.290371 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m12:45:28.290962 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m12:45:28.291440 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m12:45:28.298944 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:45:28.300823 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m12:45:28.302128 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m12:45:28.302857 [info ] [Thread-1 (]: 4 of 18 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.04s]
[0m12:45:28.303610 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m12:45:28.304129 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m12:45:28.304613 [info ] [Thread-1 (]: 5 of 18 START test assert_timestamp_equal_add_time_new_value ................... [RUN]
[0m12:45:28.305184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value)
[0m12:45:28.305652 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m12:45:28.307588 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m12:45:28.308390 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m12:45:28.310832 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m12:45:28.311867 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m12:45:28.312362 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: BEGIN
[0m12:45:28.312763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.332324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m12:45:28.332948 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m12:45:28.333443 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Assert that the change_time is equal to the new_value when the changed_field_key is 'add_time'
-- With this test, it's OK to ignore the new_value field for add_time changes
SELECT * FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'add_time'
	AND change_time != new_value::TIMESTAMP
      
    ) dbt_internal_test
[0m12:45:28.338553 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:45:28.340268 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: ROLLBACK
[0m12:45:28.341701 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: Close
[0m12:45:28.342495 [info ] [Thread-1 (]: 5 of 18 PASS assert_timestamp_equal_add_time_new_value ......................... [[32mPASS[0m in 0.04s]
[0m12:45:28.343500 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m12:45:28.344099 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m12:45:28.345482 [info ] [Thread-1 (]: 6 of 18 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m12:45:28.347807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m12:45:28.348502 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m12:45:28.355850 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m12:45:28.357469 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m12:45:28.360169 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m12:45:28.362387 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m12:45:28.363336 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m12:45:28.363805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.386059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m12:45:28.386761 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m12:45:28.387280 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m12:45:28.390308 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:45:28.392473 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m12:45:28.394895 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m12:45:28.396545 [info ] [Thread-1 (]: 6 of 18 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.05s]
[0m12:45:28.397693 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m12:45:28.398290 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m12:45:28.398846 [info ] [Thread-1 (]: 7 of 18 START test not_null_stg_pipedrive__activity_due_time ................... [RUN]
[0m12:45:28.399775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191)
[0m12:45:28.400318 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m12:45:28.406251 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m12:45:28.407600 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m12:45:28.411365 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m12:45:28.412947 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m12:45:28.413517 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: BEGIN
[0m12:45:28.413949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.433748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m12:45:28.434459 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m12:45:28.434920 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_time is null



      
    ) dbt_internal_test
[0m12:45:28.437349 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:45:28.439165 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: ROLLBACK
[0m12:45:28.440631 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: Close
[0m12:45:28.441387 [info ] [Thread-1 (]: 7 of 18 PASS not_null_stg_pipedrive__activity_due_time ......................... [[32mPASS[0m in 0.04s]
[0m12:45:28.442156 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m12:45:28.442684 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m12:45:28.443281 [info ] [Thread-1 (]: 8 of 18 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m12:45:28.444013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m12:45:28.444488 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m12:45:28.449217 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m12:45:28.450083 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m12:45:28.452544 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m12:45:28.453779 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m12:45:28.454229 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m12:45:28.454647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.474527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m12:45:28.475202 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m12:45:28.475685 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m12:45:28.478823 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:45:28.481413 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m12:45:28.483915 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m12:45:28.484723 [info ] [Thread-1 (]: 8 of 18 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m12:45:28.485525 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m12:45:28.486075 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m12:45:28.486587 [info ] [Thread-1 (]: 9 of 18 START test not_null_stg_pipedrive__activity_is_done .................... [RUN]
[0m12:45:28.487294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m12:45:28.487794 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m12:45:28.492786 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m12:45:28.496177 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m12:45:28.501279 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m12:45:28.502378 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m12:45:28.503034 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m12:45:28.503462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.521753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m12:45:28.522316 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m12:45:28.522764 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m12:45:28.525302 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:45:28.527148 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m12:45:28.529913 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m12:45:28.531182 [info ] [Thread-1 (]: 9 of 18 PASS not_null_stg_pipedrive__activity_is_done .......................... [[32mPASS[0m in 0.04s]
[0m12:45:28.532424 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m12:45:28.533427 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m12:45:28.534259 [info ] [Thread-1 (]: 10 of 18 START test not_null_stg_pipedrive__deal_changes_change_time ........... [RUN]
[0m12:45:28.535212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m12:45:28.536016 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m12:45:28.543194 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m12:45:28.544524 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m12:45:28.547407 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m12:45:28.548336 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m12:45:28.548780 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m12:45:28.549174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.567657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m12:45:28.568473 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m12:45:28.569026 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m12:45:28.572220 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:45:28.573976 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m12:45:28.575523 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m12:45:28.576244 [info ] [Thread-1 (]: 10 of 18 PASS not_null_stg_pipedrive__deal_changes_change_time ................. [[32mPASS[0m in 0.04s]
[0m12:45:28.577292 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m12:45:28.577840 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m12:45:28.578532 [info ] [Thread-1 (]: 11 of 18 START test not_null_stg_pipedrive__deal_changes_deal_id ............... [RUN]
[0m12:45:28.579327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d)
[0m12:45:28.579800 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m12:45:28.584045 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m12:45:28.585255 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m12:45:28.587930 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m12:45:28.588803 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m12:45:28.589251 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: BEGIN
[0m12:45:28.589647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.609873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m12:45:28.610836 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m12:45:28.611487 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where deal_id is null



      
    ) dbt_internal_test
[0m12:45:28.616610 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:45:28.618498 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: ROLLBACK
[0m12:45:28.620072 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: Close
[0m12:45:28.620901 [info ] [Thread-1 (]: 11 of 18 PASS not_null_stg_pipedrive__deal_changes_deal_id ..................... [[32mPASS[0m in 0.04s]
[0m12:45:28.621668 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m12:45:28.622200 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m12:45:28.622654 [info ] [Thread-1 (]: 12 of 18 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m12:45:28.623234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m12:45:28.623835 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m12:45:28.630892 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m12:45:28.631940 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m12:45:28.634584 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m12:45:28.635450 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m12:45:28.635882 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m12:45:28.636280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.654328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m12:45:28.655041 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m12:45:28.655605 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m12:45:28.659174 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:45:28.661279 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m12:45:28.663629 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m12:45:28.664428 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m12:45:28.665391 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m12:45:28.665971 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m12:45:28.666429 [info ] [Thread-1 (]: 13 of 18 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m12:45:28.667196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m12:45:28.667723 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m12:45:28.673973 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m12:45:28.675355 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m12:45:28.679394 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m12:45:28.680353 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m12:45:28.680795 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m12:45:28.681190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.701554 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m12:45:28.702194 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m12:45:28.702715 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m12:45:28.704990 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:45:28.706730 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m12:45:28.708191 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m12:45:28.708972 [info ] [Thread-1 (]: 13 of 18 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m12:45:28.709937 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m12:45:28.710579 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m12:45:28.711224 [info ] [Thread-1 (]: 14 of 18 START test not_null_stg_pipedrive__users_modified_time ................ [RUN]
[0m12:45:28.711828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5)
[0m12:45:28.712398 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m12:45:28.716819 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m12:45:28.717664 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m12:45:28.720401 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m12:45:28.721264 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m12:45:28.721721 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: BEGIN
[0m12:45:28.722125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.739944 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m12:45:28.740533 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m12:45:28.741112 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_time is null



      
    ) dbt_internal_test
[0m12:45:28.743489 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:45:28.745467 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: ROLLBACK
[0m12:45:28.746891 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: Close
[0m12:45:28.747690 [info ] [Thread-1 (]: 14 of 18 PASS not_null_stg_pipedrive__users_modified_time ...................... [[32mPASS[0m in 0.04s]
[0m12:45:28.748543 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m12:45:28.749061 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m12:45:28.749561 [info ] [Thread-1 (]: 15 of 18 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m12:45:28.750152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m12:45:28.750622 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m12:45:28.755227 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m12:45:28.756096 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m12:45:28.760142 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m12:45:28.761569 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m12:45:28.762281 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m12:45:28.762916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.780684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m12:45:28.781362 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m12:45:28.781857 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m12:45:28.784169 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:45:28.785886 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m12:45:28.787238 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m12:45:28.787950 [info ] [Thread-1 (]: 15 of 18 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m12:45:28.788778 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m12:45:28.789300 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m12:45:28.789800 [info ] [Thread-1 (]: 16 of 18 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m12:45:28.790552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m12:45:28.791039 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m12:45:28.796026 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m12:45:28.796894 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m12:45:28.799491 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m12:45:28.800399 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m12:45:28.800854 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m12:45:28.801283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.817913 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m12:45:28.818657 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m12:45:28.819132 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m12:45:28.821798 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:45:28.823536 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m12:45:28.824901 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m12:45:28.825635 [info ] [Thread-1 (]: 16 of 18 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m12:45:28.826366 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m12:45:28.826889 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m12:45:28.827435 [info ] [Thread-1 (]: 17 of 18 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m12:45:28.828489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m12:45:28.829079 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m12:45:28.838238 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m12:45:28.839099 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m12:45:28.841472 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m12:45:28.842282 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m12:45:28.842739 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m12:45:28.843333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.860777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m12:45:28.861756 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m12:45:28.862410 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:28.866584 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:45:28.868494 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m12:45:28.870044 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m12:45:28.870806 [info ] [Thread-1 (]: 17 of 18 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m12:45:28.871572 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m12:45:28.872111 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m12:45:28.872575 [info ] [Thread-1 (]: 18 of 18 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m12:45:28.873120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m12:45:28.873819 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m12:45:28.880468 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m12:45:28.881276 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m12:45:28.883638 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m12:45:28.884450 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m12:45:28.884909 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m12:45:28.885328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:28.903555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m12:45:28.904336 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m12:45:28.904890 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:28.909815 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:45:28.911631 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m12:45:28.913221 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m12:45:28.914061 [info ] [Thread-1 (]: 18 of 18 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m12:45:28.914875 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m12:45:28.916358 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:28.916899 [debug] [MainThread]: On master: BEGIN
[0m12:45:28.917342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:45:28.934568 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m12:45:28.935305 [debug] [MainThread]: On master: COMMIT
[0m12:45:28.935818 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:28.936215 [debug] [MainThread]: On master: COMMIT
[0m12:45:28.937709 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:45:28.938156 [debug] [MainThread]: On master: Close
[0m12:45:28.938742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:28.939208 [debug] [MainThread]: Connection 'test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d' was properly closed.
[0m12:45:28.939651 [info ] [MainThread]: 
[0m12:45:28.940102 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m12:45:28.944510 [debug] [MainThread]: Command end result
[0m12:45:29.025260 [info ] [MainThread]: 
[0m12:45:29.025835 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:29.026250 [info ] [MainThread]: 
[0m12:45:29.026679 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m12:45:29.029034 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.6964586, "process_in_blocks": "0", "process_kernel_time": 0.637091, "process_mem_max_rss": "116785152", "process_out_blocks": "0", "process_user_time": 3.542001}
[0m12:45:29.029799 [debug] [MainThread]: Command `dbt test` succeeded at 12:45:29.029655 after 2.70 seconds
[0m12:45:29.030339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101222d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f170e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f16f90>]}
[0m12:45:29.030877 [debug] [MainThread]: Flushing usage events
[0m13:15:56.516282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe6c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119a74a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119a6ff0>]}


============================== 13:15:56.523813 | de296a20-04ef-4ba9-9c1f-51171e3d29c2 ==============================
[0m13:15:56.523813 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:15:56.524718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:15:56.813257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111422a20>]}
[0m13:15:56.880215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fb24e0>]}
[0m13:15:56.882065 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:15:57.074133 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:15:57.276832 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 0 files changed.
[0m13:15:57.277640 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/intermediate/schema.yml
[0m13:15:57.278092 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/intermediate/int_activity_join_activity_types.sql
[0m13:15:57.278515 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/intermediate/int_deal_changes_dedupe_new_deals.sql
[0m13:15:57.278890 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/staging/intermediate/int_activity_join_activity_types.sql
[0m13:15:57.279252 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/staging/intermediate/int_deal_changes_filter_new_deals.sql
[0m13:15:57.551419 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:15:57.552249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112845a60>]}
[0m13:15:57.781693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11285a5d0>]}
[0m13:15:57.962527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111efb680>]}
[0m13:15:57.963166 [info ] [MainThread]: Found 19 data tests, 10 models, 6 sources, 428 macros
[0m13:15:57.967906 [info ] [MainThread]: 
[0m13:15:57.968838 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:15:57.976049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:15:58.056476 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:15:58.056984 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:15:58.057381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:58.127272 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.070 seconds
[0m13:15:58.129034 [debug] [ThreadPool]: On list_postgres: Close
[0m13:15:58.131247 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:15:58.137628 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:15:58.138094 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m13:15:58.138441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:58.154720 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m13:15:58.155345 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:15:58.155890 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:15:58.160059 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m13:15:58.161754 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:15:58.163055 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:15:58.170000 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:58.170459 [debug] [MainThread]: On master: BEGIN
[0m13:15:58.170827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:15:58.186809 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m13:15:58.187394 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:58.187893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:15:58.192996 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m13:15:58.195170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130175f0>]}
[0m13:15:58.195679 [debug] [MainThread]: On master: ROLLBACK
[0m13:15:58.197093 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:58.197533 [debug] [MainThread]: On master: BEGIN
[0m13:15:58.199774 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:15:58.200396 [debug] [MainThread]: On master: COMMIT
[0m13:15:58.200810 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:58.201161 [debug] [MainThread]: On master: COMMIT
[0m13:15:58.202499 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:15:58.202952 [debug] [MainThread]: On master: Close
[0m13:15:58.203589 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:15:58.204074 [info ] [MainThread]: 
[0m13:15:58.207567 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m13:15:58.208260 [info ] [Thread-1 (]: 1 of 28 START sql view model public_pipedrive_analytics.base_pipedrive__fields . [RUN]
[0m13:15:58.208833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m13:15:58.209272 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m13:15:58.218129 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:15:58.219765 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m13:15:58.261806 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:15:58.262719 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:15:58.263152 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m13:15:58.263559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:58.282253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:15:58.283776 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:15:58.284370 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m13:15:58.287323 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:15:58.294530 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:15:58.295057 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m13:15:58.297437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:15:58.301228 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:15:58.301760 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m13:15:58.303474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:58.323190 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m13:15:58.323735 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:15:58.324161 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m13:15:58.327706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:15:58.336750 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m13:15:58.343785 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:15:58.344309 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m13:15:58.348326 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:15:58.351209 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m13:15:58.352865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f59eb0>]}
[0m13:15:58.353646 [info ] [Thread-1 (]: 1 of 28 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m13:15:58.354491 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m13:15:58.355098 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:15:58.355834 [info ] [Thread-1 (]: 2 of 28 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_new_deals  [RUN]
[0m13:15:58.356530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.int_deal_changes_dedupe_new_deals)
[0m13:15:58.357181 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:15:58.359505 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:15:58.361158 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:15:58.365884 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:15:58.368008 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:15:58.368686 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: BEGIN
[0m13:15:58.369268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:58.385080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:15:58.385720 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:15:58.386214 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_tmp"
    
    
  as (
    -- Separate new deals model from the deal_changes model
-- There are a handful of dupe deals in the deal_changes model (assumption - deals should not have more than one added date)
-- Materialize as a view so it can be tested for deduplication
SELECT
	deal_id, 
	MAX(change_time)
FROM deal_changes
WHERE changed_field_key = 'add_time'
GROUP BY deal_id
  );
[0m13:15:58.389787 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:15:58.393215 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:15:58.393702 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_tmp" rename to "int_deal_changes_dedupe_new_deals"
[0m13:15:58.395338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:58.397141 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: COMMIT
[0m13:15:58.397598 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:15:58.398031 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: COMMIT
[0m13:15:58.401220 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:15:58.404472 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_backup"
[0m13:15:58.405626 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:15:58.406229 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
drop view if exists "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_backup" cascade
[0m13:15:58.408005 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:15:58.409735 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: Close
[0m13:15:58.410375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113006720>]}
[0m13:15:58.411149 [info ] [Thread-1 (]: 2 of 28 OK created sql view model public_pipedrive_analytics.int_deal_changes_dedupe_new_deals  [[32mCREATE VIEW[0m in 0.05s]
[0m13:15:58.411942 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:15:58.412471 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:15:58.413185 [info ] [Thread-1 (]: 3 of 28 START sql view model public_pipedrive_analytics.stg_pipedrive__activity  [RUN]
[0m13:15:58.413875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_new_deals, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m13:15:58.414316 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:15:58.417288 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:15:58.418571 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:15:58.422659 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:15:58.425360 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:15:58.425947 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m13:15:58.426364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:58.442319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:15:58.443003 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:15:58.443501 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to::TIMESTAMP AS due_time
FROM "postgres"."public"."activity"
  );
[0m13:15:58.446029 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:15:58.449377 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:15:58.449863 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m13:15:58.451628 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:58.454934 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:15:58.455375 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m13:15:58.457023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:58.459235 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:15:58.459720 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:15:58.460132 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:15:58.462152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:15:58.464897 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m13:15:58.465766 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:15:58.466656 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m13:15:58.469544 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:15:58.471297 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m13:15:58.471930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130aef90>]}
[0m13:15:58.472817 [info ] [Thread-1 (]: 3 of 28 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m13:15:58.473732 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:15:58.474391 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:15:58.475260 [info ] [Thread-1 (]: 4 of 28 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m13:15:58.475961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m13:15:58.476407 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:15:58.479129 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:15:58.480377 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:15:58.487960 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:15:58.489313 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:15:58.489793 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m13:15:58.490269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:58.506706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:15:58.507653 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:15:58.508170 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS activity_is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m13:15:58.511687 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:15:58.515195 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:15:58.515709 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m13:15:58.517385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:58.520510 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:15:58.521061 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m13:15:58.522725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:58.524825 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:15:58.525342 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:15:58.525799 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:15:58.527863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:15:58.530511 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m13:15:58.531360 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:15:58.531796 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m13:15:58.534716 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:15:58.536336 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m13:15:58.536921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113183a40>]}
[0m13:15:58.537652 [info ] [Thread-1 (]: 4 of 28 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m13:15:58.538402 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:15:58.538925 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:15:58.539624 [info ] [Thread-1 (]: 5 of 28 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m13:15:58.540350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m13:15:58.540876 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:15:58.543780 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:15:58.544965 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:15:58.550544 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:15:58.551574 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:15:58.552033 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m13:15:58.552437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:58.571065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:15:58.571703 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:15:58.572189 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- This is not a source deals table, and deal_id is not a PK (UNIQUE), so leave deal_id named as is
SELECT
    deal_id,
    change_time::TIMESTAMP AS change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m13:15:58.575044 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:15:58.578499 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:15:58.578976 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m13:15:58.580550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:58.583900 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:15:58.584369 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m13:15:58.585982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:58.587852 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:15:58.588285 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:15:58.588690 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:15:58.590728 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:15:58.593463 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m13:15:58.594306 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:15:58.594731 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m13:15:58.597787 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:15:58.599475 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m13:15:58.600618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130b1d00>]}
[0m13:15:58.601375 [info ] [Thread-1 (]: 5 of 28 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m13:15:58.602161 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:15:58.602700 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:15:58.603331 [info ] [Thread-1 (]: 6 of 28 START sql view model public_pipedrive_analytics.stg_pipedrive__stages .. [RUN]
[0m13:15:58.604155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m13:15:58.604737 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:15:58.607975 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:15:58.609712 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:15:58.615333 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:15:58.617114 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:15:58.617904 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m13:15:58.618387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:58.637455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:15:58.638113 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:15:58.638577 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m13:15:58.641296 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:15:58.644634 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:15:58.645081 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m13:15:58.646672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:58.651543 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:15:58.652033 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m13:15:58.653747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:58.655747 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:15:58.656266 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:15:58.657043 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:15:58.660186 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:15:58.662926 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m13:15:58.664107 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:15:58.664793 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m13:15:58.668322 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:15:58.670442 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m13:15:58.671547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11319a5d0>]}
[0m13:15:58.672646 [info ] [Thread-1 (]: 6 of 28 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.07s]
[0m13:15:58.674158 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:15:58.674905 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:15:58.675999 [info ] [Thread-1 (]: 7 of 28 START sql view model public_pipedrive_analytics.stg_pipedrive__users ... [RUN]
[0m13:15:58.676899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m13:15:58.677651 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m13:15:58.683654 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:15:58.684578 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m13:15:58.688505 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:15:58.689804 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:15:58.690318 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m13:15:58.691009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:58.710705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:15:58.711395 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:15:58.711897 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified::TIMESTAMP AS modified_time
FROM "postgres"."public"."users"
  );
[0m13:15:58.714415 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:15:58.718114 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:15:58.718615 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m13:15:58.720242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:58.723567 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:15:58.724183 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m13:15:58.726422 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:15:58.728336 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:15:58.728769 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:15:58.729180 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:15:58.731167 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:15:58.734155 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m13:15:58.735030 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:15:58.735457 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m13:15:58.738070 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:15:58.739672 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m13:15:58.740263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130de540>]}
[0m13:15:58.740995 [info ] [Thread-1 (]: 7 of 28 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m13:15:58.742054 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:15:58.742702 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:15:58.743252 [info ] [Thread-1 (]: 8 of 28 START test assert_timestamp_equal_add_time_new_value ................... [RUN]
[0m13:15:58.744060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value)
[0m13:15:58.744512 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:15:58.746496 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:15:58.747737 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:15:58.769753 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:15:58.770668 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:15:58.771107 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: BEGIN
[0m13:15:58.771506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:58.788710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:15:58.789369 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:15:58.789827 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Assert that the change_time is equal to the new_value when the changed_field_key is 'add_time'
-- With this test, it's OK to ignore the new_value field for add_time changes
SELECT * FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'add_time'
	AND change_time != new_value::TIMESTAMP
      
    ) dbt_internal_test
[0m13:15:58.796053 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:15:58.801142 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: ROLLBACK
[0m13:15:58.802743 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: Close
[0m13:15:58.804125 [info ] [Thread-1 (]: 8 of 28 PASS assert_timestamp_equal_add_time_new_value ......................... [[32mPASS[0m in 0.06s]
[0m13:15:58.805156 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:15:58.805763 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:15:58.806410 [info ] [Thread-1 (]: 9 of 28 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m13:15:58.807724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m13:15:58.808250 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:15:58.811209 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:15:58.812842 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:15:58.817141 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:15:58.818453 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:15:58.819839 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m13:15:58.820618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:58.840874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:15:58.841830 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:15:58.842327 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m13:15:58.846121 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:15:58.851265 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:15:58.851801 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m13:15:58.853730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:58.855541 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m13:15:58.856145 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:15:58.856706 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m13:15:58.859248 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:15:58.928481 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m13:15:58.929880 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:15:58.930927 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m13:15:58.935765 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:15:58.938571 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m13:15:58.939579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f59eb0>]}
[0m13:15:58.940444 [info ] [Thread-1 (]: 9 of 28 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.13s]
[0m13:15:58.941733 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:15:58.942402 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:15:58.943279 [info ] [Thread-1 (]: 10 of 28 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m13:15:58.944021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m13:15:58.944529 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:15:58.947745 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:15:58.949089 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:15:58.953307 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:15:58.954720 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:15:58.955732 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m13:15:58.956395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:58.978448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m13:15:58.979402 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:15:58.980198 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m13:15:58.983856 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:15:58.987226 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:15:58.987903 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m13:15:58.989749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:58.991920 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m13:15:58.992452 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:15:58.992875 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m13:15:58.996044 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:15:58.998895 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m13:15:59.000102 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:15:59.000848 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m13:15:59.002541 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:15:59.004273 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m13:15:59.004900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de296a20-04ef-4ba9-9c1f-51171e3d29c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11317d2e0>]}
[0m13:15:59.005619 [info ] [Thread-1 (]: 10 of 28 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.06s]
[0m13:15:59.006384 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:15:59.007114 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:15:59.007948 [info ] [Thread-1 (]: 11 of 28 START test unique_int_deal_changes_dedupe_new_deals_deal_id ........... [RUN]
[0m13:15:59.008703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_stages, now test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7)
[0m13:15:59.009200 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:15:59.020440 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:15:59.021496 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:15:59.026080 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:15:59.027096 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:15:59.027546 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: BEGIN
[0m13:15:59.027947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.050652 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m13:15:59.051385 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:15:59.051931 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    deal_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals"
where deal_id is not null
group by deal_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:15:59.058088 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:15:59.060014 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: ROLLBACK
[0m13:15:59.061510 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: Close
[0m13:15:59.062267 [info ] [Thread-1 (]: 11 of 28 PASS unique_int_deal_changes_dedupe_new_deals_deal_id ................. [[32mPASS[0m in 0.05s]
[0m13:15:59.063082 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:15:59.063667 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:15:59.064126 [info ] [Thread-1 (]: 12 of 28 START test not_null_stg_pipedrive__activity_deal_id ................... [RUN]
[0m13:15:59.064901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m13:15:59.065423 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:15:59.074541 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:15:59.075905 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:15:59.078357 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:15:59.079139 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:15:59.079575 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m13:15:59.079974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.099096 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:15:59.100012 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:15:59.100665 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m13:15:59.103515 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:15:59.105272 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m13:15:59.106742 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m13:15:59.107810 [info ] [Thread-1 (]: 12 of 28 PASS not_null_stg_pipedrive__activity_deal_id ......................... [[32mPASS[0m in 0.04s]
[0m13:15:59.108643 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:15:59.109173 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:15:59.109618 [info ] [Thread-1 (]: 13 of 28 START test not_null_stg_pipedrive__activity_due_time .................. [RUN]
[0m13:15:59.110295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191)
[0m13:15:59.110747 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:15:59.115369 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:15:59.116643 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:15:59.119095 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:15:59.119865 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:15:59.120295 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: BEGIN
[0m13:15:59.120689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.137419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:15:59.138015 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:15:59.138481 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_time is null



      
    ) dbt_internal_test
[0m13:15:59.141002 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:15:59.142750 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: ROLLBACK
[0m13:15:59.144004 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: Close
[0m13:15:59.144730 [info ] [Thread-1 (]: 13 of 28 PASS not_null_stg_pipedrive__activity_due_time ........................ [[32mPASS[0m in 0.03s]
[0m13:15:59.145465 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:15:59.145982 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:15:59.146477 [info ] [Thread-1 (]: 14 of 28 START test not_null_stg_pipedrive__activity_id ........................ [RUN]
[0m13:15:59.147157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m13:15:59.147677 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:15:59.153809 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:15:59.155057 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:15:59.158058 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:15:59.159710 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:15:59.160351 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m13:15:59.160963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.178164 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:15:59.178934 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:15:59.179632 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m13:15:59.183408 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:15:59.185200 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m13:15:59.186531 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m13:15:59.187307 [info ] [Thread-1 (]: 14 of 28 PASS not_null_stg_pipedrive__activity_id .............................. [[32mPASS[0m in 0.04s]
[0m13:15:59.188294 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:15:59.189034 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:15:59.189572 [info ] [Thread-1 (]: 15 of 28 START test not_null_stg_pipedrive__activity_is_done ................... [RUN]
[0m13:15:59.190217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m13:15:59.190749 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:15:59.195049 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:15:59.196220 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:15:59.198616 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:15:59.199459 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:15:59.200086 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m13:15:59.200555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.218724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:15:59.219472 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:15:59.219997 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m13:15:59.222482 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:15:59.224526 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m13:15:59.225973 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m13:15:59.226702 [info ] [Thread-1 (]: 15 of 28 PASS not_null_stg_pipedrive__activity_is_done ......................... [[32mPASS[0m in 0.04s]
[0m13:15:59.227449 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:15:59.227981 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:15:59.228439 [info ] [Thread-1 (]: 16 of 28 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m13:15:59.229175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m13:15:59.229645 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:15:59.239454 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:15:59.240793 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:15:59.243301 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:15:59.244106 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:15:59.244560 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m13:15:59.244971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.261394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:15:59.262221 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:15:59.262729 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:15:59.267274 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:15:59.269045 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m13:15:59.270616 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m13:15:59.271377 [info ] [Thread-1 (]: 16 of 28 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m13:15:59.272122 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:15:59.272656 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:15:59.273113 [info ] [Thread-1 (]: 17 of 28 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m13:15:59.273836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m13:15:59.274650 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:15:59.286343 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:15:59.287660 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:15:59.290414 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:15:59.291354 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:15:59.291838 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m13:15:59.292394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.309125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:15:59.309842 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:15:59.310347 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m13:15:59.315177 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:15:59.317065 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m13:15:59.318517 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m13:15:59.319314 [info ] [Thread-1 (]: 17 of 28 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.05s]
[0m13:15:59.320092 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:15:59.320618 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:15:59.321121 [info ] [Thread-1 (]: 18 of 28 START test not_null_stg_pipedrive__deal_changes_change_time ........... [RUN]
[0m13:15:59.321801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m13:15:59.322265 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:15:59.326734 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:15:59.327909 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:15:59.330289 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:15:59.331466 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:15:59.331907 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m13:15:59.332306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.349805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:15:59.350752 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:15:59.351258 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m13:15:59.354519 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:15:59.356311 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m13:15:59.357958 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m13:15:59.358787 [info ] [Thread-1 (]: 18 of 28 PASS not_null_stg_pipedrive__deal_changes_change_time ................. [[32mPASS[0m in 0.04s]
[0m13:15:59.359760 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:15:59.360298 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:15:59.360797 [info ] [Thread-1 (]: 19 of 28 START test not_null_stg_pipedrive__deal_changes_deal_id ............... [RUN]
[0m13:15:59.361495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d)
[0m13:15:59.361986 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:15:59.366539 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:15:59.367902 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:15:59.373220 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:15:59.374212 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:15:59.374703 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: BEGIN
[0m13:15:59.375118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.391563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:15:59.392107 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:15:59.392580 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where deal_id is null



      
    ) dbt_internal_test
[0m13:15:59.395546 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:15:59.397296 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: ROLLBACK
[0m13:15:59.398668 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: Close
[0m13:15:59.399635 [info ] [Thread-1 (]: 19 of 28 PASS not_null_stg_pipedrive__deal_changes_deal_id ..................... [[32mPASS[0m in 0.04s]
[0m13:15:59.400589 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:15:59.401126 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:15:59.401703 [info ] [Thread-1 (]: 20 of 28 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m13:15:59.402463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m13:15:59.402945 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:15:59.407556 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:15:59.408401 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:15:59.410798 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:15:59.411572 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:15:59.412013 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m13:15:59.412420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.429204 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:15:59.429873 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:15:59.430359 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m13:15:59.433351 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:15:59.435075 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m13:15:59.436614 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m13:15:59.437382 [info ] [Thread-1 (]: 20 of 28 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.03s]
[0m13:15:59.438232 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:15:59.438780 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:15:59.439373 [info ] [Thread-1 (]: 21 of 28 START test assert_change_user_references_user_id ...................... [RUN]
[0m13:15:59.439995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m13:15:59.440459 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:15:59.443418 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:15:59.444645 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:15:59.447603 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:15:59.448631 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:15:59.449132 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m13:15:59.449717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.467277 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:15:59.468069 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:15:59.468558 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:15:59.474064 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:15:59.475862 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m13:15:59.477433 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m13:15:59.478175 [info ] [Thread-1 (]: 21 of 28 PASS assert_change_user_references_user_id ............................ [[32mPASS[0m in 0.04s]
[0m13:15:59.478954 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:15:59.479503 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:15:59.480011 [info ] [Thread-1 (]: 22 of 28 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m13:15:59.480706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m13:15:59.481180 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:15:59.485915 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:15:59.487105 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:15:59.489567 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:15:59.490380 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:15:59.491131 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m13:15:59.491562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.513215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:15:59.514150 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:15:59.514853 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m13:15:59.518197 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:15:59.520929 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m13:15:59.522837 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m13:15:59.523995 [info ] [Thread-1 (]: 22 of 28 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m13:15:59.525290 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:15:59.526049 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:15:59.526864 [info ] [Thread-1 (]: 23 of 28 START test not_null_stg_pipedrive__users_modified_time ................ [RUN]
[0m13:15:59.527992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5)
[0m13:15:59.528726 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:15:59.536087 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:15:59.537102 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:15:59.540104 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:15:59.541338 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:15:59.542122 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: BEGIN
[0m13:15:59.542658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.561305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:15:59.562696 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:15:59.563231 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_time is null



      
    ) dbt_internal_test
[0m13:15:59.565962 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:15:59.567905 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: ROLLBACK
[0m13:15:59.569441 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: Close
[0m13:15:59.570184 [info ] [Thread-1 (]: 23 of 28 PASS not_null_stg_pipedrive__users_modified_time ...................... [[32mPASS[0m in 0.04s]
[0m13:15:59.571018 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:15:59.571534 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:15:59.572038 [info ] [Thread-1 (]: 24 of 28 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m13:15:59.572676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m13:15:59.573153 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:15:59.577609 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:15:59.578440 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:15:59.580969 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:15:59.581927 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:15:59.582392 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m13:15:59.582799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.600407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:15:59.601096 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:15:59.601698 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m13:15:59.604128 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:15:59.605910 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m13:15:59.607330 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m13:15:59.608091 [info ] [Thread-1 (]: 24 of 28 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m13:15:59.608837 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:15:59.609358 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:15:59.609872 [info ] [Thread-1 (]: 25 of 28 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m13:15:59.610458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m13:15:59.610942 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:15:59.615327 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:15:59.616155 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:15:59.618615 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:15:59.619453 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:15:59.619900 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m13:15:59.620304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.639194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:15:59.640096 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:15:59.640896 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m13:15:59.643708 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:15:59.645808 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m13:15:59.647419 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m13:15:59.648440 [info ] [Thread-1 (]: 25 of 28 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m13:15:59.649640 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:15:59.650714 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:15:59.651811 [info ] [Thread-1 (]: 26 of 28 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m13:15:59.652708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m13:15:59.653188 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:15:59.662828 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:15:59.663665 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:15:59.666682 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:15:59.667611 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:15:59.668098 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m13:15:59.668616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.690901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m13:15:59.691915 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:15:59.692510 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:15:59.697084 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:15:59.699443 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m13:15:59.701707 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m13:15:59.703071 [info ] [Thread-1 (]: 26 of 28 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.05s]
[0m13:15:59.704300 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:15:59.705128 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:15:59.706170 [info ] [Thread-1 (]: 27 of 28 START test assert_change_stage_references_lost_reason_id .............. [RUN]
[0m13:15:59.707037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m13:15:59.707932 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:15:59.711460 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:15:59.713067 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:15:59.716908 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:15:59.718123 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:15:59.718809 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m13:15:59.719381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.743854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m13:15:59.744776 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:15:59.745639 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:15:59.752927 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:15:59.755588 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m13:15:59.758493 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m13:15:59.759770 [info ] [Thread-1 (]: 27 of 28 PASS assert_change_stage_references_lost_reason_id .................... [[32mPASS[0m in 0.05s]
[0m13:15:59.761196 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:15:59.762129 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:15:59.763081 [info ] [Thread-1 (]: 28 of 28 START test assert_change_stage_references_stage_id .................... [RUN]
[0m13:15:59.763781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m13:15:59.764255 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:15:59.768743 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:15:59.769856 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:15:59.773109 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:15:59.774167 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:15:59.774905 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m13:15:59.775677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:59.798996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m13:15:59.799900 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:15:59.800695 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:15:59.810011 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m13:15:59.812031 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m13:15:59.813758 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m13:15:59.815173 [info ] [Thread-1 (]: 28 of 28 PASS assert_change_stage_references_stage_id .......................... [[32mPASS[0m in 0.05s]
[0m13:15:59.816613 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:15:59.817610 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:15:59.818609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now model.enpal_assessment_project.int_activity_join_activity_types)
[0m13:15:59.819361 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:15:59.824419 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity_join_activity_types"
[0m13:15:59.825722 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:15:59.827154 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:59.827569 [debug] [MainThread]: On master: BEGIN
[0m13:15:59.827926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:59.847697 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m13:15:59.848555 [debug] [MainThread]: On master: COMMIT
[0m13:15:59.849077 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:59.849492 [debug] [MainThread]: On master: COMMIT
[0m13:15:59.851120 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:15:59.851610 [debug] [MainThread]: On master: Close
[0m13:15:59.852328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:59.853257 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_activity_join_activity_types' was properly closed.
[0m13:15:59.853826 [info ] [MainThread]: 
[0m13:15:59.854359 [info ] [MainThread]: Finished running 9 view models, 19 data tests in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m13:15:59.860790 [debug] [MainThread]: Command end result
[0m13:15:59.903639 [info ] [MainThread]: 
[0m13:15:59.904158 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:59.904560 [info ] [MainThread]: 
[0m13:15:59.904968 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=0 SKIP=0 TOTAL=28
[0m13:15:59.907472 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.4931002, "process_in_blocks": "0", "process_kernel_time": 0.69574, "process_mem_max_rss": "117735424", "process_out_blocks": "0", "process_user_time": 4.28439}
[0m13:15:59.908211 [debug] [MainThread]: Command `dbt build` succeeded at 13:15:59.908057 after 3.49 seconds
[0m13:15:59.908683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eed7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11310e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe6c2f0>]}
[0m13:15:59.909109 [debug] [MainThread]: Flushing usage events
[0m13:39:34.073232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e580b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11293b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11293ad50>]}


============================== 13:39:34.081578 | 9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a ==============================
[0m13:39:34.081578 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:39:34.082602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:39:34.382565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111814350>]}
[0m13:39:34.463368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d54680>]}
[0m13:39:34.465338 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:39:34.611990 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:39:34.819150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m13:39:34.819989 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/intermediate/int_deal_changes_dedupe_stage.sql
[0m13:39:34.821382 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/intermediate/schema.yml
[0m13:39:34.822517 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/intermediate/int_deal_changes_dedupe_new_deals.sql
[0m13:39:35.103479 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:39:35.104071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ea2090>]}
[0m13:39:35.338625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11392d9a0>]}
[0m13:39:35.513393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a670b0>]}
[0m13:39:35.513965 [info ] [MainThread]: Found 20 data tests, 11 models, 6 sources, 428 macros
[0m13:39:35.518209 [info ] [MainThread]: 
[0m13:39:35.518949 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:39:35.524322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:39:35.600484 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:39:35.600984 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:39:35.601362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:35.658761 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.057 seconds
[0m13:39:35.660406 [debug] [ThreadPool]: On list_postgres: Close
[0m13:39:35.662649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:39:35.669671 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:39:35.670146 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m13:39:35.670547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:35.688230 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m13:39:35.689158 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:39:35.689962 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:39:35.695083 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m13:39:35.697223 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:39:35.699206 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:39:35.711016 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:35.711980 [debug] [MainThread]: On master: BEGIN
[0m13:39:35.712493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:35.737932 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m13:39:35.738525 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:35.739161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:39:35.744791 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m13:39:35.747055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a02c30>]}
[0m13:39:35.747572 [debug] [MainThread]: On master: ROLLBACK
[0m13:39:35.748992 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:35.749441 [debug] [MainThread]: On master: BEGIN
[0m13:39:35.751490 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:39:35.752132 [debug] [MainThread]: On master: COMMIT
[0m13:39:35.752554 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:35.752918 [debug] [MainThread]: On master: COMMIT
[0m13:39:35.754310 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:39:35.754896 [debug] [MainThread]: On master: Close
[0m13:39:35.755499 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:35.756110 [info ] [MainThread]: 
[0m13:39:35.759292 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m13:39:35.760110 [info ] [Thread-1 (]: 1 of 30 START sql view model public_pipedrive_analytics.base_pipedrive__fields . [RUN]
[0m13:39:35.760837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m13:39:35.761353 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m13:39:35.771939 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:35.773715 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m13:39:35.822382 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:35.823366 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:35.823953 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m13:39:35.824425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:35.843293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:39:35.844012 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:35.844518 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m13:39:35.847191 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:39:35.854836 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:35.855378 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m13:39:35.857419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:39:35.861008 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:35.861635 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m13:39:35.863391 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:35.886480 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m13:39:35.887231 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:35.887694 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m13:39:35.892062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:39:35.900047 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m13:39:35.906584 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:35.907142 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m13:39:35.910704 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:39:35.913561 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m13:39:35.915533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11123d5b0>]}
[0m13:39:35.916417 [info ] [Thread-1 (]: 1 of 30 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.15s]
[0m13:39:35.917422 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m13:39:35.918024 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:39:35.918733 [info ] [Thread-1 (]: 2 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__activity  [RUN]
[0m13:39:35.919495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m13:39:35.919969 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:39:35.923124 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:35.924670 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:39:35.928873 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:35.929813 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:35.930302 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m13:39:35.930719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:35.949006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:39:35.950629 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:35.951425 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to::TIMESTAMP AS due_time
FROM "postgres"."public"."activity"
  );
[0m13:39:35.954713 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:39:35.958560 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:35.959106 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m13:39:35.960964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:35.964617 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:35.966150 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m13:39:35.968767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:35.970783 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:39:35.971279 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:35.971704 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:39:35.974092 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:39:35.976969 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m13:39:35.977977 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:35.978457 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m13:39:35.981285 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:39:35.982929 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m13:39:35.983571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fa6810>]}
[0m13:39:35.984373 [info ] [Thread-1 (]: 2 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m13:39:35.985214 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:39:35.985796 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:39:35.986671 [info ] [Thread-1 (]: 3 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m13:39:35.987452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m13:39:35.987936 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:39:35.991037 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:35.992264 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:39:35.996917 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:35.997849 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:35.998492 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m13:39:35.999174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.021925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m13:39:36.022606 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:36.023161 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS activity_is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m13:39:36.026307 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:39:36.029852 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:36.030344 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m13:39:36.032381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:36.036031 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:36.036497 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m13:39:36.038284 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:36.040452 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:39:36.041037 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:36.041477 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:39:36.043621 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:39:36.047663 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m13:39:36.048532 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:36.048978 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m13:39:36.051474 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:39:36.053166 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m13:39:36.053784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140cc350>]}
[0m13:39:36.054492 [info ] [Thread-1 (]: 3 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.07s]
[0m13:39:36.055236 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:39:36.055766 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:39:36.056734 [info ] [Thread-1 (]: 4 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m13:39:36.057531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m13:39:36.057999 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:39:36.061038 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:36.061925 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:39:36.069379 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:36.070276 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:36.070716 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m13:39:36.071119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.091361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:39:36.092070 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:36.092535 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- This is not a source deals table, and deal_id is not a PK (UNIQUE), so leave deal_id named as is
SELECT
    deal_id,
    change_time::TIMESTAMP AS change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m13:39:36.094878 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:39:36.099189 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:36.099714 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m13:39:36.101497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:36.104821 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:36.105295 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m13:39:36.107018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:36.108964 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:39:36.109415 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:36.109915 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:39:36.111846 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:39:36.114607 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m13:39:36.115473 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:36.115911 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m13:39:36.118275 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:39:36.119866 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m13:39:36.120465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140e1250>]}
[0m13:39:36.121171 [info ] [Thread-1 (]: 4 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m13:39:36.121920 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:39:36.122439 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:39:36.123287 [info ] [Thread-1 (]: 5 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__stages .. [RUN]
[0m13:39:36.124133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m13:39:36.124612 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:39:36.127503 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:36.128304 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:39:36.132275 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:36.133126 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:36.133569 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m13:39:36.133981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.149991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:39:36.150517 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:36.151040 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m13:39:36.154328 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:39:36.157765 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:36.158266 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m13:39:36.159799 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:36.163158 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:36.163618 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m13:39:36.165213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:36.167137 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:39:36.167959 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:36.168560 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:39:36.170869 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:39:36.174120 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m13:39:36.175061 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:36.175510 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m13:39:36.177919 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:39:36.179517 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m13:39:36.180095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f8e750>]}
[0m13:39:36.180850 [info ] [Thread-1 (]: 5 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m13:39:36.181615 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:39:36.182137 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:39:36.182833 [info ] [Thread-1 (]: 6 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__users ... [RUN]
[0m13:39:36.183407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m13:39:36.183951 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m13:39:36.187036 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:36.188046 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m13:39:36.193827 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:36.194653 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:36.195092 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m13:39:36.195494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.212096 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:39:36.212794 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:36.213288 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified::TIMESTAMP AS modified_time
FROM "postgres"."public"."users"
  );
[0m13:39:36.216176 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:39:36.219589 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:36.220055 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m13:39:36.221480 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:36.224842 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:36.225332 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m13:39:36.226871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:36.228753 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:39:36.229214 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:36.229626 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:39:36.231506 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:39:36.234300 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m13:39:36.235159 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:36.235600 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m13:39:36.238007 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:39:36.239721 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m13:39:36.240372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11411c830>]}
[0m13:39:36.241157 [info ] [Thread-1 (]: 6 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m13:39:36.241914 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:39:36.242501 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:39:36.243186 [info ] [Thread-1 (]: 7 of 30 START test assert_timestamp_equal_add_time_new_value ................... [RUN]
[0m13:39:36.243900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value)
[0m13:39:36.244357 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:39:36.246382 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:39:36.247220 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:39:36.266962 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:39:36.267888 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:39:36.268338 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: BEGIN
[0m13:39:36.268771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.285571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:39:36.286150 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:39:36.286627 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Assert that the change_time is equal to the new_value when the changed_field_key is 'add_time'
-- With this test, it's OK to ignore the new_value field for add_time changes
SELECT * FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'add_time'
	AND change_time != new_value::TIMESTAMP
      
    ) dbt_internal_test
[0m13:39:36.292863 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:39:36.297182 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: ROLLBACK
[0m13:39:36.298708 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: Close
[0m13:39:36.299797 [info ] [Thread-1 (]: 7 of 30 PASS assert_timestamp_equal_add_time_new_value ......................... [[32mPASS[0m in 0.06s]
[0m13:39:36.300858 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:39:36.301401 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:39:36.302308 [info ] [Thread-1 (]: 8 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m13:39:36.303224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m13:39:36.303922 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:39:36.307291 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:39:36.308537 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:39:36.312757 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:39:36.313711 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:39:36.314435 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m13:39:36.314994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.331064 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:39:36.331729 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:39:36.332255 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m13:39:36.336156 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:39:36.339920 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:39:36.340495 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m13:39:36.342098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:36.344127 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m13:39:36.344618 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:39:36.345081 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m13:39:36.347080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:39:36.349818 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m13:39:36.350663 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:39:36.351108 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m13:39:36.352508 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:39:36.354111 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m13:39:36.354720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fbc080>]}
[0m13:39:36.355413 [info ] [Thread-1 (]: 8 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.05s]
[0m13:39:36.356335 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:39:36.356994 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:39:36.357719 [info ] [Thread-1 (]: 9 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m13:39:36.358541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m13:39:36.359119 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:39:36.361980 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:39:36.362788 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:39:36.368331 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:39:36.369181 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:39:36.369704 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m13:39:36.370150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.388514 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:39:36.389373 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:39:36.389895 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m13:39:36.393280 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:39:36.448567 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:39:36.449119 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m13:39:36.451349 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:39:36.453195 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m13:39:36.453691 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:39:36.454134 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m13:39:36.456265 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:39:36.459002 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m13:39:36.459870 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:39:36.460316 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m13:39:36.461839 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:39:36.463447 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m13:39:36.464148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c80d10>]}
[0m13:39:36.465354 [info ] [Thread-1 (]: 9 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.11s]
[0m13:39:36.466448 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:39:36.467081 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:39:36.467787 [info ] [Thread-1 (]: 10 of 30 START test not_null_stg_pipedrive__activity_deal_id ................... [RUN]
[0m13:39:36.468486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_stages, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m13:39:36.468978 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:39:36.480266 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:39:36.481824 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:39:36.484616 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:39:36.485495 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:39:36.486059 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m13:39:36.486643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.505515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:39:36.506204 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:39:36.506884 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m13:39:36.509524 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:39:36.511301 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m13:39:36.512742 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m13:39:36.513474 [info ] [Thread-1 (]: 10 of 30 PASS not_null_stg_pipedrive__activity_deal_id ......................... [[32mPASS[0m in 0.04s]
[0m13:39:36.514461 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:39:36.515043 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:39:36.515564 [info ] [Thread-1 (]: 11 of 30 START test not_null_stg_pipedrive__activity_due_time .................. [RUN]
[0m13:39:36.516230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191)
[0m13:39:36.516754 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:39:36.521388 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:39:36.522978 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:39:36.526389 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:39:36.527420 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:39:36.527958 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: BEGIN
[0m13:39:36.528487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.547896 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:39:36.548588 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:39:36.549353 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_time is null



      
    ) dbt_internal_test
[0m13:39:36.551991 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:39:36.553806 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: ROLLBACK
[0m13:39:36.555241 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: Close
[0m13:39:36.555973 [info ] [Thread-1 (]: 11 of 30 PASS not_null_stg_pipedrive__activity_due_time ........................ [[32mPASS[0m in 0.04s]
[0m13:39:36.557150 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:39:36.557811 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:39:36.558355 [info ] [Thread-1 (]: 12 of 30 START test not_null_stg_pipedrive__activity_id ........................ [RUN]
[0m13:39:36.558962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m13:39:36.559434 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:39:36.564093 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:39:36.565484 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:39:36.568351 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:39:36.569545 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:39:36.570008 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m13:39:36.570422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.588325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:39:36.588933 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:39:36.589415 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m13:39:36.591938 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:39:36.593700 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m13:39:36.594954 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m13:39:36.595686 [info ] [Thread-1 (]: 12 of 30 PASS not_null_stg_pipedrive__activity_id .............................. [[32mPASS[0m in 0.04s]
[0m13:39:36.596424 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:39:36.596943 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:39:36.597740 [info ] [Thread-1 (]: 13 of 30 START test not_null_stg_pipedrive__activity_is_done ................... [RUN]
[0m13:39:36.598498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m13:39:36.599172 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:39:36.603462 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:39:36.604845 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:39:36.607612 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:39:36.608586 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:39:36.609195 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m13:39:36.609673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.626772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:39:36.627414 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:39:36.627954 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m13:39:36.631533 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:39:36.633293 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m13:39:36.634774 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m13:39:36.635747 [info ] [Thread-1 (]: 13 of 30 PASS not_null_stg_pipedrive__activity_is_done ......................... [[32mPASS[0m in 0.04s]
[0m13:39:36.636549 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:39:36.637080 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:39:36.637690 [info ] [Thread-1 (]: 14 of 30 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m13:39:36.638279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m13:39:36.638761 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:39:36.648789 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:39:36.649809 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:39:36.654172 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:39:36.655095 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:39:36.655586 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m13:39:36.656010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.672942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:39:36.673812 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:39:36.674341 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:39:36.678368 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:39:36.680259 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m13:39:36.681713 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m13:39:36.682494 [info ] [Thread-1 (]: 14 of 30 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m13:39:36.683324 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:39:36.683850 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:39:36.684373 [info ] [Thread-1 (]: 15 of 30 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m13:39:36.685142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m13:39:36.685646 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:39:36.697244 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:39:36.698460 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:39:36.701093 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:39:36.701990 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:39:36.702547 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m13:39:36.703219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.720654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:39:36.721296 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:39:36.721798 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m13:39:36.727017 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:39:36.728860 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m13:39:36.730393 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m13:39:36.731370 [info ] [Thread-1 (]: 15 of 30 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.05s]
[0m13:39:36.732760 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:39:36.733464 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:39:36.734378 [info ] [Thread-1 (]: 16 of 30 START test not_null_stg_pipedrive__deal_changes_change_time ........... [RUN]
[0m13:39:36.735430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m13:39:36.736120 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:39:36.741080 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:39:36.742374 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:39:36.744944 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:39:36.745780 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:39:36.746251 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m13:39:36.746694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.765890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:39:36.766585 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:39:36.767161 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m13:39:36.770264 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:39:36.772041 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m13:39:36.773557 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m13:39:36.774392 [info ] [Thread-1 (]: 16 of 30 PASS not_null_stg_pipedrive__deal_changes_change_time ................. [[32mPASS[0m in 0.04s]
[0m13:39:36.775216 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:39:36.775779 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:39:36.776308 [info ] [Thread-1 (]: 17 of 30 START test not_null_stg_pipedrive__deal_changes_deal_id ............... [RUN]
[0m13:39:36.776930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d)
[0m13:39:36.777416 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:39:36.781908 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:39:36.783197 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:39:36.785785 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:39:36.786607 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:39:36.787080 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: BEGIN
[0m13:39:36.787515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.805028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:39:36.805641 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:39:36.806322 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where deal_id is null



      
    ) dbt_internal_test
[0m13:39:36.809692 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:39:36.811462 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: ROLLBACK
[0m13:39:36.813061 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: Close
[0m13:39:36.814121 [info ] [Thread-1 (]: 17 of 30 PASS not_null_stg_pipedrive__deal_changes_deal_id ..................... [[32mPASS[0m in 0.04s]
[0m13:39:36.814918 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:39:36.815442 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:39:36.815948 [info ] [Thread-1 (]: 18 of 30 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m13:39:36.816563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m13:39:36.817034 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:39:36.821327 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:39:36.822166 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:39:36.825046 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:39:36.825896 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:39:36.826401 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m13:39:36.826985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.843900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:39:36.844443 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:39:36.844963 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m13:39:36.847995 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:39:36.849758 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m13:39:36.851058 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m13:39:36.851792 [info ] [Thread-1 (]: 18 of 30 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m13:39:36.852696 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:39:36.853232 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:39:36.853932 [info ] [Thread-1 (]: 19 of 30 START test assert_change_user_references_user_id ...................... [RUN]
[0m13:39:36.854845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m13:39:36.855318 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:39:36.858599 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:39:36.859554 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:39:36.862111 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:39:36.863073 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:39:36.863544 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m13:39:36.864002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.881013 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:39:36.881778 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:39:36.882302 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:39:36.887564 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:39:36.889338 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m13:39:36.890795 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m13:39:36.891607 [info ] [Thread-1 (]: 19 of 30 PASS assert_change_user_references_user_id ............................ [[32mPASS[0m in 0.04s]
[0m13:39:36.892376 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:39:36.892908 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:39:36.893397 [info ] [Thread-1 (]: 20 of 30 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m13:39:36.893980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m13:39:36.894453 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:39:36.899197 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:39:36.900407 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:39:36.905116 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:39:36.906101 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:39:36.906851 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m13:39:36.907319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.923902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:39:36.924440 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:39:36.924912 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m13:39:36.927984 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:39:36.929882 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m13:39:36.931326 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m13:39:36.932192 [info ] [Thread-1 (]: 20 of 30 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m13:39:36.933066 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:39:36.933588 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:39:36.934168 [info ] [Thread-1 (]: 21 of 30 START test not_null_stg_pipedrive__users_modified_time ................ [RUN]
[0m13:39:36.935059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5)
[0m13:39:36.935602 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:39:36.940523 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:39:36.941441 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:39:36.944014 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:39:36.944823 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:39:36.945256 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: BEGIN
[0m13:39:36.945679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:36.963946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:39:36.964686 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:39:36.965276 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_time is null



      
    ) dbt_internal_test
[0m13:39:36.967811 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:39:36.969725 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: ROLLBACK
[0m13:39:36.971378 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: Close
[0m13:39:36.972251 [info ] [Thread-1 (]: 21 of 30 PASS not_null_stg_pipedrive__users_modified_time ...................... [[32mPASS[0m in 0.04s]
[0m13:39:36.973164 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:39:36.973858 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:39:36.974467 [info ] [Thread-1 (]: 22 of 30 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m13:39:36.975087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m13:39:36.975548 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:39:36.979920 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:39:36.980803 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:39:36.983361 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:39:36.984192 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:39:36.984650 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m13:39:36.985069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.000531 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:39:37.001145 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:39:37.001623 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m13:39:37.004189 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:39:37.005965 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m13:39:37.007437 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m13:39:37.008247 [info ] [Thread-1 (]: 22 of 30 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.03s]
[0m13:39:37.009068 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:39:37.009586 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:39:37.010167 [info ] [Thread-1 (]: 23 of 30 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m13:39:37.010779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m13:39:37.011236 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:39:37.015752 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:39:37.016572 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:39:37.019132 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:39:37.019994 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:39:37.020445 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m13:39:37.020915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.037753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:39:37.038359 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:39:37.038867 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m13:39:37.041182 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:39:37.042962 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m13:39:37.044260 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m13:39:37.045022 [info ] [Thread-1 (]: 23 of 30 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.03s]
[0m13:39:37.045856 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:39:37.046398 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:39:37.047129 [info ] [Thread-1 (]: 24 of 30 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m13:39:37.047831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m13:39:37.048310 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:39:37.054972 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:39:37.055887 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:39:37.058738 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:39:37.059602 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:39:37.060060 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m13:39:37.060478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.077501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:39:37.078396 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:39:37.078961 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:39:37.084120 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:39:37.085961 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m13:39:37.087288 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m13:39:37.088040 [info ] [Thread-1 (]: 24 of 30 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m13:39:37.088806 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:39:37.089337 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:39:37.090059 [info ] [Thread-1 (]: 25 of 30 START test assert_change_stage_references_lost_reason_id .............. [RUN]
[0m13:39:37.090797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m13:39:37.091278 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:39:37.094352 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:39:37.095217 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:39:37.097755 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:39:37.098820 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:39:37.099364 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m13:39:37.099873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.116158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:39:37.116805 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:39:37.117290 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:39:37.122028 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:39:37.123811 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m13:39:37.125356 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m13:39:37.126258 [info ] [Thread-1 (]: 25 of 30 PASS assert_change_stage_references_lost_reason_id .................... [[32mPASS[0m in 0.04s]
[0m13:39:37.127274 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:39:37.127995 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:39:37.128694 [info ] [Thread-1 (]: 26 of 30 START test assert_change_stage_references_stage_id .................... [RUN]
[0m13:39:37.129325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m13:39:37.129950 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:39:37.133055 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:39:37.133913 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:39:37.136382 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:39:37.137270 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:39:37.137742 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m13:39:37.138329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.156176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:39:37.157158 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:39:37.157677 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:39:37.164183 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:39:37.166317 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m13:39:37.167776 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m13:39:37.168619 [info ] [Thread-1 (]: 26 of 30 PASS assert_change_stage_references_stage_id .......................... [[32mPASS[0m in 0.04s]
[0m13:39:37.169446 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:39:37.170051 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:39:37.170796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now model.enpal_assessment_project.int_activity_join_activity_types)
[0m13:39:37.171330 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:39:37.177358 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity_join_activity_types"
[0m13:39:37.178662 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:39:37.179186 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:39:37.180145 [info ] [Thread-1 (]: 27 of 30 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_new_deals  [RUN]
[0m13:39:37.180998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activity_join_activity_types, now model.enpal_assessment_project.int_deal_changes_dedupe_new_deals)
[0m13:39:37.181547 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:39:37.184918 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:37.185707 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:39:37.190527 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:37.191556 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:37.192173 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: BEGIN
[0m13:39:37.192614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.210536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:39:37.211252 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:37.211740 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_tmp"
    
    
  as (
    -- Separate new deals model from the deal_changes model
-- There are a handful of dupe deals in the deal_changes model (assumption - deals should not have more than one added date)
-- Materialize as a view so it can be tested for deduplication
SELECT
	deal_id, 
	MAX(change_time)
FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
WHERE changed_field_key = 'add_time'
GROUP BY deal_id
  );
[0m13:39:37.214896 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:39:37.218317 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:37.218831 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals" rename to "int_deal_changes_dedupe_new_deals__dbt_backup"
[0m13:39:37.220719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:37.224662 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:37.225262 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_tmp" rename to "int_deal_changes_dedupe_new_deals"
[0m13:39:37.227795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:39:37.230579 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: COMMIT
[0m13:39:37.231384 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:37.232141 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: COMMIT
[0m13:39:37.234871 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:39:37.239298 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_backup"
[0m13:39:37.241331 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:37.242423 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
drop view if exists "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_backup" cascade
[0m13:39:37.246700 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:39:37.249001 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: Close
[0m13:39:37.249840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f0ec00>]}
[0m13:39:37.251167 [info ] [Thread-1 (]: 27 of 30 OK created sql view model public_pipedrive_analytics.int_deal_changes_dedupe_new_deals  [[32mCREATE VIEW[0m in 0.07s]
[0m13:39:37.252590 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:39:37.253705 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:39:37.255136 [info ] [Thread-1 (]: 28 of 30 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_stage  [RUN]
[0m13:39:37.256131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_new_deals, now model.enpal_assessment_project.int_deal_changes_dedupe_stage)
[0m13:39:37.256962 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:39:37.261830 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:39:37.263425 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:39:37.271455 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:39:37.272564 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:39:37.273297 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: BEGIN
[0m13:39:37.273929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.294376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:39:37.295299 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:39:37.295893 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_tmp"
    
    
  as (
    -- Separate new deals model from the deal_changes model
-- There are a handful of dupe deals in the deal_changes model (assumption - deals should not have more of each stage id)
-- Materialize as a view so it can be tested for deduplication
-- Method: row_number in reverse order and then pick the first row. 
-- This pattern is better because we don't know how many duplicate rows there could be, but the latest will always be row number 1.
-- Can't just take MAX(new_value) as was done for new_deals, because there are multiple stage_ids and all that appear need to be presented to the model.
WITH deal_changes_stage AS (
	SELECT
		ROW_NUMBER() OVER(PARTITION BY deal_id, new_value ORDER BY new_value, change_time DESC) AS reverse_order,
		deal_id,
		new_value AS stage_id,
		change_time
	FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'stage_id'
)
SELECT * FROM deal_changes_stage WHERE reverse_order = 1;
  );
[0m13:39:37.298588 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: SELECT * FROM deal_changes_stage WHERE reverse_order = 1;
                                                                 ^

[0m13:39:37.299910 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: ROLLBACK
[0m13:39:37.302744 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: Close
[0m13:39:37.318311 [debug] [Thread-1 (]: Database Error in model int_deal_changes_dedupe_stage (models/intermediate/int_deal_changes_dedupe_stage.sql)
  syntax error at or near ";"
  LINE 22: SELECT * FROM deal_changes_stage WHERE reverse_order = 1;
                                                                   ^
  compiled code at target/run/enpal_assessment_project/models/intermediate/int_deal_changes_dedupe_stage.sql
[0m13:39:37.334479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f8385dd-5aee-4d6a-a0e4-c35a1c20a07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b53a70>]}
[0m13:39:37.336502 [error] [Thread-1 (]: 28 of 30 ERROR creating sql view model public_pipedrive_analytics.int_deal_changes_dedupe_stage  [[31mERROR[0m in 0.06s]
[0m13:39:37.338944 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:39:37.339830 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:39:37.341709 [info ] [Thread-1 (]: 29 of 30 START test unique_int_deal_changes_dedupe_new_deals_deal_id ........... [RUN]
[0m13:39:37.342597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_stage, now test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7)
[0m13:39:37.343355 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:39:37.352652 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:39:37.353532 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:39:37.356435 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:39:37.357977 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:39:37.358741 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: BEGIN
[0m13:39:37.359524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.377612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:39:37.378370 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:39:37.378935 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    deal_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals"
where deal_id is not null
group by deal_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:39:37.384914 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:39:37.386876 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: ROLLBACK
[0m13:39:37.388403 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: Close
[0m13:39:37.389334 [info ] [Thread-1 (]: 29 of 30 PASS unique_int_deal_changes_dedupe_new_deals_deal_id ................. [[32mPASS[0m in 0.05s]
[0m13:39:37.390459 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:39:37.391042 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93
[0m13:39:37.391643 [info ] [Thread-1 (]: 30 of 30 SKIP test unique_int_deal_changes_dedupe_stage_deal_id ................ [[33mSKIP[0m]
[0m13:39:37.392450 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93
[0m13:39:37.393938 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:37.394382 [debug] [MainThread]: On master: BEGIN
[0m13:39:37.394752 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:37.412374 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m13:39:37.413064 [debug] [MainThread]: On master: COMMIT
[0m13:39:37.413521 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:37.414006 [debug] [MainThread]: On master: COMMIT
[0m13:39:37.415840 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:39:37.416317 [debug] [MainThread]: On master: Close
[0m13:39:37.416903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:37.417377 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7' was properly closed.
[0m13:39:37.418087 [info ] [MainThread]: 
[0m13:39:37.418589 [info ] [MainThread]: Finished running 10 view models, 20 data tests in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m13:39:37.425351 [debug] [MainThread]: Command end result
[0m13:39:37.466434 [info ] [MainThread]: 
[0m13:39:37.467022 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:39:37.467473 [info ] [MainThread]: 
[0m13:39:37.468231 [error] [MainThread]:   Database Error in model int_deal_changes_dedupe_stage (models/intermediate/int_deal_changes_dedupe_stage.sql)
  syntax error at or near ";"
  LINE 22: SELECT * FROM deal_changes_stage WHERE reverse_order = 1;
                                                                   ^
  compiled code at target/run/enpal_assessment_project/models/intermediate/int_deal_changes_dedupe_stage.sql
[0m13:39:37.468878 [info ] [MainThread]: 
[0m13:39:37.469634 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=1 TOTAL=30
[0m13:39:37.472614 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.4942777, "process_in_blocks": "0", "process_kernel_time": 0.628122, "process_mem_max_rss": "118558720", "process_out_blocks": "0", "process_user_time": 4.200744}
[0m13:39:37.473829 [debug] [MainThread]: Command `dbt build` failed at 13:39:37.473601 after 3.50 seconds
[0m13:39:37.474557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecb2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113652060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138a3fb0>]}
[0m13:39:37.475245 [debug] [MainThread]: Flushing usage events
[0m13:39:52.827266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087515b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ef2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091eee10>]}


============================== 13:39:52.835572 | 41f61b78-60f9-4820-8b87-5850470fb549 ==============================
[0m13:39:52.835572 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:39:52.836610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:39:53.112165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109695610>]}
[0m13:39:53.179622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8ff80>]}
[0m13:39:53.181382 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:39:53.330725 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:39:53.531349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:39:53.532260 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/intermediate/int_deal_changes_dedupe_stage.sql
[0m13:39:53.800454 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:39:53.801086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090560f0>]}
[0m13:39:54.023429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2c2c30>]}
[0m13:39:54.201976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a405310>]}
[0m13:39:54.202600 [info ] [MainThread]: Found 20 data tests, 11 models, 6 sources, 428 macros
[0m13:39:54.207319 [info ] [MainThread]: 
[0m13:39:54.208169 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:39:54.214153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:39:54.306480 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:39:54.307641 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:39:54.308113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:54.365724 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.058 seconds
[0m13:39:54.367329 [debug] [ThreadPool]: On list_postgres: Close
[0m13:39:54.369302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:39:54.376677 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:39:54.377133 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m13:39:54.377476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:54.393789 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m13:39:54.394728 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:39:54.395323 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:39:54.401060 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m13:39:54.402924 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:39:54.404364 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:39:54.412134 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:54.412798 [debug] [MainThread]: On master: BEGIN
[0m13:39:54.413227 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:54.430415 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m13:39:54.430969 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:54.431450 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:39:54.436407 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m13:39:54.438714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2bcef0>]}
[0m13:39:54.439213 [debug] [MainThread]: On master: ROLLBACK
[0m13:39:54.440925 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:54.441422 [debug] [MainThread]: On master: BEGIN
[0m13:39:54.443819 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:39:54.444399 [debug] [MainThread]: On master: COMMIT
[0m13:39:54.444776 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:54.445211 [debug] [MainThread]: On master: COMMIT
[0m13:39:54.446470 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:39:54.446908 [debug] [MainThread]: On master: Close
[0m13:39:54.447445 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:54.447945 [info ] [MainThread]: 
[0m13:39:54.450896 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m13:39:54.451553 [info ] [Thread-1 (]: 1 of 30 START sql view model public_pipedrive_analytics.base_pipedrive__fields . [RUN]
[0m13:39:54.452097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m13:39:54.452544 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m13:39:54.462508 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:54.463369 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m13:39:54.510347 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:54.511242 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:54.511680 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m13:39:54.512074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:54.527631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:39:54.528257 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:54.528707 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m13:39:54.531179 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:39:54.538442 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:54.538954 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m13:39:54.540759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:54.544023 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:54.544476 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m13:39:54.546167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:54.566245 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m13:39:54.566762 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:54.567196 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m13:39:54.569832 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:39:54.577172 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m13:39:54.583130 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:39:54.583649 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m13:39:54.586869 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:39:54.589636 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m13:39:54.591446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107af15b0>]}
[0m13:39:54.592196 [info ] [Thread-1 (]: 1 of 30 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m13:39:54.593174 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m13:39:54.593899 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:39:54.594636 [info ] [Thread-1 (]: 2 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__activity  [RUN]
[0m13:39:54.595229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m13:39:54.595693 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:39:54.598698 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:54.599577 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:39:54.603919 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:54.604778 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:54.605205 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m13:39:54.605595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:54.620946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:39:54.621479 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:54.621942 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to::TIMESTAMP AS due_time
FROM "postgres"."public"."activity"
  );
[0m13:39:54.624756 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:39:54.628084 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:54.628543 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m13:39:54.629998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:54.633296 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:54.633754 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m13:39:54.635195 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:54.637111 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:39:54.637553 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:54.637954 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:39:54.639935 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:39:54.642661 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m13:39:54.643594 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:39:54.644021 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m13:39:54.646428 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:39:54.648092 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m13:39:54.648727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a81bf80>]}
[0m13:39:54.649584 [info ] [Thread-1 (]: 2 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.05s]
[0m13:39:54.650788 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:39:54.651440 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:39:54.652127 [info ] [Thread-1 (]: 3 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m13:39:54.652800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m13:39:54.653232 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:39:54.655941 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:54.656688 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:39:54.660684 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:54.661496 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:54.661929 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m13:39:54.662323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:54.678088 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:39:54.678712 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:54.679187 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS activity_is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m13:39:54.681955 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:39:54.685561 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:54.686052 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m13:39:54.687588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:54.690967 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:54.691476 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m13:39:54.693032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:54.694886 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:39:54.695318 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:54.695719 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:39:54.697567 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:39:54.701376 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m13:39:54.702211 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:39:54.702774 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m13:39:54.705249 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:39:54.706825 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m13:39:54.707481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9805f0>]}
[0m13:39:54.708376 [info ] [Thread-1 (]: 3 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.05s]
[0m13:39:54.709267 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:39:54.709775 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:39:54.710498 [info ] [Thread-1 (]: 4 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m13:39:54.711146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m13:39:54.711641 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:39:54.714789 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:54.715804 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:39:54.720972 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:54.721819 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:54.722250 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m13:39:54.722645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:54.738794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:39:54.739421 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:54.739871 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- This is not a source deals table, and deal_id is not a PK (UNIQUE), so leave deal_id named as is
SELECT
    deal_id,
    change_time::TIMESTAMP AS change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m13:39:54.742768 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:39:54.746205 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:54.746692 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m13:39:54.748207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:54.751399 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:54.751852 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m13:39:54.753446 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:54.755386 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:39:54.755834 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:54.756304 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:39:54.758315 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:39:54.761007 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m13:39:54.761873 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:39:54.762308 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m13:39:54.766080 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:39:54.767848 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m13:39:54.768480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a971b80>]}
[0m13:39:54.769255 [info ] [Thread-1 (]: 4 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m13:39:54.770084 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:39:54.770621 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:39:54.771483 [info ] [Thread-1 (]: 5 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__stages .. [RUN]
[0m13:39:54.772168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m13:39:54.772617 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:39:54.775521 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:54.776419 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:39:54.780594 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:54.781564 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:54.782036 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m13:39:54.782439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:54.798789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:39:54.799499 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:54.800014 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m13:39:54.803760 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:39:54.807268 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:54.807772 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m13:39:54.809419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:54.812618 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:54.813070 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m13:39:54.814515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:54.816515 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:39:54.817061 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:54.817479 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:39:54.819299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:39:54.821932 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m13:39:54.822766 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:39:54.823189 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m13:39:54.825826 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:39:54.827425 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m13:39:54.828049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a836e70>]}
[0m13:39:54.828739 [info ] [Thread-1 (]: 5 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m13:39:54.829471 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:39:54.829972 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:39:54.830624 [info ] [Thread-1 (]: 6 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__users ... [RUN]
[0m13:39:54.831171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m13:39:54.831601 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m13:39:54.834416 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:54.835185 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m13:39:54.840515 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:54.841343 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:54.841774 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m13:39:54.842169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:54.859823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:39:54.860597 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:54.861118 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified::TIMESTAMP AS modified_time
FROM "postgres"."public"."users"
  );
[0m13:39:54.863583 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:39:54.866954 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:54.867413 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m13:39:54.868908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:54.872244 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:54.872737 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m13:39:54.874714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:54.877021 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:39:54.877518 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:54.877984 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:39:54.879970 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:39:54.882579 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m13:39:54.883402 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:39:54.883829 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m13:39:54.886251 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:39:54.887829 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m13:39:54.888404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c1b80>]}
[0m13:39:54.889120 [info ] [Thread-1 (]: 6 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m13:39:54.890191 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:39:54.890817 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:39:54.891585 [info ] [Thread-1 (]: 7 of 30 START test assert_timestamp_equal_add_time_new_value ................... [RUN]
[0m13:39:54.892375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value)
[0m13:39:54.892823 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:39:54.895022 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:39:54.896054 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:39:54.915219 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:39:54.916110 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:39:54.916570 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: BEGIN
[0m13:39:54.917049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:54.933604 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:39:54.934241 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:39:54.934710 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Assert that the change_time is equal to the new_value when the changed_field_key is 'add_time'
-- With this test, it's OK to ignore the new_value field for add_time changes
SELECT * FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'add_time'
	AND change_time != new_value::TIMESTAMP
      
    ) dbt_internal_test
[0m13:39:54.939847 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:39:54.943551 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: ROLLBACK
[0m13:39:54.944998 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: Close
[0m13:39:54.945804 [info ] [Thread-1 (]: 7 of 30 PASS assert_timestamp_equal_add_time_new_value ......................... [[32mPASS[0m in 0.05s]
[0m13:39:54.946764 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:39:54.947456 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:39:54.948105 [info ] [Thread-1 (]: 8 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m13:39:54.948708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m13:39:54.949148 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:39:54.952377 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:39:54.953202 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:39:54.956981 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:39:54.957895 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:39:54.958340 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m13:39:54.958732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:54.974615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:39:54.975184 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:39:54.975673 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m13:39:54.979414 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:39:54.982520 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:39:54.982983 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m13:39:54.984567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:54.986535 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m13:39:54.987006 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:39:54.987430 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m13:39:54.989264 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:39:54.991786 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m13:39:54.992686 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:39:54.993116 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m13:39:54.994568 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:39:54.996212 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m13:39:54.996782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a826d50>]}
[0m13:39:54.997441 [info ] [Thread-1 (]: 8 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.05s]
[0m13:39:54.998179 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:39:54.998674 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:39:54.999352 [info ] [Thread-1 (]: 9 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m13:39:54.999940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m13:39:55.000492 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:39:55.003238 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:39:55.004017 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:39:55.009355 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:39:55.010189 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:39:55.010694 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m13:39:55.011137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.027584 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:39:55.028342 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:39:55.028850 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m13:39:55.031796 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:39:55.089308 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:39:55.090575 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m13:39:55.093788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:39:55.096024 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m13:39:55.096572 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:39:55.097068 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m13:39:55.100453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:39:55.103200 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m13:39:55.104093 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:39:55.104575 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m13:39:55.106098 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:39:55.107975 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m13:39:55.108601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a97d070>]}
[0m13:39:55.109366 [info ] [Thread-1 (]: 9 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.11s]
[0m13:39:55.110195 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:39:55.110741 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:39:55.111467 [info ] [Thread-1 (]: 10 of 30 START test not_null_stg_pipedrive__activity_deal_id ................... [RUN]
[0m13:39:55.112234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_stages, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m13:39:55.112697 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:39:55.123672 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:39:55.124519 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:39:55.127064 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:39:55.128081 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:39:55.128747 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m13:39:55.129170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.146008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:39:55.146788 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:39:55.147432 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m13:39:55.150198 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:39:55.152023 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m13:39:55.153597 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m13:39:55.154311 [info ] [Thread-1 (]: 10 of 30 PASS not_null_stg_pipedrive__activity_deal_id ......................... [[32mPASS[0m in 0.04s]
[0m13:39:55.155098 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:39:55.155622 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:39:55.156126 [info ] [Thread-1 (]: 11 of 30 START test not_null_stg_pipedrive__activity_due_time .................. [RUN]
[0m13:39:55.157063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191)
[0m13:39:55.157564 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:39:55.162365 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:39:55.163280 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:39:55.165928 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:39:55.166741 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:39:55.167170 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: BEGIN
[0m13:39:55.167564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.184950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:39:55.185772 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:39:55.186492 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_time is null



      
    ) dbt_internal_test
[0m13:39:55.189216 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:39:55.191245 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: ROLLBACK
[0m13:39:55.192889 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: Close
[0m13:39:55.193661 [info ] [Thread-1 (]: 11 of 30 PASS not_null_stg_pipedrive__activity_due_time ........................ [[32mPASS[0m in 0.04s]
[0m13:39:55.194575 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:39:55.195228 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:39:55.195818 [info ] [Thread-1 (]: 12 of 30 START test not_null_stg_pipedrive__activity_id ........................ [RUN]
[0m13:39:55.196545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m13:39:55.197021 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:39:55.201415 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:39:55.202318 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:39:55.205438 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:39:55.206270 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:39:55.206871 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m13:39:55.207284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.224064 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:39:55.224730 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:39:55.225268 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m13:39:55.227983 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:39:55.229823 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m13:39:55.231283 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m13:39:55.232141 [info ] [Thread-1 (]: 12 of 30 PASS not_null_stg_pipedrive__activity_id .............................. [[32mPASS[0m in 0.04s]
[0m13:39:55.233178 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:39:55.233723 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:39:55.234291 [info ] [Thread-1 (]: 13 of 30 START test not_null_stg_pipedrive__activity_is_done ................... [RUN]
[0m13:39:55.235012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m13:39:55.235629 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:39:55.240790 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:39:55.241902 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:39:55.244682 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:39:55.245700 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:39:55.246155 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m13:39:55.246636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.264640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:39:55.265454 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:39:55.266080 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m13:39:55.268767 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:39:55.270649 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m13:39:55.272007 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m13:39:55.272719 [info ] [Thread-1 (]: 13 of 30 PASS not_null_stg_pipedrive__activity_is_done ......................... [[32mPASS[0m in 0.04s]
[0m13:39:55.273698 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:39:55.274260 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:39:55.274718 [info ] [Thread-1 (]: 14 of 30 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m13:39:55.275496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m13:39:55.275965 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:39:55.285435 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:39:55.286289 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:39:55.290886 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:39:55.291846 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:39:55.292308 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m13:39:55.292724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.314465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:39:55.315176 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:39:55.315775 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:39:55.321173 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:39:55.323460 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m13:39:55.325209 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m13:39:55.326148 [info ] [Thread-1 (]: 14 of 30 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.05s]
[0m13:39:55.327262 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:39:55.327915 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:39:55.328951 [info ] [Thread-1 (]: 15 of 30 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m13:39:55.329717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m13:39:55.330301 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:39:55.342009 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:39:55.342820 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:39:55.345149 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:39:55.346137 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:39:55.346813 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m13:39:55.347461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.365307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:39:55.366043 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:39:55.366721 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m13:39:55.371860 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:39:55.373709 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m13:39:55.375271 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m13:39:55.376072 [info ] [Thread-1 (]: 15 of 30 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.05s]
[0m13:39:55.376828 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:39:55.377349 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:39:55.377845 [info ] [Thread-1 (]: 16 of 30 START test not_null_stg_pipedrive__deal_changes_change_time ........... [RUN]
[0m13:39:55.378534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m13:39:55.379117 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:39:55.383588 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:39:55.384391 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:39:55.386811 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:39:55.387601 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:39:55.388040 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m13:39:55.388445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.407015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:39:55.407610 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:39:55.408057 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m13:39:55.411326 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:39:55.413812 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m13:39:55.415682 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m13:39:55.416783 [info ] [Thread-1 (]: 16 of 30 PASS not_null_stg_pipedrive__deal_changes_change_time ................. [[32mPASS[0m in 0.04s]
[0m13:39:55.418333 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:39:55.419124 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:39:55.419882 [info ] [Thread-1 (]: 17 of 30 START test not_null_stg_pipedrive__deal_changes_deal_id ............... [RUN]
[0m13:39:55.420813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d)
[0m13:39:55.421627 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:39:55.429601 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:39:55.430699 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:39:55.433439 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:39:55.434250 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:39:55.434698 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: BEGIN
[0m13:39:55.435100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.453991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:39:55.454631 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:39:55.455102 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where deal_id is null



      
    ) dbt_internal_test
[0m13:39:55.458303 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:39:55.460029 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: ROLLBACK
[0m13:39:55.461701 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: Close
[0m13:39:55.462561 [info ] [Thread-1 (]: 17 of 30 PASS not_null_stg_pipedrive__deal_changes_deal_id ..................... [[32mPASS[0m in 0.04s]
[0m13:39:55.463450 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:39:55.463968 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:39:55.464523 [info ] [Thread-1 (]: 18 of 30 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m13:39:55.465319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m13:39:55.465842 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:39:55.470115 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:39:55.470886 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:39:55.473563 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:39:55.474372 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:39:55.474815 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m13:39:55.475227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.493218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:39:55.494030 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:39:55.494550 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m13:39:55.498565 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:39:55.501606 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m13:39:55.503266 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m13:39:55.504225 [info ] [Thread-1 (]: 18 of 30 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m13:39:55.505208 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:39:55.505778 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:39:55.506376 [info ] [Thread-1 (]: 19 of 30 START test assert_change_user_references_user_id ...................... [RUN]
[0m13:39:55.507459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m13:39:55.507946 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:39:55.510846 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:39:55.511644 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:39:55.514287 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:39:55.515102 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:39:55.515535 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m13:39:55.515933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.536083 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:39:55.537029 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:39:55.537666 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:39:55.544680 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:39:55.547172 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m13:39:55.548921 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m13:39:55.549753 [info ] [Thread-1 (]: 19 of 30 PASS assert_change_user_references_user_id ............................ [[32mPASS[0m in 0.04s]
[0m13:39:55.550815 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:39:55.551529 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:39:55.552059 [info ] [Thread-1 (]: 20 of 30 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m13:39:55.552934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m13:39:55.553593 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:39:55.558573 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:39:55.559385 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:39:55.563890 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:39:55.564679 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:39:55.565100 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m13:39:55.565499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.583909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:39:55.584710 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:39:55.585199 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m13:39:55.587381 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:39:55.589106 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m13:39:55.590780 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m13:39:55.591549 [info ] [Thread-1 (]: 20 of 30 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m13:39:55.592481 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:39:55.593110 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:39:55.594048 [info ] [Thread-1 (]: 21 of 30 START test not_null_stg_pipedrive__users_modified_time ................ [RUN]
[0m13:39:55.594914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5)
[0m13:39:55.595462 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:39:55.600139 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:39:55.601193 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:39:55.604169 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:39:55.605168 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:39:55.605649 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: BEGIN
[0m13:39:55.606049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.627787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m13:39:55.628675 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:39:55.629208 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_time is null



      
    ) dbt_internal_test
[0m13:39:55.631861 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:39:55.633927 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: ROLLBACK
[0m13:39:55.635684 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: Close
[0m13:39:55.636419 [info ] [Thread-1 (]: 21 of 30 PASS not_null_stg_pipedrive__users_modified_time ...................... [[32mPASS[0m in 0.04s]
[0m13:39:55.637463 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:39:55.637998 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:39:55.638444 [info ] [Thread-1 (]: 22 of 30 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m13:39:55.639102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m13:39:55.639620 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:39:55.644311 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:39:55.645139 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:39:55.647763 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:39:55.648603 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:39:55.649040 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m13:39:55.649436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.667405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:39:55.668168 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:39:55.668803 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m13:39:55.671872 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:39:55.673917 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m13:39:55.675576 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m13:39:55.676332 [info ] [Thread-1 (]: 22 of 30 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m13:39:55.677082 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:39:55.677598 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:39:55.678032 [info ] [Thread-1 (]: 23 of 30 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m13:39:55.678862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m13:39:55.679615 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:39:55.684174 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:39:55.684984 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:39:55.687415 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:39:55.688550 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:39:55.689249 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m13:39:55.689766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.708455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:39:55.709499 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:39:55.710221 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m13:39:55.713902 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:39:55.716376 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m13:39:55.718608 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m13:39:55.719863 [info ] [Thread-1 (]: 23 of 30 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m13:39:55.721465 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:39:55.722308 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:39:55.723392 [info ] [Thread-1 (]: 24 of 30 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m13:39:55.724625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m13:39:55.725191 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:39:55.734617 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:39:55.735473 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:39:55.737996 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:39:55.738922 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:39:55.739447 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m13:39:55.740206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.759108 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:39:55.759950 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:39:55.760720 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:39:55.765226 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:39:55.767031 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m13:39:55.768470 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m13:39:55.769435 [info ] [Thread-1 (]: 24 of 30 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m13:39:55.770319 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:39:55.770850 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:39:55.771447 [info ] [Thread-1 (]: 25 of 30 START test assert_change_stage_references_lost_reason_id .............. [RUN]
[0m13:39:55.772322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m13:39:55.772786 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:39:55.776138 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:39:55.777174 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:39:55.780107 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:39:55.781059 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:39:55.781579 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m13:39:55.781977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.800784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:39:55.801752 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:39:55.802397 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:39:55.807457 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:39:55.809211 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m13:39:55.810808 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m13:39:55.811656 [info ] [Thread-1 (]: 25 of 30 PASS assert_change_stage_references_lost_reason_id .................... [[32mPASS[0m in 0.04s]
[0m13:39:55.812734 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:39:55.813457 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:39:55.814182 [info ] [Thread-1 (]: 26 of 30 START test assert_change_stage_references_stage_id .................... [RUN]
[0m13:39:55.814821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m13:39:55.815263 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:39:55.817965 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:39:55.818794 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:39:55.821312 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:39:55.822122 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:39:55.822555 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m13:39:55.822948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.841681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:39:55.842507 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:39:55.843016 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:39:55.850060 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:39:55.851866 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m13:39:55.853373 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m13:39:55.854110 [info ] [Thread-1 (]: 26 of 30 PASS assert_change_stage_references_stage_id .......................... [[32mPASS[0m in 0.04s]
[0m13:39:55.854966 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:39:55.855536 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:39:55.856142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now model.enpal_assessment_project.int_activity_join_activity_types)
[0m13:39:55.857082 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:39:55.863245 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity_join_activity_types"
[0m13:39:55.864391 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:39:55.864894 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:39:55.865506 [info ] [Thread-1 (]: 27 of 30 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_new_deals  [RUN]
[0m13:39:55.866348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activity_join_activity_types, now model.enpal_assessment_project.int_deal_changes_dedupe_new_deals)
[0m13:39:55.866790 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:39:55.869562 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:55.870341 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:39:55.875832 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:55.876996 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:55.877703 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: BEGIN
[0m13:39:55.878121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.904150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m13:39:55.904875 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:55.905463 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_tmp"
    
    
  as (
    -- Separate new deals model from the deal_changes model
-- There are a handful of dupe deals in the deal_changes model (assumption - deals should not have more than one added date)
-- Materialize as a view so it can be tested for deduplication
SELECT
	deal_id, 
	MAX(change_time)
FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
WHERE changed_field_key = 'add_time'
GROUP BY deal_id
  );
[0m13:39:55.911419 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:39:55.915129 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:55.915619 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_tmp" rename to "int_deal_changes_dedupe_new_deals"
[0m13:39:55.917359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:55.919274 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: COMMIT
[0m13:39:55.919725 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:55.920133 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: COMMIT
[0m13:39:55.923471 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:39:55.926080 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_backup"
[0m13:39:55.926909 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:39:55.927432 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
drop view if exists "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_backup" cascade
[0m13:39:55.929015 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:39:55.930627 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: Close
[0m13:39:55.931217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8f0c50>]}
[0m13:39:55.931977 [info ] [Thread-1 (]: 27 of 30 OK created sql view model public_pipedrive_analytics.int_deal_changes_dedupe_new_deals  [[32mCREATE VIEW[0m in 0.06s]
[0m13:39:55.932747 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:39:55.933260 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:39:55.934014 [info ] [Thread-1 (]: 28 of 30 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_stage  [RUN]
[0m13:39:55.934624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_new_deals, now model.enpal_assessment_project.int_deal_changes_dedupe_stage)
[0m13:39:55.935071 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:39:55.937793 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:39:55.938569 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:39:55.943186 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:39:55.944124 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:39:55.944586 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: BEGIN
[0m13:39:55.944987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:55.961768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:39:55.962417 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:39:55.962907 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_tmp"
    
    
  as (
    -- Separate new deals model from the deal_changes model
-- There are a handful of dupe deals in the deal_changes model (assumption - deals should not have more of each stage id)
-- Materialize as a view so it can be tested for deduplication
-- Method: row_number in reverse order and then pick the first row. 
-- This pattern is better because we don't know how many duplicate rows there could be, but the latest will always be row number 1.
-- Can't just take MAX(new_value) as was done for new_deals, because there are multiple stage_ids and all that appear need to be presented to the model.
WITH deal_changes_stage AS (
	SELECT
		ROW_NUMBER() OVER(PARTITION BY deal_id, new_value ORDER BY new_value, change_time DESC) AS reverse_order,
		deal_id,
		new_value AS stage_id,
		change_time
	FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'stage_id'
)
SELECT * FROM deal_changes_stage WHERE reverse_order = 1
  );
[0m13:39:55.966663 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:39:55.970064 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:39:55.970558 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_tmp" rename to "int_deal_changes_dedupe_stage"
[0m13:39:55.972316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:55.974507 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: COMMIT
[0m13:39:55.975008 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:39:55.975423 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: COMMIT
[0m13:39:55.977228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:39:55.979847 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_backup"
[0m13:39:55.980904 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:39:55.981380 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */
drop view if exists "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_backup" cascade
[0m13:39:55.982774 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:39:55.984358 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: Close
[0m13:39:55.984978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f61b78-60f9-4820-8b87-5850470fb549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a06b5f0>]}
[0m13:39:55.985659 [info ] [Thread-1 (]: 28 of 30 OK created sql view model public_pipedrive_analytics.int_deal_changes_dedupe_stage  [[32mCREATE VIEW[0m in 0.05s]
[0m13:39:55.986477 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:39:55.987014 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:39:55.987515 [info ] [Thread-1 (]: 29 of 30 START test unique_int_deal_changes_dedupe_new_deals_deal_id ........... [RUN]
[0m13:39:55.988220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_stage, now test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7)
[0m13:39:55.988711 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:39:55.995626 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:39:55.996456 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:39:55.998813 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:39:55.999616 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:39:56.000065 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: BEGIN
[0m13:39:56.000452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:56.019851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:39:56.020641 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:39:56.021128 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    deal_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals"
where deal_id is not null
group by deal_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:39:56.027844 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:39:56.029672 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: ROLLBACK
[0m13:39:56.031157 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: Close
[0m13:39:56.031930 [info ] [Thread-1 (]: 29 of 30 PASS unique_int_deal_changes_dedupe_new_deals_deal_id ................. [[32mPASS[0m in 0.04s]
[0m13:39:56.032863 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:39:56.033561 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93
[0m13:39:56.034236 [info ] [Thread-1 (]: 30 of 30 START test unique_int_deal_changes_dedupe_stage_deal_id ............... [RUN]
[0m13:39:56.035234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7, now test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93)
[0m13:39:56.035794 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93
[0m13:39:56.043060 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93"
[0m13:39:56.044000 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93
[0m13:39:56.046546 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93"
[0m13:39:56.047599 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93"
[0m13:39:56.048082 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93: BEGIN
[0m13:39:56.048504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:56.066781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:39:56.067575 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93"
[0m13:39:56.068063 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    deal_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage"
where deal_id is not null
group by deal_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:39:56.084641 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m13:39:56.086647 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93: ROLLBACK
[0m13:39:56.088259 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93: Close
[0m13:39:56.089303 [error] [Thread-1 (]: 30 of 30 FAIL 1990 unique_int_deal_changes_dedupe_stage_deal_id ................ [[31mFAIL 1990[0m in 0.05s]
[0m13:39:56.090408 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93
[0m13:39:56.092049 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:56.092508 [debug] [MainThread]: On master: BEGIN
[0m13:39:56.092922 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:56.111788 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m13:39:56.112522 [debug] [MainThread]: On master: COMMIT
[0m13:39:56.113076 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:56.113488 [debug] [MainThread]: On master: COMMIT
[0m13:39:56.115033 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:39:56.115457 [debug] [MainThread]: On master: Close
[0m13:39:56.115951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:56.116296 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_int_deal_changes_dedupe_stage_deal_id.aae48fad93' was properly closed.
[0m13:39:56.116817 [info ] [MainThread]: 
[0m13:39:56.117318 [info ] [MainThread]: Finished running 10 view models, 20 data tests in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m13:39:56.124318 [debug] [MainThread]: Command end result
[0m13:39:56.161112 [info ] [MainThread]: 
[0m13:39:56.161743 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:39:56.162127 [info ] [MainThread]: 
[0m13:39:56.162592 [error] [MainThread]: [31mFailure in test unique_int_deal_changes_dedupe_stage_deal_id (models/intermediate/schema.yml)[0m
[0m13:39:56.163054 [error] [MainThread]:   Got 1990 results, configured to fail if != 0
[0m13:39:56.163414 [info ] [MainThread]: 
[0m13:39:56.163844 [info ] [MainThread]:   compiled code at target/compiled/enpal_assessment_project/models/intermediate/schema.yml/unique_int_deal_changes_dedupe_stage_deal_id.sql
[0m13:39:56.164294 [info ] [MainThread]: 
[0m13:39:56.164718 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=1 SKIP=0 TOTAL=30
[0m13:39:56.166983 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.4376915, "process_in_blocks": "0", "process_kernel_time": 0.590645, "process_mem_max_rss": "117604352", "process_out_blocks": "0", "process_user_time": 4.101837}
[0m13:39:56.167723 [debug] [MainThread]: Command `dbt build` failed at 13:39:56.167584 after 3.44 seconds
[0m13:39:56.168226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10556ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087515b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a14c800>]}
[0m13:39:56.168675 [debug] [MainThread]: Flushing usage events
[0m13:44:42.900605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9ef60>]}


============================== 13:44:42.908161 | 24d6204c-866b-4fd2-8ec8-ab9120f2572f ==============================
[0m13:44:42.908161 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:44:42.908998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:44:43.183680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e5a210>]}
[0m13:44:43.250200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9f1a0>]}
[0m13:44:43.252236 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:44:43.396036 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:44:43.609767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:44:43.610567 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://tests/assert_unique_deal_stage.sql
[0m13:44:43.611198 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/intermediate/schema.yml
[0m13:44:44.026984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108df0d70>]}
[0m13:44:44.200969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bbb230>]}
[0m13:44:44.201592 [info ] [MainThread]: Found 20 data tests, 11 models, 6 sources, 428 macros
[0m13:44:44.205824 [info ] [MainThread]: 
[0m13:44:44.206630 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:44:44.211688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:44:44.288248 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:44:44.288747 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:44:44.289166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:44.321998 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.033 seconds
[0m13:44:44.323664 [debug] [ThreadPool]: On list_postgres: Close
[0m13:44:44.326080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:44:44.332791 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:44:44.333243 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m13:44:44.333586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:44.349688 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m13:44:44.350244 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:44:44.350711 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:44:44.354609 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m13:44:44.356326 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:44:44.357580 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:44:44.364604 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:44.365079 [debug] [MainThread]: On master: BEGIN
[0m13:44:44.365417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:44.381614 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m13:44:44.382247 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:44.382713 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:44:44.387508 [debug] [MainThread]: SQL status: SELECT 10 in 0.004 seconds
[0m13:44:44.390090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109498fb0>]}
[0m13:44:44.390574 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:44.391885 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:44.392313 [debug] [MainThread]: On master: BEGIN
[0m13:44:44.394357 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:44:44.394875 [debug] [MainThread]: On master: COMMIT
[0m13:44:44.395359 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:44.395718 [debug] [MainThread]: On master: COMMIT
[0m13:44:44.397165 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:44:44.397615 [debug] [MainThread]: On master: Close
[0m13:44:44.398151 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:44:44.398595 [info ] [MainThread]: 
[0m13:44:44.401974 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m13:44:44.402700 [info ] [Thread-1 (]: 1 of 30 START sql view model public_pipedrive_analytics.base_pipedrive__fields . [RUN]
[0m13:44:44.403352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m13:44:44.403825 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m13:44:44.414259 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:44:44.415276 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m13:44:44.457914 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:44:44.458848 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:44:44.459283 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m13:44:44.459697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:44.476190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:44:44.476813 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:44:44.477276 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m13:44:44.479728 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:44:44.486885 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:44:44.487399 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m13:44:44.489477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:44:44.492949 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:44:44.493497 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m13:44:44.495742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:44:44.515959 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m13:44:44.516512 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:44:44.516932 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m13:44:44.522598 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:44:44.531783 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m13:44:44.538036 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:44:44.538579 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m13:44:44.542210 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:44:44.546050 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m13:44:44.548147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10956dc70>]}
[0m13:44:44.548970 [info ] [Thread-1 (]: 1 of 30 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m13:44:44.549832 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m13:44:44.550396 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:44:44.550951 [info ] [Thread-1 (]: 2 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__activity  [RUN]
[0m13:44:44.551586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m13:44:44.552120 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:44:44.555011 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:44.555798 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:44:44.559886 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:44.560953 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:44.561447 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m13:44:44.561861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:44.580094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:44:44.581085 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:44.581684 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to::TIMESTAMP AS due_time
FROM "postgres"."public"."activity"
  );
[0m13:44:44.585725 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:44:44.589020 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:44.589486 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m13:44:44.591322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:44.594710 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:44.595189 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m13:44:44.598023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:44:44.600500 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:44:44.601023 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:44.601454 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:44:44.603399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:44:44.606111 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m13:44:44.607054 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:44:44.607492 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m13:44:44.609963 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:44:44.611611 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m13:44:44.612266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109489820>]}
[0m13:44:44.612999 [info ] [Thread-1 (]: 2 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m13:44:44.613866 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:44:44.614695 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:44:44.616253 [info ] [Thread-1 (]: 3 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m13:44:44.617028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m13:44:44.617487 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:44:44.620241 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:44:44.621120 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:44:44.627101 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:44:44.628069 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:44:44.628538 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m13:44:44.628945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:44.646367 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:44:44.647299 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:44:44.647971 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS activity_is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m13:44:44.651574 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:44:44.655058 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:44:44.655580 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m13:44:44.657275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:44.660581 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:44:44.661041 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m13:44:44.664048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:44:44.666209 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:44:44.666691 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:44:44.667122 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:44:44.670013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:44:44.674437 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m13:44:44.675467 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:44:44.676014 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m13:44:44.679589 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:44:44.681600 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m13:44:44.682354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ca5d0>]}
[0m13:44:44.683164 [info ] [Thread-1 (]: 3 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.07s]
[0m13:44:44.684019 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:44:44.684639 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:44:44.685919 [info ] [Thread-1 (]: 4 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m13:44:44.686719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m13:44:44.687421 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:44:44.691647 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:44:44.692511 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:44:44.698401 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:44:44.700507 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:44:44.701360 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m13:44:44.702162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:44.721248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:44:44.721861 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:44:44.722406 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- This is not a source deals table, and deal_id is not a PK (UNIQUE), so leave deal_id named as is
SELECT
    deal_id,
    change_time::TIMESTAMP AS change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m13:44:44.724916 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:44:44.728777 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:44:44.729471 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m13:44:44.732141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:44:44.735877 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:44:44.736371 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m13:44:44.737930 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:44.740002 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:44:44.740493 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:44:44.740907 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:44:44.742823 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:44:44.745547 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m13:44:44.746376 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:44:44.746805 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m13:44:44.750883 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:44:44.752518 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m13:44:44.753147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c94f0>]}
[0m13:44:44.753842 [info ] [Thread-1 (]: 4 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.07s]
[0m13:44:44.754598 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:44:44.755143 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:44:44.755869 [info ] [Thread-1 (]: 5 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__stages .. [RUN]
[0m13:44:44.756605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m13:44:44.757055 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:44:44.759941 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:44:44.760716 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:44:44.764940 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:44:44.765872 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:44:44.766346 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m13:44:44.767815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:44.788335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:44:44.789066 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:44:44.789566 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m13:44:44.792031 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:44:44.795377 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:44:44.795853 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m13:44:44.797763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:44.801096 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:44:44.801541 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m13:44:44.803839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:44:44.805901 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:44:44.806451 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:44:44.806958 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:44:44.809119 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:44:44.812083 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m13:44:44.812966 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:44:44.813420 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m13:44:44.817133 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:44:44.818777 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m13:44:44.819365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10949e600>]}
[0m13:44:44.820093 [info ] [Thread-1 (]: 5 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m13:44:44.820843 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:44:44.821378 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:44:44.822216 [info ] [Thread-1 (]: 6 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__users ... [RUN]
[0m13:44:44.822923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m13:44:44.823385 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m13:44:44.826464 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:44:44.827433 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m13:44:44.835863 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:44:44.836799 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:44:44.837227 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m13:44:44.837621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:44.855090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:44:44.855755 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:44:44.856248 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified::TIMESTAMP AS modified_time
FROM "postgres"."public"."users"
  );
[0m13:44:44.858797 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:44:44.862117 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:44:44.862576 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m13:44:44.864372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:44.867842 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:44:44.868348 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m13:44:44.870336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:44.872356 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:44:44.872917 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:44:44.873363 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:44:44.875273 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:44:44.878009 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m13:44:44.878837 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:44:44.879270 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m13:44:44.882865 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:44:44.884622 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m13:44:44.885400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095abfe0>]}
[0m13:44:44.886214 [info ] [Thread-1 (]: 6 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m13:44:44.887179 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:44:44.888003 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:44:44.888961 [info ] [Thread-1 (]: 7 of 30 START test assert_timestamp_equal_add_time_new_value ................... [RUN]
[0m13:44:44.889842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value)
[0m13:44:44.890358 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:44:44.893462 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:44:44.894683 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:44:44.917717 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:44:44.918688 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:44:44.919199 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: BEGIN
[0m13:44:44.919622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:44.935692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:44:44.936344 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:44:44.936811 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Assert that the change_time is equal to the new_value when the changed_field_key is 'add_time'
-- With this test, it's OK to ignore the new_value field for add_time changes
SELECT * FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'add_time'
	AND change_time != new_value::TIMESTAMP
      
    ) dbt_internal_test
[0m13:44:44.942000 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:44:44.945627 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: ROLLBACK
[0m13:44:44.947410 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: Close
[0m13:44:44.948359 [info ] [Thread-1 (]: 7 of 30 PASS assert_timestamp_equal_add_time_new_value ......................... [[32mPASS[0m in 0.06s]
[0m13:44:44.949798 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:44:44.950390 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:44:44.950998 [info ] [Thread-1 (]: 8 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m13:44:44.952050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m13:44:44.952696 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:44:44.957576 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:44:44.958920 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:44:44.963852 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:44:44.965125 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:44:44.965936 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m13:44:44.966421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:44.987969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:44:44.988633 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:44:44.989218 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m13:44:44.992297 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:44:44.995495 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:44:44.995948 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m13:44:44.998656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:44:45.000631 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m13:44:45.001074 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:44:45.001485 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m13:44:45.003574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:44:45.006304 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m13:44:45.007287 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:44:45.007736 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m13:44:45.009266 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:44:45.010840 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m13:44:45.011431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fd4f0>]}
[0m13:44:45.012124 [info ] [Thread-1 (]: 8 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.06s]
[0m13:44:45.012941 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:44:45.013517 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:44:45.014792 [info ] [Thread-1 (]: 9 of 30 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m13:44:45.016311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m13:44:45.016877 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:44:45.021204 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:44:45.022256 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:44:45.027852 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:44:45.028797 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:44:45.029277 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m13:44:45.029685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.052164 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m13:44:45.052875 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:44:45.053392 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m13:44:45.056544 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:44:45.125927 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:44:45.126618 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m13:44:45.128864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:44:45.131370 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m13:44:45.132058 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:44:45.132648 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m13:44:45.135265 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:44:45.138840 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m13:44:45.139988 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:44:45.140543 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m13:44:45.142519 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:44:45.144398 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m13:44:45.145128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109613f20>]}
[0m13:44:45.145964 [info ] [Thread-1 (]: 9 of 30 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.13s]
[0m13:44:45.146812 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:44:45.147808 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:44:45.148933 [info ] [Thread-1 (]: 10 of 30 START test not_null_stg_pipedrive__activity_deal_id ................... [RUN]
[0m13:44:45.149903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_stages, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m13:44:45.150476 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:44:45.166176 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:44:45.167981 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:44:45.171020 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:44:45.171930 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:44:45.172381 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m13:44:45.172792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.190289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:44:45.191114 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:44:45.191719 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m13:44:45.194765 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:44:45.196711 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m13:44:45.198315 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m13:44:45.199125 [info ] [Thread-1 (]: 10 of 30 PASS not_null_stg_pipedrive__activity_deal_id ......................... [[32mPASS[0m in 0.05s]
[0m13:44:45.200018 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:44:45.200598 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:44:45.201225 [info ] [Thread-1 (]: 11 of 30 START test not_null_stg_pipedrive__activity_due_time .................. [RUN]
[0m13:44:45.202464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191)
[0m13:44:45.203356 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:44:45.210063 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:44:45.211040 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:44:45.213443 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:44:45.214428 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:44:45.215051 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: BEGIN
[0m13:44:45.215696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.237349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m13:44:45.238097 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:44:45.238560 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_time is null



      
    ) dbt_internal_test
[0m13:44:45.241076 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:44:45.242996 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: ROLLBACK
[0m13:44:45.245621 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: Close
[0m13:44:45.246437 [info ] [Thread-1 (]: 11 of 30 PASS not_null_stg_pipedrive__activity_due_time ........................ [[32mPASS[0m in 0.04s]
[0m13:44:45.248023 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:44:45.249118 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:44:45.249971 [info ] [Thread-1 (]: 12 of 30 START test not_null_stg_pipedrive__activity_id ........................ [RUN]
[0m13:44:45.250611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m13:44:45.251084 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:44:45.255638 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:44:45.256507 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:44:45.258845 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:44:45.259627 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:44:45.260135 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m13:44:45.260632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.281171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:44:45.282230 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:44:45.283380 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m13:44:45.287768 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:44:45.289941 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m13:44:45.291761 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m13:44:45.292554 [info ] [Thread-1 (]: 12 of 30 PASS not_null_stg_pipedrive__activity_id .............................. [[32mPASS[0m in 0.04s]
[0m13:44:45.293367 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:44:45.293903 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:44:45.294462 [info ] [Thread-1 (]: 13 of 30 START test not_null_stg_pipedrive__activity_is_done ................... [RUN]
[0m13:44:45.295285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m13:44:45.295922 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:44:45.303054 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:44:45.303957 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:44:45.306483 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:44:45.307265 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:44:45.307690 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m13:44:45.308087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.325463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:44:45.326189 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:44:45.326663 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m13:44:45.329457 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:44:45.331689 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m13:44:45.334911 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m13:44:45.335806 [info ] [Thread-1 (]: 13 of 30 PASS not_null_stg_pipedrive__activity_is_done ......................... [[32mPASS[0m in 0.04s]
[0m13:44:45.336653 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:44:45.337203 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:44:45.337667 [info ] [Thread-1 (]: 14 of 30 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m13:44:45.338505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m13:44:45.338995 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:44:45.348967 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:44:45.350506 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:44:45.355522 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:44:45.356458 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:44:45.356913 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m13:44:45.357333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.375949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:44:45.376549 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:44:45.377041 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:44:45.381533 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:44:45.384079 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m13:44:45.385952 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m13:44:45.386848 [info ] [Thread-1 (]: 14 of 30 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.05s]
[0m13:44:45.387671 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:44:45.388228 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:44:45.388865 [info ] [Thread-1 (]: 15 of 30 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m13:44:45.389543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m13:44:45.390058 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:44:45.401654 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:44:45.402540 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:44:45.405242 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:44:45.406180 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:44:45.406645 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m13:44:45.407060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.427672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:44:45.428387 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:44:45.428874 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m13:44:45.433996 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:44:45.435823 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m13:44:45.437415 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m13:44:45.438214 [info ] [Thread-1 (]: 15 of 30 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.05s]
[0m13:44:45.439226 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:44:45.439811 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:44:45.440293 [info ] [Thread-1 (]: 16 of 30 START test not_null_stg_pipedrive__deal_changes_change_time ........... [RUN]
[0m13:44:45.441008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m13:44:45.441501 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:44:45.445828 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:44:45.446724 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:44:45.449486 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:44:45.450477 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:44:45.450948 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m13:44:45.451442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.469895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:44:45.470532 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:44:45.471015 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m13:44:45.474008 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:44:45.475748 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m13:44:45.477156 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m13:44:45.477873 [info ] [Thread-1 (]: 16 of 30 PASS not_null_stg_pipedrive__deal_changes_change_time ................. [[32mPASS[0m in 0.04s]
[0m13:44:45.478678 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:44:45.479232 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:44:45.479683 [info ] [Thread-1 (]: 17 of 30 START test not_null_stg_pipedrive__deal_changes_deal_id ............... [RUN]
[0m13:44:45.480644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d)
[0m13:44:45.481239 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:44:45.485891 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:44:45.486755 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:44:45.489167 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:44:45.490010 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:44:45.490625 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: BEGIN
[0m13:44:45.491166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.508562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:44:45.509294 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:44:45.509811 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where deal_id is null



      
    ) dbt_internal_test
[0m13:44:45.512859 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:44:45.515091 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: ROLLBACK
[0m13:44:45.516657 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: Close
[0m13:44:45.517534 [info ] [Thread-1 (]: 17 of 30 PASS not_null_stg_pipedrive__deal_changes_deal_id ..................... [[32mPASS[0m in 0.04s]
[0m13:44:45.518518 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:44:45.519062 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:44:45.519577 [info ] [Thread-1 (]: 18 of 30 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m13:44:45.520159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m13:44:45.520633 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:44:45.525007 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:44:45.526007 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:44:45.528580 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:44:45.529428 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:44:45.530212 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m13:44:45.530848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.548497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:44:45.549220 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:44:45.549674 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m13:44:45.552818 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:44:45.554577 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m13:44:45.556167 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m13:44:45.556916 [info ] [Thread-1 (]: 18 of 30 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m13:44:45.557660 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:44:45.558308 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:44:45.558868 [info ] [Thread-1 (]: 19 of 30 START test assert_change_user_references_user_id ...................... [RUN]
[0m13:44:45.559901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m13:44:45.560405 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:44:45.564058 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:44:45.564933 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:44:45.567442 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:44:45.568234 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:44:45.568679 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m13:44:45.569081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.585945 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:44:45.586903 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:44:45.587569 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:44:45.592908 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:44:45.594825 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m13:44:45.596436 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m13:44:45.598265 [info ] [Thread-1 (]: 19 of 30 PASS assert_change_user_references_user_id ............................ [[32mPASS[0m in 0.04s]
[0m13:44:45.599978 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:44:45.601078 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:44:45.602220 [info ] [Thread-1 (]: 20 of 30 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m13:44:45.603503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m13:44:45.604511 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:44:45.610349 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:44:45.611203 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:44:45.617108 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:44:45.617986 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:44:45.618444 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m13:44:45.618890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.638184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:44:45.638847 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:44:45.639320 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m13:44:45.641568 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:44:45.643320 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m13:44:45.644873 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m13:44:45.645691 [info ] [Thread-1 (]: 20 of 30 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m13:44:45.646770 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:44:45.647772 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:44:45.648716 [info ] [Thread-1 (]: 21 of 30 START test not_null_stg_pipedrive__users_modified_time ................ [RUN]
[0m13:44:45.649586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5)
[0m13:44:45.650138 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:44:45.654582 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:44:45.655451 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:44:45.657990 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:44:45.658894 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:44:45.659335 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: BEGIN
[0m13:44:45.659748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.677034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:44:45.677817 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:44:45.678471 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_time is null



      
    ) dbt_internal_test
[0m13:44:45.681460 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:44:45.683554 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: ROLLBACK
[0m13:44:45.685265 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: Close
[0m13:44:45.686295 [info ] [Thread-1 (]: 21 of 30 PASS not_null_stg_pipedrive__users_modified_time ...................... [[32mPASS[0m in 0.04s]
[0m13:44:45.687229 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:44:45.687775 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:44:45.688292 [info ] [Thread-1 (]: 22 of 30 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m13:44:45.689027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m13:44:45.689492 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:44:45.694016 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:44:45.695094 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:44:45.698286 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:44:45.699239 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:44:45.699684 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m13:44:45.700085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.720783 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:44:45.721493 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:44:45.722028 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m13:44:45.725071 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:44:45.726871 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m13:44:45.728331 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m13:44:45.729078 [info ] [Thread-1 (]: 22 of 30 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m13:44:45.729849 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:44:45.730481 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:44:45.731138 [info ] [Thread-1 (]: 23 of 30 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m13:44:45.732053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m13:44:45.732569 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:44:45.738099 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:44:45.739241 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:44:45.744039 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:44:45.745164 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:44:45.745651 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m13:44:45.746108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.771391 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m13:44:45.772411 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:44:45.773246 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m13:44:45.777937 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:44:45.782217 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m13:44:45.784401 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m13:44:45.785285 [info ] [Thread-1 (]: 23 of 30 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.05s]
[0m13:44:45.787234 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:44:45.787951 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:44:45.788577 [info ] [Thread-1 (]: 24 of 30 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m13:44:45.789297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m13:44:45.789905 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:44:45.796284 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:44:45.797355 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:44:45.799965 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:44:45.800815 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:44:45.801278 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m13:44:45.801691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.820320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:44:45.821050 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:44:45.821552 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:44:45.825693 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:44:45.827515 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m13:44:45.828992 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m13:44:45.829719 [info ] [Thread-1 (]: 24 of 30 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m13:44:45.830713 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:44:45.831255 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:44:45.831706 [info ] [Thread-1 (]: 25 of 30 START test assert_change_stage_references_lost_reason_id .............. [RUN]
[0m13:44:45.832494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m13:44:45.833013 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:44:45.836469 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:44:45.837367 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:44:45.840426 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:44:45.841366 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:44:45.841902 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m13:44:45.842339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.860002 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:44:45.860571 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:44:45.861063 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:44:45.867556 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:44:45.869404 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m13:44:45.870845 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m13:44:45.871628 [info ] [Thread-1 (]: 25 of 30 PASS assert_change_stage_references_lost_reason_id .................... [[32mPASS[0m in 0.04s]
[0m13:44:45.872492 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:44:45.873025 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:44:45.873575 [info ] [Thread-1 (]: 26 of 30 START test assert_change_stage_references_stage_id .................... [RUN]
[0m13:44:45.874261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m13:44:45.874724 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:44:45.877485 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:44:45.878307 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:44:45.881192 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:44:45.882345 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:44:45.882838 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m13:44:45.883245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.901099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:44:45.901710 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:44:45.902285 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:44:45.908842 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:44:45.910656 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m13:44:45.912387 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m13:44:45.913204 [info ] [Thread-1 (]: 26 of 30 PASS assert_change_stage_references_stage_id .......................... [[32mPASS[0m in 0.04s]
[0m13:44:45.914426 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:44:45.915202 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:44:45.915852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now model.enpal_assessment_project.int_activity_join_activity_types)
[0m13:44:45.916361 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:44:45.922028 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity_join_activity_types"
[0m13:44:45.923290 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:44:45.924023 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:44:45.924824 [info ] [Thread-1 (]: 27 of 30 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_new_deals  [RUN]
[0m13:44:45.925522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activity_join_activity_types, now model.enpal_assessment_project.int_deal_changes_dedupe_new_deals)
[0m13:44:45.926101 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:44:45.929158 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:44:45.930071 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:44:45.934553 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:44:45.935473 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:44:45.935981 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: BEGIN
[0m13:44:45.936405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:45.956638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:44:45.957352 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:44:45.957833 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_tmp"
    
    
  as (
    -- Separate new deals model from the deal_changes model
-- There are a handful of dupe deals in the deal_changes model (assumption - deals should not have more than one added date)
-- Materialize as a view so it can be tested for deduplication
SELECT
	deal_id, 
	MAX(change_time)
FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
WHERE changed_field_key = 'add_time'
GROUP BY deal_id
  );
[0m13:44:45.961136 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:44:45.964873 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:44:45.965401 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_tmp" rename to "int_deal_changes_dedupe_new_deals"
[0m13:44:45.966995 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:45.969032 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: COMMIT
[0m13:44:45.969513 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:44:45.969943 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: COMMIT
[0m13:44:45.971886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:44:45.974490 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_backup"
[0m13:44:45.975323 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:44:45.975843 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
drop view if exists "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_backup" cascade
[0m13:44:45.977290 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:44:45.978933 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: Close
[0m13:44:45.979531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10840b350>]}
[0m13:44:45.980453 [info ] [Thread-1 (]: 27 of 30 OK created sql view model public_pipedrive_analytics.int_deal_changes_dedupe_new_deals  [[32mCREATE VIEW[0m in 0.05s]
[0m13:44:45.981667 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:44:45.982365 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:44:45.983093 [info ] [Thread-1 (]: 28 of 30 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_stage  [RUN]
[0m13:44:45.983736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_new_deals, now model.enpal_assessment_project.int_deal_changes_dedupe_stage)
[0m13:44:45.984207 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:44:45.987023 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:44:45.987800 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:44:45.991939 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:44:45.992788 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:44:45.993237 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: BEGIN
[0m13:44:45.993650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:46.011108 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:44:46.011843 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:44:46.012391 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_tmp"
    
    
  as (
    -- Separate new deals model from the deal_changes model
-- There are a handful of dupe deals in the deal_changes model (assumption - deals should not have more of each stage id)
-- Materialize as a view so it can be tested for deduplication
-- Method: row_number in reverse order and then pick the first row. 
-- This pattern is better because we don't know how many duplicate rows there could be, but the latest will always be row number 1.
-- Can't just take MAX(new_value) as was done for new_deals, because there are multiple stage_ids and all that appear need to be presented to the model.
WITH deal_changes_stage AS (
	SELECT
		ROW_NUMBER() OVER(PARTITION BY deal_id, new_value ORDER BY new_value, change_time DESC) AS reverse_order,
		deal_id,
		new_value AS stage_id,
		change_time
	FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'stage_id'
)
SELECT * FROM deal_changes_stage WHERE reverse_order = 1
  );
[0m13:44:46.016691 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:44:46.020035 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:44:46.020506 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_tmp" rename to "int_deal_changes_dedupe_stage"
[0m13:44:46.022094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:46.023826 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: COMMIT
[0m13:44:46.024293 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:44:46.024711 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: COMMIT
[0m13:44:46.026664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:44:46.029624 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_backup"
[0m13:44:46.030679 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:44:46.031160 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */
drop view if exists "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_backup" cascade
[0m13:44:46.032730 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:44:46.034374 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: Close
[0m13:44:46.034969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d6204c-866b-4fd2-8ec8-ab9120f2572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e7e00>]}
[0m13:44:46.035734 [info ] [Thread-1 (]: 28 of 30 OK created sql view model public_pipedrive_analytics.int_deal_changes_dedupe_stage  [[32mCREATE VIEW[0m in 0.05s]
[0m13:44:46.036482 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:44:46.037131 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:44:46.037734 [info ] [Thread-1 (]: 29 of 30 START test unique_int_deal_changes_dedupe_new_deals_deal_id ........... [RUN]
[0m13:44:46.038404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_stage, now test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7)
[0m13:44:46.038865 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:44:46.045809 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:44:46.047142 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:44:46.051042 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:44:46.052097 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:44:46.052612 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: BEGIN
[0m13:44:46.053057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:46.071249 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:44:46.072092 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:44:46.072603 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    deal_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals"
where deal_id is not null
group by deal_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:44:46.078849 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:44:46.081401 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: ROLLBACK
[0m13:44:46.083431 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: Close
[0m13:44:46.084199 [info ] [Thread-1 (]: 29 of 30 PASS unique_int_deal_changes_dedupe_new_deals_deal_id ................. [[32mPASS[0m in 0.05s]
[0m13:44:46.085057 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:44:46.085596 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:44:46.086141 [info ] [Thread-1 (]: 30 of 30 START test assert_unique_deal_stage ................................... [RUN]
[0m13:44:46.086816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7, now test.enpal_assessment_project.assert_unique_deal_stage)
[0m13:44:46.087327 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:44:46.092087 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:44:46.092985 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:44:46.095361 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:44:46.096243 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:44:46.096905 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: BEGIN
[0m13:44:46.097358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:46.116167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:44:46.116999 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:44:46.117687 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_unique_deal_stage"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    COUNT(*),
    deal_id,
    stage_id
FROM "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage"
GROUP BY
    deal_id,
    stage_id
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m13:44:46.136769 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m13:44:46.138618 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: ROLLBACK
[0m13:44:46.140170 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: Close
[0m13:44:46.141001 [info ] [Thread-1 (]: 30 of 30 PASS assert_unique_deal_stage ......................................... [[32mPASS[0m in 0.05s]
[0m13:44:46.141899 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:44:46.143443 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:46.143969 [debug] [MainThread]: On master: BEGIN
[0m13:44:46.144326 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:46.161368 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m13:44:46.161937 [debug] [MainThread]: On master: COMMIT
[0m13:44:46.162402 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:46.162764 [debug] [MainThread]: On master: COMMIT
[0m13:44:46.164309 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:44:46.164823 [debug] [MainThread]: On master: Close
[0m13:44:46.165466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:46.165870 [debug] [MainThread]: Connection 'test.enpal_assessment_project.assert_unique_deal_stage' was properly closed.
[0m13:44:46.166327 [info ] [MainThread]: 
[0m13:44:46.166762 [info ] [MainThread]: Finished running 10 view models, 20 data tests in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m13:44:46.173072 [debug] [MainThread]: Command end result
[0m13:44:46.216088 [info ] [MainThread]: 
[0m13:44:46.216653 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:46.217242 [info ] [MainThread]: 
[0m13:44:46.217757 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=0 SKIP=0 TOTAL=30
[0m13:44:46.220382 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.409886, "process_in_blocks": "0", "process_kernel_time": 0.626951, "process_mem_max_rss": "116613120", "process_out_blocks": "0", "process_user_time": 4.157115}
[0m13:44:46.221099 [debug] [MainThread]: Command `dbt build` succeeded at 13:44:46.220963 after 3.41 seconds
[0m13:44:46.221549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104413290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce2cc0>]}
[0m13:44:46.221974 [debug] [MainThread]: Flushing usage events
[0m13:51:27.041572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4e4440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a516ff0>]}


============================== 13:51:27.049862 | e046cc0f-09a2-4b6b-ad81-6c03fe05be90 ==============================
[0m13:51:27.049862 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:51:27.050815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m13:51:27.358311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b46b0>]}
[0m13:51:27.431388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b5a30>]}
[0m13:51:27.433332 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:51:27.611454 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:51:27.814077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:51:27.814851 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/intermediate/int_deal_changes_dedupe_lost_reason.sql
[0m13:51:27.815390 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/intermediate/schema.yml
[0m13:51:28.081759 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:51:28.082418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a651910>]}
[0m13:51:28.307629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaf1d30>]}
[0m13:51:28.491148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3ac590>]}
[0m13:51:28.492003 [info ] [MainThread]: Found 21 data tests, 12 models, 6 sources, 428 macros
[0m13:51:28.497293 [info ] [MainThread]: 
[0m13:51:28.498071 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:51:28.503660 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:51:28.582711 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:51:28.583208 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:51:28.583681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:28.641619 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.058 seconds
[0m13:51:28.643214 [debug] [ThreadPool]: On list_postgres: Close
[0m13:51:28.645449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:51:28.652102 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:51:28.652559 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m13:51:28.652902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:28.668284 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m13:51:28.668868 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:51:28.669490 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:51:28.673410 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m13:51:28.675077 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:51:28.676419 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:51:28.683895 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:28.684347 [debug] [MainThread]: On master: BEGIN
[0m13:51:28.684690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:28.701521 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m13:51:28.702142 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:28.702658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:51:28.707850 [debug] [MainThread]: SQL status: SELECT 10 in 0.005 seconds
[0m13:51:28.710517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b733d40>]}
[0m13:51:28.711035 [debug] [MainThread]: On master: ROLLBACK
[0m13:51:28.712521 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:28.712953 [debug] [MainThread]: On master: BEGIN
[0m13:51:28.714951 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:51:28.715560 [debug] [MainThread]: On master: COMMIT
[0m13:51:28.715966 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:28.716325 [debug] [MainThread]: On master: COMMIT
[0m13:51:28.717566 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:51:28.717974 [debug] [MainThread]: On master: Close
[0m13:51:28.718530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:51:28.718997 [info ] [MainThread]: 
[0m13:51:28.722432 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m13:51:28.723196 [info ] [Thread-1 (]: 1 of 32 START sql view model public_pipedrive_analytics.base_pipedrive__fields . [RUN]
[0m13:51:28.723932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m13:51:28.724415 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m13:51:28.734359 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:51:28.735207 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m13:51:28.777164 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:51:28.778799 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:51:28.779306 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m13:51:28.779710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:28.795840 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:51:28.796580 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:51:28.797047 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m13:51:28.799691 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:51:28.806605 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:51:28.807108 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m13:51:28.808779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:28.813271 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:51:28.813990 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m13:51:28.817293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:51:28.836354 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m13:51:28.836877 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:51:28.837292 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m13:51:28.840465 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:51:28.847574 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m13:51:28.853329 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:51:28.853845 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m13:51:28.857498 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:51:28.860383 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m13:51:28.862053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4026c0>]}
[0m13:51:28.862878 [info ] [Thread-1 (]: 1 of 32 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m13:51:28.863944 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m13:51:28.864645 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:51:28.865443 [info ] [Thread-1 (]: 2 of 32 START sql view model public_pipedrive_analytics.stg_pipedrive__activity  [RUN]
[0m13:51:28.866007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m13:51:28.866442 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:51:28.869415 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:51:28.870264 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:51:28.874152 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:51:28.874975 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:51:28.875403 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m13:51:28.875797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:28.895937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:51:28.896758 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:51:28.897238 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to::TIMESTAMP AS due_time
FROM "postgres"."public"."activity"
  );
[0m13:51:28.900121 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:51:28.903626 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:51:28.904120 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m13:51:28.905940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:28.909455 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:51:28.909980 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m13:51:28.911952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:28.914133 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:51:28.914880 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:51:28.915483 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:51:28.918806 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:51:28.922009 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m13:51:28.923054 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:51:28.923527 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m13:51:28.926309 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:51:28.927988 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m13:51:28.928674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc65f70>]}
[0m13:51:28.929514 [info ] [Thread-1 (]: 2 of 32 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m13:51:28.930436 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:51:28.931001 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:51:28.931853 [info ] [Thread-1 (]: 3 of 32 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m13:51:28.932666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m13:51:28.933139 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:51:28.936129 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:51:28.937574 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:51:28.941723 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:51:28.942648 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:51:28.943096 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m13:51:28.943506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:28.964766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:51:28.965796 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:51:28.966296 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS activity_is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m13:51:28.969387 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:51:28.972822 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:51:28.973332 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m13:51:28.975198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:28.979944 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:51:28.980488 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m13:51:28.982590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:51:28.984578 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:51:28.985030 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:51:28.985443 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:51:28.987919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:51:28.990730 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m13:51:28.991656 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:51:28.992126 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m13:51:28.994880 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:51:28.996628 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m13:51:28.997339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcc9490>]}
[0m13:51:28.998281 [info ] [Thread-1 (]: 3 of 32 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m13:51:28.999198 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:51:28.999843 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:51:29.000670 [info ] [Thread-1 (]: 4 of 32 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m13:51:29.001379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m13:51:29.001904 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:51:29.004765 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:51:29.005606 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:51:29.010670 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:51:29.011604 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:51:29.012098 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m13:51:29.012703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.032478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:51:29.033148 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:51:29.033747 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- This is not a source deals table, and deal_id is not a PK (UNIQUE), so leave deal_id named as is
SELECT
    deal_id,
    change_time::TIMESTAMP AS change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m13:51:29.036619 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:51:29.040014 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:51:29.040551 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m13:51:29.042473 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:29.046054 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:51:29.046588 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m13:51:29.048437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:29.050451 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:51:29.051076 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:51:29.051650 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:51:29.053787 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:51:29.056756 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m13:51:29.057707 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:51:29.058174 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m13:51:29.061681 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:51:29.063344 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m13:51:29.064020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbaf2f0>]}
[0m13:51:29.064794 [info ] [Thread-1 (]: 4 of 32 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m13:51:29.065640 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:51:29.066215 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:51:29.067270 [info ] [Thread-1 (]: 5 of 32 START sql view model public_pipedrive_analytics.stg_pipedrive__stages .. [RUN]
[0m13:51:29.067988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m13:51:29.068474 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:51:29.071586 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:51:29.072429 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:51:29.076948 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:51:29.079121 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:51:29.080014 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m13:51:29.080480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.098992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:51:29.099752 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:51:29.100228 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m13:51:29.102846 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:51:29.106235 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:51:29.106732 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m13:51:29.108348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:29.111622 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:51:29.112078 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m13:51:29.113753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:29.115919 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:51:29.116613 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:51:29.117101 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:51:29.119055 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:51:29.122630 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m13:51:29.123816 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:51:29.124324 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m13:51:29.128240 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:51:29.129952 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m13:51:29.130591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbaf2f0>]}
[0m13:51:29.131372 [info ] [Thread-1 (]: 5 of 32 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m13:51:29.132162 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:51:29.132749 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:51:29.133579 [info ] [Thread-1 (]: 6 of 32 START sql view model public_pipedrive_analytics.stg_pipedrive__users ... [RUN]
[0m13:51:29.134169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m13:51:29.134638 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m13:51:29.139389 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:51:29.140655 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m13:51:29.148046 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:51:29.149053 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:51:29.149506 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m13:51:29.149948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.170120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:51:29.171243 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:51:29.171703 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified::TIMESTAMP AS modified_time
FROM "postgres"."public"."users"
  );
[0m13:51:29.174502 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:51:29.177996 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:51:29.178476 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m13:51:29.180204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:29.183456 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:51:29.183909 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m13:51:29.185553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:29.187593 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:51:29.188153 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:51:29.188594 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:51:29.190723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:51:29.193441 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m13:51:29.194274 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:51:29.194701 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m13:51:29.197244 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:51:29.198856 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m13:51:29.199518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcec6b0>]}
[0m13:51:29.200282 [info ] [Thread-1 (]: 6 of 32 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.07s]
[0m13:51:29.201036 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:51:29.201581 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:51:29.202408 [info ] [Thread-1 (]: 7 of 32 START test assert_timestamp_equal_add_time_new_value ................... [RUN]
[0m13:51:29.203308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value)
[0m13:51:29.203925 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:51:29.205961 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:51:29.207266 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:51:29.228436 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:51:29.229362 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:51:29.229805 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: BEGIN
[0m13:51:29.230209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.245794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:51:29.246468 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:51:29.246934 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Assert that the change_time is equal to the new_value when the changed_field_key is 'add_time'
-- With this test, it's OK to ignore the new_value field for add_time changes
SELECT * FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'add_time'
	AND change_time != new_value::TIMESTAMP
      
    ) dbt_internal_test
[0m13:51:29.253155 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:51:29.256936 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: ROLLBACK
[0m13:51:29.258437 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: Close
[0m13:51:29.259447 [info ] [Thread-1 (]: 7 of 32 PASS assert_timestamp_equal_add_time_new_value ......................... [[32mPASS[0m in 0.06s]
[0m13:51:29.260241 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:51:29.260908 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:51:29.261794 [info ] [Thread-1 (]: 8 of 32 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m13:51:29.262591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m13:51:29.263444 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:51:29.266816 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:51:29.268141 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:51:29.272510 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:51:29.273420 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:51:29.273879 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m13:51:29.274275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.292539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:51:29.293415 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:51:29.293933 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m13:51:29.296929 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:51:29.300376 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:51:29.300850 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m13:51:29.303390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:51:29.305916 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m13:51:29.306455 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:51:29.306894 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m13:51:29.308738 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:51:29.311377 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m13:51:29.312205 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:51:29.312639 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m13:51:29.313969 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:51:29.315743 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m13:51:29.316386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcb51c0>]}
[0m13:51:29.317108 [info ] [Thread-1 (]: 8 of 32 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.05s]
[0m13:51:29.317844 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:51:29.318541 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:51:29.319286 [info ] [Thread-1 (]: 9 of 32 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m13:51:29.319969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m13:51:29.320406 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:51:29.323135 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:51:29.324080 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:51:29.400500 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:51:29.401629 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:51:29.402206 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m13:51:29.402743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.425477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m13:51:29.426232 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:51:29.426795 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m13:51:29.430568 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:51:29.434040 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:51:29.434504 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m13:51:29.436374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:29.438320 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m13:51:29.438776 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:51:29.439195 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m13:51:29.441285 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:51:29.444436 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m13:51:29.445372 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:51:29.445836 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m13:51:29.447661 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:51:29.449305 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m13:51:29.449895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa1220>]}
[0m13:51:29.450579 [info ] [Thread-1 (]: 9 of 32 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.13s]
[0m13:51:29.451316 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:51:29.451909 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:51:29.452561 [info ] [Thread-1 (]: 10 of 32 START test not_null_stg_pipedrive__activity_deal_id ................... [RUN]
[0m13:51:29.453270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_stages, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m13:51:29.453716 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:51:29.466826 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:51:29.468197 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:51:29.471147 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:51:29.472669 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:51:29.473193 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m13:51:29.473791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.491027 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:51:29.491684 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:51:29.492145 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m13:51:29.495206 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:51:29.497135 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m13:51:29.498756 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m13:51:29.499777 [info ] [Thread-1 (]: 10 of 32 PASS not_null_stg_pipedrive__activity_deal_id ......................... [[32mPASS[0m in 0.05s]
[0m13:51:29.500954 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:51:29.501713 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:51:29.502505 [info ] [Thread-1 (]: 11 of 32 START test not_null_stg_pipedrive__activity_due_time .................. [RUN]
[0m13:51:29.503493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191)
[0m13:51:29.504257 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:51:29.508934 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:51:29.509828 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:51:29.512176 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:51:29.512945 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:51:29.513381 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: BEGIN
[0m13:51:29.513780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.532798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:51:29.533890 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:51:29.534475 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_time is null



      
    ) dbt_internal_test
[0m13:51:29.537623 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:51:29.540022 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: ROLLBACK
[0m13:51:29.541411 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: Close
[0m13:51:29.542616 [info ] [Thread-1 (]: 11 of 32 PASS not_null_stg_pipedrive__activity_due_time ........................ [[32mPASS[0m in 0.04s]
[0m13:51:29.544081 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:51:29.544967 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:51:29.545602 [info ] [Thread-1 (]: 12 of 32 START test not_null_stg_pipedrive__activity_id ........................ [RUN]
[0m13:51:29.546160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m13:51:29.546593 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:51:29.551177 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:51:29.552271 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:51:29.554694 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:51:29.555462 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:51:29.555898 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m13:51:29.556301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.578534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m13:51:29.579394 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:51:29.579857 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m13:51:29.582135 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:51:29.583858 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m13:51:29.585250 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m13:51:29.586242 [info ] [Thread-1 (]: 12 of 32 PASS not_null_stg_pipedrive__activity_id .............................. [[32mPASS[0m in 0.04s]
[0m13:51:29.587257 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:51:29.588036 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:51:29.588979 [info ] [Thread-1 (]: 13 of 32 START test not_null_stg_pipedrive__activity_is_done ................... [RUN]
[0m13:51:29.589564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m13:51:29.590011 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:51:29.595365 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:51:29.597846 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:51:29.600469 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:51:29.601295 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:51:29.601726 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m13:51:29.602223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.619930 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:51:29.620833 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:51:29.621307 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m13:51:29.623707 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:51:29.625453 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m13:51:29.626858 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m13:51:29.627708 [info ] [Thread-1 (]: 13 of 32 PASS not_null_stg_pipedrive__activity_is_done ......................... [[32mPASS[0m in 0.04s]
[0m13:51:29.628713 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:51:29.629415 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:51:29.630438 [info ] [Thread-1 (]: 14 of 32 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m13:51:29.631134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m13:51:29.631593 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:51:29.643612 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:51:29.644526 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:51:29.647048 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:51:29.648025 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:51:29.648496 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m13:51:29.648927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.665542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:51:29.666250 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:51:29.666777 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:51:29.672902 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:51:29.674916 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m13:51:29.676274 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m13:51:29.677038 [info ] [Thread-1 (]: 14 of 32 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.05s]
[0m13:51:29.677830 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:51:29.678416 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:51:29.678956 [info ] [Thread-1 (]: 15 of 32 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m13:51:29.679780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m13:51:29.680269 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:51:29.691538 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:51:29.692434 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:51:29.695106 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:51:29.696128 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:51:29.696661 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m13:51:29.697105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.718172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:51:29.718937 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:51:29.719437 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m13:51:29.724194 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:51:29.725977 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m13:51:29.727488 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m13:51:29.728343 [info ] [Thread-1 (]: 15 of 32 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.05s]
[0m13:51:29.729185 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:51:29.729746 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:51:29.730271 [info ] [Thread-1 (]: 16 of 32 START test not_null_stg_pipedrive__deal_changes_change_time ........... [RUN]
[0m13:51:29.730864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m13:51:29.731358 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:51:29.735748 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:51:29.737225 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:51:29.739843 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:51:29.740742 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:51:29.741206 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m13:51:29.741627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.759079 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:51:29.759944 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:51:29.760554 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m13:51:29.764187 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:51:29.766072 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m13:51:29.767557 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m13:51:29.768355 [info ] [Thread-1 (]: 16 of 32 PASS not_null_stg_pipedrive__deal_changes_change_time ................. [[32mPASS[0m in 0.04s]
[0m13:51:29.769498 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:51:29.770242 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:51:29.771049 [info ] [Thread-1 (]: 17 of 32 START test not_null_stg_pipedrive__deal_changes_deal_id ............... [RUN]
[0m13:51:29.772050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d)
[0m13:51:29.772817 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:51:29.778934 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:51:29.780109 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:51:29.783500 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:51:29.784594 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:51:29.785341 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: BEGIN
[0m13:51:29.785857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.803955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:51:29.804729 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:51:29.806360 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where deal_id is null



      
    ) dbt_internal_test
[0m13:51:29.809573 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:51:29.831184 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: ROLLBACK
[0m13:51:29.833359 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: Close
[0m13:51:29.834115 [info ] [Thread-1 (]: 17 of 32 PASS not_null_stg_pipedrive__deal_changes_deal_id ..................... [[32mPASS[0m in 0.06s]
[0m13:51:29.834923 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:51:29.835457 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:51:29.836001 [info ] [Thread-1 (]: 18 of 32 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m13:51:29.836829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m13:51:29.837459 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:51:29.841933 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:51:29.842782 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:51:29.845206 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:51:29.846038 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:51:29.846496 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m13:51:29.846914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.863684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:51:29.864433 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:51:29.864924 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m13:51:29.867921 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:51:29.869705 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m13:51:29.871144 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m13:51:29.871943 [info ] [Thread-1 (]: 18 of 32 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m13:51:29.872828 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:51:29.873378 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:51:29.873959 [info ] [Thread-1 (]: 19 of 32 START test assert_change_user_references_user_id ...................... [RUN]
[0m13:51:29.874786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m13:51:29.875248 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:51:29.878125 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:51:29.878933 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:51:29.881249 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:51:29.882231 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:51:29.882702 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m13:51:29.883112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.900387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:51:29.900965 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:51:29.901463 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:51:29.906735 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:51:29.908872 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m13:51:29.910780 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m13:51:29.911885 [info ] [Thread-1 (]: 19 of 32 PASS assert_change_user_references_user_id ............................ [[32mPASS[0m in 0.04s]
[0m13:51:29.912765 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:51:29.913329 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:51:29.913819 [info ] [Thread-1 (]: 20 of 32 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m13:51:29.914566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m13:51:29.915036 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:51:29.922111 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:51:29.923023 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:51:29.926282 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:51:29.927333 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:51:29.927826 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m13:51:29.928245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.945784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:51:29.946556 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:51:29.947082 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m13:51:29.949494 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:51:29.951398 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m13:51:29.953035 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m13:51:29.953865 [info ] [Thread-1 (]: 20 of 32 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m13:51:29.954917 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:51:29.955548 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:51:29.956087 [info ] [Thread-1 (]: 21 of 32 START test not_null_stg_pipedrive__users_modified_time ................ [RUN]
[0m13:51:29.956924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5)
[0m13:51:29.957414 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:51:29.961915 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:51:29.962815 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:51:29.965303 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:51:29.966165 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:51:29.966645 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: BEGIN
[0m13:51:29.967068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:29.986225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:51:29.987114 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:51:29.987645 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_time is null



      
    ) dbt_internal_test
[0m13:51:29.990187 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:51:29.991947 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: ROLLBACK
[0m13:51:29.993549 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: Close
[0m13:51:29.994477 [info ] [Thread-1 (]: 21 of 32 PASS not_null_stg_pipedrive__users_modified_time ...................... [[32mPASS[0m in 0.04s]
[0m13:51:29.995396 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:51:29.995934 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:51:29.996451 [info ] [Thread-1 (]: 22 of 32 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m13:51:29.997177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m13:51:29.997653 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:51:30.003064 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:51:30.004335 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:51:30.007036 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:51:30.007947 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:51:30.008537 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m13:51:30.009004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:30.026291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:51:30.027141 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:51:30.027652 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m13:51:30.030091 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:51:30.032428 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m13:51:30.034187 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m13:51:30.035128 [info ] [Thread-1 (]: 22 of 32 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m13:51:30.036432 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:51:30.037342 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:51:30.038273 [info ] [Thread-1 (]: 23 of 32 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m13:51:30.038992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m13:51:30.039524 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:51:30.044610 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:51:30.045490 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:51:30.048262 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:51:30.049155 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:51:30.049647 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m13:51:30.050073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:30.068402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:51:30.069174 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:51:30.069834 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m13:51:30.073348 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:51:30.075550 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m13:51:30.077243 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m13:51:30.078395 [info ] [Thread-1 (]: 23 of 32 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m13:51:30.079593 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:51:30.080251 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:51:30.081052 [info ] [Thread-1 (]: 24 of 32 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m13:51:30.081762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m13:51:30.082232 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:51:30.090963 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:51:30.092181 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:51:30.096049 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:51:30.097335 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:51:30.097932 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m13:51:30.098452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:30.121443 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m13:51:30.122272 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:51:30.122806 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:51:30.126937 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:51:30.128828 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m13:51:30.130490 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m13:51:30.131539 [info ] [Thread-1 (]: 24 of 32 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.05s]
[0m13:51:30.132576 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:51:30.133262 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:51:30.134044 [info ] [Thread-1 (]: 25 of 32 START test assert_change_stage_references_lost_reason_id .............. [RUN]
[0m13:51:30.134922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m13:51:30.135455 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:51:30.139558 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:51:30.140689 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:51:30.143883 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:51:30.144874 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:51:30.145374 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m13:51:30.145804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:30.170625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m13:51:30.171582 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:51:30.172442 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:51:30.181533 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m13:51:30.184433 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m13:51:30.186503 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m13:51:30.187766 [info ] [Thread-1 (]: 25 of 32 PASS assert_change_stage_references_lost_reason_id .................... [[32mPASS[0m in 0.05s]
[0m13:51:30.189160 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:51:30.190148 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:51:30.191033 [info ] [Thread-1 (]: 26 of 32 START test assert_change_stage_references_stage_id .................... [RUN]
[0m13:51:30.192182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m13:51:30.192931 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:51:30.197556 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:51:30.198865 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:51:30.206515 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:51:30.208308 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:51:30.209336 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m13:51:30.210073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:30.236526 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m13:51:30.237780 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:51:30.238683 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:51:30.248061 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m13:51:30.251722 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m13:51:30.253957 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m13:51:30.255561 [info ] [Thread-1 (]: 26 of 32 PASS assert_change_stage_references_stage_id .......................... [[32mPASS[0m in 0.06s]
[0m13:51:30.257152 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:51:30.258010 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:51:30.258778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now model.enpal_assessment_project.int_activity_join_activity_types)
[0m13:51:30.259530 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:51:30.265998 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity_join_activity_types"
[0m13:51:30.267852 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:51:30.268767 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason
[0m13:51:30.269803 [info ] [Thread-1 (]: 27 of 32 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_lost_reason  [RUN]
[0m13:51:30.270697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activity_join_activity_types, now model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason)
[0m13:51:30.271433 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason
[0m13:51:30.276096 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:51:30.277533 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason
[0m13:51:30.287125 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:51:30.288857 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:51:30.289738 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: BEGIN
[0m13:51:30.290469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:30.318708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m13:51:30.320283 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:51:30.321144 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_lost_reason__dbt_tmp"
    
    
  as (
    WITH deal_changes_lost_reason AS (
	SELECT
		ROW_NUMBER() OVER(PARTITION BY deal_id ORDER BY change_time DESC) AS reverse_order,
		deal_id,
		new_value AS lost_reason,
		change_time
	FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'lost_reason'
)
SELECT * FROM deal_changes_stage WHERE reverse_order = 1
  );
[0m13:51:30.325606 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "deal_changes_stage" does not exist
LINE 16: SELECT * FROM deal_changes_stage WHERE reverse_order = 1
                       ^

[0m13:51:30.326638 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: ROLLBACK
[0m13:51:30.329111 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: Close
[0m13:51:30.343166 [debug] [Thread-1 (]: Database Error in model int_deal_changes_dedupe_lost_reason (models/intermediate/int_deal_changes_dedupe_lost_reason.sql)
  relation "deal_changes_stage" does not exist
  LINE 16: SELECT * FROM deal_changes_stage WHERE reverse_order = 1
                         ^
  compiled code at target/run/enpal_assessment_project/models/intermediate/int_deal_changes_dedupe_lost_reason.sql
[0m13:51:30.343890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc98530>]}
[0m13:51:30.344684 [error] [Thread-1 (]: 27 of 32 ERROR creating sql view model public_pipedrive_analytics.int_deal_changes_dedupe_lost_reason  [[31mERROR[0m in 0.07s]
[0m13:51:30.345517 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason
[0m13:51:30.346062 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:51:30.347086 [info ] [Thread-1 (]: 28 of 32 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_new_deals  [RUN]
[0m13:51:30.347696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason, now model.enpal_assessment_project.int_deal_changes_dedupe_new_deals)
[0m13:51:30.348162 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:51:30.351225 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:51:30.352302 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:51:30.357460 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:51:30.358870 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:51:30.359666 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: BEGIN
[0m13:51:30.360412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:30.379589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:51:30.380328 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:51:30.380817 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_tmp"
    
    
  as (
    -- Separate new deals model from the deal_changes model
-- There are a handful of dupe deals in the deal_changes model (assumption - deals should not have more than one added date)
-- Materialize as a view so it can be tested for deduplication
SELECT
	deal_id, 
	MAX(change_time)
FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
WHERE changed_field_key = 'add_time'
GROUP BY deal_id
  );
[0m13:51:30.384099 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:51:30.387813 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:51:30.388348 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_tmp" rename to "int_deal_changes_dedupe_new_deals"
[0m13:51:30.390055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:30.391868 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: COMMIT
[0m13:51:30.392374 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:51:30.392799 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: COMMIT
[0m13:51:30.395235 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:51:30.397979 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_backup"
[0m13:51:30.398947 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:51:30.399424 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
drop view if exists "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_backup" cascade
[0m13:51:30.400985 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:51:30.402576 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: Close
[0m13:51:30.403378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108264f80>]}
[0m13:51:30.404188 [info ] [Thread-1 (]: 28 of 32 OK created sql view model public_pipedrive_analytics.int_deal_changes_dedupe_new_deals  [[32mCREATE VIEW[0m in 0.06s]
[0m13:51:30.404950 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:51:30.405470 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:51:30.406435 [info ] [Thread-1 (]: 29 of 32 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_stage  [RUN]
[0m13:51:30.407262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_new_deals, now model.enpal_assessment_project.int_deal_changes_dedupe_stage)
[0m13:51:30.407757 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:51:30.411029 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:51:30.412320 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:51:30.416699 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:51:30.417590 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:51:30.418163 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: BEGIN
[0m13:51:30.418831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:30.437845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:51:30.438581 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:51:30.439134 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_tmp"
    
    
  as (
    -- Separate new deals model from the deal_changes model
-- There are a handful of dupe deals in the deal_changes model (assumption - deals should not have more of each stage id)
-- Materialize as a view so it can be tested for deduplication
-- Method: row_number in reverse order and then pick the first row. 
-- This pattern is better because we don't know how many duplicate rows there could be, but the latest will always be row number 1.
-- Can't just take MAX(new_value) as was done for new_deals, because there are multiple stage_ids and all that appear need to be presented to the model.
WITH deal_changes_stage AS (
	SELECT
		ROW_NUMBER() OVER(PARTITION BY deal_id, new_value ORDER BY new_value, change_time DESC) AS reverse_order,
		deal_id,
		new_value AS stage_id,
		change_time
	FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'stage_id'
)
SELECT * FROM deal_changes_stage WHERE reverse_order = 1
  );
[0m13:51:30.442870 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:51:30.446526 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:51:30.447038 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_tmp" rename to "int_deal_changes_dedupe_stage"
[0m13:51:30.448872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:30.450619 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: COMMIT
[0m13:51:30.451061 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:51:30.451474 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: COMMIT
[0m13:51:30.453541 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:51:30.458138 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_backup"
[0m13:51:30.459034 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:51:30.459487 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */
drop view if exists "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_backup" cascade
[0m13:51:30.461056 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:51:30.462704 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: Close
[0m13:51:30.463315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e046cc0f-09a2-4b6b-ad81-6c03fe05be90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b460f80>]}
[0m13:51:30.464372 [info ] [Thread-1 (]: 29 of 32 OK created sql view model public_pipedrive_analytics.int_deal_changes_dedupe_stage  [[32mCREATE VIEW[0m in 0.06s]
[0m13:51:30.465714 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:51:30.466570 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907
[0m13:51:30.467414 [info ] [Thread-1 (]: 30 of 32 SKIP test unique_int_deal_changes_dedupe_lost_reason_deal_id .......... [[33mSKIP[0m]
[0m13:51:30.468157 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907
[0m13:51:30.468751 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:51:30.469345 [info ] [Thread-1 (]: 31 of 32 START test unique_int_deal_changes_dedupe_new_deals_deal_id ........... [RUN]
[0m13:51:30.470029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_stage, now test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7)
[0m13:51:30.470543 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:51:30.477857 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:51:30.478821 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:51:30.481709 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:51:30.482674 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:51:30.483161 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: BEGIN
[0m13:51:30.483574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:30.501540 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:51:30.502417 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:51:30.503248 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    deal_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals"
where deal_id is not null
group by deal_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:51:30.510376 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:51:30.512156 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: ROLLBACK
[0m13:51:30.513616 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: Close
[0m13:51:30.514484 [info ] [Thread-1 (]: 31 of 32 PASS unique_int_deal_changes_dedupe_new_deals_deal_id ................. [[32mPASS[0m in 0.04s]
[0m13:51:30.515522 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:51:30.516073 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:51:30.516823 [info ] [Thread-1 (]: 32 of 32 START test assert_unique_deal_stage ................................... [RUN]
[0m13:51:30.517685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7, now test.enpal_assessment_project.assert_unique_deal_stage)
[0m13:51:30.518144 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:51:30.521265 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:51:30.522035 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:51:30.524409 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:51:30.525219 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:51:30.525657 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: BEGIN
[0m13:51:30.526054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:30.546410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:51:30.547223 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:51:30.548069 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_unique_deal_stage"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    COUNT(*),
    deal_id,
    stage_id
FROM "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage"
GROUP BY
    deal_id,
    stage_id
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m13:51:30.568010 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m13:51:30.570550 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: ROLLBACK
[0m13:51:30.572146 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: Close
[0m13:51:30.573039 [info ] [Thread-1 (]: 32 of 32 PASS assert_unique_deal_stage ......................................... [[32mPASS[0m in 0.06s]
[0m13:51:30.573967 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:51:30.575483 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:30.575929 [debug] [MainThread]: On master: BEGIN
[0m13:51:30.576284 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:51:30.593403 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m13:51:30.593944 [debug] [MainThread]: On master: COMMIT
[0m13:51:30.594544 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:30.594939 [debug] [MainThread]: On master: COMMIT
[0m13:51:30.596258 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:51:30.596693 [debug] [MainThread]: On master: Close
[0m13:51:30.597210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:30.597587 [debug] [MainThread]: Connection 'test.enpal_assessment_project.assert_unique_deal_stage' was properly closed.
[0m13:51:30.598064 [info ] [MainThread]: 
[0m13:51:30.598513 [info ] [MainThread]: Finished running 11 view models, 21 data tests in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m13:51:30.605329 [debug] [MainThread]: Command end result
[0m13:51:30.643795 [info ] [MainThread]: 
[0m13:51:30.644314 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:51:30.644701 [info ] [MainThread]: 
[0m13:51:30.645179 [error] [MainThread]:   Database Error in model int_deal_changes_dedupe_lost_reason (models/intermediate/int_deal_changes_dedupe_lost_reason.sql)
  relation "deal_changes_stage" does not exist
  LINE 16: SELECT * FROM deal_changes_stage WHERE reverse_order = 1
                         ^
  compiled code at target/run/enpal_assessment_project/models/intermediate/int_deal_changes_dedupe_lost_reason.sql
[0m13:51:30.645598 [info ] [MainThread]: 
[0m13:51:30.646168 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=1 SKIP=1 TOTAL=32
[0m13:51:30.649297 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.7013388, "process_in_blocks": "0", "process_kernel_time": 0.659152, "process_mem_max_rss": "117563392", "process_out_blocks": "0", "process_user_time": 4.278427}
[0m13:51:30.650035 [debug] [MainThread]: Command `dbt build` failed at 13:51:30.649897 after 3.70 seconds
[0m13:51:30.650513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd0a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4e4290>]}
[0m13:51:30.650938 [debug] [MainThread]: Flushing usage events
[0m13:52:09.952727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbbc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfa3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfa2e70>]}


============================== 13:52:09.960171 | 3d4b5e99-8cc4-45f7-b202-61e98ec08c40 ==============================
[0m13:52:09.960171 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:52:09.961101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:10.259369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b55b800>]}
[0m13:52:10.325384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b12ac00>]}
[0m13:52:10.327316 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:52:10.482187 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:52:10.685888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:52:10.686790 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/intermediate/int_deal_changes_dedupe_lost_reason.sql
[0m13:52:10.948238 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:52:10.948862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf0e9f0>]}
[0m13:52:11.175065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf571d0>]}
[0m13:52:11.352624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5a07a0>]}
[0m13:52:11.353246 [info ] [MainThread]: Found 21 data tests, 12 models, 6 sources, 428 macros
[0m13:52:11.358241 [info ] [MainThread]: 
[0m13:52:11.359078 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:52:11.364388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:52:11.452164 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:52:11.452689 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:52:11.453076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:11.512194 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.059 seconds
[0m13:52:11.513939 [debug] [ThreadPool]: On list_postgres: Close
[0m13:52:11.516266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:52:11.523458 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:52:11.523920 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m13:52:11.524266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:11.539907 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m13:52:11.540630 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:52:11.541053 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:52:11.545389 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m13:52:11.547135 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:52:11.548439 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:52:11.556379 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:11.556875 [debug] [MainThread]: On master: BEGIN
[0m13:52:11.557221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:11.573341 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m13:52:11.573933 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:11.574461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:52:11.580338 [debug] [MainThread]: SQL status: SELECT 10 in 0.005 seconds
[0m13:52:11.583064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d08ff50>]}
[0m13:52:11.583601 [debug] [MainThread]: On master: ROLLBACK
[0m13:52:11.585032 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:11.585461 [debug] [MainThread]: On master: BEGIN
[0m13:52:11.587640 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:52:11.588280 [debug] [MainThread]: On master: COMMIT
[0m13:52:11.588690 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:11.589042 [debug] [MainThread]: On master: COMMIT
[0m13:52:11.590510 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:52:11.590981 [debug] [MainThread]: On master: Close
[0m13:52:11.591799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:11.592656 [info ] [MainThread]: 
[0m13:52:11.596342 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m13:52:11.597072 [info ] [Thread-1 (]: 1 of 32 START sql view model public_pipedrive_analytics.base_pipedrive__fields . [RUN]
[0m13:52:11.597685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m13:52:11.598138 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m13:52:11.607439 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:52:11.610251 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m13:52:11.652375 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:52:11.653319 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:52:11.653755 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m13:52:11.654157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:11.670643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:52:11.671319 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:52:11.671768 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m13:52:11.674434 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:52:11.681411 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:52:11.681910 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m13:52:11.683814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:11.688708 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:52:11.689243 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m13:52:11.691101 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:11.710227 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m13:52:11.710779 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:52:11.711218 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m13:52:11.714239 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:52:11.721264 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m13:52:11.728030 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:52:11.728624 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m13:52:11.733104 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:52:11.735962 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m13:52:11.737602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a855b80>]}
[0m13:52:11.738429 [info ] [Thread-1 (]: 1 of 32 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m13:52:11.739471 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m13:52:11.740441 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:52:11.741044 [info ] [Thread-1 (]: 2 of 32 START sql view model public_pipedrive_analytics.stg_pipedrive__activity  [RUN]
[0m13:52:11.741723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m13:52:11.742160 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:52:11.745062 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:52:11.745973 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:52:11.749737 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:52:11.750519 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:52:11.750979 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m13:52:11.751378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:11.768432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:52:11.769121 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:52:11.769671 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to::TIMESTAMP AS due_time
FROM "postgres"."public"."activity"
  );
[0m13:52:11.774140 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:52:11.778155 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:52:11.778811 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m13:52:11.780615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:11.784282 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:52:11.784766 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m13:52:11.786582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:11.788750 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:52:11.789343 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:52:11.789817 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:52:11.791894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:52:11.794648 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m13:52:11.795707 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:52:11.796161 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m13:52:11.798822 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:52:11.800445 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m13:52:11.801043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5cb6e0>]}
[0m13:52:11.801730 [info ] [Thread-1 (]: 2 of 32 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m13:52:11.802581 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:52:11.803257 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:52:11.804087 [info ] [Thread-1 (]: 3 of 32 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m13:52:11.805046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m13:52:11.805523 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:52:11.809816 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:52:11.810679 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:52:11.814565 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:52:11.815367 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:52:11.815784 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m13:52:11.816175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:11.833629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:52:11.834332 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:52:11.834835 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS activity_is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m13:52:11.837615 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:52:11.842194 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:52:11.842886 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m13:52:11.844821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:11.850056 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:52:11.850604 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m13:52:11.852442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:11.854365 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:52:11.854800 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:52:11.855207 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:52:11.857442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:52:11.860188 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m13:52:11.861043 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:52:11.861470 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m13:52:11.863947 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:52:11.865547 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m13:52:11.866129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d723980>]}
[0m13:52:11.866818 [info ] [Thread-1 (]: 3 of 32 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.06s]
[0m13:52:11.867583 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:52:11.868104 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:52:11.868885 [info ] [Thread-1 (]: 4 of 32 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m13:52:11.869631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m13:52:11.870071 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:52:11.872867 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:52:11.873824 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:52:11.878236 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:52:11.879073 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:52:11.879500 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m13:52:11.879894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:11.897020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:52:11.897657 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:52:11.898129 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- This is not a source deals table, and deal_id is not a PK (UNIQUE), so leave deal_id named as is
SELECT
    deal_id,
    change_time::TIMESTAMP AS change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m13:52:11.900736 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:52:11.903990 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:52:11.904430 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m13:52:11.906188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:11.910729 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:52:11.911281 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m13:52:11.912969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:11.915199 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:52:11.915713 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:52:11.916128 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:52:11.918057 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:52:11.920778 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m13:52:11.921589 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:52:11.922017 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m13:52:11.925194 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:52:11.926794 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m13:52:11.927485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5cbf50>]}
[0m13:52:11.928191 [info ] [Thread-1 (]: 4 of 32 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.06s]
[0m13:52:11.928926 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:52:11.929446 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:52:11.930143 [info ] [Thread-1 (]: 5 of 32 START sql view model public_pipedrive_analytics.stg_pipedrive__stages .. [RUN]
[0m13:52:11.930873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m13:52:11.931320 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:52:11.934178 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:52:11.934973 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:52:11.938772 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:52:11.939589 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:52:11.940096 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m13:52:11.940518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:11.959456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:52:11.960244 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:52:11.960928 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m13:52:11.965394 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:52:11.968828 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:52:11.969399 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m13:52:11.971384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:11.975318 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:52:11.975841 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m13:52:11.977909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:52:11.979896 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:52:11.980532 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:52:11.981048 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:52:11.983229 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:52:11.986030 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m13:52:11.987049 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:52:11.987533 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m13:52:11.991295 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:52:11.992977 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m13:52:11.993602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5cbfb0>]}
[0m13:52:11.994340 [info ] [Thread-1 (]: 5 of 32 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.06s]
[0m13:52:11.995237 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:52:11.995805 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:52:11.996591 [info ] [Thread-1 (]: 6 of 32 START sql view model public_pipedrive_analytics.stg_pipedrive__users ... [RUN]
[0m13:52:11.997347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m13:52:11.997833 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m13:52:12.002254 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:52:12.003158 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m13:52:12.007724 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:52:12.008630 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:52:12.009074 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m13:52:12.009480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.030504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:52:12.031730 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:52:12.032332 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified::TIMESTAMP AS modified_time
FROM "postgres"."public"."users"
  );
[0m13:52:12.035061 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:52:12.038475 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:52:12.038968 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m13:52:12.041131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:52:12.044446 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:52:12.044894 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m13:52:12.046912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:12.049017 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:52:12.049497 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:52:12.049904 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:52:12.052108 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:52:12.054750 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m13:52:12.055561 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:52:12.055981 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m13:52:12.058696 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:52:12.060354 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m13:52:12.060992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d75eab0>]}
[0m13:52:12.061742 [info ] [Thread-1 (]: 6 of 32 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m13:52:12.062551 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:52:12.063097 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:52:12.063655 [info ] [Thread-1 (]: 7 of 32 START test assert_timestamp_equal_add_time_new_value ................... [RUN]
[0m13:52:12.064412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value)
[0m13:52:12.064875 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:52:12.066906 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:52:12.067701 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:52:12.093185 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:52:12.094160 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:52:12.094640 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: BEGIN
[0m13:52:12.095055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.114341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:52:12.115269 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:52:12.115842 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Assert that the change_time is equal to the new_value when the changed_field_key is 'add_time'
-- With this test, it's OK to ignore the new_value field for add_time changes
SELECT * FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'add_time'
	AND change_time != new_value::TIMESTAMP
      
    ) dbt_internal_test
[0m13:52:12.121875 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:52:12.126002 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: ROLLBACK
[0m13:52:12.127719 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: Close
[0m13:52:12.128600 [info ] [Thread-1 (]: 7 of 32 PASS assert_timestamp_equal_add_time_new_value ......................... [[32mPASS[0m in 0.06s]
[0m13:52:12.129996 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:52:12.130777 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:52:12.131786 [info ] [Thread-1 (]: 8 of 32 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m13:52:12.132829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m13:52:12.133907 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:52:12.137722 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:52:12.138690 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:52:12.144097 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:52:12.145174 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:52:12.145689 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m13:52:12.146146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.174138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m13:52:12.175002 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:52:12.175880 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m13:52:12.180445 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:52:12.186013 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:52:12.186716 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m13:52:12.189234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:52:12.191442 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m13:52:12.192069 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:52:12.192736 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m13:52:12.195500 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:52:12.198900 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m13:52:12.201267 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:52:12.202390 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m13:52:12.204599 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:52:12.206722 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m13:52:12.207943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7010d0>]}
[0m13:52:12.209334 [info ] [Thread-1 (]: 8 of 32 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.08s]
[0m13:52:12.210700 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:52:12.211738 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:52:12.212721 [info ] [Thread-1 (]: 9 of 32 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m13:52:12.213807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m13:52:12.214344 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:52:12.217734 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:52:12.218840 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:52:12.309546 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:52:12.310597 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:52:12.311085 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m13:52:12.311541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.329252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:52:12.329933 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:52:12.330466 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m13:52:12.334039 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:52:12.337587 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:52:12.338105 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m13:52:12.340046 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:12.341849 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m13:52:12.342343 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:52:12.342781 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m13:52:12.344924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:52:12.347670 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m13:52:12.348643 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:52:12.349096 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m13:52:12.350658 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:52:12.352268 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m13:52:12.352868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cece450>]}
[0m13:52:12.353543 [info ] [Thread-1 (]: 9 of 32 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.14s]
[0m13:52:12.354237 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:52:12.354765 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:52:12.355288 [info ] [Thread-1 (]: 10 of 32 START test not_null_stg_pipedrive__activity_deal_id ................... [RUN]
[0m13:52:12.355928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_stages, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m13:52:12.356680 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:52:12.369321 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:52:12.370179 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:52:12.373073 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:52:12.373948 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:52:12.374398 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m13:52:12.374939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.393424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:52:12.394316 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:52:12.394902 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m13:52:12.397415 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:52:12.399800 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m13:52:12.401449 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m13:52:12.402425 [info ] [Thread-1 (]: 10 of 32 PASS not_null_stg_pipedrive__activity_deal_id ......................... [[32mPASS[0m in 0.05s]
[0m13:52:12.403516 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:52:12.404083 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:52:12.404634 [info ] [Thread-1 (]: 11 of 32 START test not_null_stg_pipedrive__activity_due_time .................. [RUN]
[0m13:52:12.405635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191)
[0m13:52:12.406394 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:52:12.410968 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:52:12.412027 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:52:12.414918 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:52:12.415773 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:52:12.416254 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: BEGIN
[0m13:52:12.416691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.436315 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:52:12.437072 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:52:12.437688 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_time is null



      
    ) dbt_internal_test
[0m13:52:12.440720 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:52:12.442475 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: ROLLBACK
[0m13:52:12.444015 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: Close
[0m13:52:12.445060 [info ] [Thread-1 (]: 11 of 32 PASS not_null_stg_pipedrive__activity_due_time ........................ [[32mPASS[0m in 0.04s]
[0m13:52:12.446375 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:52:12.447270 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:52:12.448267 [info ] [Thread-1 (]: 12 of 32 START test not_null_stg_pipedrive__activity_id ........................ [RUN]
[0m13:52:12.448914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m13:52:12.449526 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:52:12.455638 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:52:12.457095 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:52:12.459822 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:52:12.460741 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:52:12.461452 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m13:52:12.462304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.481705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:52:12.482503 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:52:12.483077 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m13:52:12.486120 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:52:12.488038 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m13:52:12.490025 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m13:52:12.490871 [info ] [Thread-1 (]: 12 of 32 PASS not_null_stg_pipedrive__activity_id .............................. [[32mPASS[0m in 0.04s]
[0m13:52:12.491831 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:52:12.492405 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:52:12.493072 [info ] [Thread-1 (]: 13 of 32 START test not_null_stg_pipedrive__activity_is_done ................... [RUN]
[0m13:52:12.493937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m13:52:12.494566 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:52:12.499714 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:52:12.500637 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:52:12.503027 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:52:12.503803 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:52:12.504246 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m13:52:12.504643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.521697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:52:12.522577 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:52:12.523470 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m13:52:12.526753 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:52:12.528508 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m13:52:12.529912 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m13:52:12.530782 [info ] [Thread-1 (]: 13 of 32 PASS not_null_stg_pipedrive__activity_is_done ......................... [[32mPASS[0m in 0.04s]
[0m13:52:12.531623 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:52:12.532303 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:52:12.532974 [info ] [Thread-1 (]: 14 of 32 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m13:52:12.533847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m13:52:12.534378 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:52:12.545750 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:52:12.546772 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:52:12.549355 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:52:12.550190 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:52:12.550627 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m13:52:12.551034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.568114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:52:12.568845 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:52:12.569362 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:52:12.573516 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:52:12.575381 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m13:52:12.576850 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m13:52:12.577591 [info ] [Thread-1 (]: 14 of 32 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m13:52:12.578354 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:52:12.578873 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:52:12.579427 [info ] [Thread-1 (]: 15 of 32 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m13:52:12.580206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m13:52:12.580695 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:52:12.592140 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:52:12.593025 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:52:12.595593 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:52:12.596420 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:52:12.596881 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m13:52:12.597294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.613825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:52:12.614518 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:52:12.615049 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m13:52:12.619777 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:52:12.621538 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m13:52:12.622875 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m13:52:12.623814 [info ] [Thread-1 (]: 15 of 32 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.04s]
[0m13:52:12.624690 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:52:12.625225 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:52:12.625722 [info ] [Thread-1 (]: 16 of 32 START test not_null_stg_pipedrive__deal_changes_change_time ........... [RUN]
[0m13:52:12.626303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m13:52:12.626767 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:52:12.631153 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:52:12.632175 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:52:12.634671 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:52:12.635527 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:52:12.635974 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m13:52:12.636377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.653463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:52:12.654326 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:52:12.654853 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m13:52:12.658170 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:52:12.659920 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m13:52:12.661363 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m13:52:12.662220 [info ] [Thread-1 (]: 16 of 32 PASS not_null_stg_pipedrive__deal_changes_change_time ................. [[32mPASS[0m in 0.04s]
[0m13:52:12.663071 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:52:12.663616 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:52:12.664070 [info ] [Thread-1 (]: 17 of 32 START test not_null_stg_pipedrive__deal_changes_deal_id ............... [RUN]
[0m13:52:12.664803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d)
[0m13:52:12.665345 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:52:12.670086 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:52:12.670911 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:52:12.673571 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:52:12.674629 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:52:12.675181 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: BEGIN
[0m13:52:12.675634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.693325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:52:12.694048 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:52:12.694559 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where deal_id is null



      
    ) dbt_internal_test
[0m13:52:12.697438 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:52:12.699327 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: ROLLBACK
[0m13:52:12.700772 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: Close
[0m13:52:12.701532 [info ] [Thread-1 (]: 17 of 32 PASS not_null_stg_pipedrive__deal_changes_deal_id ..................... [[32mPASS[0m in 0.04s]
[0m13:52:12.702307 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:52:12.702829 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:52:12.703332 [info ] [Thread-1 (]: 18 of 32 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m13:52:12.704028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m13:52:12.704495 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:52:12.709070 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:52:12.710041 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:52:12.712492 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:52:12.713286 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:52:12.713731 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m13:52:12.714136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.730711 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:52:12.731482 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:52:12.732013 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m13:52:12.735251 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:52:12.736992 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m13:52:12.738418 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m13:52:12.739455 [info ] [Thread-1 (]: 18 of 32 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m13:52:12.740289 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:52:12.740877 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:52:12.741340 [info ] [Thread-1 (]: 19 of 32 START test assert_change_user_references_user_id ...................... [RUN]
[0m13:52:12.742025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m13:52:12.742629 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:52:12.745496 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:52:12.746291 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:52:12.748718 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:52:12.749513 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:52:12.749949 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m13:52:12.750347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.766928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:52:12.767618 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:52:12.768115 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:52:12.773383 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:52:12.775341 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m13:52:12.777154 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m13:52:12.778005 [info ] [Thread-1 (]: 19 of 32 PASS assert_change_user_references_user_id ............................ [[32mPASS[0m in 0.04s]
[0m13:52:12.779009 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:52:12.779596 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:52:12.780076 [info ] [Thread-1 (]: 20 of 32 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m13:52:12.780883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m13:52:12.781479 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:52:12.788502 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:52:12.789431 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:52:12.791998 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:52:12.792835 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:52:12.793276 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m13:52:12.793681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.811805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:52:12.812571 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:52:12.813050 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m13:52:12.815248 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:52:12.817058 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m13:52:12.818607 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m13:52:12.819595 [info ] [Thread-1 (]: 20 of 32 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.04s]
[0m13:52:12.820502 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:52:12.821104 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:52:12.821852 [info ] [Thread-1 (]: 21 of 32 START test not_null_stg_pipedrive__users_modified_time ................ [RUN]
[0m13:52:12.822599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5)
[0m13:52:12.823239 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:52:12.827551 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:52:12.828393 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:52:12.830834 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:52:12.831741 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:52:12.832190 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: BEGIN
[0m13:52:12.832608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.850328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:52:12.851064 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:52:12.851727 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_time is null



      
    ) dbt_internal_test
[0m13:52:12.854515 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:52:12.856440 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: ROLLBACK
[0m13:52:12.858091 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: Close
[0m13:52:12.859040 [info ] [Thread-1 (]: 21 of 32 PASS not_null_stg_pipedrive__users_modified_time ...................... [[32mPASS[0m in 0.04s]
[0m13:52:12.859950 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:52:12.860604 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:52:12.861297 [info ] [Thread-1 (]: 22 of 32 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m13:52:12.861904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m13:52:12.862356 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:52:12.867251 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:52:12.868160 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:52:12.870738 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:52:12.871688 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:52:12.872280 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m13:52:12.872700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.890618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:52:12.891460 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:52:12.891989 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m13:52:12.894486 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:52:12.896315 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m13:52:12.897846 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m13:52:12.898759 [info ] [Thread-1 (]: 22 of 32 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.04s]
[0m13:52:12.899939 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:52:12.900528 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:52:12.901025 [info ] [Thread-1 (]: 23 of 32 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m13:52:12.901642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m13:52:12.902102 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:52:12.906354 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:52:12.907296 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:52:12.909778 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:52:12.910599 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:52:12.911051 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m13:52:12.911533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.927785 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:52:12.928482 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:52:12.928951 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m13:52:12.931840 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:52:12.933831 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m13:52:12.935548 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m13:52:12.936496 [info ] [Thread-1 (]: 23 of 32 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.03s]
[0m13:52:12.937373 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:52:12.937906 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:52:12.938515 [info ] [Thread-1 (]: 24 of 32 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m13:52:12.939402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m13:52:12.940102 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:52:12.946341 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:52:12.947183 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:52:12.949593 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:52:12.950410 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:52:12.950840 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m13:52:12.951264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:12.969143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:52:12.969815 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:52:12.970417 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:52:12.974534 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:52:12.976332 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m13:52:12.977799 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m13:52:12.978541 [info ] [Thread-1 (]: 24 of 32 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m13:52:12.979292 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:52:12.979821 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:52:12.980438 [info ] [Thread-1 (]: 25 of 32 START test assert_change_stage_references_lost_reason_id .............. [RUN]
[0m13:52:12.981060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m13:52:12.981644 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:52:12.984566 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:52:12.985368 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:52:12.987792 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:52:12.988707 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:52:12.989155 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m13:52:12.989559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:13.007724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:52:13.008666 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:52:13.009317 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:52:13.014833 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:52:13.016766 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m13:52:13.018215 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m13:52:13.019055 [info ] [Thread-1 (]: 25 of 32 PASS assert_change_stage_references_lost_reason_id .................... [[32mPASS[0m in 0.04s]
[0m13:52:13.019795 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:52:13.020318 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:52:13.020766 [info ] [Thread-1 (]: 26 of 32 START test assert_change_stage_references_stage_id .................... [RUN]
[0m13:52:13.021521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m13:52:13.022124 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:52:13.025232 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:52:13.026203 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:52:13.030601 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:52:13.031550 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:52:13.032018 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m13:52:13.032438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:13.051370 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:52:13.052192 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:52:13.052692 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:52:13.059839 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m13:52:13.061740 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m13:52:13.063132 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m13:52:13.063965 [info ] [Thread-1 (]: 26 of 32 PASS assert_change_stage_references_stage_id .......................... [[32mPASS[0m in 0.04s]
[0m13:52:13.064929 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:52:13.065575 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:52:13.066307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now model.enpal_assessment_project.int_activity_join_activity_types)
[0m13:52:13.066939 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:52:13.070815 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity_join_activity_types"
[0m13:52:13.072001 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:52:13.072518 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason
[0m13:52:13.073278 [info ] [Thread-1 (]: 27 of 32 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_lost_reason  [RUN]
[0m13:52:13.074160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activity_join_activity_types, now model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason)
[0m13:52:13.074781 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason
[0m13:52:13.078288 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:52:13.079415 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason
[0m13:52:13.085499 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:52:13.086519 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:52:13.086986 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: BEGIN
[0m13:52:13.087519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:13.112730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m13:52:13.113701 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:52:13.114389 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_lost_reason__dbt_tmp"
    
    
  as (
    WITH deal_changes_lost_reason AS (
	SELECT
		ROW_NUMBER() OVER(PARTITION BY deal_id ORDER BY change_time DESC) AS reverse_order,
		deal_id,
		new_value AS lost_reason,
		change_time
	FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'lost_reason'
)
SELECT * FROM deal_changes_lost_reason WHERE reverse_order = 1
  );
[0m13:52:13.118711 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:52:13.122692 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:52:13.123260 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_lost_reason__dbt_tmp" rename to "int_deal_changes_dedupe_lost_reason"
[0m13:52:13.126237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:52:13.128403 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: COMMIT
[0m13:52:13.129063 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:52:13.129552 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: COMMIT
[0m13:52:13.131889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:52:13.134827 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_lost_reason__dbt_backup"
[0m13:52:13.135829 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:52:13.136436 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"} */
drop view if exists "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_lost_reason__dbt_backup" cascade
[0m13:52:13.138126 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:52:13.139731 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: Close
[0m13:52:13.140651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d685b20>]}
[0m13:52:13.141444 [info ] [Thread-1 (]: 27 of 32 OK created sql view model public_pipedrive_analytics.int_deal_changes_dedupe_lost_reason  [[32mCREATE VIEW[0m in 0.07s]
[0m13:52:13.142233 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason
[0m13:52:13.142756 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:52:13.143559 [info ] [Thread-1 (]: 28 of 32 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_new_deals  [RUN]
[0m13:52:13.144260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason, now model.enpal_assessment_project.int_deal_changes_dedupe_new_deals)
[0m13:52:13.144719 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:52:13.147605 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:52:13.148602 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:52:13.152767 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:52:13.153726 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:52:13.154370 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: BEGIN
[0m13:52:13.154829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:13.176264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:52:13.176915 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:52:13.177456 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_tmp"
    
    
  as (
    -- Separate new deals model from the deal_changes model
-- There are a handful of dupe deals in the deal_changes model (assumption - deals should not have more than one added date)
-- Materialize as a view so it can be tested for deduplication
SELECT
	deal_id, 
	MAX(change_time)
FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
WHERE changed_field_key = 'add_time'
GROUP BY deal_id
  );
[0m13:52:13.181209 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:52:13.186332 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:52:13.187043 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_tmp" rename to "int_deal_changes_dedupe_new_deals"
[0m13:52:13.189177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:13.191680 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: COMMIT
[0m13:52:13.192184 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:52:13.192620 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: COMMIT
[0m13:52:13.195066 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:52:13.197730 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_backup"
[0m13:52:13.198559 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:52:13.198993 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
drop view if exists "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_backup" cascade
[0m13:52:13.200900 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:52:13.202529 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: Close
[0m13:52:13.203126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cde9c40>]}
[0m13:52:13.203805 [info ] [Thread-1 (]: 28 of 32 OK created sql view model public_pipedrive_analytics.int_deal_changes_dedupe_new_deals  [[32mCREATE VIEW[0m in 0.06s]
[0m13:52:13.204581 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:52:13.205107 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:52:13.205875 [info ] [Thread-1 (]: 29 of 32 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_stage  [RUN]
[0m13:52:13.206657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_new_deals, now model.enpal_assessment_project.int_deal_changes_dedupe_stage)
[0m13:52:13.207143 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:52:13.210112 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:52:13.210933 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:52:13.216794 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:52:13.217634 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:52:13.218088 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: BEGIN
[0m13:52:13.218494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:13.238696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:52:13.239555 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:52:13.240168 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_tmp"
    
    
  as (
    -- Separate new deals model from the deal_changes model
-- There are a handful of dupe deals in the deal_changes model (assumption - deals should not have more of each stage id)
-- Materialize as a view so it can be tested for deduplication
-- Method: row_number in reverse order and then pick the first row. 
-- This pattern is better because we don't know how many duplicate rows there could be, but the latest will always be row number 1.
-- Can't just take MAX(new_value) as was done for new_deals, because there are multiple stage_ids and all that appear need to be presented to the model.
WITH deal_changes_stage AS (
	SELECT
		ROW_NUMBER() OVER(PARTITION BY deal_id, new_value ORDER BY new_value, change_time DESC) AS reverse_order,
		deal_id,
		new_value AS stage_id,
		change_time
	FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'stage_id'
)
SELECT * FROM deal_changes_stage WHERE reverse_order = 1
  );
[0m13:52:13.244009 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:52:13.247479 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:52:13.248108 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_tmp" rename to "int_deal_changes_dedupe_stage"
[0m13:52:13.249864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:13.251600 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: COMMIT
[0m13:52:13.252049 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:52:13.252531 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: COMMIT
[0m13:52:13.254515 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:52:13.257538 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_backup"
[0m13:52:13.258599 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:52:13.259095 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */
drop view if exists "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_backup" cascade
[0m13:52:13.260792 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:52:13.262781 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: Close
[0m13:52:13.263487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d4b5e99-8cc4-45f7-b202-61e98ec08c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ced6ea0>]}
[0m13:52:13.264322 [info ] [Thread-1 (]: 29 of 32 OK created sql view model public_pipedrive_analytics.int_deal_changes_dedupe_stage  [[32mCREATE VIEW[0m in 0.06s]
[0m13:52:13.265068 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:52:13.265706 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907
[0m13:52:13.266533 [info ] [Thread-1 (]: 30 of 32 START test unique_int_deal_changes_dedupe_lost_reason_deal_id ......... [RUN]
[0m13:52:13.267345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_stage, now test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907)
[0m13:52:13.267814 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907
[0m13:52:13.274918 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907"
[0m13:52:13.275751 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907
[0m13:52:13.278106 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907"
[0m13:52:13.279100 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907"
[0m13:52:13.279589 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907: BEGIN
[0m13:52:13.280007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:13.296991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:52:13.297670 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907"
[0m13:52:13.298209 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    deal_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_lost_reason"
where deal_id is not null
group by deal_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:52:13.304719 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:52:13.306604 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907: ROLLBACK
[0m13:52:13.308007 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907: Close
[0m13:52:13.308739 [info ] [Thread-1 (]: 30 of 32 PASS unique_int_deal_changes_dedupe_lost_reason_deal_id ............... [[32mPASS[0m in 0.04s]
[0m13:52:13.309550 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907
[0m13:52:13.310093 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:52:13.310640 [info ] [Thread-1 (]: 31 of 32 START test unique_int_deal_changes_dedupe_new_deals_deal_id ........... [RUN]
[0m13:52:13.311400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907, now test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7)
[0m13:52:13.311891 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:52:13.316777 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:52:13.317620 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:52:13.320029 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:52:13.320870 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:52:13.321338 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: BEGIN
[0m13:52:13.321760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:13.339704 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:52:13.340473 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:52:13.340954 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    deal_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals"
where deal_id is not null
group by deal_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:52:13.346251 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:52:13.348180 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: ROLLBACK
[0m13:52:13.349992 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: Close
[0m13:52:13.350961 [info ] [Thread-1 (]: 31 of 32 PASS unique_int_deal_changes_dedupe_new_deals_deal_id ................. [[32mPASS[0m in 0.04s]
[0m13:52:13.352041 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:52:13.352755 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:52:13.353478 [info ] [Thread-1 (]: 32 of 32 START test assert_unique_deal_stage ................................... [RUN]
[0m13:52:13.354081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7, now test.enpal_assessment_project.assert_unique_deal_stage)
[0m13:52:13.354529 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:52:13.357635 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:52:13.358519 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:52:13.361224 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:52:13.362312 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:52:13.362877 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: BEGIN
[0m13:52:13.363333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:13.379592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:52:13.380273 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:52:13.380790 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_unique_deal_stage"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    COUNT(*),
    deal_id,
    stage_id
FROM "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage"
GROUP BY
    deal_id,
    stage_id
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m13:52:13.399423 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m13:52:13.401269 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: ROLLBACK
[0m13:52:13.402781 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: Close
[0m13:52:13.403569 [info ] [Thread-1 (]: 32 of 32 PASS assert_unique_deal_stage ......................................... [[32mPASS[0m in 0.05s]
[0m13:52:13.404435 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:52:13.405981 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:13.406499 [debug] [MainThread]: On master: BEGIN
[0m13:52:13.406880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:13.422110 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m13:52:13.422696 [debug] [MainThread]: On master: COMMIT
[0m13:52:13.423500 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:13.424029 [debug] [MainThread]: On master: COMMIT
[0m13:52:13.425651 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:52:13.426124 [debug] [MainThread]: On master: Close
[0m13:52:13.426630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:13.426990 [debug] [MainThread]: Connection 'test.enpal_assessment_project.assert_unique_deal_stage' was properly closed.
[0m13:52:13.427456 [info ] [MainThread]: 
[0m13:52:13.427866 [info ] [MainThread]: Finished running 11 view models, 21 data tests in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m13:52:13.434700 [debug] [MainThread]: Command end result
[0m13:52:13.471621 [info ] [MainThread]: 
[0m13:52:13.472138 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:13.472543 [info ] [MainThread]: 
[0m13:52:13.473112 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m13:52:13.475369 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.6116805, "process_in_blocks": "0", "process_kernel_time": 0.630798, "process_mem_max_rss": "118312960", "process_out_blocks": "0", "process_user_time": 4.292108}
[0m13:52:13.476097 [debug] [MainThread]: Command `dbt build` succeeded at 13:52:13.475957 after 3.61 seconds
[0m13:52:13.476590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b6d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6b9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6ab200>]}
[0m13:52:13.477025 [debug] [MainThread]: Flushing usage events
[0m13:59:45.804927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb92a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e37110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e36c30>]}


============================== 13:59:45.813535 | 5486dc1b-1423-4eba-85c8-4b93e4809c0f ==============================
[0m13:59:45.813535 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:59:45.814731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:59:46.129553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d185f0>]}
[0m13:59:46.198966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11119fd40>]}
[0m13:59:46.200827 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:59:46.352443 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:59:46.542782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:59:46.543575 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/intermediate/int_deal_changes_user.sql
[0m13:59:46.544065 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/intermediate/int_activity_join_activity_types.sql
[0m13:59:46.857058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d07800>]}
[0m13:59:47.007727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112debfb0>]}
[0m13:59:47.008374 [info ] [MainThread]: Found 21 data tests, 13 models, 6 sources, 428 macros
[0m13:59:47.009026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11242c2f0>]}
[0m13:59:47.013716 [info ] [MainThread]: 
[0m13:59:47.014585 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:47.019976 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:59:47.100146 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:59:47.100641 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:59:47.101027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:47.170879 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.070 seconds
[0m13:59:47.172557 [debug] [ThreadPool]: On list_postgres: Close
[0m13:59:47.174896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:59:47.181758 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:59:47.182301 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m13:59:47.182672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:47.200562 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m13:59:47.201154 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:59:47.201603 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:59:47.205780 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m13:59:47.207460 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:59:47.208842 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:59:47.217946 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:47.218389 [debug] [MainThread]: On master: BEGIN
[0m13:59:47.218824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:47.236209 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m13:59:47.236981 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:47.237564 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:59:47.243058 [debug] [MainThread]: SQL status: SELECT 11 in 0.005 seconds
[0m13:59:47.246210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11319c8f0>]}
[0m13:59:47.246740 [debug] [MainThread]: On master: ROLLBACK
[0m13:59:47.248085 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:47.248692 [debug] [MainThread]: On master: BEGIN
[0m13:59:47.252223 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:59:47.253025 [debug] [MainThread]: On master: COMMIT
[0m13:59:47.253429 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:47.253791 [debug] [MainThread]: On master: COMMIT
[0m13:59:47.255180 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:59:47.255623 [debug] [MainThread]: On master: Close
[0m13:59:47.256166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:47.256668 [info ] [MainThread]: 
[0m13:59:47.260446 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.base_pipedrive__fields
[0m13:59:47.261604 [info ] [Thread-1 (]: 1 of 11 START sql view model public_pipedrive_analytics.base_pipedrive__fields . [RUN]
[0m13:59:47.262635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.base_pipedrive__fields)
[0m13:59:47.263320 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.base_pipedrive__fields
[0m13:59:47.274177 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:59:47.276342 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.base_pipedrive__fields
[0m13:59:47.322310 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:59:47.323396 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:59:47.323873 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: BEGIN
[0m13:59:47.324276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:47.341993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:59:47.342679 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:59:47.343141 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */

  create view "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."fields"
  );
[0m13:59:47.345884 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:59:47.353213 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:59:47.353732 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields" rename to "base_pipedrive__fields__dbt_backup"
[0m13:59:47.355508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:47.358859 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:59:47.359335 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
alter table "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_tmp" rename to "base_pipedrive__fields"
[0m13:59:47.361159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:47.380127 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m13:59:47.380667 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:59:47.381089 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: COMMIT
[0m13:59:47.385075 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:59:47.392297 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup"
[0m13:59:47.398017 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.base_pipedrive__fields"
[0m13:59:47.398603 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.base_pipedrive__fields"} */
drop view if exists "postgres"."public_pipedrive_analytics"."base_pipedrive__fields__dbt_backup" cascade
[0m13:59:47.402620 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:59:47.405537 [debug] [Thread-1 (]: On model.enpal_assessment_project.base_pipedrive__fields: Close
[0m13:59:47.407307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110739760>]}
[0m13:59:47.408107 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public_pipedrive_analytics.base_pipedrive__fields  [[32mCREATE VIEW[0m in 0.14s]
[0m13:59:47.409083 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.base_pipedrive__fields
[0m13:59:47.409724 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:59:47.410461 [info ] [Thread-1 (]: 2 of 11 START sql view model public_pipedrive_analytics.stg_pipedrive__activity  [RUN]
[0m13:59:47.411019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.base_pipedrive__fields, now model.enpal_assessment_project.stg_pipedrive__activity)
[0m13:59:47.411453 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:59:47.414347 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:59:47.415143 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:59:47.419415 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:59:47.420313 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:59:47.420748 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: BEGIN
[0m13:59:47.421149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:47.439211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:59:47.439847 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:59:47.440301 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp"
    
    
  as (
    -- This model is a staging table for the activity table in the Pipedrive database.
-- Renaming a couple of columns to avoid using reserved keywords
-- Rename others for consistency with other models: model.id, model.reference_model_id
SELECT
    activity_id AS id,
    type AS activity_type,
    assigned_to_user AS user_id,
    deal_id,
    done AS is_done,
    due_to::TIMESTAMP AS due_time
FROM "postgres"."public"."activity"
  );
[0m13:59:47.443101 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:59:47.447597 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:59:47.448105 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity" rename to "stg_pipedrive__activity__dbt_backup"
[0m13:59:47.450091 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:47.454731 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:59:47.455211 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_tmp" rename to "stg_pipedrive__activity"
[0m13:59:47.457290 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:59:47.459236 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:59:47.459726 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:59:47.460146 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: COMMIT
[0m13:59:47.462677 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:59:47.465617 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup"
[0m13:59:47.466649 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity"
[0m13:59:47.467108 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity__dbt_backup" cascade
[0m13:59:47.469996 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:59:47.471690 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity: Close
[0m13:59:47.472800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11329b470>]}
[0m13:59:47.474310 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity  [[32mCREATE VIEW[0m in 0.06s]
[0m13:59:47.475497 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity
[0m13:59:47.476465 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:59:47.477401 [info ] [Thread-1 (]: 3 of 11 START sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [RUN]
[0m13:59:47.478340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity, now model.enpal_assessment_project.stg_pipedrive__activity_types)
[0m13:59:47.479494 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:59:47.483462 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:59:47.484809 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:59:47.490816 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:59:47.491836 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:59:47.492574 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: BEGIN
[0m13:59:47.494407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:47.520743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m13:59:47.521711 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:59:47.522402 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp"
    
    
  as (
    -- This model is generated from the `activity_types` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords
-- The `active` column is a string with just two possible value. It makes more sense as a bool
SELECT
    id,
    name AS activity_name,
    CASE
        WHEN active = 'Yes' THEN TRUE
        ELSE FALSE
    END AS activity_is_active,
    type AS activity_type
FROM "postgres"."public"."activity_types"
  );
[0m13:59:47.526160 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:59:47.529993 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:59:47.530552 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types" rename to "stg_pipedrive__activity_types__dbt_backup"
[0m13:59:47.532927 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:59:47.536661 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:59:47.537230 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_tmp" rename to "stg_pipedrive__activity_types"
[0m13:59:47.539425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:59:47.541623 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:59:47.542258 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:59:47.542807 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: COMMIT
[0m13:59:47.545270 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:59:47.548022 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup"
[0m13:59:47.548894 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__activity_types"
[0m13:59:47.549543 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types__dbt_backup" cascade
[0m13:59:47.552884 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:59:47.555133 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__activity_types: Close
[0m13:59:47.555917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132aa5d0>]}
[0m13:59:47.556924 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public_pipedrive_analytics.stg_pipedrive__activity_types  [[32mCREATE VIEW[0m in 0.08s]
[0m13:59:47.557955 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__activity_types
[0m13:59:47.558857 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:59:47.559745 [info ] [Thread-1 (]: 4 of 11 START sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [RUN]
[0m13:59:47.560477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__activity_types, now model.enpal_assessment_project.stg_pipedrive__deal_changes)
[0m13:59:47.561029 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:59:47.582610 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:59:47.583686 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:59:47.589280 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:59:47.590170 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:59:47.590593 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: BEGIN
[0m13:59:47.590980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:47.607948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:59:47.608546 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:59:47.609021 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp"
    
    
  as (
    -- This model is generated from the `deal_changes` table in the `pipedrive` schema.
-- This is not a source deals table, and deal_id is not a PK (UNIQUE), so leave deal_id named as is
SELECT
    deal_id,
    change_time::TIMESTAMP AS change_time,
    changed_field_key,
    new_value
FROM "postgres"."public"."deal_changes"
  );
[0m13:59:47.611455 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:59:47.615083 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:59:47.615699 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes" rename to "stg_pipedrive__deal_changes__dbt_backup"
[0m13:59:47.617357 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:47.620739 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:59:47.621203 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_tmp" rename to "stg_pipedrive__deal_changes"
[0m13:59:47.622720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:47.624589 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:59:47.625033 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:59:47.625441 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: COMMIT
[0m13:59:47.627239 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:59:47.631370 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup"
[0m13:59:47.632290 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__deal_changes"
[0m13:59:47.632795 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes__dbt_backup" cascade
[0m13:59:47.636437 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:59:47.638044 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__deal_changes: Close
[0m13:59:47.638639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132dc4d0>]}
[0m13:59:47.639318 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public_pipedrive_analytics.stg_pipedrive__deal_changes  [[32mCREATE VIEW[0m in 0.08s]
[0m13:59:47.640032 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__deal_changes
[0m13:59:47.640535 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:59:47.641233 [info ] [Thread-1 (]: 5 of 11 START sql view model public_pipedrive_analytics.stg_pipedrive__stages .. [RUN]
[0m13:59:47.641948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__deal_changes, now model.enpal_assessment_project.stg_pipedrive__stages)
[0m13:59:47.642397 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:59:47.645283 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:59:47.646121 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:59:47.650215 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:59:47.651192 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:59:47.651729 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: BEGIN
[0m13:59:47.652143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:47.668251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:59:47.668844 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:59:47.669308 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp"
    
    
  as (
    /* NOT USED. 
    The source table has it's origins in the fields table, which is not used in the final model.
    I would rather keep stages and lost_reasons standardised in the final model.
    My assumption is that the fields table is used to store custom fields,
    and if this were to be updated by a sysadmin, the static stages table would not reflect the changes.
NOT USED. */

-- This model is generated from the `stages` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    stage_id AS id,
    stage_name
FROM "postgres"."public"."stages"
  );
[0m13:59:47.672140 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:59:47.675551 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:59:47.676014 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages" rename to "stg_pipedrive__stages__dbt_backup"
[0m13:59:47.677502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:47.680702 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:59:47.681153 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_tmp" rename to "stg_pipedrive__stages"
[0m13:59:47.682829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:47.684812 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:59:47.685260 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:59:47.685778 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: COMMIT
[0m13:59:47.687700 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:59:47.690323 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup"
[0m13:59:47.691217 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__stages"
[0m13:59:47.691707 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__stages__dbt_backup" cascade
[0m13:59:47.694404 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:59:47.695973 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__stages: Close
[0m13:59:47.696547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132cd160>]}
[0m13:59:47.697216 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public_pipedrive_analytics.stg_pipedrive__stages  [[32mCREATE VIEW[0m in 0.05s]
[0m13:59:47.697932 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__stages
[0m13:59:47.698434 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:59:47.699374 [info ] [Thread-1 (]: 6 of 11 START sql view model public_pipedrive_analytics.stg_pipedrive__users ... [RUN]
[0m13:59:47.699963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__stages, now model.enpal_assessment_project.stg_pipedrive__users)
[0m13:59:47.700562 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__users
[0m13:59:47.703468 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:59:47.704325 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__users
[0m13:59:47.708533 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:59:47.709527 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:59:47.709973 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: BEGIN
[0m13:59:47.710373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:47.727221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:59:47.727978 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:59:47.728484 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp"
    
    
  as (
    -- This model is generated from the `users` table in the `pipedrive` schema.
-- Renaming a couple of columns to avoid using reserved keywords and standardise
SELECT
    id,
    name AS user_name,
    email AS user_email,
    modified::TIMESTAMP AS modified_time
FROM "postgres"."public"."users"
  );
[0m13:59:47.730943 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:59:47.734500 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:59:47.735013 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" rename to "stg_pipedrive__users__dbt_backup"
[0m13:59:47.736708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:47.740011 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:59:47.740468 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_tmp" rename to "stg_pipedrive__users"
[0m13:59:47.741940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:47.743778 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:59:47.744216 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:59:47.744619 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: COMMIT
[0m13:59:47.746452 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:59:47.749387 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup"
[0m13:59:47.750264 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__users"
[0m13:59:47.750695 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__users__dbt_backup" cascade
[0m13:59:47.753281 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:59:47.754869 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__users: Close
[0m13:59:47.755449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131bbec0>]}
[0m13:59:47.756116 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public_pipedrive_analytics.stg_pipedrive__users  [[32mCREATE VIEW[0m in 0.06s]
[0m13:59:47.756894 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__users
[0m13:59:47.757399 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:59:47.758051 [info ] [Thread-1 (]: 7 of 11 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [RUN]
[0m13:59:47.758617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__users, now model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons)
[0m13:59:47.759071 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:59:47.761954 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:59:47.763110 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:59:47.769039 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:59:47.769935 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:59:47.770375 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: BEGIN
[0m13:59:47.770778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:47.790402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:59:47.791092 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:59:47.791670 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'lost_reason'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS reason
FROM expand_array
  );
[0m13:59:47.795034 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:59:47.798397 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:59:47.799143 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_tmp" rename to "stg_pipedrive__fields_lost_reasons"
[0m13:59:47.801095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:47.803247 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m13:59:47.803769 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:59:47.804193 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: COMMIT
[0m13:59:47.806277 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:59:47.808915 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup"
[0m13:59:47.810003 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"
[0m13:59:47.810467 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons__dbt_backup" cascade
[0m13:59:47.811830 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:59:47.813378 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons: Close
[0m13:59:47.813949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132f9b50>]}
[0m13:59:47.814621 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_lost_reasons  [[32mCREATE VIEW[0m in 0.06s]
[0m13:59:47.815336 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons
[0m13:59:47.816081 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:59:47.816847 [info ] [Thread-1 (]: 8 of 11 START sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [RUN]
[0m13:59:47.817419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_lost_reasons, now model.enpal_assessment_project.stg_pipedrive__fields_stages)
[0m13:59:47.817858 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:59:47.820558 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:59:47.821331 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:59:47.825126 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:59:47.825899 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:59:47.826335 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: BEGIN
[0m13:59:47.826746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:47.842469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:59:47.843304 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:59:47.843871 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp"
    
    
  as (
    -- This model is generated from the `base_pipedrive__fields` model, which has the values buried in a JSON array.
-- ids should be INTEGER as a rule, even though one DBT test is comparing this to a STRING, I still prefer to cast to INTEGER here and in the test.
-- because in the real world, collaborators would be confused to see numeric-looking values as STRINGs.
WITH expand_array AS (
	SELECT 
		jsonb_array_elements(field_value_options) AS field_value_options
	FROM "postgres"."public_pipedrive_analytics"."base_pipedrive__fields"
	WHERE field_key = 'stage_id'
)
SELECT
	CAST(field_value_options ->> 'id' AS INTEGER) AS id,
	field_value_options ->> 'label' AS stage_name
FROM expand_array
  );
[0m13:59:47.847076 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:59:47.850600 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:59:47.851105 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_tmp" rename to "stg_pipedrive__fields_stages"
[0m13:59:47.852729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:47.854456 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m13:59:47.854898 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:59:47.855309 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: COMMIT
[0m13:59:47.856964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:59:47.859527 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup"
[0m13:59:47.860336 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_pipedrive__fields_stages"
[0m13:59:47.860771 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_pipedrive__fields_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages__dbt_backup" cascade
[0m13:59:47.862205 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:59:47.863771 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_pipedrive__fields_stages: Close
[0m13:59:47.864354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132b6f60>]}
[0m13:59:47.865033 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public_pipedrive_analytics.stg_pipedrive__fields_stages  [[32mCREATE VIEW[0m in 0.05s]
[0m13:59:47.866157 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_pipedrive__fields_stages
[0m13:59:47.867221 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:59:47.867849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_pipedrive__fields_stages, now model.enpal_assessment_project.int_activity_join_activity_types)
[0m13:59:47.868427 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:59:47.871826 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activity_join_activity_types"
[0m13:59:47.872931 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activity_join_activity_types
[0m13:59:47.873439 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason
[0m13:59:47.874232 [info ] [Thread-1 (]: 9 of 11 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_lost_reason  [RUN]
[0m13:59:47.874934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activity_join_activity_types, now model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason)
[0m13:59:47.875401 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason
[0m13:59:47.878221 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:59:47.879052 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason
[0m13:59:47.884112 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:59:47.885359 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:59:47.885952 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: BEGIN
[0m13:59:47.886391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:47.905355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:59:47.906055 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:59:47.906532 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_lost_reason__dbt_tmp"
    
    
  as (
    WITH deal_changes_lost_reason AS (
	SELECT
		ROW_NUMBER() OVER(PARTITION BY deal_id ORDER BY change_time DESC) AS reverse_order,
		deal_id,
		new_value AS lost_reason,
		change_time
	FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'lost_reason'
)
SELECT * FROM deal_changes_lost_reason WHERE reverse_order = 1
  );
[0m13:59:47.909937 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:59:47.913399 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:59:47.913884 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_lost_reason__dbt_tmp" rename to "int_deal_changes_dedupe_lost_reason"
[0m13:59:47.915799 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:47.917601 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: COMMIT
[0m13:59:47.918056 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:59:47.918471 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: COMMIT
[0m13:59:47.920610 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:59:47.925752 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_lost_reason__dbt_backup"
[0m13:59:47.926733 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"
[0m13:59:47.927202 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason"} */
drop view if exists "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_lost_reason__dbt_backup" cascade
[0m13:59:47.928928 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:59:47.930626 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason: Close
[0m13:59:47.931240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132c6960>]}
[0m13:59:47.932309 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public_pipedrive_analytics.int_deal_changes_dedupe_lost_reason  [[32mCREATE VIEW[0m in 0.06s]
[0m13:59:47.933404 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason
[0m13:59:47.934674 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:59:47.935434 [info ] [Thread-1 (]: 10 of 11 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_new_deals  [RUN]
[0m13:59:47.936059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_lost_reason, now model.enpal_assessment_project.int_deal_changes_dedupe_new_deals)
[0m13:59:47.936591 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:59:47.939552 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:59:47.940351 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:59:47.944120 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:59:47.944904 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:59:47.945350 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: BEGIN
[0m13:59:47.945823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:47.966735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:59:47.967645 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:59:47.968277 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_tmp"
    
    
  as (
    -- Separate new deals model from the deal_changes model
-- There are a handful of dupe deals in the deal_changes model (assumption - deals should not have more than one added date)
-- Materialize as a view so it can be tested for deduplication
SELECT
	deal_id, 
	MAX(change_time)
FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
WHERE changed_field_key = 'add_time'
GROUP BY deal_id
  );
[0m13:59:47.972354 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:59:47.976173 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:59:47.976858 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_tmp" rename to "int_deal_changes_dedupe_new_deals"
[0m13:59:47.978801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:47.980841 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: COMMIT
[0m13:59:47.981338 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:59:47.981775 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: COMMIT
[0m13:59:47.985217 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:59:47.988683 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_backup"
[0m13:59:47.989811 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"
[0m13:59:47.990365 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_new_deals"} */
drop view if exists "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals__dbt_backup" cascade
[0m13:59:47.992246 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:59:47.994311 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_new_deals: Close
[0m13:59:47.995223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131921b0>]}
[0m13:59:47.996265 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public_pipedrive_analytics.int_deal_changes_dedupe_new_deals  [[32mCREATE VIEW[0m in 0.06s]
[0m13:59:47.997483 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_new_deals
[0m13:59:47.998490 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:59:47.999479 [info ] [Thread-1 (]: 11 of 11 START sql view model public_pipedrive_analytics.int_deal_changes_dedupe_stage  [RUN]
[0m13:59:48.000386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_new_deals, now model.enpal_assessment_project.int_deal_changes_dedupe_stage)
[0m13:59:48.001153 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:59:48.005433 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:59:48.006359 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:59:48.011153 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:59:48.012009 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:59:48.012833 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: BEGIN
[0m13:59:48.013562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:48.039314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m13:59:48.040335 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:59:48.041154 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */

  create view "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_tmp"
    
    
  as (
    -- Separate new deals model from the deal_changes model
-- There are a handful of dupe deals in the deal_changes model (assumption - deals should not have more of each stage id)
-- Materialize as a view so it can be tested for deduplication
-- Method: row_number in reverse order and then pick the first row. 
-- This pattern is better because we don't know how many duplicate rows there could be, but the latest will always be row number 1.
-- Can't just take MAX(new_value) as was done for new_deals, because there are multiple stage_ids and all that appear need to be presented to the model.
WITH deal_changes_stage AS (
	SELECT
		ROW_NUMBER() OVER(PARTITION BY deal_id, new_value ORDER BY new_value, change_time DESC) AS reverse_order,
		deal_id,
		new_value AS stage_id,
		change_time
	FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'stage_id'
)
SELECT * FROM deal_changes_stage WHERE reverse_order = 1
  );
[0m13:59:48.046163 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:59:48.054025 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:59:48.055674 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_tmp" rename to "int_deal_changes_dedupe_stage"
[0m13:59:48.058264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:59:48.061260 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: COMMIT
[0m13:59:48.061947 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:59:48.062586 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: COMMIT
[0m13:59:48.064976 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:59:48.069329 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_backup"
[0m13:59:48.071049 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_changes_dedupe_stage"
[0m13:59:48.071864 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_changes_dedupe_stage"} */
drop view if exists "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage__dbt_backup" cascade
[0m13:59:48.073981 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:59:48.076485 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_changes_dedupe_stage: Close
[0m13:59:48.077498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5486dc1b-1423-4eba-85c8-4b93e4809c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11325e360>]}
[0m13:59:48.078595 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public_pipedrive_analytics.int_deal_changes_dedupe_stage  [[32mCREATE VIEW[0m in 0.08s]
[0m13:59:48.079774 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_dedupe_stage
[0m13:59:48.080718 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_changes_user
[0m13:59:48.082015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_changes_dedupe_stage, now model.enpal_assessment_project.int_deal_changes_user)
[0m13:59:48.082975 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_changes_user
[0m13:59:48.087978 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_changes_user"
[0m13:59:48.089573 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_changes_user
[0m13:59:48.091274 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:48.091854 [debug] [MainThread]: On master: BEGIN
[0m13:59:48.092421 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:48.111180 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m13:59:48.111937 [debug] [MainThread]: On master: COMMIT
[0m13:59:48.112365 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:48.112780 [debug] [MainThread]: On master: COMMIT
[0m13:59:48.114107 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:59:48.114548 [debug] [MainThread]: On master: Close
[0m13:59:48.115060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:48.115494 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_deal_changes_user' was properly closed.
[0m13:59:48.116228 [info ] [MainThread]: 
[0m13:59:48.116844 [info ] [MainThread]: Finished running 11 view models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m13:59:48.120100 [debug] [MainThread]: Command end result
[0m13:59:48.210724 [info ] [MainThread]: 
[0m13:59:48.211230 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:48.211622 [info ] [MainThread]: 
[0m13:59:48.212032 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m13:59:48.214559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.501678, "process_in_blocks": "0", "process_kernel_time": 0.588212, "process_mem_max_rss": "113963008", "process_out_blocks": "0", "process_user_time": 3.476293}
[0m13:59:48.215299 [debug] [MainThread]: Command `dbt run` succeeded at 13:59:48.215158 after 2.50 seconds
[0m13:59:48.216009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118bbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118d40b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118d4800>]}
[0m13:59:48.216531 [debug] [MainThread]: Flushing usage events
[0m13:59:53.284699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110953380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af2c30>]}


============================== 13:59:53.289815 | 433f714e-087f-4cca-944c-771d898bb2a0 ==============================
[0m13:59:53.289815 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:59:53.290925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment/logs', 'debug': 'False', 'profiles_dir': '/Users/julian/Documents/hatvalues_repo/dbt_enpal_assessment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:59:53.527481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '433f714e-087f-4cca-944c-771d898bb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bbffe0>]}
[0m13:59:53.593054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '433f714e-087f-4cca-944c-771d898bb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119de480>]}
[0m13:59:53.594079 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:59:53.729057 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:59:53.884635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:53.885131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:53.943797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '433f714e-087f-4cca-944c-771d898bb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e8fb0>]}
[0m13:59:54.100609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '433f714e-087f-4cca-944c-771d898bb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c05910>]}
[0m13:59:54.101201 [info ] [MainThread]: Found 21 data tests, 13 models, 6 sources, 428 macros
[0m13:59:54.101640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '433f714e-087f-4cca-944c-771d898bb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11203d3d0>]}
[0m13:59:54.105069 [info ] [MainThread]: 
[0m13:59:54.105816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:54.110886 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m13:59:54.179718 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:59:54.180220 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: BEGIN
[0m13:59:54.180604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:54.210431 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m13:59:54.211014 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:59:54.211448 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:59:54.215300 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m13:59:54.217123 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:59:54.219079 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:59:54.226633 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:54.227079 [debug] [MainThread]: On master: BEGIN
[0m13:59:54.227419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:54.244198 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m13:59:54.244982 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:54.245618 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:59:54.253211 [debug] [MainThread]: SQL status: SELECT 11 in 0.007 seconds
[0m13:59:54.256199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '433f714e-087f-4cca-944c-771d898bb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110402720>]}
[0m13:59:54.256715 [debug] [MainThread]: On master: ROLLBACK
[0m13:59:54.258142 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:54.258684 [debug] [MainThread]: On master: BEGIN
[0m13:59:54.261779 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:59:54.262756 [debug] [MainThread]: On master: COMMIT
[0m13:59:54.263171 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:54.263524 [debug] [MainThread]: On master: COMMIT
[0m13:59:54.264814 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:59:54.265239 [debug] [MainThread]: On master: Close
[0m13:59:54.266039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:54.266560 [info ] [MainThread]: 
[0m13:59:54.269286 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:59:54.269864 [info ] [Thread-1 (]: 1 of 21 START test accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [RUN]
[0m13:59:54.270497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0)
[0m13:59:54.271041 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:59:54.294313 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:59:54.295302 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:59:54.317655 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:59:54.318592 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:59:54.319032 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: BEGIN
[0m13:59:54.319438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.336301 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:59:54.336937 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"
[0m13:59:54.337406 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        changed_field_key as value_field,
        count(*) as n_records

    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
    group by changed_field_key

)

select *
from all_values
where value_field not in (
    'user_id','stage_id','lost_reason','add_time'
)



      
    ) dbt_internal_test
[0m13:59:54.341826 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:59:54.346488 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: ROLLBACK
[0m13:59:54.348534 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0: Close
[0m13:59:54.349421 [info ] [Thread-1 (]: 1 of 21 PASS accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time  [[32mPASS[0m in 0.08s]
[0m13:59:54.350248 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0
[0m13:59:54.350807 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:59:54.351352 [info ] [Thread-1 (]: 2 of 21 START test assert_change_stage_references_lost_reason_id ............... [RUN]
[0m13:59:54.352069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_pipedrive__deal_changes_changed_field_key__user_id__stage_id__lost_reason__add_time.84526954c0, now test.enpal_assessment_project.assert_change_stage_references_lost_reason_id)
[0m13:59:54.352541 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:59:54.355584 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:59:54.356435 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:59:54.358848 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:59:54.359661 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:59:54.360084 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: BEGIN
[0m13:59:54.360478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.379159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:59:54.380318 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"
[0m13:59:54.380843 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_lost_reason_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'lost_reason'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_lost_reasons" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:59:54.385776 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:59:54.387571 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: ROLLBACK
[0m13:59:54.390305 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_lost_reason_id: Close
[0m13:59:54.391088 [info ] [Thread-1 (]: 2 of 21 PASS assert_change_stage_references_lost_reason_id ..................... [[32mPASS[0m in 0.04s]
[0m13:59:54.391855 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_lost_reason_id
[0m13:59:54.392389 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:59:54.392906 [info ] [Thread-1 (]: 3 of 21 START test assert_change_stage_references_stage_id ..................... [RUN]
[0m13:59:54.393627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_lost_reason_id, now test.enpal_assessment_project.assert_change_stage_references_stage_id)
[0m13:59:54.394122 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:59:54.397355 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:59:54.398414 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:59:54.402505 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:59:54.403410 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:59:54.403838 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: BEGIN
[0m13:59:54.404233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.420676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:59:54.421321 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_stage_references_stage_id"
[0m13:59:54.421868 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_stage_references_stage_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_stage AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'stage_id'
)
SELECT *
FROM deal_change_stage d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__fields_stages" s
ON CAST(d.new_value AS INTEGER) = s.id
WHERE s.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:59:54.428269 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:59:54.430182 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: ROLLBACK
[0m13:59:54.431660 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_stage_references_stage_id: Close
[0m13:59:54.432524 [info ] [Thread-1 (]: 3 of 21 PASS assert_change_stage_references_stage_id ........................... [[32mPASS[0m in 0.04s]
[0m13:59:54.433331 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_stage_references_stage_id
[0m13:59:54.433865 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:59:54.434377 [info ] [Thread-1 (]: 4 of 21 START test assert_change_user_references_user_id ....................... [RUN]
[0m13:59:54.435112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_stage_references_stage_id, now test.enpal_assessment_project.assert_change_user_references_user_id)
[0m13:59:54.435592 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:59:54.438398 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:59:54.439278 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:59:54.441728 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:59:54.442548 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:59:54.443044 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: BEGIN
[0m13:59:54.443439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.459767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:59:54.460366 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_change_user_references_user_id"
[0m13:59:54.460885 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_change_user_references_user_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- CTE to pre-filter deal_changes for stage_id changes
-- to safely cast new_value to an integer when we're sure all the values can be implicitly casted
WITH deal_change_user AS (
	SELECT changed_field_key, new_value FROM deal_changes
	WHERE changed_field_key = 'user_id'
)
SELECT *
FROM deal_change_user d
LEFT OUTER JOIN "postgres"."public_pipedrive_analytics"."stg_pipedrive__users" u
ON CAST(d.new_value AS INTEGER) = u.id
WHERE u.id IS NULL -- Any non referential values in d will return a NULL s.id
      
    ) dbt_internal_test
[0m13:59:54.467335 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:59:54.469088 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: ROLLBACK
[0m13:59:54.470472 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_change_user_references_user_id: Close
[0m13:59:54.471209 [info ] [Thread-1 (]: 4 of 21 PASS assert_change_user_references_user_id ............................. [[32mPASS[0m in 0.04s]
[0m13:59:54.471977 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_change_user_references_user_id
[0m13:59:54.472512 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:59:54.473029 [info ] [Thread-1 (]: 5 of 21 START test assert_timestamp_equal_add_time_new_value ................... [RUN]
[0m13:59:54.473852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_change_user_references_user_id, now test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value)
[0m13:59:54.474344 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:59:54.476250 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:59:54.477887 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:59:54.480420 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:59:54.481262 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:59:54.481717 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: BEGIN
[0m13:59:54.482133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.500145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:59:54.501138 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"
[0m13:59:54.501607 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Assert that the change_time is equal to the new_value when the changed_field_key is 'add_time'
-- With this test, it's OK to ignore the new_value field for add_time changes
SELECT * FROM "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
	WHERE changed_field_key = 'add_time'
	AND change_time != new_value::TIMESTAMP
      
    ) dbt_internal_test
[0m13:59:54.507187 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:59:54.508959 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: ROLLBACK
[0m13:59:54.510360 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value: Close
[0m13:59:54.511179 [info ] [Thread-1 (]: 5 of 21 PASS assert_timestamp_equal_add_time_new_value ......................... [[32mPASS[0m in 0.04s]
[0m13:59:54.511967 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value
[0m13:59:54.512531 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:59:54.513024 [info ] [Thread-1 (]: 6 of 21 START test assert_unique_deal_stage .................................... [RUN]
[0m13:59:54.513810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_timestamp_equal_add_time_new_value, now test.enpal_assessment_project.assert_unique_deal_stage)
[0m13:59:54.514342 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:59:54.518693 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:59:54.519972 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:59:54.522333 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:59:54.523080 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:59:54.523501 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: BEGIN
[0m13:59:54.523899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.540856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:59:54.541566 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.assert_unique_deal_stage"
[0m13:59:54.542016 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.assert_unique_deal_stage"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    COUNT(*),
    deal_id,
    stage_id
FROM "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_stage"
GROUP BY
    deal_id,
    stage_id
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m13:59:54.560996 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m13:59:54.562726 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: ROLLBACK
[0m13:59:54.564099 [debug] [Thread-1 (]: On test.enpal_assessment_project.assert_unique_deal_stage: Close
[0m13:59:54.564824 [info ] [Thread-1 (]: 6 of 21 PASS assert_unique_deal_stage .......................................... [[32mPASS[0m in 0.05s]
[0m13:59:54.565968 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.assert_unique_deal_stage
[0m13:59:54.566555 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:59:54.567069 [info ] [Thread-1 (]: 7 of 21 START test not_null_stg_pipedrive__activity_deal_id .................... [RUN]
[0m13:59:54.567815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.assert_unique_deal_stage, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e)
[0m13:59:54.568314 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:59:54.575698 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:59:54.576668 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:59:54.583430 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:59:54.584937 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:59:54.585479 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: BEGIN
[0m13:59:54.585994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.602247 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:59:54.602943 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"
[0m13:59:54.603418 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where deal_id is null



      
    ) dbt_internal_test
[0m13:59:54.605905 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:59:54.607789 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: ROLLBACK
[0m13:59:54.609505 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e: Close
[0m13:59:54.610414 [info ] [Thread-1 (]: 7 of 21 PASS not_null_stg_pipedrive__activity_deal_id .......................... [[32mPASS[0m in 0.04s]
[0m13:59:54.611284 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e
[0m13:59:54.611839 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:59:54.612363 [info ] [Thread-1 (]: 8 of 21 START test not_null_stg_pipedrive__activity_due_time ................... [RUN]
[0m13:59:54.613053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_deal_id.baf61bb80e, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191)
[0m13:59:54.613506 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:59:54.618978 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:59:54.619967 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:59:54.622551 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:59:54.623420 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:59:54.623878 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: BEGIN
[0m13:59:54.624301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.643322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:59:54.644027 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"
[0m13:59:54.644473 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select due_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where due_time is null



      
    ) dbt_internal_test
[0m13:59:54.647044 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:59:54.648852 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: ROLLBACK
[0m13:59:54.650585 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191: Close
[0m13:59:54.651419 [info ] [Thread-1 (]: 8 of 21 PASS not_null_stg_pipedrive__activity_due_time ......................... [[32mPASS[0m in 0.04s]
[0m13:59:54.652204 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191
[0m13:59:54.652824 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:59:54.653346 [info ] [Thread-1 (]: 9 of 21 START test not_null_stg_pipedrive__activity_id ......................... [RUN]
[0m13:59:54.654174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_due_time.a110302191, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb)
[0m13:59:54.654674 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:59:54.659281 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:59:54.660688 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:59:54.664052 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:59:54.665699 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:59:54.666323 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: BEGIN
[0m13:59:54.666967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.688503 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m13:59:54.689166 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"
[0m13:59:54.689750 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where id is null



      
    ) dbt_internal_test
[0m13:59:54.692497 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:59:54.694291 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: ROLLBACK
[0m13:59:54.695871 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb: Close
[0m13:59:54.696785 [info ] [Thread-1 (]: 9 of 21 PASS not_null_stg_pipedrive__activity_id ............................... [[32mPASS[0m in 0.04s]
[0m13:59:54.697827 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb
[0m13:59:54.698446 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:59:54.699324 [info ] [Thread-1 (]: 10 of 21 START test not_null_stg_pipedrive__activity_is_done ................... [RUN]
[0m13:59:54.700364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_id.5590c96fbb, now test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543)
[0m13:59:54.701307 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:59:54.706050 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:59:54.706944 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:59:54.709310 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:59:54.710082 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:59:54.710518 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: BEGIN
[0m13:59:54.710918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.730345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:59:54.731168 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"
[0m13:59:54.731704 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_done
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
where is_done is null



      
    ) dbt_internal_test
[0m13:59:54.736181 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:59:54.738732 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: ROLLBACK
[0m13:59:54.740440 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543: Close
[0m13:59:54.741260 [info ] [Thread-1 (]: 10 of 21 PASS not_null_stg_pipedrive__activity_is_done ......................... [[32mPASS[0m in 0.04s]
[0m13:59:54.742146 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543
[0m13:59:54.742858 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:59:54.743330 [info ] [Thread-1 (]: 11 of 21 START test not_null_stg_pipedrive__deal_changes_change_time ........... [RUN]
[0m13:59:54.744133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__activity_is_done.1d7811c543, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d)
[0m13:59:54.744678 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:59:54.749162 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:59:54.750046 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:59:54.752454 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:59:54.753236 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:59:54.753670 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: BEGIN
[0m13:59:54.754075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.774823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:59:54.775717 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"
[0m13:59:54.776266 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select change_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where change_time is null



      
    ) dbt_internal_test
[0m13:59:54.779634 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:59:54.781562 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: ROLLBACK
[0m13:59:54.783608 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d: Close
[0m13:59:54.784417 [info ] [Thread-1 (]: 11 of 21 PASS not_null_stg_pipedrive__deal_changes_change_time ................. [[32mPASS[0m in 0.04s]
[0m13:59:54.785165 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d
[0m13:59:54.785696 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:59:54.786234 [info ] [Thread-1 (]: 12 of 21 START test not_null_stg_pipedrive__deal_changes_deal_id ............... [RUN]
[0m13:59:54.786816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_change_time.aa9805807d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d)
[0m13:59:54.787266 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:59:54.791904 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:59:54.793047 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:59:54.796805 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:59:54.797729 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:59:54.798170 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: BEGIN
[0m13:59:54.798699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.817547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:59:54.818171 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"
[0m13:59:54.818633 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select deal_id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where deal_id is null



      
    ) dbt_internal_test
[0m13:59:54.822938 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:59:54.824757 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: ROLLBACK
[0m13:59:54.826392 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d: Close
[0m13:59:54.827256 [info ] [Thread-1 (]: 12 of 21 PASS not_null_stg_pipedrive__deal_changes_deal_id ..................... [[32mPASS[0m in 0.04s]
[0m13:59:54.828182 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d
[0m13:59:54.828824 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:59:54.829369 [info ] [Thread-1 (]: 13 of 21 START test not_null_stg_pipedrive__deal_changes_new_value ............. [RUN]
[0m13:59:54.829991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_deal_id.6ebfdbb65d, now test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96)
[0m13:59:54.830462 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:59:54.835702 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:59:54.836598 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:59:54.842040 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:59:54.843158 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:59:54.843628 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: BEGIN
[0m13:59:54.844028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.863071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:59:54.863862 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"
[0m13:59:54.864378 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select new_value
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__deal_changes"
where new_value is null



      
    ) dbt_internal_test
[0m13:59:54.868620 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:59:54.870448 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: ROLLBACK
[0m13:59:54.872043 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96: Close
[0m13:59:54.872825 [info ] [Thread-1 (]: 13 of 21 PASS not_null_stg_pipedrive__deal_changes_new_value ................... [[32mPASS[0m in 0.04s]
[0m13:59:54.873911 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96
[0m13:59:54.874463 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:59:54.874926 [info ] [Thread-1 (]: 14 of 21 START test not_null_stg_pipedrive__users_id ........................... [RUN]
[0m13:59:54.875566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__deal_changes_new_value.bb225b4f96, now test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817)
[0m13:59:54.876142 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:59:54.880725 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:59:54.881773 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:59:54.884307 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:59:54.885121 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:59:54.885560 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: BEGIN
[0m13:59:54.885959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.902908 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:59:54.903547 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"
[0m13:59:54.904025 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where id is null



      
    ) dbt_internal_test
[0m13:59:54.906174 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:59:54.907885 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: ROLLBACK
[0m13:59:54.909208 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817: Close
[0m13:59:54.910130 [info ] [Thread-1 (]: 14 of 21 PASS not_null_stg_pipedrive__users_id ................................. [[32mPASS[0m in 0.03s]
[0m13:59:54.910955 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817
[0m13:59:54.911632 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:59:54.912370 [info ] [Thread-1 (]: 15 of 21 START test not_null_stg_pipedrive__users_modified_time ................ [RUN]
[0m13:59:54.913125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_id.2e370a8817, now test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5)
[0m13:59:54.913696 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:59:54.918791 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:59:54.919654 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:59:54.922074 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:59:54.922886 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:59:54.923330 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: BEGIN
[0m13:59:54.923737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.940590 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:59:54.941312 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"
[0m13:59:54.941801 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select modified_time
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where modified_time is null



      
    ) dbt_internal_test
[0m13:59:54.945331 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:59:54.947152 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: ROLLBACK
[0m13:59:54.948675 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5: Close
[0m13:59:54.949984 [info ] [Thread-1 (]: 15 of 21 PASS not_null_stg_pipedrive__users_modified_time ...................... [[32mPASS[0m in 0.04s]
[0m13:59:54.950863 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5
[0m13:59:54.951385 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:59:54.951910 [info ] [Thread-1 (]: 16 of 21 START test not_null_stg_pipedrive__users_user_email ................... [RUN]
[0m13:59:54.952607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_modified_time.03287111d5, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157)
[0m13:59:54.953138 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:59:54.957952 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:59:54.958879 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:59:54.961256 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:59:54.962040 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:59:54.962484 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: BEGIN
[0m13:59:54.962884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:54.979690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:59:54.980398 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"
[0m13:59:54.980958 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_email
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_email is null



      
    ) dbt_internal_test
[0m13:59:54.983592 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:59:54.985430 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: ROLLBACK
[0m13:59:54.986789 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157: Close
[0m13:59:54.987518 [info ] [Thread-1 (]: 16 of 21 PASS not_null_stg_pipedrive__users_user_email ......................... [[32mPASS[0m in 0.03s]
[0m13:59:54.988251 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157
[0m13:59:54.988771 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:59:54.989272 [info ] [Thread-1 (]: 17 of 21 START test not_null_stg_pipedrive__users_user_name .................... [RUN]
[0m13:59:54.989831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_email.ea967e8157, now test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5)
[0m13:59:54.990371 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:59:54.994696 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:59:54.995521 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:59:54.997840 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:59:54.998607 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:59:54.999211 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: BEGIN
[0m13:59:54.999861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:55.017661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:59:55.018283 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"
[0m13:59:55.018753 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_name
from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
where user_name is null



      
    ) dbt_internal_test
[0m13:59:55.022546 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:59:55.024368 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: ROLLBACK
[0m13:59:55.025831 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5: Close
[0m13:59:55.026568 [info ] [Thread-1 (]: 17 of 21 PASS not_null_stg_pipedrive__users_user_name .......................... [[32mPASS[0m in 0.04s]
[0m13:59:55.027334 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5
[0m13:59:55.027862 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:59:55.028319 [info ] [Thread-1 (]: 18 of 21 START test relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [RUN]
[0m13:59:55.029044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_pipedrive__users_user_name.3145d7edb5, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8)
[0m13:59:55.029587 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:59:55.040112 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:59:55.041016 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:59:55.043434 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:59:55.044203 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:59:55.044645 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: BEGIN
[0m13:59:55.045050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:55.062210 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:59:55.062984 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"
[0m13:59:55.063598 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select activity_type as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where activity_type is not null
),

parent as (
    select activity_type as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity_types"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:59:55.068139 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:59:55.069956 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: ROLLBACK
[0m13:59:55.071464 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8: Close
[0m13:59:55.072233 [info ] [Thread-1 (]: 18 of 21 PASS relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_  [[32mPASS[0m in 0.04s]
[0m13:59:55.073065 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8
[0m13:59:55.073612 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:59:55.074070 [info ] [Thread-1 (]: 19 of 21 START test relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [RUN]
[0m13:59:55.074815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_activity_type__activity_type__ref_stg_pipedrive__activity_types_.7370c13ee8, now test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d)
[0m13:59:55.075300 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:59:55.081329 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:59:55.082314 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:59:55.086470 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:59:55.087320 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:59:55.087766 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: BEGIN
[0m13:59:55.088176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:55.106321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:59:55.107025 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"
[0m13:59:55.107521 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_id as from_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__activity"
    where user_id is not null
),

parent as (
    select id as to_field
    from "postgres"."public_pipedrive_analytics"."stg_pipedrive__users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:59:55.111509 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:59:55.113245 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: ROLLBACK
[0m13:59:55.114715 [debug] [Thread-1 (]: On test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d: Close
[0m13:59:55.115867 [info ] [Thread-1 (]: 19 of 21 PASS relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_  [[32mPASS[0m in 0.04s]
[0m13:59:55.116683 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d
[0m13:59:55.117201 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907
[0m13:59:55.117726 [info ] [Thread-1 (]: 20 of 21 START test unique_int_deal_changes_dedupe_lost_reason_deal_id ......... [RUN]
[0m13:59:55.118439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.relationships_stg_pipedrive__activity_user_id__id__ref_stg_pipedrive__users_.d7739cfd5d, now test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907)
[0m13:59:55.118912 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907
[0m13:59:55.125975 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907"
[0m13:59:55.126840 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907
[0m13:59:55.129177 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907"
[0m13:59:55.129914 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907"
[0m13:59:55.130363 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907: BEGIN
[0m13:59:55.130768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:55.150577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:59:55.151328 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907"
[0m13:59:55.151803 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    deal_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_lost_reason"
where deal_id is not null
group by deal_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:59:55.158449 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:59:55.160267 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907: ROLLBACK
[0m13:59:55.161803 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907: Close
[0m13:59:55.162584 [info ] [Thread-1 (]: 20 of 21 PASS unique_int_deal_changes_dedupe_lost_reason_deal_id ............... [[32mPASS[0m in 0.04s]
[0m13:59:55.163431 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907
[0m13:59:55.164042 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:59:55.164668 [info ] [Thread-1 (]: 21 of 21 START test unique_int_deal_changes_dedupe_new_deals_deal_id ........... [RUN]
[0m13:59:55.165754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_int_deal_changes_dedupe_lost_reason_deal_id.9dd6535907, now test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7)
[0m13:59:55.166375 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:59:55.171624 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:59:55.172583 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:59:55.175108 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:59:55.175970 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:59:55.176417 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: BEGIN
[0m13:59:55.176824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:55.196358 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:59:55.197210 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"
[0m13:59:55.197735 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    deal_id as unique_field,
    count(*) as n_records

from "postgres"."public_pipedrive_analytics"."int_deal_changes_dedupe_new_deals"
where deal_id is not null
group by deal_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:59:55.204321 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:59:55.206129 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: ROLLBACK
[0m13:59:55.207720 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7: Close
[0m13:59:55.208511 [info ] [Thread-1 (]: 21 of 21 PASS unique_int_deal_changes_dedupe_new_deals_deal_id ................. [[32mPASS[0m in 0.04s]
[0m13:59:55.209334 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7
[0m13:59:55.210688 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:55.211141 [debug] [MainThread]: On master: BEGIN
[0m13:59:55.211515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:55.229492 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m13:59:55.230231 [debug] [MainThread]: On master: COMMIT
[0m13:59:55.230706 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:55.231070 [debug] [MainThread]: On master: COMMIT
[0m13:59:55.233133 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m13:59:55.234026 [debug] [MainThread]: On master: Close
[0m13:59:55.234920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:55.235523 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_int_deal_changes_dedupe_new_deals_deal_id.b2c110fdd7' was properly closed.
[0m13:59:55.235987 [info ] [MainThread]: 
[0m13:59:55.236716 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m13:59:55.242151 [debug] [MainThread]: Command end result
[0m13:59:55.280970 [info ] [MainThread]: 
[0m13:59:55.281608 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:55.282705 [info ] [MainThread]: 
[0m13:59:55.283477 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m13:59:55.285672 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.088844, "process_in_blocks": "0", "process_kernel_time": 0.431757, "process_mem_max_rss": "111767552", "process_out_blocks": "0", "process_user_time": 2.963379}
[0m13:59:55.286433 [debug] [MainThread]: Command `dbt test` succeeded at 13:59:55.286291 after 2.09 seconds
[0m13:59:55.286954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddfed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ea81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ab1eb0>]}
[0m13:59:55.287397 [debug] [MainThread]: Flushing usage events
